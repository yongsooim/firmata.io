var ai=Object.defineProperty;var si=(e,o,t)=>o in e?ai(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t;var nt=(e,o,t)=>(si(e,typeof o!="symbol"?o+"":o,t),t);const p=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const f of s)if(f.type==="childList")for(const h of f.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function t(s){const f={};return s.integrity&&(f.integrity=s.integrity),s.referrerpolicy&&(f.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?f.credentials="include":s.crossorigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function r(s){if(s.ep)return;s.ep=!0;const f=t(s);fetch(s.href,f)}};p();function noop$1(){}function assign(e,o){for(const t in o)e[t]=o[t];return e}function run(e){return e()}function blank_object(){return Object.create(null)}function run_all(e){e.forEach(run)}function is_function(e){return typeof e=="function"}function safe_not_equal(e,o){return e!=e?o==o:e!==o||e&&typeof e=="object"||typeof e=="function"}function is_empty(e){return Object.keys(e).length===0}function create_slot(e,o,t,r){if(e){const s=get_slot_context(e,o,t,r);return e[0](s)}}function get_slot_context(e,o,t,r){return e[1]&&r?assign(t.ctx.slice(),e[1](r(o))):t.ctx}function get_slot_changes(e,o,t,r){if(e[2]&&r){const s=e[2](r(t));if(o.dirty===void 0)return s;if(typeof s=="object"){const f=[],h=Math.max(o.dirty.length,s.length);for(let g=0;g<h;g+=1)f[g]=o.dirty[g]|s[g];return f}return o.dirty|s}return o.dirty}function update_slot_base(e,o,t,r,s,f){if(s){const h=get_slot_context(o,t,r,f);e.p(h,s)}}function get_all_dirty_from_scope(e){if(e.ctx.length>32){const o=[],t=e.ctx.length/32;for(let r=0;r<t;r++)o[r]=-1;return o}return-1}function exclude_internal_props(e){const o={};for(const t in e)t[0]!=="$"&&(o[t]=e[t]);return o}function compute_rest_props(e,o){const t={};o=new Set(o);for(const r in e)!o.has(r)&&r[0]!=="$"&&(t[r]=e[r]);return t}function append(e,o){e.appendChild(o)}function insert(e,o,t){e.insertBefore(o,t||null)}function detach(e){e.parentNode.removeChild(e)}function destroy_each(e,o){for(let t=0;t<e.length;t+=1)e[t]&&e[t].d(o)}function element(e){return document.createElement(e)}function text(e){return document.createTextNode(e)}function space(){return text(" ")}function empty(){return text("")}function listen(e,o,t,r){return e.addEventListener(o,t,r),()=>e.removeEventListener(o,t,r)}function attr(e,o,t){t==null?e.removeAttribute(o):e.getAttribute(o)!==t&&e.setAttribute(o,t)}function set_attributes(e,o){const t=Object.getOwnPropertyDescriptors(e.__proto__);for(const r in o)o[r]==null?e.removeAttribute(r):r==="style"?e.style.cssText=o[r]:r==="__value"?e.value=e[r]=o[r]:t[r]&&t[r].set?e[r]=o[r]:attr(e,r,o[r])}function children(e){return Array.from(e.childNodes)}function set_data(e,o){o=""+o,e.wholeText!==o&&(e.data=o)}let current_component;function set_current_component(e){current_component=e}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function onMount(e){get_current_component().$$.on_mount.push(e)}function bubble(e,o){const t=e.$$.callbacks[o.type];t&&t.slice().forEach(r=>r.call(this,o))}const dirty_components=[],binding_callbacks=[],render_callbacks=[],flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function add_render_callback(e){render_callbacks.push(e)}const seen_callbacks=new Set;let flushidx=0;function flush(){const e=current_component;do{for(;flushidx<dirty_components.length;){const o=dirty_components[flushidx];flushidx++,set_current_component(o),update(o.$$)}for(set_current_component(null),dirty_components.length=0,flushidx=0;binding_callbacks.length;)binding_callbacks.pop()();for(let o=0;o<render_callbacks.length;o+=1){const t=render_callbacks[o];seen_callbacks.has(t)||(seen_callbacks.add(t),t())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,seen_callbacks.clear(),set_current_component(e)}function update(e){if(e.fragment!==null){e.update(),run_all(e.before_update);const o=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,o),e.after_update.forEach(add_render_callback)}}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(e,o){e&&e.i&&(outroing.delete(e),e.i(o))}function transition_out(e,o,t,r){if(e&&e.o){if(outroing.has(e))return;outroing.add(e),outros.c.push(()=>{outroing.delete(e),r&&(t&&e.d(1),r())}),e.o(o)}}function get_spread_update(e,o){const t={},r={},s={$$scope:1};let f=e.length;for(;f--;){const h=e[f],g=o[f];if(g){for(const u in h)u in g||(r[u]=1);for(const u in g)s[u]||(t[u]=g[u],s[u]=1);e[f]=g}else for(const u in h)s[u]=1}for(const h in r)h in t||(t[h]=void 0);return t}function create_component(e){e&&e.c()}function mount_component(e,o,t,r){const{fragment:s,on_mount:f,on_destroy:h,after_update:g}=e.$$;s&&s.m(o,t),r||add_render_callback(()=>{const u=f.map(run).filter(is_function);h?h.push(...u):run_all(u),e.$$.on_mount=[]}),g.forEach(add_render_callback)}function destroy_component(e,o){const t=e.$$;t.fragment!==null&&(run_all(t.on_destroy),t.fragment&&t.fragment.d(o),t.on_destroy=t.fragment=null,t.ctx=[])}function make_dirty(e,o){e.$$.dirty[0]===-1&&(dirty_components.push(e),schedule_update(),e.$$.dirty.fill(0)),e.$$.dirty[o/31|0]|=1<<o%31}function init(e,o,t,r,s,f,h,g=[-1]){const u=current_component;set_current_component(e);const d=e.$$={fragment:null,ctx:null,props:f,update:noop$1,not_equal:s,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(u?u.$$.context:[])),callbacks:blank_object(),dirty:g,skip_bound:!1,root:o.target||u.$$.root};h&&h(d.root);let a=!1;if(d.ctx=t?t(e,o.props||{},(b,v,...w)=>{const S=w.length?w[0]:v;return d.ctx&&s(d.ctx[b],d.ctx[b]=S)&&(!d.skip_bound&&d.bound[b]&&d.bound[b](S),a&&make_dirty(e,b)),v}):[],d.update(),a=!0,run_all(d.before_update),d.fragment=r?r(d.ctx):!1,o.target){if(o.hydrate){const b=children(o.target);d.fragment&&d.fragment.l(b),b.forEach(detach)}else d.fragment&&d.fragment.c();o.intro&&transition_in(e.$$.fragment),mount_component(e,o.target,o.anchor,o.customElement),flush()}set_current_component(u)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop$1}$on(o,t){const r=this.$$.callbacks[o]||(this.$$.callbacks[o]=[]);return r.push(t),()=>{const s=r.indexOf(t);s!==-1&&r.splice(s,1)}}$set(o){this.$$set&&!is_empty(o)&&(this.$$.skip_bound=!0,this.$$set(o),this.$$.skip_bound=!1)}}function isObject(e){const o=typeof e;return e!=null&&(o=="object"||o=="function")}function getColumnSizeClass(e,o,t){return t===!0||t===""?e?"col":`col-${o}`:t==="auto"?e?"col-auto":`col-${o}-auto`:e?`col-${t}`:`col-${o}-${t}`}function toClassName(e){let o="";if(typeof e=="string"||typeof e=="number")o+=e;else if(typeof e=="object")if(Array.isArray(e))o=e.map(toClassName).filter(Boolean).join(" ");else for(let t in e)e[t]&&(o&&(o+=" "),o+=t);return o}function classnames(...e){return e.map(toClassName).filter(Boolean).join(" ")}function create_else_block_1(e){let o,t,r,s,f;const h=e[19].default,g=create_slot(h,e,e[18],null),u=g||fallback_block(e);let d=[e[9],{class:e[7]},{disabled:e[2]},{value:e[5]},{"aria-label":t=e[8]||e[6]},{style:e[4]}],a={};for(let b=0;b<d.length;b+=1)a=assign(a,d[b]);return{c(){o=element("button"),u&&u.c(),set_attributes(o,a)},m(b,v){insert(b,o,v),u&&u.m(o,null),o.autofocus&&o.focus(),e[23](o),r=!0,s||(f=listen(o,"click",e[21]),s=!0)},p(b,v){g?g.p&&(!r||v&262144)&&update_slot_base(g,h,b,b[18],r?get_slot_changes(h,b[18],v,null):get_all_dirty_from_scope(b[18]),null):u&&u.p&&(!r||v&262146)&&u.p(b,r?v:-1),set_attributes(o,a=get_spread_update(d,[v&512&&b[9],(!r||v&128)&&{class:b[7]},(!r||v&4)&&{disabled:b[2]},(!r||v&32)&&{value:b[5]},(!r||v&320&&t!==(t=b[8]||b[6]))&&{"aria-label":t},(!r||v&16)&&{style:b[4]}]))},i(b){r||(transition_in(u,b),r=!0)},o(b){transition_out(u,b),r=!1},d(b){b&&detach(o),u&&u.d(b),e[23](null),s=!1,f()}}}function create_if_block$1(e){let o,t,r,s,f,h,g;const u=[create_if_block_1,create_else_block],d=[];function a(w,S){return w[1]?0:1}t=a(e),r=d[t]=u[t](e);let b=[e[9],{class:e[7]},{disabled:e[2]},{href:e[3]},{"aria-label":s=e[8]||e[6]},{style:e[4]}],v={};for(let w=0;w<b.length;w+=1)v=assign(v,b[w]);return{c(){o=element("a"),r.c(),set_attributes(o,v)},m(w,S){insert(w,o,S),d[t].m(o,null),e[22](o),f=!0,h||(g=listen(o,"click",e[20]),h=!0)},p(w,S){let E=t;t=a(w),t===E?d[t].p(w,S):(group_outros(),transition_out(d[E],1,1,()=>{d[E]=null}),check_outros(),r=d[t],r?r.p(w,S):(r=d[t]=u[t](w),r.c()),transition_in(r,1),r.m(o,null)),set_attributes(o,v=get_spread_update(b,[S&512&&w[9],(!f||S&128)&&{class:w[7]},(!f||S&4)&&{disabled:w[2]},(!f||S&8)&&{href:w[3]},(!f||S&320&&s!==(s=w[8]||w[6]))&&{"aria-label":s},(!f||S&16)&&{style:w[4]}]))},i(w){f||(transition_in(r),f=!0)},o(w){transition_out(r),f=!1},d(w){w&&detach(o),d[t].d(),e[22](null),h=!1,g()}}}function create_else_block_2(e){let o;const t=e[19].default,r=create_slot(t,e,e[18],null);return{c(){r&&r.c()},m(s,f){r&&r.m(s,f),o=!0},p(s,f){r&&r.p&&(!o||f&262144)&&update_slot_base(r,t,s,s[18],o?get_slot_changes(t,s[18],f,null):get_all_dirty_from_scope(s[18]),null)},i(s){o||(transition_in(r,s),o=!0)},o(s){transition_out(r,s),o=!1},d(s){r&&r.d(s)}}}function create_if_block_2(e){let o;return{c(){o=text(e[1])},m(t,r){insert(t,o,r)},p(t,r){r&2&&set_data(o,t[1])},i:noop$1,o:noop$1,d(t){t&&detach(o)}}}function fallback_block(e){let o,t,r,s;const f=[create_if_block_2,create_else_block_2],h=[];function g(u,d){return u[1]?0:1}return o=g(e),t=h[o]=f[o](e),{c(){t.c(),r=empty()},m(u,d){h[o].m(u,d),insert(u,r,d),s=!0},p(u,d){let a=o;o=g(u),o===a?h[o].p(u,d):(group_outros(),transition_out(h[a],1,1,()=>{h[a]=null}),check_outros(),t=h[o],t?t.p(u,d):(t=h[o]=f[o](u),t.c()),transition_in(t,1),t.m(r.parentNode,r))},i(u){s||(transition_in(t),s=!0)},o(u){transition_out(t),s=!1},d(u){h[o].d(u),u&&detach(r)}}}function create_else_block(e){let o;const t=e[19].default,r=create_slot(t,e,e[18],null);return{c(){r&&r.c()},m(s,f){r&&r.m(s,f),o=!0},p(s,f){r&&r.p&&(!o||f&262144)&&update_slot_base(r,t,s,s[18],o?get_slot_changes(t,s[18],f,null):get_all_dirty_from_scope(s[18]),null)},i(s){o||(transition_in(r,s),o=!0)},o(s){transition_out(r,s),o=!1},d(s){r&&r.d(s)}}}function create_if_block_1(e){let o;return{c(){o=text(e[1])},m(t,r){insert(t,o,r)},p(t,r){r&2&&set_data(o,t[1])},i:noop$1,o:noop$1,d(t){t&&detach(o)}}}function create_fragment$6(e){let o,t,r,s;const f=[create_if_block$1,create_else_block_1],h=[];function g(u,d){return u[3]?0:1}return o=g(e),t=h[o]=f[o](e),{c(){t.c(),r=empty()},m(u,d){h[o].m(u,d),insert(u,r,d),s=!0},p(u,[d]){let a=o;o=g(u),o===a?h[o].p(u,d):(group_outros(),transition_out(h[a],1,1,()=>{h[a]=null}),check_outros(),t=h[o],t?t.p(u,d):(t=h[o]=f[o](u),t.c()),transition_in(t,1),t.m(r.parentNode,r))},i(u){s||(transition_in(t),s=!0)},o(u){transition_out(t),s=!1},d(u){h[o].d(u),u&&detach(r)}}}function instance$5(e,o,t){let r,s,f;const h=["class","active","block","children","close","color","disabled","href","inner","outline","size","style","value","white"];let g=compute_rest_props(o,h),{$$slots:u={},$$scope:d}=o,{class:a=""}=o,{active:b=!1}=o,{block:v=!1}=o,{children:w=void 0}=o,{close:S=!1}=o,{color:E="secondary"}=o,{disabled:m=!1}=o,{href:_=""}=o,{inner:T=void 0}=o,{outline:M=!1}=o,{size:P=null}=o,{style:B=""}=o,{value:D=""}=o,{white:L=!1}=o;function X(q){bubble.call(this,e,q)}function ie(q){bubble.call(this,e,q)}function ue(q){binding_callbacks[q?"unshift":"push"](()=>{T=q,t(0,T)})}function fe(q){binding_callbacks[q?"unshift":"push"](()=>{T=q,t(0,T)})}return e.$$set=q=>{t(24,o=assign(assign({},o),exclude_internal_props(q))),t(9,g=compute_rest_props(o,h)),"class"in q&&t(10,a=q.class),"active"in q&&t(11,b=q.active),"block"in q&&t(12,v=q.block),"children"in q&&t(1,w=q.children),"close"in q&&t(13,S=q.close),"color"in q&&t(14,E=q.color),"disabled"in q&&t(2,m=q.disabled),"href"in q&&t(3,_=q.href),"inner"in q&&t(0,T=q.inner),"outline"in q&&t(15,M=q.outline),"size"in q&&t(16,P=q.size),"style"in q&&t(4,B=q.style),"value"in q&&t(5,D=q.value),"white"in q&&t(17,L=q.white),"$$scope"in q&&t(18,d=q.$$scope)},e.$$.update=()=>{t(8,r=o["aria-label"]),e.$$.dirty&261120&&t(7,s=classnames(a,S?"btn-close":"btn",S||`btn${M?"-outline":""}-${E}`,P?`btn-${P}`:!1,v?"d-block w-100":!1,{active:b,"btn-close-white":S&&L})),e.$$.dirty&8192&&t(6,f=S?"Close":null)},o=exclude_internal_props(o),[T,w,m,_,B,D,f,s,r,g,a,b,v,S,E,M,P,L,d,u,X,ie,ue,fe]}class Button extends SvelteComponent{constructor(o){super(),init(this,o,instance$5,create_fragment$6,safe_not_equal,{class:10,active:11,block:12,children:1,close:13,color:14,disabled:2,href:3,inner:0,outline:15,size:16,style:4,value:5,white:17})}}function create_fragment$5(e){let o,t,r;const s=e[10].default,f=create_slot(s,e,e[9],null);let h=[e[1],{class:t=e[0].join(" ")}],g={};for(let u=0;u<h.length;u+=1)g=assign(g,h[u]);return{c(){o=element("div"),f&&f.c(),set_attributes(o,g)},m(u,d){insert(u,o,d),f&&f.m(o,null),r=!0},p(u,[d]){f&&f.p&&(!r||d&512)&&update_slot_base(f,s,u,u[9],r?get_slot_changes(s,u[9],d,null):get_all_dirty_from_scope(u[9]),null),set_attributes(o,g=get_spread_update(h,[d&2&&u[1],{class:t}]))},i(u){r||(transition_in(f,u),r=!0)},o(u){transition_out(f,u),r=!1},d(u){u&&detach(o),f&&f.d(u)}}}function instance$4(e,o,t){const r=["class","xs","sm","md","lg","xl","xxl"];let s=compute_rest_props(o,r),{$$slots:f={},$$scope:h}=o,{class:g=""}=o,{xs:u=void 0}=o,{sm:d=void 0}=o,{md:a=void 0}=o,{lg:b=void 0}=o,{xl:v=void 0}=o,{xxl:w=void 0}=o;const S=[],E={xs:u,sm:d,md:a,lg:b,xl:v,xxl:w};return Object.keys(E).forEach(m=>{const _=E[m];if(!_&&_!=="")return;const T=m==="xs";if(isObject(_)){const M=T?"-":`-${m}-`,P=getColumnSizeClass(T,m,_.size);(_.size||_.size==="")&&S.push(P),_.push&&S.push(`push${M}${_.push}`),_.pull&&S.push(`pull${M}${_.pull}`),_.offset&&S.push(`offset${M}${_.offset}`),_.order&&S.push(`order${M}${_.order}`)}else S.push(getColumnSizeClass(T,m,_))}),S.length||S.push("col"),g&&S.push(g),e.$$set=m=>{o=assign(assign({},o),exclude_internal_props(m)),t(1,s=compute_rest_props(o,r)),"class"in m&&t(2,g=m.class),"xs"in m&&t(3,u=m.xs),"sm"in m&&t(4,d=m.sm),"md"in m&&t(5,a=m.md),"lg"in m&&t(6,b=m.lg),"xl"in m&&t(7,v=m.xl),"xxl"in m&&t(8,w=m.xxl),"$$scope"in m&&t(9,h=m.$$scope)},[S,s,g,u,d,a,b,v,w,h,f]}class Col extends SvelteComponent{constructor(o){super(),init(this,o,instance$4,create_fragment$5,safe_not_equal,{class:2,xs:3,sm:4,md:5,lg:6,xl:7,xxl:8})}}var Modal_svelte_svelte_type_style_lang=(()=>`.modal-open{overflow:hidden;padding-right:0}
`)(),Offcanvas_svelte_svelte_type_style_lang=(()=>`.overflow-noscroll{overflow:hidden;padding-right:0}
`)();function create_fragment$4(e){let o,t;const r=e[8].default,s=create_slot(r,e,e[7],null);let f=[e[2],{class:e[1]}],h={};for(let g=0;g<f.length;g+=1)h=assign(h,f[g]);return{c(){o=element("div"),s&&s.c(),set_attributes(o,h)},m(g,u){insert(g,o,u),s&&s.m(o,null),e[9](o),t=!0},p(g,[u]){s&&s.p&&(!t||u&128)&&update_slot_base(s,r,g,g[7],t?get_slot_changes(r,g[7],u,null):get_all_dirty_from_scope(g[7]),null),set_attributes(o,h=get_spread_update(f,[u&4&&g[2],(!t||u&2)&&{class:g[1]}]))},i(g){t||(transition_in(s,g),t=!0)},o(g){transition_out(s,g),t=!1},d(g){g&&detach(o),s&&s.d(g),e[9](null)}}}function getCols(e){const o=parseInt(e);if(isNaN(o)){if(typeof e=="object")return["xs","sm","md","lg","xl"].map(t=>{const s=t==="xs"?"-":`-${t}-`,f=e[t];return typeof f=="number"&&f>0?`row-cols${s}${f}`:null}).filter(t=>!!t)}else if(o>0)return[`row-cols-${o}`];return[]}function instance$3(e,o,t){let r;const s=["class","noGutters","form","cols","inner"];let f=compute_rest_props(o,s),{$$slots:h={},$$scope:g}=o,{class:u=""}=o,{noGutters:d=!1}=o,{form:a=!1}=o,{cols:b=0}=o,{inner:v=void 0}=o;function w(S){binding_callbacks[S?"unshift":"push"](()=>{v=S,t(0,v)})}return e.$$set=S=>{o=assign(assign({},o),exclude_internal_props(S)),t(2,f=compute_rest_props(o,s)),"class"in S&&t(3,u=S.class),"noGutters"in S&&t(4,d=S.noGutters),"form"in S&&t(5,a=S.form),"cols"in S&&t(6,b=S.cols),"inner"in S&&t(0,v=S.inner),"$$scope"in S&&t(7,g=S.$$scope)},e.$$.update=()=>{e.$$.dirty&120&&t(1,r=classnames(u,d?"gx-0":null,a?"form-row":"row",...getCols(b)))},[v,r,f,u,d,a,b,g,h,w]}class Row extends SvelteComponent{constructor(o){super(),init(this,o,instance$3,create_fragment$4,safe_not_equal,{class:3,noGutters:4,form:5,cols:6,inner:0})}}function create_if_block(e){let o;return{c(){o=element("link"),attr(o,"rel","stylesheet"),attr(o,"href","https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.0/font/bootstrap-icons.css")},m(t,r){insert(t,o,r)},d(t){t&&detach(o)}}}function create_fragment$3(e){let o,t,r=e[0]&&create_if_block();return{c(){o=element("link"),r&&r.c(),t=empty(),attr(o,"rel","stylesheet"),attr(o,"href","https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css")},m(s,f){append(document.head,o),r&&r.m(document.head,null),append(document.head,t)},p(s,[f]){s[0]?r||(r=create_if_block(),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null)},i:noop$1,o:noop$1,d(s){detach(o),r&&r.d(s),detach(t)}}}function instance$2(e,o,t){let{icons:r=!0}=o;return e.$$set=s=>{"icons"in s&&t(0,r=s.icons)},[r]}class Styles extends SvelteComponent{constructor(o){super(),init(this,o,instance$2,create_fragment$3,safe_not_equal,{icons:0})}}var extendStatics=function(e,o){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},extendStatics(e,o)};function __extends(e,o){if(typeof o!="function"&&o!==null)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");extendStatics(e,o);function t(){this.constructor=e}e.prototype=o===null?Object.create(o):(t.prototype=o.prototype,new t)}function __awaiter$1(e,o,t,r){function s(f){return f instanceof t?f:new t(function(h){h(f)})}return new(t||(t=Promise))(function(f,h){function g(a){try{d(r.next(a))}catch(b){h(b)}}function u(a){try{d(r.throw(a))}catch(b){h(b)}}function d(a){a.done?f(a.value):s(a.value).then(g,u)}d((r=r.apply(e,o||[])).next())})}function __generator$1(e,o){var t={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},r,s,f,h;return h={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function g(d){return function(a){return u([d,a])}}function u(d){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,s&&(f=d[0]&2?s.return:d[0]?s.throw||((f=s.return)&&f.call(s),0):s.next)&&!(f=f.call(s,d[1])).done)return f;switch(s=0,f&&(d=[d[0]&2,f.value]),d[0]){case 0:case 1:f=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,s=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(f=t.trys,!(f=f.length>0&&f[f.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!f||d[1]>f[0]&&d[1]<f[3])){t.label=d[1];break}if(d[0]===6&&t.label<f[1]){t.label=f[1],f=d;break}if(f&&t.label<f[2]){t.label=f[2],t.ops.push(d);break}f[2]&&t.ops.pop(),t.trys.pop();continue}d=o.call(e,t)}catch(a){d=[6,a],s=0}finally{r=f=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function __values(e){var o=typeof Symbol=="function"&&Symbol.iterator,t=o&&e[o],r=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(o?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(e,o){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var r=t.call(e),s,f=[],h;try{for(;(o===void 0||o-- >0)&&!(s=r.next()).done;)f.push(s.value)}catch(g){h={error:g}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(h)throw h.error}}return f}function __spreadArray(e,o,t){if(t||arguments.length===2)for(var r=0,s=o.length,f;r<s;r++)(f||!(r in o))&&(f||(f=Array.prototype.slice.call(o,0,r)),f[r]=o[r]);return e.concat(f||Array.prototype.slice.call(o))}function __await(e){return this instanceof __await?(this.v=e,this):new __await(e)}function __asyncGenerator(e,o,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(e,o||[]),s,f=[];return s={},h("next"),h("throw"),h("return"),s[Symbol.asyncIterator]=function(){return this},s;function h(v){r[v]&&(s[v]=function(w){return new Promise(function(S,E){f.push([v,w,S,E])>1||g(v,w)})})}function g(v,w){try{u(r[v](w))}catch(S){b(f[0][3],S)}}function u(v){v.value instanceof __await?Promise.resolve(v.value.v).then(d,a):b(f[0][2],v)}function d(v){g("next",v)}function a(v){g("throw",v)}function b(v,w){v(w),f.shift(),f.length&&g(f[0][0],f[0][1])}}function __asyncValues(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o=e[Symbol.asyncIterator],t;return o?o.call(e):(e=typeof __values=="function"?__values(e):e[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(f){t[f]=e[f]&&function(h){return new Promise(function(g,u){h=e[f](h),s(g,u,h.done,h.value)})}}function s(f,h,g,u){Promise.resolve(u).then(function(d){f({value:d,done:g})},h)}}function isFunction(e){return typeof e=="function"}function createErrorClass(e){var o=function(r){Error.call(r),r.stack=new Error().stack},t=e(o);return t.prototype=Object.create(Error.prototype),t.prototype.constructor=t,t}var UnsubscriptionError=createErrorClass(function(e){return function(t){e(this),this.message=t?t.length+` errors occurred during unsubscription:
`+t.map(function(r,s){return s+1+") "+r.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=t}});function arrRemove(e,o){if(e){var t=e.indexOf(o);0<=t&&e.splice(t,1)}}var Subscription=function(){function e(o){this.initialTeardown=o,this.closed=!1,this._parentage=null,this._finalizers=null}return e.prototype.unsubscribe=function(){var o,t,r,s,f;if(!this.closed){this.closed=!0;var h=this._parentage;if(h)if(this._parentage=null,Array.isArray(h))try{for(var g=__values(h),u=g.next();!u.done;u=g.next()){var d=u.value;d.remove(this)}}catch(E){o={error:E}}finally{try{u&&!u.done&&(t=g.return)&&t.call(g)}finally{if(o)throw o.error}}else h.remove(this);var a=this.initialTeardown;if(isFunction(a))try{a()}catch(E){f=E instanceof UnsubscriptionError?E.errors:[E]}var b=this._finalizers;if(b){this._finalizers=null;try{for(var v=__values(b),w=v.next();!w.done;w=v.next()){var S=w.value;try{execFinalizer(S)}catch(E){f=f!=null?f:[],E instanceof UnsubscriptionError?f=__spreadArray(__spreadArray([],__read(f)),__read(E.errors)):f.push(E)}}}catch(E){r={error:E}}finally{try{w&&!w.done&&(s=v.return)&&s.call(v)}finally{if(r)throw r.error}}}if(f)throw new UnsubscriptionError(f)}},e.prototype.add=function(o){var t;if(o&&o!==this)if(this.closed)execFinalizer(o);else{if(o instanceof e){if(o.closed||o._hasParent(this))return;o._addParent(this)}(this._finalizers=(t=this._finalizers)!==null&&t!==void 0?t:[]).push(o)}},e.prototype._hasParent=function(o){var t=this._parentage;return t===o||Array.isArray(t)&&t.includes(o)},e.prototype._addParent=function(o){var t=this._parentage;this._parentage=Array.isArray(t)?(t.push(o),t):t?[t,o]:o},e.prototype._removeParent=function(o){var t=this._parentage;t===o?this._parentage=null:Array.isArray(t)&&arrRemove(t,o)},e.prototype.remove=function(o){var t=this._finalizers;t&&arrRemove(t,o),o instanceof e&&o._removeParent(this)},e.EMPTY=function(){var o=new e;return o.closed=!0,o}(),e}(),EMPTY_SUBSCRIPTION=Subscription.EMPTY;function isSubscription(e){return e instanceof Subscription||e&&"closed"in e&&isFunction(e.remove)&&isFunction(e.add)&&isFunction(e.unsubscribe)}function execFinalizer(e){isFunction(e)?e():e.unsubscribe()}var config={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},timeoutProvider={setTimeout:function(e,o){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var s=timeoutProvider.delegate;return s!=null&&s.setTimeout?s.setTimeout.apply(s,__spreadArray([e,o],__read(t))):setTimeout.apply(void 0,__spreadArray([e,o],__read(t)))},clearTimeout:function(e){var o=timeoutProvider.delegate;return((o==null?void 0:o.clearTimeout)||clearTimeout)(e)},delegate:void 0};function reportUnhandledError(e){timeoutProvider.setTimeout(function(){throw e})}function noop(){}var context=null;function errorContext(e){if(config.useDeprecatedSynchronousErrorHandling){var o=!context;if(o&&(context={errorThrown:!1,error:null}),e(),o){var t=context,r=t.errorThrown,s=t.error;if(context=null,r)throw s}}else e()}var Subscriber=function(e){__extends(o,e);function o(t){var r=e.call(this)||this;return r.isStopped=!1,t?(r.destination=t,isSubscription(t)&&t.add(r)):r.destination=EMPTY_OBSERVER,r}return o.create=function(t,r,s){return new SafeSubscriber(t,r,s)},o.prototype.next=function(t){this.isStopped||this._next(t)},o.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},o.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},o.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,e.prototype.unsubscribe.call(this),this.destination=null)},o.prototype._next=function(t){this.destination.next(t)},o.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},o.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},o}(Subscription),_bind=Function.prototype.bind;function bind(e,o){return _bind.call(e,o)}var ConsumerObserver=function(){function e(o){this.partialObserver=o}return e.prototype.next=function(o){var t=this.partialObserver;if(t.next)try{t.next(o)}catch(r){handleUnhandledError(r)}},e.prototype.error=function(o){var t=this.partialObserver;if(t.error)try{t.error(o)}catch(r){handleUnhandledError(r)}else handleUnhandledError(o)},e.prototype.complete=function(){var o=this.partialObserver;if(o.complete)try{o.complete()}catch(t){handleUnhandledError(t)}},e}(),SafeSubscriber=function(e){__extends(o,e);function o(t,r,s){var f=e.call(this)||this,h;if(isFunction(t)||!t)h={next:t!=null?t:void 0,error:r!=null?r:void 0,complete:s!=null?s:void 0};else{var g;f&&config.useDeprecatedNextContext?(g=Object.create(t),g.unsubscribe=function(){return f.unsubscribe()},h={next:t.next&&bind(t.next,g),error:t.error&&bind(t.error,g),complete:t.complete&&bind(t.complete,g)}):h=t}return f.destination=new ConsumerObserver(h),f}return o}(Subscriber);function handleUnhandledError(e){reportUnhandledError(e)}function defaultErrorHandler(e){throw e}var EMPTY_OBSERVER={closed:!0,next:noop,error:defaultErrorHandler,complete:noop},observable=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function identity(e){return e}function pipeFromArray(e){return e.length===0?identity:e.length===1?e[0]:function(t){return e.reduce(function(r,s){return s(r)},t)}}var Observable=function(){function e(o){o&&(this._subscribe=o)}return e.prototype.lift=function(o){var t=new e;return t.source=this,t.operator=o,t},e.prototype.subscribe=function(o,t,r){var s=this,f=isSubscriber(o)?o:new SafeSubscriber(o,t,r);return errorContext(function(){var h=s,g=h.operator,u=h.source;f.add(g?g.call(f,u):u?s._subscribe(f):s._trySubscribe(f))}),f},e.prototype._trySubscribe=function(o){try{return this._subscribe(o)}catch(t){o.error(t)}},e.prototype.forEach=function(o,t){var r=this;return t=getPromiseCtor(t),new t(function(s,f){var h=new SafeSubscriber({next:function(g){try{o(g)}catch(u){f(u),h.unsubscribe()}},error:f,complete:s});r.subscribe(h)})},e.prototype._subscribe=function(o){var t;return(t=this.source)===null||t===void 0?void 0:t.subscribe(o)},e.prototype[observable]=function(){return this},e.prototype.pipe=function(){for(var o=[],t=0;t<arguments.length;t++)o[t]=arguments[t];return pipeFromArray(o)(this)},e.prototype.toPromise=function(o){var t=this;return o=getPromiseCtor(o),new o(function(r,s){var f;t.subscribe(function(h){return f=h},function(h){return s(h)},function(){return r(f)})})},e.create=function(o){return new e(o)},e}();function getPromiseCtor(e){var o;return(o=e!=null?e:config.Promise)!==null&&o!==void 0?o:Promise}function isObserver(e){return e&&isFunction(e.next)&&isFunction(e.error)&&isFunction(e.complete)}function isSubscriber(e){return e&&e instanceof Subscriber||isObserver(e)&&isSubscription(e)}function hasLift(e){return isFunction(e==null?void 0:e.lift)}function operate(e){return function(o){if(hasLift(o))return o.lift(function(t){try{return e(t,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function createOperatorSubscriber(e,o,t,r,s){return new OperatorSubscriber(e,o,t,r,s)}var OperatorSubscriber=function(e){__extends(o,e);function o(t,r,s,f,h,g){var u=e.call(this,t)||this;return u.onFinalize=h,u.shouldUnsubscribe=g,u._next=r?function(d){try{r(d)}catch(a){t.error(a)}}:e.prototype._next,u._error=f?function(d){try{f(d)}catch(a){t.error(a)}finally{this.unsubscribe()}}:e.prototype._error,u._complete=s?function(){try{s()}catch(d){t.error(d)}finally{this.unsubscribe()}}:e.prototype._complete,u}return o.prototype.unsubscribe=function(){var t;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;e.prototype.unsubscribe.call(this),!r&&((t=this.onFinalize)===null||t===void 0||t.call(this))}},o}(Subscriber),ObjectUnsubscribedError=createErrorClass(function(e){return function(){e(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),Subject=function(e){__extends(o,e);function o(){var t=e.call(this)||this;return t.closed=!1,t.currentObservers=null,t.observers=[],t.isStopped=!1,t.hasError=!1,t.thrownError=null,t}return o.prototype.lift=function(t){var r=new AnonymousSubject(this,this);return r.operator=t,r},o.prototype._throwIfClosed=function(){if(this.closed)throw new ObjectUnsubscribedError},o.prototype.next=function(t){var r=this;errorContext(function(){var s,f;if(r._throwIfClosed(),!r.isStopped){r.currentObservers||(r.currentObservers=Array.from(r.observers));try{for(var h=__values(r.currentObservers),g=h.next();!g.done;g=h.next()){var u=g.value;u.next(t)}}catch(d){s={error:d}}finally{try{g&&!g.done&&(f=h.return)&&f.call(h)}finally{if(s)throw s.error}}}})},o.prototype.error=function(t){var r=this;errorContext(function(){if(r._throwIfClosed(),!r.isStopped){r.hasError=r.isStopped=!0,r.thrownError=t;for(var s=r.observers;s.length;)s.shift().error(t)}})},o.prototype.complete=function(){var t=this;errorContext(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var r=t.observers;r.length;)r.shift().complete()}})},o.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(o.prototype,"observed",{get:function(){var t;return((t=this.observers)===null||t===void 0?void 0:t.length)>0},enumerable:!1,configurable:!0}),o.prototype._trySubscribe=function(t){return this._throwIfClosed(),e.prototype._trySubscribe.call(this,t)},o.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},o.prototype._innerSubscribe=function(t){var r=this,s=this,f=s.hasError,h=s.isStopped,g=s.observers;return f||h?EMPTY_SUBSCRIPTION:(this.currentObservers=null,g.push(t),new Subscription(function(){r.currentObservers=null,arrRemove(g,t)}))},o.prototype._checkFinalizedStatuses=function(t){var r=this,s=r.hasError,f=r.thrownError,h=r.isStopped;s?t.error(f):h&&t.complete()},o.prototype.asObservable=function(){var t=new Observable;return t.source=this,t},o.create=function(t,r){return new AnonymousSubject(t,r)},o}(Observable),AnonymousSubject=function(e){__extends(o,e);function o(t,r){var s=e.call(this)||this;return s.destination=t,s.source=r,s}return o.prototype.next=function(t){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.next)===null||s===void 0||s.call(r,t)},o.prototype.error=function(t){var r,s;(s=(r=this.destination)===null||r===void 0?void 0:r.error)===null||s===void 0||s.call(r,t)},o.prototype.complete=function(){var t,r;(r=(t=this.destination)===null||t===void 0?void 0:t.complete)===null||r===void 0||r.call(t)},o.prototype._subscribe=function(t){var r,s;return(s=(r=this.source)===null||r===void 0?void 0:r.subscribe(t))!==null&&s!==void 0?s:EMPTY_SUBSCRIPTION},o}(Subject),dateTimestampProvider={now:function(){return(dateTimestampProvider.delegate||Date).now()},delegate:void 0},Action=function(e){__extends(o,e);function o(t,r){return e.call(this)||this}return o.prototype.schedule=function(t,r){return this},o}(Subscription),intervalProvider={setInterval:function(e,o){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];var s=intervalProvider.delegate;return s!=null&&s.setInterval?s.setInterval.apply(s,__spreadArray([e,o],__read(t))):setInterval.apply(void 0,__spreadArray([e,o],__read(t)))},clearInterval:function(e){var o=intervalProvider.delegate;return((o==null?void 0:o.clearInterval)||clearInterval)(e)},delegate:void 0},AsyncAction=function(e){__extends(o,e);function o(t,r){var s=e.call(this,t,r)||this;return s.scheduler=t,s.work=r,s.pending=!1,s}return o.prototype.schedule=function(t,r){if(r===void 0&&(r=0),this.closed)return this;this.state=t;var s=this.id,f=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(f,s,r)),this.pending=!0,this.delay=r,this.id=this.id||this.requestAsyncId(f,this.id,r),this},o.prototype.requestAsyncId=function(t,r,s){return s===void 0&&(s=0),intervalProvider.setInterval(t.flush.bind(t,this),s)},o.prototype.recycleAsyncId=function(t,r,s){if(s===void 0&&(s=0),s!=null&&this.delay===s&&this.pending===!1)return r;intervalProvider.clearInterval(r)},o.prototype.execute=function(t,r){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var s=this._execute(t,r);if(s)return s;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},o.prototype._execute=function(t,r){var s=!1,f;try{this.work(t)}catch(h){s=!0,f=h||new Error("Scheduled action threw falsy error")}if(s)return this.unsubscribe(),f},o.prototype.unsubscribe=function(){if(!this.closed){var t=this,r=t.id,s=t.scheduler,f=s.actions;this.work=this.state=this.scheduler=null,this.pending=!1,arrRemove(f,this),r!=null&&(this.id=this.recycleAsyncId(s,r,null)),this.delay=null,e.prototype.unsubscribe.call(this)}},o}(Action),Scheduler=function(){function e(o,t){t===void 0&&(t=e.now),this.schedulerActionCtor=o,this.now=t}return e.prototype.schedule=function(o,t,r){return t===void 0&&(t=0),new this.schedulerActionCtor(this,o).schedule(r,t)},e.now=dateTimestampProvider.now,e}(),AsyncScheduler=function(e){__extends(o,e);function o(t,r){r===void 0&&(r=Scheduler.now);var s=e.call(this,t,r)||this;return s.actions=[],s._active=!1,s._scheduled=void 0,s}return o.prototype.flush=function(t){var r=this.actions;if(this._active){r.push(t);return}var s;this._active=!0;do if(s=t.execute(t.state,t.delay))break;while(t=r.shift());if(this._active=!1,s){for(;t=r.shift();)t.unsubscribe();throw s}},o}(Scheduler),asyncScheduler=new AsyncScheduler(AsyncAction),EMPTY=new Observable(function(e){return e.complete()});function isScheduler(e){return e&&isFunction(e.schedule)}function last(e){return e[e.length-1]}function popScheduler(e){return isScheduler(last(e))?e.pop():void 0}var isArrayLike=function(e){return e&&typeof e.length=="number"&&typeof e!="function"};function isPromise(e){return isFunction(e==null?void 0:e.then)}function isInteropObservable(e){return isFunction(e[observable])}function isAsyncIterable(e){return Symbol.asyncIterator&&isFunction(e==null?void 0:e[Symbol.asyncIterator])}function createInvalidObservableTypeError(e){return new TypeError("You provided "+(e!==null&&typeof e=="object"?"an invalid object":"'"+e+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function getSymbolIterator(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var iterator=getSymbolIterator();function isIterable(e){return isFunction(e==null?void 0:e[iterator])}function readableStreamLikeToAsyncGenerator(e){return __asyncGenerator(this,arguments,function(){var t,r,s,f;return __generator$1(this,function(h){switch(h.label){case 0:t=e.getReader(),h.label=1;case 1:h.trys.push([1,,9,10]),h.label=2;case 2:return[4,__await(t.read())];case 3:return r=h.sent(),s=r.value,f=r.done,f?[4,__await(void 0)]:[3,5];case 4:return[2,h.sent()];case 5:return[4,__await(s)];case 6:return[4,h.sent()];case 7:return h.sent(),[3,2];case 8:return[3,10];case 9:return t.releaseLock(),[7];case 10:return[2]}})})}function isReadableStreamLike(e){return isFunction(e==null?void 0:e.getReader)}function innerFrom(e){if(e instanceof Observable)return e;if(e!=null){if(isInteropObservable(e))return fromInteropObservable(e);if(isArrayLike(e))return fromArrayLike(e);if(isPromise(e))return fromPromise(e);if(isAsyncIterable(e))return fromAsyncIterable(e);if(isIterable(e))return fromIterable(e);if(isReadableStreamLike(e))return fromReadableStreamLike(e)}throw createInvalidObservableTypeError(e)}function fromInteropObservable(e){return new Observable(function(o){var t=e[observable]();if(isFunction(t.subscribe))return t.subscribe(o);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function fromArrayLike(e){return new Observable(function(o){for(var t=0;t<e.length&&!o.closed;t++)o.next(e[t]);o.complete()})}function fromPromise(e){return new Observable(function(o){e.then(function(t){o.closed||(o.next(t),o.complete())},function(t){return o.error(t)}).then(null,reportUnhandledError)})}function fromIterable(e){return new Observable(function(o){var t,r;try{for(var s=__values(e),f=s.next();!f.done;f=s.next()){var h=f.value;if(o.next(h),o.closed)return}}catch(g){t={error:g}}finally{try{f&&!f.done&&(r=s.return)&&r.call(s)}finally{if(t)throw t.error}}o.complete()})}function fromAsyncIterable(e){return new Observable(function(o){process(e,o).catch(function(t){return o.error(t)})})}function fromReadableStreamLike(e){return fromAsyncIterable(readableStreamLikeToAsyncGenerator(e))}function process(e,o){var t,r,s,f;return __awaiter$1(this,void 0,void 0,function(){var h,g;return __generator$1(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),t=__asyncValues(e),u.label=1;case 1:return[4,t.next()];case 2:if(r=u.sent(),!!r.done)return[3,4];if(h=r.value,o.next(h),o.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return g=u.sent(),s={error:g},[3,11];case 6:return u.trys.push([6,,9,10]),r&&!r.done&&(f=t.return)?[4,f.call(t)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return o.complete(),[2]}})})}function executeSchedule(e,o,t,r,s){r===void 0&&(r=0),s===void 0&&(s=!1);var f=o.schedule(function(){t(),s?e.add(this.schedule(null,r)):this.unsubscribe()},r);if(e.add(f),!s)return f}function observeOn(e,o){return o===void 0&&(o=0),operate(function(t,r){t.subscribe(createOperatorSubscriber(r,function(s){return executeSchedule(r,e,function(){return r.next(s)},o)},function(){return executeSchedule(r,e,function(){return r.complete()},o)},function(s){return executeSchedule(r,e,function(){return r.error(s)},o)}))})}function subscribeOn(e,o){return o===void 0&&(o=0),operate(function(t,r){r.add(e.schedule(function(){return t.subscribe(r)},o))})}function scheduleObservable(e,o){return innerFrom(e).pipe(subscribeOn(o),observeOn(o))}function schedulePromise(e,o){return innerFrom(e).pipe(subscribeOn(o),observeOn(o))}function scheduleArray(e,o){return new Observable(function(t){var r=0;return o.schedule(function(){r===e.length?t.complete():(t.next(e[r++]),t.closed||this.schedule())})})}function scheduleIterable(e,o){return new Observable(function(t){var r;return executeSchedule(t,o,function(){r=e[iterator](),executeSchedule(t,o,function(){var s,f,h;try{s=r.next(),f=s.value,h=s.done}catch(g){t.error(g);return}h?t.complete():t.next(f)},0,!0)}),function(){return isFunction(r==null?void 0:r.return)&&r.return()}})}function scheduleAsyncIterable(e,o){if(!e)throw new Error("Iterable cannot be null");return new Observable(function(t){executeSchedule(t,o,function(){var r=e[Symbol.asyncIterator]();executeSchedule(t,o,function(){r.next().then(function(s){s.done?t.complete():t.next(s.value)})},0,!0)})})}function scheduleReadableStreamLike(e,o){return scheduleAsyncIterable(readableStreamLikeToAsyncGenerator(e),o)}function scheduled(e,o){if(e!=null){if(isInteropObservable(e))return scheduleObservable(e,o);if(isArrayLike(e))return scheduleArray(e,o);if(isPromise(e))return schedulePromise(e,o);if(isAsyncIterable(e))return scheduleAsyncIterable(e,o);if(isIterable(e))return scheduleIterable(e,o);if(isReadableStreamLike(e))return scheduleReadableStreamLike(e,o)}throw createInvalidObservableTypeError(e)}function from(e,o){return o?scheduled(e,o):innerFrom(e)}function of(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var t=popScheduler(e);return from(e,t)}function throwError(e,o){var t=isFunction(e)?e:function(){return e},r=function(s){return s.error(t())};return new Observable(o?function(s){return o.schedule(r,0,s)}:r)}var EmptyError=createErrorClass(function(e){return function(){e(this),this.name="EmptyError",this.message="no elements in sequence"}});function map(e,o){return operate(function(t,r){var s=0;t.subscribe(createOperatorSubscriber(r,function(f){r.next(e.call(o,f,s++))}))})}function mergeInternals(e,o,t,r,s,f,h,g){var u=[],d=0,a=0,b=!1,v=function(){b&&!u.length&&!d&&o.complete()},w=function(E){return d<r?S(E):u.push(E)},S=function(E){f&&o.next(E),d++;var m=!1;innerFrom(t(E,a++)).subscribe(createOperatorSubscriber(o,function(_){s==null||s(_),f?w(_):o.next(_)},function(){m=!0},void 0,function(){if(m)try{d--;for(var _=function(){var T=u.shift();h?executeSchedule(o,h,function(){return S(T)}):S(T)};u.length&&d<r;)_();v()}catch(T){o.error(T)}}))};return e.subscribe(createOperatorSubscriber(o,w,function(){b=!0,v()})),function(){g==null||g()}}function mergeMap(e,o,t){return t===void 0&&(t=1/0),isFunction(o)?mergeMap(function(r,s){return map(function(f,h){return o(r,f,s,h)})(innerFrom(e(r,s)))},t):(typeof o=="number"&&(t=o),operate(function(r,s){return mergeInternals(r,s,e,t)}))}function filter(e,o){return operate(function(t,r){var s=0;t.subscribe(createOperatorSubscriber(r,function(f){return e.call(o,f,s++)&&r.next(f)}))})}function buffer(e){return operate(function(o,t){var r=[];return o.subscribe(createOperatorSubscriber(t,function(s){return r.push(s)},function(){t.next(r),t.complete()})),e.subscribe(createOperatorSubscriber(t,function(){var s=r;r=[],t.next(s)},noop)),function(){r=null}})}function catchError(e){return operate(function(o,t){var r=null,s=!1,f;r=o.subscribe(createOperatorSubscriber(t,void 0,void 0,function(h){f=innerFrom(e(h,catchError(e)(o))),r?(r.unsubscribe(),r=null,f.subscribe(t)):s=!0})),s&&(r.unsubscribe(),r=null,f.subscribe(t))})}function debounceTime(e,o){return o===void 0&&(o=asyncScheduler),operate(function(t,r){var s=null,f=null,h=null,g=function(){if(s){s.unsubscribe(),s=null;var d=f;f=null,r.next(d)}};function u(){var d=h+e,a=o.now();if(a<d){s=this.schedule(void 0,d-a),r.add(s);return}g()}t.subscribe(createOperatorSubscriber(r,function(d){f=d,h=o.now(),s||(s=o.schedule(u,e),r.add(s))},function(){g(),r.complete()},void 0,function(){f=s=null}))})}function defaultIfEmpty(e){return operate(function(o,t){var r=!1;o.subscribe(createOperatorSubscriber(t,function(s){r=!0,t.next(s)},function(){r||t.next(e),t.complete()}))})}function take(e){return e<=0?function(){return EMPTY}:operate(function(o,t){var r=0;o.subscribe(createOperatorSubscriber(t,function(s){++r<=e&&(t.next(s),e<=r&&t.complete())}))})}function throwIfEmpty(e){return e===void 0&&(e=defaultErrorFactory),operate(function(o,t){var r=!1;o.subscribe(createOperatorSubscriber(t,function(s){r=!0,t.next(s)},function(){return r?t.complete():t.error(e())}))})}function defaultErrorFactory(){return new EmptyError}function finalize(e){return operate(function(o,t){try{o.subscribe(t)}finally{t.add(e)}})}function first(e,o){var t=arguments.length>=2;return function(r){return r.pipe(e?filter(function(s,f){return e(s,f,r)}):identity,take(1),t?defaultIfEmpty(o):throwIfEmpty(function(){return new EmptyError}))}}function switchMap(e,o){return operate(function(t,r){var s=null,f=0,h=!1,g=function(){return h&&!s&&r.complete()};t.subscribe(createOperatorSubscriber(r,function(u){s==null||s.unsubscribe();var d=0,a=f++;innerFrom(e(u,a)).subscribe(s=createOperatorSubscriber(r,function(b){return r.next(o?o(u,b,a,d++):b)},function(){s=null,g()}))},function(){h=!0,g()}))})}function takeUntil(e){return operate(function(o,t){innerFrom(e).subscribe(createOperatorSubscriber(t,function(){return t.complete()},noop)),!t.closed&&o.subscribe(t)})}function tap(e,o,t){var r=isFunction(e)||o||t?{next:e,error:o,complete:t}:e;return r?operate(function(s,f){var h;(h=r.subscribe)===null||h===void 0||h.call(r);var g=!0;s.subscribe(createOperatorSubscriber(f,function(u){var d;(d=r.next)===null||d===void 0||d.call(r,u),f.next(u)},function(){var u;g=!1,(u=r.complete)===null||u===void 0||u.call(r),f.complete()},function(u){var d;g=!1,(d=r.error)===null||d===void 0||d.call(r,u),f.error(u)},function(){var u,d;g&&((u=r.unsubscribe)===null||u===void 0||u.call(r)),(d=r.finalize)===null||d===void 0||d.call(r)}))}):identity}function __awaiter(e,o,t,r){function s(f){return f instanceof t?f:new t(function(h){h(f)})}return new(t||(t=Promise))(function(f,h){function g(a){try{d(r.next(a))}catch(b){h(b)}}function u(a){try{d(r.throw(a))}catch(b){h(b)}}function d(a){a.done?f(a.value):s(a.value).then(g,u)}d((r=r.apply(e,o||[])).next())})}function __generator(e,o){var t={label:0,sent:function(){if(f[0]&1)throw f[1];return f[1]},trys:[],ops:[]},r,s,f,h;return h={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(h[Symbol.iterator]=function(){return this}),h;function g(d){return function(a){return u([d,a])}}function u(d){if(r)throw new TypeError("Generator is already executing.");for(;t;)try{if(r=1,s&&(f=d[0]&2?s.return:d[0]?s.throw||((f=s.return)&&f.call(s),0):s.next)&&!(f=f.call(s,d[1])).done)return f;switch(s=0,f&&(d=[d[0]&2,f.value]),d[0]){case 0:case 1:f=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,s=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(f=t.trys,!(f=f.length>0&&f[f.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!f||d[1]>f[0]&&d[1]<f[3])){t.label=d[1];break}if(d[0]===6&&t.label<f[1]){t.label=f[1],f=d;break}if(f&&t.label<f[2]){t.label=f[2],t.ops.push(d);break}f[2]&&t.ops.pop(),t.trys.pop();continue}d=o.call(e,t)}catch(a){d=[6,a],s=0}finally{r=f=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function roundNumber(e,o){var t=Math.pow(10,o);return Math.round(e*t)/t}var SupportedLengths={CENTIMETERS:"cm",FEET:"feet",INCHES:"inches",KILOMETERS:"km",METERS:"meters",MILES:"miles",YARDS:"yards"},Lengths;(function(e){e.CENTIMETERS="cm",e.FEET="feet",e.INCHES="inches",e.KILOMETERS="km",e.METERS="meters",e.MILES="miles",e.YARDS="yards"})(Lengths||(Lengths={}));var _a,_b,_c,_d,_e,_f,_g;_a={},_a[SupportedLengths.CENTIMETERS]=function(e,o){return roundNumber(e,o)},_a[SupportedLengths.FEET]=function(e,o){return roundNumber(e*.032808,o)},_a[SupportedLengths.INCHES]=function(e,o){return roundNumber(e*.3937,o)},_a[SupportedLengths.KILOMETERS]=function(e,o){return roundNumber(e/1e5,o)},_a[SupportedLengths.METERS]=function(e,o){return roundNumber(e/100,o)},_a[SupportedLengths.MILES]=function(e,o){return roundNumber(e*62137e-10,o)},_a.yards=function(e,o){return roundNumber(e*.010936,o)};_b={},_b[SupportedLengths.CENTIMETERS]=function(e,o){return roundNumber(e/.032808,o)},_b[SupportedLengths.FEET]=function(e,o){return roundNumber(e,o)},_b[SupportedLengths.INCHES]=function(e,o){return roundNumber(e*12,o)},_b[SupportedLengths.KILOMETERS]=function(e,o){return roundNumber(e/3280.8,o)},_b[SupportedLengths.METERS]=function(e,o){return roundNumber(e/3.2808,o)},_b[SupportedLengths.MILES]=function(e,o){return roundNumber(e*18939e-8,o)},_b[SupportedLengths.YARDS]=function(e,o){return roundNumber(e*.33333,o)};_c={},_c[SupportedLengths.CENTIMETERS]=function(e,o){return roundNumber(e/.3937,o)},_c[SupportedLengths.FEET]=function(e,o){return roundNumber(e*.083333,o)},_c[SupportedLengths.INCHES]=function(e,o){return roundNumber(e,o)},_c[SupportedLengths.KILOMETERS]=function(e,o){return roundNumber(e/39370,o)},_c[SupportedLengths.METERS]=function(e,o){return roundNumber(e/39.37,o)},_c[SupportedLengths.MILES]=function(e,o){return roundNumber(e*15783e-9,o)},_c[SupportedLengths.YARDS]=function(e,o){return roundNumber(e*.027778,o)};_d={},_d[SupportedLengths.CENTIMETERS]=function(e,o){return roundNumber(e*1e5,o)},_d[SupportedLengths.FEET]=function(e,o){return roundNumber(e*3280.8,o)},_d[SupportedLengths.INCHES]=function(e,o){return roundNumber(e*39370,o)},_d[SupportedLengths.KILOMETERS]=function(e,o){return roundNumber(e,o)},_d[SupportedLengths.METERS]=function(e,o){return roundNumber(e*1e3,o)},_d[SupportedLengths.MILES]=function(e,o){return roundNumber(e*.62137,o)},_d[SupportedLengths.YARDS]=function(e,o){return roundNumber(e*1093.6,o)};_e={},_e[SupportedLengths.CENTIMETERS]=function(e,o){return roundNumber(e/.01,o)},_e[SupportedLengths.FEET]=function(e,o){return roundNumber(e*3.2808,o)},_e[SupportedLengths.INCHES]=function(e,o){return roundNumber(e*39.37,o)},_e[SupportedLengths.KILOMETERS]=function(e,o){return roundNumber(e/1e3,o)},_e[SupportedLengths.METERS]=function(e,o){return roundNumber(e,o)},_e[SupportedLengths.MILES]=function(e,o){return roundNumber(e*62137e-8,o)},_e[SupportedLengths.YARDS]=function(e,o){return roundNumber(e*1.0936,o)};_f={},_f[SupportedLengths.CENTIMETERS]=function(e,o){return roundNumber(e/62137e-10,o)},_f[SupportedLengths.FEET]=function(e,o){return roundNumber(e*5280,o)},_f[SupportedLengths.INCHES]=function(e,o){return roundNumber(e*63360,o)},_f[SupportedLengths.KILOMETERS]=function(e,o){return roundNumber(e/.62137,o)},_f[SupportedLengths.METERS]=function(e,o){return roundNumber(e/62137e-8,o)},_f[SupportedLengths.MILES]=function(e,o){return roundNumber(e,o)},_f[SupportedLengths.YARDS]=function(e,o){return roundNumber(e*1760,o)};_g={},_g[SupportedLengths.CENTIMETERS]=function(e,o){return roundNumber(e/.010936,o)},_g[SupportedLengths.FEET]=function(e,o){return roundNumber(e*3,o)},_g[SupportedLengths.INCHES]=function(e,o){return roundNumber(e*36,o)},_g[SupportedLengths.KILOMETERS]=function(e,o){return roundNumber(e/1093.6,o)},_g[SupportedLengths.METERS]=function(e,o){return roundNumber(e/1.0936,o)},_g[SupportedLengths.MILES]=function(e,o){return roundNumber(e*56818e-8,o)},_g[SupportedLengths.YARDS]=function(e,o){return roundNumber(e,o)};function toWritableStream(e,o){var t,r=!((t=e)===null||t===void 0)&&t.getWriter?e.getWriter():e,s=!1;return o&&(o.onabort=function(){s=!0,from(r.close()).pipe(catchError(function(){return EMPTY})).subscribe()}),function(f){return f.pipe(tap(function(h){s||from(r.ready).pipe(mergeMap(function(){return from(r.write(h)).pipe(catchError(function(){return EMPTY}))})).subscribe()}),catchError(function(h){return s=!0,from(r.close()).pipe(switchMap(function(){return throwError(h)}))}),finalize(function(){s=!0,from(r.close()).pipe(catchError(function(){return EMPTY})).subscribe()}))}}function fromWebSerial(e,o,t,r){var s=this;return new Observable(function(f){var h=new Subject,g,u;return from(e.open(t||{baudRate:9600})).pipe(tap(function(){h.asObservable().pipe(tap(function(){return __awaiter(s,void 0,void 0,function(){return __generator(this,function(a){switch(a.label){case 0:return[4,u.close()];case 1:return a.sent(),[4,g.cancel()];case 2:return a.sent(),[4,e.close()];case 3:return a.sent(),!f.closed&&f.complete(),[2]}})})})).subscribe(),r&&(r.onabort=function(){h.next(),h.complete()}),e.ondisconnect=function(){h.next(),h.complete()},o&&e.writable&&(u=e.writable.getWriter(),o.pipe(takeUntil(h),toWritableStream(u),catchError(function(a){return f.error(a),EMPTY})).subscribe());var d=function a(b){return __awaiter(s,void 0,void 0,function(){return __generator(this,function(v){return f.next(b.value),[2,!b.done||!e.readable?g.read().then(a):Promise.resolve(b)]})})};e.readable&&(g=e.readable.getReader(),from(g.read()).pipe(takeUntil(h),switchMap(function(a){return d(a)})).subscribe())}),catchError(function(d){return f.error(d),EMPTY})).subscribe(),function(){h.next(),h.complete()}})}function tapOnFirstEmit(e){return function(o){return of(void 0).pipe(tap(e),switchMap(function(){return o}))}}var SupportedTemperatures={CELSIUS:"celsius",FAHRENHEIT:"fahrenheit",KELVIN:"kelvin",RANKINE:"rankine"},Temperatures;(function(e){e.CELSIUS="celsius",e.FAHRENHEIT="fahrenheit",e.KELVIN="kelvin",e.RANKINE="rankine"})(Temperatures||(Temperatures={}));var _a$1,_b$1,_c$1,_d$1;_a$1={},_a$1[SupportedTemperatures.CELSIUS]=function(e,o){return roundNumber(e,o)},_a$1[SupportedTemperatures.FAHRENHEIT]=function(e,o){return roundNumber(e*1.8+32,o)},_a$1[SupportedTemperatures.KELVIN]=function(e,o){return roundNumber(e+273.15,o)},_a$1[SupportedTemperatures.RANKINE]=function(e,o){return roundNumber((e+273.15)*1.8,o)};_b$1={},_b$1[SupportedTemperatures.CELSIUS]=function(e,o){return roundNumber((e-32)/1.8,o)},_b$1[SupportedTemperatures.FAHRENHEIT]=function(e,o){return roundNumber(e,o)},_b$1[SupportedTemperatures.KELVIN]=function(e,o){return roundNumber((e-32)/1.8+273.15,o)},_b$1[SupportedTemperatures.RANKINE]=function(e,o){return roundNumber(e+459.67,o)};_c$1={},_c$1[SupportedTemperatures.CELSIUS]=function(e,o){return roundNumber(e-273.15,o)},_c$1[SupportedTemperatures.FAHRENHEIT]=function(e,o){return roundNumber((e-273.15)*1.8+32,o)},_c$1[SupportedTemperatures.KELVIN]=function(e,o){return roundNumber(e,o)},_c$1[SupportedTemperatures.RANKINE]=function(e,o){return roundNumber(e*1.8,o)};_d$1={},_d$1[SupportedTemperatures.CELSIUS]=function(e,o){return roundNumber((e-491.67)*1.8,o)},_d$1[SupportedTemperatures.FAHRENHEIT]=function(e,o){return roundNumber(e-491.67,o)},_d$1[SupportedTemperatures.KELVIN]=function(e,o){return roundNumber(e/1.8,o)},_d$1[SupportedTemperatures.RANKINE]=function(e,o){return roundNumber(e,o)};var SupportedWeights={GRAMS:"g",KILOGRAMS:"kg",POUNDS:"lb",OUNCES:"oz",STONE:"st"},Weights;(function(e){e.GRAMS="g",e.KILOGRAMS="kg",e.POUNDS="lb",e.OUNCES="oz",e.STONE="st"})(Weights||(Weights={}));var _a$2,_b$2,_c$2,_d$2,_e$1;_a$2={},_a$2[SupportedWeights.GRAMS]=function(e,o){return roundNumber(e*1e3,o)},_a$2[SupportedWeights.KILOGRAMS]=function(e,o){return roundNumber(e,o)},_a$2[SupportedWeights.POUNDS]=function(e,o){return roundNumber(e*2.2046,o)},_a$2[SupportedWeights.OUNCES]=function(e,o){return roundNumber(e*35.274,o)},_a$2[SupportedWeights.STONE]=function(e,o){return roundNumber(e*.1574,o)};_b$2={},_b$2[SupportedWeights.GRAMS]=function(e,o){return roundNumber(e/.0022046,o)},_b$2[SupportedWeights.KILOGRAMS]=function(e,o){return roundNumber(e/2.2046,o)},_b$2[SupportedWeights.POUNDS]=function(e,o){return roundNumber(e,o)},_b$2[SupportedWeights.OUNCES]=function(e,o){return roundNumber(e*16,o)},_b$2[SupportedWeights.STONE]=function(e,o){return roundNumber(e*.071429,o)};_c$2={},_c$2[SupportedWeights.GRAMS]=function(e,o){return roundNumber(e,o)},_c$2[SupportedWeights.KILOGRAMS]=function(e,o){return roundNumber(e/1e3,o)},_c$2[SupportedWeights.POUNDS]=function(e,o){return roundNumber(e*.0022046,o)},_c$2[SupportedWeights.OUNCES]=function(e,o){return roundNumber(e*.035274,o)},_c$2[SupportedWeights.STONE]=function(e,o){return roundNumber(e*15747e-8,o)};_d$2={},_d$2[SupportedWeights.GRAMS]=function(e,o){return roundNumber(e/.035274,o)},_d$2[SupportedWeights.KILOGRAMS]=function(e,o){return roundNumber(e/35.274,o)},_d$2[SupportedWeights.POUNDS]=function(e,o){return roundNumber(e*.0625,o)},_d$2[SupportedWeights.OUNCES]=function(e,o){return roundNumber(e,o)},_d$2[SupportedWeights.STONE]=function(e,o){return roundNumber(e*.0044643,o)};_e$1={},_e$1[SupportedWeights.GRAMS]=function(e,o){return roundNumber(e/15747e-8,o)},_e$1[SupportedWeights.KILOGRAMS]=function(e,o){return roundNumber(e/.15747,o)},_e$1[SupportedWeights.POUNDS]=function(e,o){return roundNumber(e*14,o)},_e$1[SupportedWeights.OUNCES]=function(e,o){return roundNumber(e*224,o)},_e$1[SupportedWeights.STONE]=function(e,o){return roundNumber(e,o)};class WebSerial{constructor(){nt(this,"port");nt(this,"serialObservable");nt(this,"serialSubject",new Subject);nt(this,"isConnected$",new Subject);nt(this,"sendMessage$",new Subject);nt(this,"interByteTimeout$",new Subject);nt(this,"responseReceived$",new Subject);nt(this,"endCtrl",new AbortController);nt(this,"decoder",new TextDecoder);nt(this,"encoder",new TextEncoder)}async requestPort(){try{this.port=await navigator.serial.requestPort(),this.serialObservable=fromWebSerial(this.port,this.sendMessage$,{baudRate:57600},this.endCtrl.signal),this.serialObservable.pipe(tapOnFirstEmit(()=>{this.isConnected$.next(!0),console.log("Connected to Serial Device")}),finalize(()=>{console.log("finalized")})).subscribe(this.serialSubject),this.serialSubject.pipe(debounceTime(50)).subscribe(()=>{this.interByteTimeout$.next()}),this.serialSubject.pipe(buffer(this.interByteTimeout$),tap(o=>{const t=o.map(r=>Array.from(r)).flat();this.responseReceived$.next(t)})).subscribe(),this.responseReceived$.pipe().subscribe(o=>{console.log(o.map(t=>"0x"+t.toString(16).padStart(2,"0")).join(", "))})}catch(o){console.error(o)}}close(){this.endCtrl.abort(),this.port.writable.getWriter().close(),this.port.readable.getReader().cancel(),this.port.close()}}const ws=new WebSerial;var CommandByte=(e=>(e[e.DIGITAL_MESSAGE=144]="DIGITAL_MESSAGE",e[e.ANALOG_MESSAGE=224]="ANALOG_MESSAGE",e[e.REPORT_ANALOG=192]="REPORT_ANALOG",e[e.REPORT_DIGITAL=208]="REPORT_DIGITAL",e[e.SET_PIN_MODE=244]="SET_PIN_MODE",e[e.SET_DIGITAL_PIN_VALUE=245]="SET_DIGITAL_PIN_VALUE",e[e.REPORT_VERSION=249]="REPORT_VERSION",e[e.SYSTEM_RESET=255]="SYSTEM_RESET",e[e.START_SYSEX=240]="START_SYSEX",e[e.END_SYSEX=247]="END_SYSEX",e))(CommandByte||{});class Firmata{toggleLed(){ws.responseReceived$.pipe(first()).subscribe(o=>{console.log(o);let r=(o[1]<<8|o[0])>>13&1;ws.sendMessage$.next(new Uint8Array([CommandByte.SET_DIGITAL_PIN_VALUE,13,r===0?1:0]))}),ws.sendMessage$.next(new Uint8Array([CommandByte.REPORT_DIGITAL,1]))}readADC(){ws.sendMessage$.next(new Uint8Array([CommandByte.DIGITAL_MESSAGE,13,1]))}async reset(){await ws.port.close(),await ws.port.open({baudRate:115200}),await ws.port.setSignals({dataTerminalReady:!1,requestToSend:!1}),await new Promise(o=>setTimeout(o,250)),await ws.port.setSignals({dataTerminalReady:!0,requestToSend:!0})}}const firmata=new Firmata;window.AvrgirlArduino=(()=>{var e={8860:(r,s,f)=>{var h=f(4424),g=f(6126),u=f(5957),d=f(1990);r.exports=d(h,g,u)},1990:(r,s,f)=>{var h=function(g,u,d){var a=f(7187),b=f(9539),v=f(8623),w=function(S){if(S=S||{},this.options={debug:S.debug||!1,megaDebug:S.megaDebug||!1,board:S.board||"uno",port:S.port||"",manualReset:S.manualReset||!1,disableVerify:S.disableVerify||!1},this.options.debug===!0?this.debug=this.options.debug=console.log.bind(console):typeof this.options.debug=="function"?this.debug=this.options.debug=this.options.debug:this.debug=this.options.debug=function(){},typeof this.options.board=="object"){const m=Object.getOwnPropertyNames(this.options.board);m.length===1&&m[0]==="name"&&(this.options.board=this.options.board.name)}if(typeof this.options.board=="string"&&(this.options.board=g[this.options.board]),this.options.board&&!this.options.board.manualReset&&(this.options.board.manualReset=this.options.manualReset),this.options.board&&!this.options.board.disableVerify&&(this.options.board.disableVerify=this.options.disableVerify),this.connection=new u(this.options),this.options.board){var E=d[this.options.board.protocol]||function(){};this.protocol=new E({board:this.options.board,connection:this.connection,debug:this.debug,megaDebug:this.options.megaDebug})}a.call(this)};return b.inherits(w,a),w.prototype._validateBoard=function(S){if(typeof this.options.board!="object")return S(new Error('"'+this.options.board+'" is not a supported board type.'));if(this.protocol.chip)return!this.options.port&&this.options.board.name==="pro-mini"?S(new Error("using a pro-mini, please specify the port in your options.")):S(null);var E="not a supported programming protocol: "+this.options.board.protocol;return S(new Error(E))},w.prototype.flash=function(S,E){var m=this;m._validateBoard(function(_){if(_)return E(_);m.connection._init(function(T){if(T)return E(T);m.protocol._upload(S,E)})})},w.prototype.listPorts=w.listPorts=w.prototype.list=w.list=function(S){return u.prototype._listPorts(S)},w.listKnownBoards=function(){return Object.keys(g).filter(function(S){var E=g[S].aliases;return!E||!~E.indexOf(S)})},w.prototype.tools=v,w};r.exports=h},4424:(r,s,f)=>{var h=f(8764).Buffer,g=[{name:"uno",baud:115200,signature:h.from([30,149,15]),pageSize:128,numPages:256,timeout:400,productId:["0x0043","0x7523","0x0001","0xea60","0x6015"],productPage:"https://store.arduino.cc/arduino-uno-rev3",protocol:"stk500v1"},{name:"micro",baud:57600,signature:h.from([67,65,84,69,82,73,78]),productId:["0x0037","0x8037","0x0036","0x0237"],productPage:"https://store.arduino.cc/arduino-micro",protocol:"avr109"},{name:"imuduino",baud:57600,signature:h.from([67,65,84,69,82,73,78]),productId:["0x0036","0x8037","0x8036"],productPage:"https://www.kickstarter.com/projects/1265095814/imuduino-wireless-3d-motion-html-js-apps-arduino-p?lang=de",protocol:"avr109"},{name:"leonardo",baud:57600,signature:h.from([67,65,84,69,82,73,78]),productId:["0x0036","0x8036","0x800c"],productPage:"https://store.arduino.cc/leonardo",protocol:"avr109"},{name:"arduboy",baud:57600,signature:h.from([67,65,84,69,82,73,78]),productId:["0x0036","0x8036","0x800c"],productPage:"https://arduboy.com/",protocol:"avr109"},{name:"feather",baud:57600,signature:h.from([67,65,84,69,82,73,78]),productId:["0x800c","0x000c"],productPage:"https://www.adafruit.com/feather",protocol:"avr109"},{name:"little-bits",baud:57600,signature:h.from([67,65,84,69,82,73,78]),productId:["0x0036","0x8036"],productPage:"https://littlebits.com/collections/bits-and-accessories/products/arduino-bit",protocol:"avr109"},{name:"blend-micro",baud:57600,signature:h.from([67,65,84,69,82,73,78]),productId:["0x2404"],productPage:"https://redbear.cc/product/retired/blend-micro.html",protocol:"avr109"},{name:"nano",baud:57600,signature:h.from([30,149,15]),pageSize:128,numPages:256,timeout:400,productId:["0x6001","0x7523"],productPage:"https://web.archive.org/web/20150813095112/https://www.arduino.cc/en/Main/ArduinoBoardNano",protocol:"stk500v1"},{name:"nano (new bootloader)",baud:115200,signature:h.from([30,149,15]),pageSize:128,numPages:256,timeout:400,productId:["0x6001","0x7523"],productPage:"https://store.arduino.cc/arduino-nano",protocol:"stk500v1"},{name:"duemilanove168",baud:19200,signature:h.from([30,148,6]),pageSize:128,numPages:128,timeout:400,productId:["0x6001"],productPage:"https://www.arduino.cc/en/Main/arduinoBoardDuemilanove",protocol:"stk500v1"},{name:"duemilanove328",baud:57600,signature:h.from([30,149,20]),pageSize:128,numPages:256,timeout:400,productId:["0x6001"],productPage:"https://www.arduino.cc/en/Main/arduinoBoardDuemilanove",protocol:"stk500v1"},{name:"tinyduino",baud:57600,signature:h.from([30,149,15]),pageSize:128,numPages:256,timeout:400,productId:["0x6015"],productPage:"https://tinycircuits.com/pages/tinyduino-overview",protocol:"stk500v1",aliases:["tinduino"]},{name:"mega",baud:115200,signature:h.from([30,152,1]),pageSize:256,delay1:10,delay2:1,timeout:200,stabDelay:100,cmdexeDelay:25,synchLoops:32,byteDelay:0,pollValue:83,pollIndex:3,productId:["0x0042","0x6001","0x0010","0x7523"],productPage:"https://store.arduino.cc/mega-2560-r3",protocol:"stk500v2"},{name:"adk",baud:115200,signature:h.from([30,152,1]),pageSize:256,delay1:10,delay2:1,timeout:200,stabDelay:100,cmdexeDelay:25,synchLoops:32,byteDelay:0,pollValue:83,pollIndex:3,productId:["0x0044","0x6001","0x003F"],productPage:"https://store.arduino.cc/arduino-mega-adk-rev3",protocol:"stk500v2"},{name:"sf-pro-micro",baud:57600,signature:h.from([67,65,84,69,82,73,78]),productId:["0x9206","0x9205","0x0036"],productPage:"https://www.sparkfun.com/products/12640",protocol:"avr109"},{name:"pro-mini",baud:57600,signature:h.from([30,149,15]),pageSize:128,numPages:256,timeout:400,productPage:"https://store.arduino.cc/arduino-pro-mini",protocol:"stk500v1"},{name:"qduino",baud:57600,signature:h.from([67,65,84,69,82,73,78]),productId:["0x516d","0x514d"],productPage:"https://www.sparkfun.com/products/13614",protocol:"avr109"},{name:"pinoccio",baud:115200,signature:h.from([30,168,2]),pageSize:256,delay1:10,delay2:1,timeout:200,stabDelay:100,cmdexeDelay:25,synchLoops:32,byteDelay:0,pollValue:83,pollIndex:3,productId:["0x6051"],productPage:"https://www.mouser.de/new/crowd-supply/crowd-supply-pinoccio-microcontroller/",protocol:"stk500v2"},{name:"lilypad-usb",baud:57600,signature:h.from([67,65,84,69,82,73,78]),productId:["0x9207","0x9208","0x1B4F"],productPage:"https://www.sparkfun.com/products/12049",protocol:"avr109"},{name:"yun",baud:57600,signature:h.from([67,65,84,69,82,73,78]),productId:["0x0041","0x8041"],productPage:"https://store.arduino.cc/arduino-yun",protocol:"avr109"},{name:"esplora",baud:57600,signature:h.from([67,65,84,69,82,73,78]),productId:["0x003C","0x803C"],productPage:"https://store.arduino.cc/arduino-esplora",protocol:"avr109"},{name:"circuit-playground-classic",baud:57600,signature:h.from([67,65,84,69,82,73,78]),productId:["0x0011","0x8011"],productPage:"https://www.adafruit.com/product/3000",protocol:"avr109"},{name:"zumjunior",baud:115200,signature:h.from([30,149,15]),pageSize:128,numPages:256,timeout:400,productId:["0xEA60"],productPage:"https://store-de.bq.com/de/zum-kit-junior",protocol:"stk500v1"},{name:"zumcore2",baud:115200,signature:h.from([30,149,15]),pageSize:128,numPages:256,timeout:400,productId:["0xEA60"],productPage:"https://www.bq.com/de/zum-core-2-0",protocol:"stk500v1"},{name:"bqZum",baud:19200,signature:h.from([30,149,15]),pageSize:128,numPages:256,timeout:400,productId:["0x6001","0x7523"],productPage:"http://diwo.bq.com/zum-bt-328-especificaciones-tecnicas/",protocol:"stk500v1"},{name:"xprov4",baud:115200,signature:h.from([30,149,22]),pageSize:128,numPages:256,timeout:400,productId:["0x0043","0x7523","0x0001","0xea60"],productPage:"http://www.spark-concepts.com/cnc-xpro-v4-controller/",protocol:"stk500v1"}];function u(){for(var d={},a=0;a<g.length;a++){var b=g[a];d[b.name]=b;var v=b.aliases;if(Array.isArray(v))for(var w=0;w<v.length;w++){var S=v[w];d[S]=b}}return d}r.exports=u()},8828:(r,s,f)=>{var h=f(5997),g=f(3196),u=f(594),d=f(6615),a=f(1195),b=f(8099),v=f(9539),w=function(S){S.protocol=function(){return h},b.call(this,S)};v.inherits(w,b),w.prototype._upload=function(S,E){var m=this,_;try{typeof S=="string"?_=u.readFileSync(S,{encoding:"utf8"}):_=S}catch(T){return E(T)}m._reset(function(T){if(T)return E(T);m.debug("reset complete."),m.connection._pollForOpen(function(M){if(M)return E(M);m.debug("connected"),m._write(_,function(P){var B=P?g.red:g.green;return m.debug(B("flash complete.")),E(P)})})})},w.prototype._write=function(S,E){var m=this,_={signature:m.board.signature.toString(),debug:this.megaDebug};m.chip.init(m.connection.serialPort,_,function(T,M){if(T)return E(T);m.debug("flashing, please wait..."),a.series([M.erase.bind(M),M.program.bind(M,S.toString()),function(B){m.board.disableVerify===!0?B():M.verify(B)},M.fuseCheck.bind(M)],function(P){return E(P)})})},w.prototype._reset=function(S){var E=this,m;if(E.board.manualReset)return S(null);var _=new d(E.connection.options.port,{baudRate:1200,autoOpen:!1});E.connection.serialPort=_,m=E.connection,E.debug("resetting board..."),a.series([_.open.bind(_),m._setDTR.bind(m,!1,250)],function(T){if(T)return S(T);a.series([m._pollForPort.bind(m)],function(M){return S(M)})})},r.exports=w},1167:(r,s,f)=>{var h=f(8764).Buffer;const{EventEmitter:g}=f(7187);class u extends g{constructor(a,b){super(b),this.options=b||{},this.browser=!0,this.path=this.options.path,this.isOpen=!1,this.port=null,this.writer=null,this.reader=null,this.baudRate=this.options.baudRate,this.requestOptions=this.options.requestOptions||{},this.options.autoOpen&&this.open()}list(a){return navigator.serial.getPorts().then(b=>{if(a)return a(null,b)}).catch(b=>{if(a)return a(b)})}open(a){window.navigator.serial.requestPort(this.requestOptions).then(b=>{if(this.port=b,!this.isOpen)return this.port.open({baudRate:this.baudRate||57600})}).then(()=>this.writer=this.port.writable.getWriter()).then(()=>this.reader=this.port.readable.getReader()).then(async()=>{for(this.emit("open"),this.isOpen=!0,a(null);this.port.readable.locked;)try{const{value:b,done:v}=await this.reader.read();if(v)break;this.emit("data",h.from(b))}catch(b){console.error(b)}}).catch(b=>{a(b)})}async close(a){try{await this.reader.releaseLock(),await this.writer.releaseLock(),await this.port.close(),this.isOpen=!1}catch(b){if(a)return a(b);throw b}a&&a(null)}async set(a={},b){try{const v={};Object.prototype.hasOwnProperty.call(a,"dtr")&&(v.dataTerminalReady=a.dtr),Object.prototype.hasOwnProperty.call(a,"rts")&&(v.requestToSend=a.rts),Object.prototype.hasOwnProperty.call(a,"brk")&&(v.break=a.brk),Object.keys(v).length>0&&await this.port.setSignals(v)}catch(v){if(b)return b(v);throw v}if(b)return b(null)}write(a,b){if(this.writer.write(a),b)return b(null)}async read(a){let b;try{b=await this.reader.read()}catch(v){if(a)return a(v);throw v}a&&a(null,b)}flush(a){if(console.warn("flush method is a NOP right now"),a)return a(null)}drain(a){if(console.warn("drain method is a NOP right now"),a)return a(null)}}r.exports=u},6126:(r,s,f)=>{var h=f(1167),g=f(1195),u=f(9911),d=function(a){if(this.options=a,this.debug=this.options.debug?console.log.bind(console):function(){},this.board=this.options.board,this.board.protocol==="avr109")throw new Error(`Sorry, we currently don't support ${this.board.name} or other avr109 boards in webserial. Please see https://github.com/noopkat/avrgirl-arduino/issues/204#issuecomment-703284131 for further details`)};d.prototype._init=function(a){this._setUpSerial(function(b){return a(b)})},d.prototype._setUpSerial=function(a){return this.serialPort=new h("",{baudRate:this.board.baud,autoOpen:!1}),this.serialPort.on("open",function(){}),a(null)},d.prototype._sniffPort=function(a){var b=this,v=b.board.productId.map(function(w){return parseInt(w,16)});b._listPorts(function(w,S){var E=S.filter(function(m){return v.indexOf(parseInt(m._standardPid,16))!==-1});return a(null,E)})},d.prototype._setDTR=function(a,b,v){var w=this,S={rts:!1,dtr:a};w.serialPort.set(S,function(E){if(E)return v(E);setTimeout(function(){v(E)},b)})},d.prototype._pollForPort=function(a){var b=this,v=u(function(w){var S=!1;b._sniffPort(function(E,m){m.length&&(b.options.port=m[0].comName,S=!0),w(S)})});v.every(100).ask(15),v(function(w){if(w)b.debug("found port on",b.options.port),b._setUpSerial(function(S){return a(S)});else return a(new Error("could not reconnect after resetting board."))})},d.prototype._pollForOpen=function(a){var b=this,v=u(function(w){b.serialPort.open(function(S){w(!S)})});v.every(200).ask(10),v(function(w){var S;w||(S=new Error("could not open board on "+b.serialPort.path)),a(S)})},d.prototype._cycleDTR=function(a){var b=this;g.series([b._setDTR.bind(b,!0,250),b._setDTR.bind(b,!1,50)],function(v){return a(v)})},d.prototype._listPorts=function(a){var b=[];h.list(function(v,w){if(v)return a(v);for(var S=0;S<w.length;S+=1){var E;if(w[S].productId)E=w[S].productId;else if(w[S].pnpId)try{E="0x"+/PID_\d*/.exec(w[S].pnpId)[0].substr(4)}catch{E=""}else E="";w[S]._standardPid=E,b.push(w[S])}return a(null,b)})},r.exports=d},8099:r=>{var s=function(f){this.debug=f.debug,this.megaDebug=f.megaDebug,this.board=f.board,this.connection=f.connection,this.chip=new f.protocol({quiet:!this.megaDebug})};s.prototype._reset=function(f){var h=this;h.connection._setDTR(!1,250,function(g){return g||h.debug("reset complete."),f(g)})},r.exports=s},5957:(r,s,f)=>{r.exports={stk500v1:f(1023),stk500v2:f(6209),avr109:f(8828)}},1023:(r,s,f)=>{var h=f(8764).Buffer,g=f(4107),u=f(3196),d=f(8623),a=f(8099),b=f(9539),v=function(w){w.protocol=g,a.call(this,w)};b.inherits(v,a),v.prototype._upload=function(w,S){var E=this;this.serialPort=this.connection.serialPort;var m=d._parseHex(w);if(!h.isBuffer(m))return S(m);E.serialPort.open(function(_){if(_)return S(_);E.debug("connected"),E._reset(function(T){if(T)return S(T);E.debug("flashing, please wait..."),E.chip.bootload(E.serialPort,m,E.board,function(M){var P=M?u.red:u.green;return E.debug(P("flash complete.")),E.serialPort.close(),S(M)})})})},v.prototype._reset=function(w){var S=this;S.connection._setDTR(!1,250,function(E){if(E)return w(E);S.connection._setDTR(!0,50,function(m){return S.debug("reset complete."),w(m)})})},r.exports=v},6209:(r,s,f)=>{var h=f(8764).Buffer,g=f(4777),u=f(1195),d=f(3196),a=f(8623),b=f(8099),v=f(9539),w=function(S){S.protocol=function(){return g},b.call(this,S)};v.inherits(w,b),w.prototype._upload=function(S,E){var m=this;m.serialPort=m.connection.serialPort;var _=a._parseHex(S);if(!h.isBuffer(_))return E(_);m.serialPort.open(function(T){if(T)return E(T);m.debug("connected");var M=m.chip(m.serialPort);u.series([m._reset.bind(m),M.sync.bind(M,5),M.verifySignature.bind(M,m.board.signature),M.enterProgrammingMode.bind(M,m.board),function(B){m.debug("flashing, please wait..."),B(null)},M.upload.bind(M,_,m.board.pageSize),M.exitProgrammingMode.bind(M)],function(P){var B=P?d.red:d.green;return m.debug(B("flash complete.")),m.serialPort.close(),E(P)})})},r.exports=w},8623:(r,s,f)=>{var h=f(8764).Buffer,g=f(594),u=f(4620),d={};d._parseHex=function(a){try{var b;return typeof a=="string"?b=g.readFileSync(a,{encoding:"utf8"}):b=h.from(a),u.parse(b).data}catch(v){return v}},d._hexStringToByte=function(a){return h.from([parseInt(a,16)])},r.exports=d},2190:r=>{r.exports=function(f,h,g){if(f.filter)return f.filter(h,g);if(f==null)throw new TypeError;if(typeof h!="function")throw new TypeError;for(var u=[],d=0;d<f.length;d++)if(!!s.call(f,d)){var a=f[d];h.call(g,a,d,f)&&u.push(a)}return u};var s=Object.prototype.hasOwnProperty},1195:function(r,s,f){r=f.nmd(r);var h=f(4155);(function(g,u){u(s)})(this,function(g){function u(V,ee){ee=ee|0;for(var se=Math.max(V.length-ee,0),ce=Array(se),je=0;je<se;je++)ce[je]=V[ee+je];return ce}var d=function(V){var ee=u(arguments,1);return function(){var se=u(arguments);return V.apply(null,ee.concat(se))}},a=function(V){return function(){var ee=u(arguments),se=ee.pop();V.call(this,ee,se)}};function b(V){var ee=typeof V;return V!=null&&(ee=="object"||ee=="function")}var v=typeof setImmediate=="function"&&setImmediate,w=typeof h=="object"&&typeof h.nextTick=="function";function S(V){setTimeout(V,0)}function E(V){return function(ee){var se=u(arguments,1);V(function(){ee.apply(null,se)})}}var m;v?m=setImmediate:w?m=h.nextTick:m=S;var _=E(m);function T(V){return a(function(ee,se){var ce;try{ce=V.apply(this,ee)}catch(je){return se(je)}b(ce)&&typeof ce.then=="function"?ce.then(function(je){M(se,null,je)},function(je){M(se,je.message?je:new Error(je))}):se(null,ce)})}function M(V,ee,se){try{V(ee,se)}catch(ce){_(P,ce)}}function P(V){throw V}var B=typeof Symbol=="function";function D(V){return B&&V[Symbol.toStringTag]==="AsyncFunction"}function L(V){return D(V)?T(V):V}function X(V){return function(ee){var se=u(arguments,1),ce=a(function(je,ye){var Ie=this;return V(ee,function(Le,Ne){L(Le).apply(Ie,je.concat(Ne))},ye)});return se.length?ce.apply(this,se):ce}}var ie=typeof f.g=="object"&&f.g&&f.g.Object===Object&&f.g,ue=typeof self=="object"&&self&&self.Object===Object&&self,fe=ie||ue||Function("return this")(),q=fe.Symbol,G=Object.prototype,Y=G.hasOwnProperty,J=G.toString,A=q?q.toStringTag:void 0;function C(V){var ee=Y.call(V,A),se=V[A];try{V[A]=void 0;var ce=!0}catch{}var je=J.call(V);return ce&&(ee?V[A]=se:delete V[A]),je}var N=Object.prototype,U=N.toString;function R(V){return U.call(V)}var H="[object Null]",W="[object Undefined]",ae=q?q.toStringTag:void 0;function ge(V){return V==null?V===void 0?W:H:ae&&ae in Object(V)?C(V):R(V)}var xe="[object AsyncFunction]",we="[object Function]",be="[object GeneratorFunction]",le="[object Proxy]";function pe(V){if(!b(V))return!1;var ee=ge(V);return ee==we||ee==be||ee==xe||ee==le}var me=9007199254740991;function te(V){return typeof V=="number"&&V>-1&&V%1==0&&V<=me}function de(V){return V!=null&&te(V.length)&&!pe(V)}var Z={};function Q(){}function ve(V){return function(){if(V!==null){var ee=V;V=null,ee.apply(this,arguments)}}}var Se=typeof Symbol=="function"&&Symbol.iterator,Re=function(V){return Se&&V[Se]&&V[Se]()};function ne(V,ee){for(var se=-1,ce=Array(V);++se<V;)ce[se]=ee(se);return ce}function re(V){return V!=null&&typeof V=="object"}var Ce="[object Arguments]";function Me(V){return re(V)&&ge(V)==Ce}var ke=Object.prototype,Ae=ke.hasOwnProperty,Be=ke.propertyIsEnumerable,et=Me(function(){return arguments}())?Me:function(V){return re(V)&&Ae.call(V,"callee")&&!Be.call(V,"callee")},Ke=Array.isArray;function Ze(){return!1}var lt=typeof g=="object"&&g&&!g.nodeType&&g,dt=lt&&!0&&r&&!r.nodeType&&r,Qe=dt&&dt.exports===lt,ut=Qe?fe.Buffer:void 0,K=ut?ut.isBuffer:void 0,I=K||Ze,O=9007199254740991,oe=/^(?:0|[1-9]\d*)$/;function he(V,ee){var se=typeof V;return ee=ee==null?O:ee,!!ee&&(se=="number"||se!="symbol"&&oe.test(V))&&V>-1&&V%1==0&&V<ee}var Ee="[object Arguments]",Te="[object Array]",Pe="[object Boolean]",$e="[object Date]",He="[object Error]",We="[object Function]",Ue="[object Map]",wn="[object Number]",En="[object Object]",An="[object RegExp]",Sn="[object Set]",Cn="[object String]",Tn="[object WeakMap]",_n="[object ArrayBuffer]",In="[object DataView]",Ln="[object Float32Array]",Mn="[object Float64Array]",Nn="[object Int8Array]",On="[object Int16Array]",Rn="[object Int32Array]",Dn="[object Uint8Array]",Fn="[object Uint8ClampedArray]",Pn="[object Uint16Array]",Bn="[object Uint32Array]",Ve={};Ve[Ln]=Ve[Mn]=Ve[Nn]=Ve[On]=Ve[Rn]=Ve[Dn]=Ve[Fn]=Ve[Pn]=Ve[Bn]=!0,Ve[Ee]=Ve[Te]=Ve[_n]=Ve[Pe]=Ve[In]=Ve[$e]=Ve[He]=Ve[We]=Ve[Ue]=Ve[wn]=Ve[En]=Ve[An]=Ve[Sn]=Ve[Cn]=Ve[Tn]=!1;function kn(V){return re(V)&&te(V.length)&&!!Ve[ge(V)]}function Un(V){return function(ee){return V(ee)}}var gr=typeof g=="object"&&g&&!g.nodeType&&g,xt=gr&&!0&&r&&!r.nodeType&&r,Hn=xt&&xt.exports===gr,Zt=Hn&&ie.process,vr=function(){try{var V=xt&&xt.require&&xt.require("util").types;return V||Zt&&Zt.binding&&Zt.binding("util")}catch{}}(),br=vr&&vr.isTypedArray,Vn=br?Un(br):kn,Gn=Object.prototype,$n=Gn.hasOwnProperty;function Wn(V,ee){var se=Ke(V),ce=!se&&et(V),je=!se&&!ce&&I(V),ye=!se&&!ce&&!je&&Vn(V),Ie=se||ce||je||ye,Le=Ie?ne(V.length,String):[],Ne=Le.length;for(var De in V)(ee||$n.call(V,De))&&!(Ie&&(De=="length"||je&&(De=="offset"||De=="parent")||ye&&(De=="buffer"||De=="byteLength"||De=="byteOffset")||he(De,Ne)))&&Le.push(De);return Le}var zn=Object.prototype;function Yn(V){var ee=V&&V.constructor,se=typeof ee=="function"&&ee.prototype||zn;return V===se}function Kn(V,ee){return function(se){return V(ee(se))}}var Xn=Kn(Object.keys,Object),qn=Object.prototype,Jn=qn.hasOwnProperty;function Zn(V){if(!Yn(V))return Xn(V);var ee=[];for(var se in Object(V))Jn.call(V,se)&&se!="constructor"&&ee.push(se);return ee}function Qt(V){return de(V)?Wn(V):Zn(V)}function Qn(V){var ee=-1,se=V.length;return function(){return++ee<se?{value:V[ee],key:ee}:null}}function eo(V){var ee=-1;return function(){var ce=V.next();return ce.done?null:(ee++,{value:ce.value,key:ee})}}function to(V){var ee=Qt(V),se=-1,ce=ee.length;return function(){var ye=ee[++se];return se<ce?{value:V[ye],key:ye}:null}}function ro(V){if(de(V))return Qn(V);var ee=Re(V);return ee?eo(ee):to(V)}function ot(V){return function(){if(V===null)throw new Error("Callback was already called.");var ee=V;V=null,ee.apply(this,arguments)}}function Lt(V){return function(ee,se,ce){if(ce=ve(ce||Q),V<=0||!ee)return ce(null);var je=ro(ee),ye=!1,Ie=0,Le=!1;function Ne(Oe,Fe){if(Ie-=1,Oe)ye=!0,ce(Oe);else{if(Fe===Z||ye&&Ie<=0)return ye=!0,ce(null);Le||De()}}function De(){for(Le=!0;Ie<V&&!ye;){var Oe=je();if(Oe===null){ye=!0,Ie<=0&&ce(null);return}Ie+=1,se(Oe.value,Oe.key,ot(Ne))}Le=!1}De()}}function pt(V,ee,se,ce){Lt(ee)(V,L(se),ce)}function qe(V,ee){return function(se,ce,je){return V(se,ee,ce,je)}}function no(V,ee,se){se=ve(se||Q);var ce=0,je=0,ye=V.length;ye===0&&se(null);function Ie(Le,Ne){Le?se(Le):(++je===ye||Ne===Z)&&se(null)}for(;ce<ye;ce++)ee(V[ce],ce,ot(Ie))}var oo=qe(pt,1/0),ft=function(V,ee,se){var ce=de(V)?no:oo;ce(V,L(ee),se)};function ht(V){return function(ee,se,ce){return V(ft,ee,L(se),ce)}}function mr(V,ee,se,ce){ce=ce||Q,ee=ee||[];var je=[],ye=0,Ie=L(se);V(ee,function(Le,Ne,De){var Oe=ye++;Ie(Le,function(Fe,Ge){je[Oe]=Ge,De(Fe)})},function(Le){ce(Le,je)})}var Mt=ht(mr),yr=X(Mt);function gt(V){return function(ee,se,ce,je){return V(Lt(se),ee,L(ce),je)}}var vt=gt(mr),er=qe(vt,1),jr=X(er);function Nt(V,ee){for(var se=-1,ce=V==null?0:V.length;++se<ce&&ee(V[se],se,V)!==!1;);return V}function io(V){return function(ee,se,ce){for(var je=-1,ye=Object(ee),Ie=ce(ee),Le=Ie.length;Le--;){var Ne=Ie[V?Le:++je];if(se(ye[Ne],Ne,ye)===!1)break}return ee}}var ao=io();function wt(V,ee){return V&&ao(V,ee,Qt)}function so(V,ee,se,ce){for(var je=V.length,ye=se+(ce?1:-1);ce?ye--:++ye<je;)if(ee(V[ye],ye,V))return ye;return-1}function lo(V){return V!==V}function uo(V,ee,se){for(var ce=se-1,je=V.length;++ce<je;)if(V[ce]===ee)return ce;return-1}function Ot(V,ee,se){return ee===ee?uo(V,ee,se):so(V,lo,se)}var tr=function(V,ee,se){typeof ee=="function"&&(se=ee,ee=null),se=ve(se||Q);var ce=Qt(V),je=ce.length;if(!je)return se(null);ee||(ee=je);var ye={},Ie=0,Le=!1,Ne=Object.create(null),De=[],Oe=[],Fe={};wt(V,function(ze,Ye){if(!Ke(ze)){Ge(Ye,[ze]),Oe.push(Ye);return}var Xe=ze.slice(0,ze.length-1),st=Xe.length;if(st===0){Ge(Ye,ze),Oe.push(Ye);return}Fe[Ye]=st,Nt(Xe,function(jt){if(!V[jt])throw new Error("async.auto task `"+Ye+"` has a non-existent dependency `"+jt+"` in "+Xe.join(", "));it(jt,function(){st--,st===0&&Ge(Ye,ze)})})}),ri(),Je();function Ge(ze,Ye){De.push(function(){at(ze,Ye)})}function Je(){if(De.length===0&&Ie===0)return se(null,ye);for(;De.length&&Ie<ee;){var ze=De.shift();ze()}}function it(ze,Ye){var Xe=Ne[ze];Xe||(Xe=Ne[ze]=[]),Xe.push(Ye)}function tt(ze){var Ye=Ne[ze]||[];Nt(Ye,function(Xe){Xe()}),Je()}function at(ze,Ye){if(!Le){var Xe=ot(function(jt,pr){if(Ie--,arguments.length>2&&(pr=u(arguments,1)),jt){var hr={};wt(ye,function(oi,ii){hr[ii]=oi}),hr[ze]=pr,Le=!0,Ne=Object.create(null),se(jt,hr)}else ye[ze]=pr,tt(ze)});Ie++;var st=L(Ye[Ye.length-1]);Ye.length>1?st(ye,Xe):st(Xe)}}function ri(){for(var ze,Ye=0;Oe.length;)ze=Oe.pop(),Ye++,Nt(ni(ze),function(Xe){--Fe[Xe]===0&&Oe.push(Xe)});if(Ye!==je)throw new Error("async.auto cannot execute tasks due to a recursive dependency")}function ni(ze){var Ye=[];return wt(V,function(Xe,st){Ke(Xe)&&Ot(Xe,ze,0)>=0&&Ye.push(st)}),Ye}};function bt(V,ee){for(var se=-1,ce=V==null?0:V.length,je=Array(ce);++se<ce;)je[se]=ee(V[se],se,V);return je}var fo="[object Symbol]";function co(V){return typeof V=="symbol"||re(V)&&ge(V)==fo}var po=1/0,xr=q?q.prototype:void 0,wr=xr?xr.toString:void 0;function rr(V){if(typeof V=="string")return V;if(Ke(V))return bt(V,rr)+"";if(co(V))return wr?wr.call(V):"";var ee=V+"";return ee=="0"&&1/V==-po?"-0":ee}function ho(V,ee,se){var ce=-1,je=V.length;ee<0&&(ee=-ee>je?0:je+ee),se=se>je?je:se,se<0&&(se+=je),je=ee>se?0:se-ee>>>0,ee>>>=0;for(var ye=Array(je);++ce<je;)ye[ce]=V[ce+ee];return ye}function go(V,ee,se){var ce=V.length;return se=se===void 0?ce:se,!ee&&se>=ce?V:ho(V,ee,se)}function vo(V,ee){for(var se=V.length;se--&&Ot(ee,V[se],0)>-1;);return se}function bo(V,ee){for(var se=-1,ce=V.length;++se<ce&&Ot(ee,V[se],0)>-1;);return se}function mo(V){return V.split("")}var yo="\\ud800-\\udfff",jo="\\u0300-\\u036f",xo="\\ufe20-\\ufe2f",wo="\\u20d0-\\u20ff",Eo=jo+xo+wo,Ao="\\ufe0e\\ufe0f",So="\\u200d",Co=RegExp("["+So+yo+Eo+Ao+"]");function To(V){return Co.test(V)}var Er="\\ud800-\\udfff",_o="\\u0300-\\u036f",Io="\\ufe20-\\ufe2f",Lo="\\u20d0-\\u20ff",Mo=_o+Io+Lo,No="\\ufe0e\\ufe0f",Oo="["+Er+"]",nr="["+Mo+"]",or="\\ud83c[\\udffb-\\udfff]",Ro="(?:"+nr+"|"+or+")",Ar="[^"+Er+"]",Sr="(?:\\ud83c[\\udde6-\\uddff]){2}",Cr="[\\ud800-\\udbff][\\udc00-\\udfff]",Do="\\u200d",Tr=Ro+"?",_r="["+No+"]?",Fo="(?:"+Do+"(?:"+[Ar,Sr,Cr].join("|")+")"+_r+Tr+")*",Po=_r+Tr+Fo,Bo="(?:"+[Ar+nr+"?",nr,Sr,Cr,Oo].join("|")+")",ko=RegExp(or+"(?="+or+")|"+Bo+Po,"g");function Uo(V){return V.match(ko)||[]}function Ir(V){return To(V)?Uo(V):mo(V)}function Ho(V){return V==null?"":rr(V)}var Vo=/^\s+|\s+$/g;function Go(V,ee,se){if(V=Ho(V),V&&(se||ee===void 0))return V.replace(Vo,"");if(!V||!(ee=rr(ee)))return V;var ce=Ir(V),je=Ir(ee),ye=bo(ce,je),Ie=vo(ce,je)+1;return go(ce,ye,Ie).join("")}var $o=/^(?:async\s+)?(function)?\s*[^\(]*\(\s*([^\)]*)\)/m,Wo=/,/,zo=/(=.+)?(\s*)$/,Yo=/((\/\/.*$)|(\/\*[\s\S]*?\*\/))/mg;function Ko(V){return V=V.toString().replace(Yo,""),V=V.match($o)[2].replace(" ",""),V=V?V.split(Wo):[],V=V.map(function(ee){return Go(ee.replace(zo,""))}),V}function Lr(V,ee){var se={};wt(V,function(ce,je){var ye,Ie=D(ce),Le=!Ie&&ce.length===1||Ie&&ce.length===0;if(Ke(ce))ye=ce.slice(0,-1),ce=ce[ce.length-1],se[je]=ye.concat(ye.length>0?Ne:ce);else if(Le)se[je]=ce;else{if(ye=Ko(ce),ce.length===0&&!Ie&&ye.length===0)throw new Error("autoInject task functions require explicit parameters.");Ie||ye.pop(),se[je]=ye.concat(Ne)}function Ne(De,Oe){var Fe=bt(ye,function(Ge){return De[Ge]});Fe.push(Oe),L(ce).apply(null,Fe)}}),tr(se,ee)}function rt(){this.head=this.tail=null,this.length=0}function Mr(V,ee){V.length=1,V.head=V.tail=ee}rt.prototype.removeLink=function(V){return V.prev?V.prev.next=V.next:this.head=V.next,V.next?V.next.prev=V.prev:this.tail=V.prev,V.prev=V.next=null,this.length-=1,V},rt.prototype.empty=function(){for(;this.head;)this.shift();return this},rt.prototype.insertAfter=function(V,ee){ee.prev=V,ee.next=V.next,V.next?V.next.prev=ee:this.tail=ee,V.next=ee,this.length+=1},rt.prototype.insertBefore=function(V,ee){ee.prev=V.prev,ee.next=V,V.prev?V.prev.next=ee:this.head=ee,V.prev=ee,this.length+=1},rt.prototype.unshift=function(V){this.head?this.insertBefore(this.head,V):Mr(this,V)},rt.prototype.push=function(V){this.tail?this.insertAfter(this.tail,V):Mr(this,V)},rt.prototype.shift=function(){return this.head&&this.removeLink(this.head)},rt.prototype.pop=function(){return this.tail&&this.removeLink(this.tail)},rt.prototype.toArray=function(){for(var V=Array(this.length),ee=this.head,se=0;se<this.length;se++)V[se]=ee.data,ee=ee.next;return V},rt.prototype.remove=function(V){for(var ee=this.head;ee;){var se=ee.next;V(ee)&&this.removeLink(ee),ee=se}return this};function Nr(V,ee,se){if(ee==null)ee=1;else if(ee===0)throw new Error("Concurrency must not be zero");var ce=L(V),je=0,ye=[],Ie=!1;function Le(Fe,Ge,Je){if(Je!=null&&typeof Je!="function")throw new Error("task callback must be a function");if(Oe.started=!0,Ke(Fe)||(Fe=[Fe]),Fe.length===0&&Oe.idle())return _(function(){Oe.drain()});for(var it=0,tt=Fe.length;it<tt;it++){var at={data:Fe[it],callback:Je||Q};Ge?Oe._tasks.unshift(at):Oe._tasks.push(at)}Ie||(Ie=!0,_(function(){Ie=!1,Oe.process()}))}function Ne(Fe){return function(Ge){je-=1;for(var Je=0,it=Fe.length;Je<it;Je++){var tt=Fe[Je],at=Ot(ye,tt,0);at===0?ye.shift():at>0&&ye.splice(at,1),tt.callback.apply(tt,arguments),Ge!=null&&Oe.error(Ge,tt.data)}je<=Oe.concurrency-Oe.buffer&&Oe.unsaturated(),Oe.idle()&&Oe.drain(),Oe.process()}}var De=!1,Oe={_tasks:new rt,concurrency:ee,payload:se,saturated:Q,unsaturated:Q,buffer:ee/4,empty:Q,drain:Q,error:Q,started:!1,paused:!1,push:function(Fe,Ge){Le(Fe,!1,Ge)},kill:function(){Oe.drain=Q,Oe._tasks.empty()},unshift:function(Fe,Ge){Le(Fe,!0,Ge)},remove:function(Fe){Oe._tasks.remove(Fe)},process:function(){if(!De){for(De=!0;!Oe.paused&&je<Oe.concurrency&&Oe._tasks.length;){var Fe=[],Ge=[],Je=Oe._tasks.length;Oe.payload&&(Je=Math.min(Je,Oe.payload));for(var it=0;it<Je;it++){var tt=Oe._tasks.shift();Fe.push(tt),ye.push(tt),Ge.push(tt.data)}je+=1,Oe._tasks.length===0&&Oe.empty(),je===Oe.concurrency&&Oe.saturated();var at=ot(Ne(Fe));ce(Ge,at)}De=!1}},length:function(){return Oe._tasks.length},running:function(){return je},workersList:function(){return ye},idle:function(){return Oe._tasks.length+je===0},pause:function(){Oe.paused=!0},resume:function(){Oe.paused!==!1&&(Oe.paused=!1,_(Oe.process))}};return Oe}function Or(V,ee){return Nr(V,1,ee)}var mt=qe(pt,1);function ct(V,ee,se,ce){ce=ve(ce||Q);var je=L(se);mt(V,function(ye,Ie,Le){je(ee,ye,function(Ne,De){ee=De,Le(Ne)})},function(ye){ce(ye,ee)})}function ir(){var V=bt(arguments,L);return function(){var ee=u(arguments),se=this,ce=ee[ee.length-1];typeof ce=="function"?ee.pop():ce=Q,ct(V,ee,function(je,ye,Ie){ye.apply(se,je.concat(function(Le){var Ne=u(arguments,1);Ie(Le,Ne)}))},function(je,ye){ce.apply(se,[je].concat(ye))})}}var Rr=function(){return ir.apply(null,u(arguments).reverse())},Xo=Array.prototype.concat,Rt=function(V,ee,se,ce){ce=ce||Q;var je=L(se);vt(V,ee,function(ye,Ie){je(ye,function(Le){return Le?Ie(Le):Ie(null,u(arguments,1))})},function(ye,Ie){for(var Le=[],Ne=0;Ne<Ie.length;Ne++)Ie[Ne]&&(Le=Xo.apply(Le,Ie[Ne]));return ce(ye,Le)})},Dr=qe(Rt,1/0),Fr=qe(Rt,1),Pr=function(){var V=u(arguments),ee=[null].concat(V);return function(){var se=arguments[arguments.length-1];return se.apply(this,ee)}};function Et(V){return V}function yt(V,ee){return function(se,ce,je,ye){ye=ye||Q;var Ie=!1,Le;se(ce,function(Ne,De,Oe){je(Ne,function(Fe,Ge){Fe?Oe(Fe):V(Ge)&&!Le?(Ie=!0,Le=ee(!0,Ne),Oe(null,Z)):Oe()})},function(Ne){Ne?ye(Ne):ye(null,Ie?Le:ee(!1))})}}function Br(V,ee){return ee}var Dt=ht(yt(Et,Br)),At=gt(yt(Et,Br)),Ft=qe(At,1);function kr(V){return function(ee){var se=u(arguments,1);se.push(function(ce){var je=u(arguments,1);typeof console=="object"&&(ce?console.error&&console.error(ce):console[V]&&Nt(je,function(ye){console[V](ye)}))}),L(ee).apply(null,se)}}var Ur=kr("dir");function Hr(V,ee,se){se=ot(se||Q);var ce=L(V),je=L(ee);function ye(Le){if(Le)return se(Le);var Ne=u(arguments,1);Ne.push(Ie),je.apply(this,Ne)}function Ie(Le,Ne){if(Le)return se(Le);if(!Ne)return se(null);ce(ye)}Ie(null,!0)}function ar(V,ee,se){se=ot(se||Q);var ce=L(V),je=function(ye){if(ye)return se(ye);var Ie=u(arguments,1);if(ee.apply(this,Ie))return ce(je);se.apply(null,[null].concat(Ie))};ce(je)}function Vr(V,ee,se){ar(V,function(){return!ee.apply(this,arguments)},se)}function Gr(V,ee,se){se=ot(se||Q);var ce=L(ee),je=L(V);function ye(Le){if(Le)return se(Le);je(Ie)}function Ie(Le,Ne){if(Le)return se(Le);if(!Ne)return se(null);ce(ye)}je(Ie)}function $r(V){return function(ee,se,ce){return V(ee,ce)}}function Pt(V,ee,se){ft(V,$r(L(ee)),se)}function St(V,ee,se,ce){Lt(ee)(V,$r(L(se)),ce)}var Ct=qe(St,1);function sr(V){return D(V)?V:a(function(ee,se){var ce=!0;ee.push(function(){var je=arguments;ce?_(function(){se.apply(null,je)}):se.apply(null,je)}),V.apply(this,ee),ce=!1})}function Bt(V){return!V}var kt=ht(yt(Bt,Bt)),Tt=gt(yt(Bt,Bt)),Ut=qe(Tt,1);function Wr(V){return function(ee){return ee==null?void 0:ee[V]}}function qo(V,ee,se,ce){var je=new Array(ee.length);V(ee,function(ye,Ie,Le){se(ye,function(Ne,De){je[Ie]=!!De,Le(Ne)})},function(ye){if(ye)return ce(ye);for(var Ie=[],Le=0;Le<ee.length;Le++)je[Le]&&Ie.push(ee[Le]);ce(null,Ie)})}function Jo(V,ee,se,ce){var je=[];V(ee,function(ye,Ie,Le){se(ye,function(Ne,De){Ne?Le(Ne):(De&&je.push({index:Ie,value:ye}),Le())})},function(ye){ye?ce(ye):ce(null,bt(je.sort(function(Ie,Le){return Ie.index-Le.index}),Wr("value")))})}function lr(V,ee,se,ce){var je=de(ee)?qo:Jo;je(V,ee,L(se),ce||Q)}var Ht=ht(lr),_t=gt(lr),Vt=qe(_t,1);function zr(V,ee){var se=ot(ee||Q),ce=L(sr(V));function je(ye){if(ye)return se(ye);ce(je)}je()}var Gt=function(V,ee,se,ce){ce=ce||Q;var je=L(se);vt(V,ee,function(ye,Ie){je(ye,function(Le,Ne){return Le?Ie(Le):Ie(null,{key:Ne,val:ye})})},function(ye,Ie){for(var Le={},Ne=Object.prototype.hasOwnProperty,De=0;De<Ie.length;De++)if(Ie[De]){var Oe=Ie[De].key,Fe=Ie[De].val;Ne.call(Le,Oe)?Le[Oe].push(Fe):Le[Oe]=[Fe]}return ce(ye,Le)})},Yr=qe(Gt,1/0),Kr=qe(Gt,1),Xr=kr("log");function $t(V,ee,se,ce){ce=ve(ce||Q);var je={},ye=L(se);pt(V,ee,function(Ie,Le,Ne){ye(Ie,Le,function(De,Oe){if(De)return Ne(De);je[Le]=Oe,Ne()})},function(Ie){ce(Ie,je)})}var qr=qe($t,1/0),Jr=qe($t,1);function Zr(V,ee){return ee in V}function Qr(V,ee){var se=Object.create(null),ce=Object.create(null);ee=ee||Et;var je=L(V),ye=a(function(Le,Ne){var De=ee.apply(null,Le);Zr(se,De)?_(function(){Ne.apply(null,se[De])}):Zr(ce,De)?ce[De].push(Ne):(ce[De]=[Ne],je.apply(null,Le.concat(function(){var Oe=u(arguments);se[De]=Oe;var Fe=ce[De];delete ce[De];for(var Ge=0,Je=Fe.length;Ge<Je;Ge++)Fe[Ge].apply(null,Oe)})))});return ye.memo=se,ye.unmemoized=V,ye}var Wt;w?Wt=h.nextTick:v?Wt=setImmediate:Wt=S;var en=E(Wt);function ur(V,ee,se){se=se||Q;var ce=de(ee)?[]:{};V(ee,function(je,ye,Ie){L(je)(function(Le,Ne){arguments.length>2&&(Ne=u(arguments,1)),ce[ye]=Ne,Ie(Le)})},function(je){se(je,ce)})}function tn(V,ee){ur(ft,V,ee)}function rn(V,ee,se){ur(Lt(ee),V,se)}var fr=function(V,ee){var se=L(V);return Nr(function(ce,je){se(ce[0],je)},ee,1)},nn=function(V,ee){var se=fr(V,ee);return se.push=function(ce,je,ye){if(ye==null&&(ye=Q),typeof ye!="function")throw new Error("task callback must be a function");if(se.started=!0,Ke(ce)||(ce=[ce]),ce.length===0)return _(function(){se.drain()});je=je||0;for(var Ie=se._tasks.head;Ie&&je>=Ie.priority;)Ie=Ie.next;for(var Le=0,Ne=ce.length;Le<Ne;Le++){var De={data:ce[Le],priority:je,callback:ye};Ie?se._tasks.insertBefore(Ie,De):se._tasks.push(De)}_(se.process)},delete se.unshift,se};function on(V,ee){if(ee=ve(ee||Q),!Ke(V))return ee(new TypeError("First argument to race must be an array of functions"));if(!V.length)return ee();for(var se=0,ce=V.length;se<ce;se++)L(V[se])(ee)}function zt(V,ee,se,ce){var je=u(V).reverse();ct(je,ee,se,ce)}function Yt(V){var ee=L(V);return a(function(ce,je){return ce.push(function(Ie,Le){if(Ie)je(null,{error:Ie});else{var Ne;arguments.length<=2?Ne=Le:Ne=u(arguments,1),je(null,{value:Ne})}}),ee.apply(this,ce)})}function an(V){var ee;return Ke(V)?ee=bt(V,Yt):(ee={},wt(V,function(se,ce){ee[ce]=Yt.call(this,se)})),ee}function sn(V,ee,se,ce){lr(V,ee,function(je,ye){se(je,function(Ie,Le){ye(Ie,!Le)})},ce)}var ln=ht(sn),cr=gt(sn),un=qe(cr,1);function fn(V){return function(){return V}}function Kt(V,ee,se){var ce=5,je=0,ye={times:ce,intervalFunc:fn(je)};function Ie(Oe,Fe){if(typeof Fe=="object")Oe.times=+Fe.times||ce,Oe.intervalFunc=typeof Fe.interval=="function"?Fe.interval:fn(+Fe.interval||je),Oe.errorFilter=Fe.errorFilter;else if(typeof Fe=="number"||typeof Fe=="string")Oe.times=+Fe||ce;else throw new Error("Invalid arguments for async.retry")}if(arguments.length<3&&typeof V=="function"?(se=ee||Q,ee=V):(Ie(ye,V),se=se||Q),typeof ee!="function")throw new Error("Invalid arguments for async.retry");var Le=L(ee),Ne=1;function De(){Le(function(Oe){Oe&&Ne++<ye.times&&(typeof ye.errorFilter!="function"||ye.errorFilter(Oe))?setTimeout(De,ye.intervalFunc(Ne)):se.apply(null,arguments)})}De()}var cn=function(V,ee){ee||(ee=V,V=null);var se=L(ee);return a(function(ce,je){function ye(Ie){se.apply(null,ce.concat(Ie))}V?Kt(V,ye,je):Kt(ye,je)})};function dn(V,ee){ur(mt,V,ee)}var Xt=ht(yt(Boolean,Et)),It=gt(yt(Boolean,Et)),qt=qe(It,1);function pn(V,ee,se){var ce=L(ee);Mt(V,function(ye,Ie){ce(ye,function(Le,Ne){if(Le)return Ie(Le);Ie(null,{value:ye,criteria:Ne})})},function(ye,Ie){if(ye)return se(ye);se(null,bt(Ie.sort(je),Wr("value")))});function je(ye,Ie){var Le=ye.criteria,Ne=Ie.criteria;return Le<Ne?-1:Le>Ne?1:0}}function hn(V,ee,se){var ce=L(V);return a(function(je,ye){var Ie=!1,Le;function Ne(){var De=V.name||"anonymous",Oe=new Error('Callback function "'+De+'" timed out.');Oe.code="ETIMEDOUT",se&&(Oe.info=se),Ie=!0,ye(Oe)}je.push(function(){Ie||(ye.apply(null,arguments),clearTimeout(Le))}),Le=setTimeout(Ne,ee),ce.apply(null,je)})}var Zo=Math.ceil,Qo=Math.max;function ei(V,ee,se,ce){for(var je=-1,ye=Qo(Zo((ee-V)/(se||1)),0),Ie=Array(ye);ye--;)Ie[ce?ye:++je]=V,V+=se;return Ie}function Jt(V,ee,se,ce){var je=L(se);vt(ei(0,V,1),ee,je,ce)}var gn=qe(Jt,1/0),vn=qe(Jt,1);function bn(V,ee,se,ce){arguments.length<=3&&(ce=se,se=ee,ee=Ke(V)?[]:{}),ce=ve(ce||Q);var je=L(se);ft(V,function(ye,Ie,Le){je(ee,ye,Ie,Le)},function(ye){ce(ye,ee)})}function mn(V,ee){var se=null,ce;ee=ee||Q,Ct(V,function(je,ye){L(je)(function(Ie,Le){arguments.length>2?ce=u(arguments,1):ce=Le,se=Ie,ye(!Ie)})},function(){ee(se,ce)})}function yn(V){return function(){return(V.unmemoized||V).apply(null,arguments)}}function dr(V,ee,se){se=ot(se||Q);var ce=L(ee);if(!V())return se(null);var je=function(ye){if(ye)return se(ye);if(V())return ce(je);var Ie=u(arguments,1);se.apply(null,[null].concat(Ie))};ce(je)}function jn(V,ee,se){dr(function(){return!V.apply(this,arguments)},ee,se)}var xn=function(V,ee){if(ee=ve(ee||Q),!Ke(V))return ee(new Error("First argument to waterfall must be an array of functions"));if(!V.length)return ee();var se=0;function ce(ye){var Ie=L(V[se++]);ye.push(ot(je)),Ie.apply(null,ye)}function je(ye){if(ye||se===V.length)return ee.apply(null,arguments);ce(u(arguments,1))}ce([])},ti={apply:d,applyEach:yr,applyEachSeries:jr,asyncify:T,auto:tr,autoInject:Lr,cargo:Or,compose:Rr,concat:Dr,concatLimit:Rt,concatSeries:Fr,constant:Pr,detect:Dt,detectLimit:At,detectSeries:Ft,dir:Ur,doDuring:Hr,doUntil:Vr,doWhilst:ar,during:Gr,each:Pt,eachLimit:St,eachOf:ft,eachOfLimit:pt,eachOfSeries:mt,eachSeries:Ct,ensureAsync:sr,every:kt,everyLimit:Tt,everySeries:Ut,filter:Ht,filterLimit:_t,filterSeries:Vt,forever:zr,groupBy:Yr,groupByLimit:Gt,groupBySeries:Kr,log:Xr,map:Mt,mapLimit:vt,mapSeries:er,mapValues:qr,mapValuesLimit:$t,mapValuesSeries:Jr,memoize:Qr,nextTick:en,parallel:tn,parallelLimit:rn,priorityQueue:nn,queue:fr,race:on,reduce:ct,reduceRight:zt,reflect:Yt,reflectAll:an,reject:ln,rejectLimit:cr,rejectSeries:un,retry:Kt,retryable:cn,seq:ir,series:dn,setImmediate:_,some:Xt,someLimit:It,someSeries:qt,sortBy:pn,timeout:hn,times:gn,timesLimit:Jt,timesSeries:vn,transform:bn,tryEach:mn,unmemoize:yn,until:jn,waterfall:xn,whilst:dr,all:kt,allLimit:Tt,allSeries:Ut,any:Xt,anyLimit:It,anySeries:qt,find:Dt,findLimit:At,findSeries:Ft,forEach:Pt,forEachSeries:Ct,forEachLimit:St,forEachOf:ft,forEachOfSeries:mt,forEachOfLimit:pt,inject:ct,foldl:ct,foldr:zt,select:Ht,selectLimit:_t,selectSeries:Vt,wrapSync:T};g.default=ti,g.apply=d,g.applyEach=yr,g.applyEachSeries=jr,g.asyncify=T,g.auto=tr,g.autoInject=Lr,g.cargo=Or,g.compose=Rr,g.concat=Dr,g.concatLimit=Rt,g.concatSeries=Fr,g.constant=Pr,g.detect=Dt,g.detectLimit=At,g.detectSeries=Ft,g.dir=Ur,g.doDuring=Hr,g.doUntil=Vr,g.doWhilst=ar,g.during=Gr,g.each=Pt,g.eachLimit=St,g.eachOf=ft,g.eachOfLimit=pt,g.eachOfSeries=mt,g.eachSeries=Ct,g.ensureAsync=sr,g.every=kt,g.everyLimit=Tt,g.everySeries=Ut,g.filter=Ht,g.filterLimit=_t,g.filterSeries=Vt,g.forever=zr,g.groupBy=Yr,g.groupByLimit=Gt,g.groupBySeries=Kr,g.log=Xr,g.map=Mt,g.mapLimit=vt,g.mapSeries=er,g.mapValues=qr,g.mapValuesLimit=$t,g.mapValuesSeries=Jr,g.memoize=Qr,g.nextTick=en,g.parallel=tn,g.parallelLimit=rn,g.priorityQueue=nn,g.queue=fr,g.race=on,g.reduce=ct,g.reduceRight=zt,g.reflect=Yt,g.reflectAll=an,g.reject=ln,g.rejectLimit=cr,g.rejectSeries=un,g.retry=Kt,g.retryable=cn,g.seq=ir,g.series=dn,g.setImmediate=_,g.some=Xt,g.someLimit=It,g.someSeries=qt,g.sortBy=pn,g.timeout=hn,g.times=gn,g.timesLimit=Jt,g.timesSeries=vn,g.transform=bn,g.tryEach=mn,g.unmemoize=yn,g.until=jn,g.waterfall=xn,g.whilst=dr,g.all=kt,g.allLimit=Tt,g.allSeries=Ut,g.any=Xt,g.anyLimit=It,g.anySeries=qt,g.find=Dt,g.findLimit=At,g.findSeries=Ft,g.forEach=Pt,g.forEachSeries=Ct,g.forEachLimit=St,g.forEachOf=ft,g.forEachOfSeries=mt,g.forEachOfLimit=pt,g.inject=ct,g.foldl=ct,g.foldr=zt,g.select=Ht,g.selectLimit=_t,g.selectSeries=Vt,g.wrapSync=T,Object.defineProperty(g,"__esModule",{value:!0})})},6314:(r,s,f)=>{var h=f(2190);r.exports=function(){return h(["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],function(u){return typeof f.g[u]=="function"})}},3664:r=>{r.exports=function(f,h){for(var g=0;g++<h;)f=f*2;return f}},9911:(r,s,f)=>{var h=f(7413),g=f(3664);r.exports=function(d){if(!arguments.length)throw new SyntaxError("must supply a polling function");if(!h(d,"function"))throw new TypeError("poll must be a function");return function(){var a=1/0,b=!1,v=1e3,w=null,S=0,E,m;function _(){var M=d(T);d.length===0&&T(M)}function T(M){var P=v,B=m;if(S+=1,M||S>=a){m&&(m=null,B(!!M));return}b&&(b===!0?P=g(P,S):P+=S*b),w=setTimeout(_,P)}return E=function(P){if(w&&(clearTimeout(w),w=null,m&&m(!1),m=null,S=0),arguments.length){if(!h(P,"function"))throw new TypeError("done callback must be a function");m=P}w=setTimeout(_,v)},E.ask=function(P){if(w)throw new SyntaxError("can not set ask limit during polling");if(!h(P,"number"))throw new TypeError("ask limit must be a number");return a=P,E},E.every=function(P){if(w)throw new SyntaxError("can not set timeout during polling");if(!h(P,"number"))throw new TypeError("timout must be a number");return v=P,E},E.incr=function(P){if(w)throw new SyntexError("can not set increment during polling");if(!arguments.length||h(P,"boolean"))b=!!P;else if(h(P,"number"))b=P;else throw new TypeError("increment must be a boolean or number");return E},E}()}},7413:r=>{r.exports=function(f,h){arguments.length===2&&typeof h=="undefined"?h="undefined":Number.isNaN(h)&&(h="NaN");function g(d){return typeof f=="object"&&f!==null}function u(d){return d.name.toLowerCase()}switch(h){case"boolean":case"function":case"string":return typeof f===h;case"number":return typeof f===h&&!isNaN(f);case Number:if(isNaN(f))return!1;case String:case Boolean:return typeof f===u(h);case Object:case"object":return g();case"array":return Array.isArray(f);case"regex":case"regexp":return f instanceof RegExp;case"date":return f instanceof Date;case"null":case null:return f===null;case"undefined":return typeof f=="undefined";case"NaN":return Number.isNaN(f);case"arguments":return g()?typeof f.callee=="function"||/arguments/i.test(f.toString()):!1;default:return typeof h=="function"?f instanceof h:f}}},9742:(r,s)=>{s.byteLength=v,s.toByteArray=S,s.fromByteArray=_;for(var f=[],h=[],g=typeof Uint8Array!="undefined"?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,a=u.length;d<a;++d)f[d]=u[d],h[u.charCodeAt(d)]=d;h["-".charCodeAt(0)]=62,h["_".charCodeAt(0)]=63;function b(T){var M=T.length;if(M%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var P=T.indexOf("=");P===-1&&(P=M);var B=P===M?0:4-P%4;return[P,B]}function v(T){var M=b(T),P=M[0],B=M[1];return(P+B)*3/4-B}function w(T,M,P){return(M+P)*3/4-P}function S(T){var M,P=b(T),B=P[0],D=P[1],L=new g(w(T,B,D)),X=0,ie=D>0?B-4:B,ue;for(ue=0;ue<ie;ue+=4)M=h[T.charCodeAt(ue)]<<18|h[T.charCodeAt(ue+1)]<<12|h[T.charCodeAt(ue+2)]<<6|h[T.charCodeAt(ue+3)],L[X++]=M>>16&255,L[X++]=M>>8&255,L[X++]=M&255;return D===2&&(M=h[T.charCodeAt(ue)]<<2|h[T.charCodeAt(ue+1)]>>4,L[X++]=M&255),D===1&&(M=h[T.charCodeAt(ue)]<<10|h[T.charCodeAt(ue+1)]<<4|h[T.charCodeAt(ue+2)]>>2,L[X++]=M>>8&255,L[X++]=M&255),L}function E(T){return f[T>>18&63]+f[T>>12&63]+f[T>>6&63]+f[T&63]}function m(T,M,P){for(var B,D=[],L=M;L<P;L+=3)B=(T[L]<<16&16711680)+(T[L+1]<<8&65280)+(T[L+2]&255),D.push(E(B));return D.join("")}function _(T){for(var M,P=T.length,B=P%3,D=[],L=16383,X=0,ie=P-B;X<ie;X+=L)D.push(m(T,X,X+L>ie?ie:X+L));return B===1?(M=T[P-1],D.push(f[M>>2]+f[M<<4&63]+"==")):B===2&&(M=(T[P-2]<<8)+T[P-1],D.push(f[M>>10]+f[M>>4&63]+f[M<<2&63]+"=")),D.join("")}},8764:(r,s,f)=>{/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */const h=f(9742),g=f(3703),u=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;s.Buffer=v,s.SlowBuffer=L,s.INSPECT_MAX_BYTES=50;const d=2147483647;s.kMaxLength=d,v.TYPED_ARRAY_SUPPORT=a(),!v.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function a(){try{const K=new Uint8Array(1),I={foo:function(){return 42}};return Object.setPrototypeOf(I,Uint8Array.prototype),Object.setPrototypeOf(K,I),K.foo()===42}catch{return!1}}Object.defineProperty(v.prototype,"parent",{enumerable:!0,get:function(){if(!!v.isBuffer(this))return this.buffer}}),Object.defineProperty(v.prototype,"offset",{enumerable:!0,get:function(){if(!!v.isBuffer(this))return this.byteOffset}});function b(K){if(K>d)throw new RangeError('The value "'+K+'" is invalid for option "size"');const I=new Uint8Array(K);return Object.setPrototypeOf(I,v.prototype),I}function v(K,I,O){if(typeof K=="number"){if(typeof I=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(K)}return w(K,I,O)}v.poolSize=8192;function w(K,I,O){if(typeof K=="string")return _(K,I);if(ArrayBuffer.isView(K))return M(K);if(K==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof K);if(Ze(K,ArrayBuffer)||K&&Ze(K.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(Ze(K,SharedArrayBuffer)||K&&Ze(K.buffer,SharedArrayBuffer)))return P(K,I,O);if(typeof K=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const oe=K.valueOf&&K.valueOf();if(oe!=null&&oe!==K)return v.from(oe,I,O);const he=B(K);if(he)return he;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof K[Symbol.toPrimitive]=="function")return v.from(K[Symbol.toPrimitive]("string"),I,O);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof K)}v.from=function(K,I,O){return w(K,I,O)},Object.setPrototypeOf(v.prototype,Uint8Array.prototype),Object.setPrototypeOf(v,Uint8Array);function S(K){if(typeof K!="number")throw new TypeError('"size" argument must be of type number');if(K<0)throw new RangeError('The value "'+K+'" is invalid for option "size"')}function E(K,I,O){return S(K),K<=0?b(K):I!==void 0?typeof O=="string"?b(K).fill(I,O):b(K).fill(I):b(K)}v.alloc=function(K,I,O){return E(K,I,O)};function m(K){return S(K),b(K<0?0:D(K)|0)}v.allocUnsafe=function(K){return m(K)},v.allocUnsafeSlow=function(K){return m(K)};function _(K,I){if((typeof I!="string"||I==="")&&(I="utf8"),!v.isEncoding(I))throw new TypeError("Unknown encoding: "+I);const O=X(K,I)|0;let oe=b(O);const he=oe.write(K,I);return he!==O&&(oe=oe.slice(0,he)),oe}function T(K){const I=K.length<0?0:D(K.length)|0,O=b(I);for(let oe=0;oe<I;oe+=1)O[oe]=K[oe]&255;return O}function M(K){if(Ze(K,Uint8Array)){const I=new Uint8Array(K);return P(I.buffer,I.byteOffset,I.byteLength)}return T(K)}function P(K,I,O){if(I<0||K.byteLength<I)throw new RangeError('"offset" is outside of buffer bounds');if(K.byteLength<I+(O||0))throw new RangeError('"length" is outside of buffer bounds');let oe;return I===void 0&&O===void 0?oe=new Uint8Array(K):O===void 0?oe=new Uint8Array(K,I):oe=new Uint8Array(K,I,O),Object.setPrototypeOf(oe,v.prototype),oe}function B(K){if(v.isBuffer(K)){const I=D(K.length)|0,O=b(I);return O.length===0||K.copy(O,0,0,I),O}if(K.length!==void 0)return typeof K.length!="number"||lt(K.length)?b(0):T(K);if(K.type==="Buffer"&&Array.isArray(K.data))return T(K.data)}function D(K){if(K>=d)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+d.toString(16)+" bytes");return K|0}function L(K){return+K!=K&&(K=0),v.alloc(+K)}v.isBuffer=function(I){return I!=null&&I._isBuffer===!0&&I!==v.prototype},v.compare=function(I,O){if(Ze(I,Uint8Array)&&(I=v.from(I,I.offset,I.byteLength)),Ze(O,Uint8Array)&&(O=v.from(O,O.offset,O.byteLength)),!v.isBuffer(I)||!v.isBuffer(O))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(I===O)return 0;let oe=I.length,he=O.length;for(let Ee=0,Te=Math.min(oe,he);Ee<Te;++Ee)if(I[Ee]!==O[Ee]){oe=I[Ee],he=O[Ee];break}return oe<he?-1:he<oe?1:0},v.isEncoding=function(I){switch(String(I).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},v.concat=function(I,O){if(!Array.isArray(I))throw new TypeError('"list" argument must be an Array of Buffers');if(I.length===0)return v.alloc(0);let oe;if(O===void 0)for(O=0,oe=0;oe<I.length;++oe)O+=I[oe].length;const he=v.allocUnsafe(O);let Ee=0;for(oe=0;oe<I.length;++oe){let Te=I[oe];if(Ze(Te,Uint8Array))Ee+Te.length>he.length?(v.isBuffer(Te)||(Te=v.from(Te)),Te.copy(he,Ee)):Uint8Array.prototype.set.call(he,Te,Ee);else if(v.isBuffer(Te))Te.copy(he,Ee);else throw new TypeError('"list" argument must be an Array of Buffers');Ee+=Te.length}return he};function X(K,I){if(v.isBuffer(K))return K.length;if(ArrayBuffer.isView(K)||Ze(K,ArrayBuffer))return K.byteLength;if(typeof K!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof K);const O=K.length,oe=arguments.length>2&&arguments[2]===!0;if(!oe&&O===0)return 0;let he=!1;for(;;)switch(I){case"ascii":case"latin1":case"binary":return O;case"utf8":case"utf-8":return ke(K).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O*2;case"hex":return O>>>1;case"base64":return et(K).length;default:if(he)return oe?-1:ke(K).length;I=(""+I).toLowerCase(),he=!0}}v.byteLength=X;function ie(K,I,O){let oe=!1;if((I===void 0||I<0)&&(I=0),I>this.length||((O===void 0||O>this.length)&&(O=this.length),O<=0)||(O>>>=0,I>>>=0,O<=I))return"";for(K||(K="utf8");;)switch(K){case"hex":return ge(this,I,O);case"utf8":case"utf-8":return U(this,I,O);case"ascii":return W(this,I,O);case"latin1":case"binary":return ae(this,I,O);case"base64":return N(this,I,O);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return xe(this,I,O);default:if(oe)throw new TypeError("Unknown encoding: "+K);K=(K+"").toLowerCase(),oe=!0}}v.prototype._isBuffer=!0;function ue(K,I,O){const oe=K[I];K[I]=K[O],K[O]=oe}v.prototype.swap16=function(){const I=this.length;if(I%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let O=0;O<I;O+=2)ue(this,O,O+1);return this},v.prototype.swap32=function(){const I=this.length;if(I%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let O=0;O<I;O+=4)ue(this,O,O+3),ue(this,O+1,O+2);return this},v.prototype.swap64=function(){const I=this.length;if(I%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let O=0;O<I;O+=8)ue(this,O,O+7),ue(this,O+1,O+6),ue(this,O+2,O+5),ue(this,O+3,O+4);return this},v.prototype.toString=function(){const I=this.length;return I===0?"":arguments.length===0?U(this,0,I):ie.apply(this,arguments)},v.prototype.toLocaleString=v.prototype.toString,v.prototype.equals=function(I){if(!v.isBuffer(I))throw new TypeError("Argument must be a Buffer");return this===I?!0:v.compare(this,I)===0},v.prototype.inspect=function(){let I="";const O=s.INSPECT_MAX_BYTES;return I=this.toString("hex",0,O).replace(/(.{2})/g,"$1 ").trim(),this.length>O&&(I+=" ... "),"<Buffer "+I+">"},u&&(v.prototype[u]=v.prototype.inspect),v.prototype.compare=function(I,O,oe,he,Ee){if(Ze(I,Uint8Array)&&(I=v.from(I,I.offset,I.byteLength)),!v.isBuffer(I))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof I);if(O===void 0&&(O=0),oe===void 0&&(oe=I?I.length:0),he===void 0&&(he=0),Ee===void 0&&(Ee=this.length),O<0||oe>I.length||he<0||Ee>this.length)throw new RangeError("out of range index");if(he>=Ee&&O>=oe)return 0;if(he>=Ee)return-1;if(O>=oe)return 1;if(O>>>=0,oe>>>=0,he>>>=0,Ee>>>=0,this===I)return 0;let Te=Ee-he,Pe=oe-O;const $e=Math.min(Te,Pe),He=this.slice(he,Ee),We=I.slice(O,oe);for(let Ue=0;Ue<$e;++Ue)if(He[Ue]!==We[Ue]){Te=He[Ue],Pe=We[Ue];break}return Te<Pe?-1:Pe<Te?1:0};function fe(K,I,O,oe,he){if(K.length===0)return-1;if(typeof O=="string"?(oe=O,O=0):O>2147483647?O=2147483647:O<-2147483648&&(O=-2147483648),O=+O,lt(O)&&(O=he?0:K.length-1),O<0&&(O=K.length+O),O>=K.length){if(he)return-1;O=K.length-1}else if(O<0)if(he)O=0;else return-1;if(typeof I=="string"&&(I=v.from(I,oe)),v.isBuffer(I))return I.length===0?-1:q(K,I,O,oe,he);if(typeof I=="number")return I=I&255,typeof Uint8Array.prototype.indexOf=="function"?he?Uint8Array.prototype.indexOf.call(K,I,O):Uint8Array.prototype.lastIndexOf.call(K,I,O):q(K,[I],O,oe,he);throw new TypeError("val must be string, number or Buffer")}function q(K,I,O,oe,he){let Ee=1,Te=K.length,Pe=I.length;if(oe!==void 0&&(oe=String(oe).toLowerCase(),oe==="ucs2"||oe==="ucs-2"||oe==="utf16le"||oe==="utf-16le")){if(K.length<2||I.length<2)return-1;Ee=2,Te/=2,Pe/=2,O/=2}function $e(We,Ue){return Ee===1?We[Ue]:We.readUInt16BE(Ue*Ee)}let He;if(he){let We=-1;for(He=O;He<Te;He++)if($e(K,He)===$e(I,We===-1?0:He-We)){if(We===-1&&(We=He),He-We+1===Pe)return We*Ee}else We!==-1&&(He-=He-We),We=-1}else for(O+Pe>Te&&(O=Te-Pe),He=O;He>=0;He--){let We=!0;for(let Ue=0;Ue<Pe;Ue++)if($e(K,He+Ue)!==$e(I,Ue)){We=!1;break}if(We)return He}return-1}v.prototype.includes=function(I,O,oe){return this.indexOf(I,O,oe)!==-1},v.prototype.indexOf=function(I,O,oe){return fe(this,I,O,oe,!0)},v.prototype.lastIndexOf=function(I,O,oe){return fe(this,I,O,oe,!1)};function G(K,I,O,oe){O=Number(O)||0;const he=K.length-O;oe?(oe=Number(oe),oe>he&&(oe=he)):oe=he;const Ee=I.length;oe>Ee/2&&(oe=Ee/2);let Te;for(Te=0;Te<oe;++Te){const Pe=parseInt(I.substr(Te*2,2),16);if(lt(Pe))return Te;K[O+Te]=Pe}return Te}function Y(K,I,O,oe){return Ke(ke(I,K.length-O),K,O,oe)}function J(K,I,O,oe){return Ke(Ae(I),K,O,oe)}function A(K,I,O,oe){return Ke(et(I),K,O,oe)}function C(K,I,O,oe){return Ke(Be(I,K.length-O),K,O,oe)}v.prototype.write=function(I,O,oe,he){if(O===void 0)he="utf8",oe=this.length,O=0;else if(oe===void 0&&typeof O=="string")he=O,oe=this.length,O=0;else if(isFinite(O))O=O>>>0,isFinite(oe)?(oe=oe>>>0,he===void 0&&(he="utf8")):(he=oe,oe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ee=this.length-O;if((oe===void 0||oe>Ee)&&(oe=Ee),I.length>0&&(oe<0||O<0)||O>this.length)throw new RangeError("Attempt to write outside buffer bounds");he||(he="utf8");let Te=!1;for(;;)switch(he){case"hex":return G(this,I,O,oe);case"utf8":case"utf-8":return Y(this,I,O,oe);case"ascii":case"latin1":case"binary":return J(this,I,O,oe);case"base64":return A(this,I,O,oe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return C(this,I,O,oe);default:if(Te)throw new TypeError("Unknown encoding: "+he);he=(""+he).toLowerCase(),Te=!0}},v.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function N(K,I,O){return I===0&&O===K.length?h.fromByteArray(K):h.fromByteArray(K.slice(I,O))}function U(K,I,O){O=Math.min(K.length,O);const oe=[];let he=I;for(;he<O;){const Ee=K[he];let Te=null,Pe=Ee>239?4:Ee>223?3:Ee>191?2:1;if(he+Pe<=O){let $e,He,We,Ue;switch(Pe){case 1:Ee<128&&(Te=Ee);break;case 2:$e=K[he+1],($e&192)===128&&(Ue=(Ee&31)<<6|$e&63,Ue>127&&(Te=Ue));break;case 3:$e=K[he+1],He=K[he+2],($e&192)===128&&(He&192)===128&&(Ue=(Ee&15)<<12|($e&63)<<6|He&63,Ue>2047&&(Ue<55296||Ue>57343)&&(Te=Ue));break;case 4:$e=K[he+1],He=K[he+2],We=K[he+3],($e&192)===128&&(He&192)===128&&(We&192)===128&&(Ue=(Ee&15)<<18|($e&63)<<12|(He&63)<<6|We&63,Ue>65535&&Ue<1114112&&(Te=Ue))}}Te===null?(Te=65533,Pe=1):Te>65535&&(Te-=65536,oe.push(Te>>>10&1023|55296),Te=56320|Te&1023),oe.push(Te),he+=Pe}return H(oe)}const R=4096;function H(K){const I=K.length;if(I<=R)return String.fromCharCode.apply(String,K);let O="",oe=0;for(;oe<I;)O+=String.fromCharCode.apply(String,K.slice(oe,oe+=R));return O}function W(K,I,O){let oe="";O=Math.min(K.length,O);for(let he=I;he<O;++he)oe+=String.fromCharCode(K[he]&127);return oe}function ae(K,I,O){let oe="";O=Math.min(K.length,O);for(let he=I;he<O;++he)oe+=String.fromCharCode(K[he]);return oe}function ge(K,I,O){const oe=K.length;(!I||I<0)&&(I=0),(!O||O<0||O>oe)&&(O=oe);let he="";for(let Ee=I;Ee<O;++Ee)he+=dt[K[Ee]];return he}function xe(K,I,O){const oe=K.slice(I,O);let he="";for(let Ee=0;Ee<oe.length-1;Ee+=2)he+=String.fromCharCode(oe[Ee]+oe[Ee+1]*256);return he}v.prototype.slice=function(I,O){const oe=this.length;I=~~I,O=O===void 0?oe:~~O,I<0?(I+=oe,I<0&&(I=0)):I>oe&&(I=oe),O<0?(O+=oe,O<0&&(O=0)):O>oe&&(O=oe),O<I&&(O=I);const he=this.subarray(I,O);return Object.setPrototypeOf(he,v.prototype),he};function we(K,I,O){if(K%1!==0||K<0)throw new RangeError("offset is not uint");if(K+I>O)throw new RangeError("Trying to access beyond buffer length")}v.prototype.readUintLE=v.prototype.readUIntLE=function(I,O,oe){I=I>>>0,O=O>>>0,oe||we(I,O,this.length);let he=this[I],Ee=1,Te=0;for(;++Te<O&&(Ee*=256);)he+=this[I+Te]*Ee;return he},v.prototype.readUintBE=v.prototype.readUIntBE=function(I,O,oe){I=I>>>0,O=O>>>0,oe||we(I,O,this.length);let he=this[I+--O],Ee=1;for(;O>0&&(Ee*=256);)he+=this[I+--O]*Ee;return he},v.prototype.readUint8=v.prototype.readUInt8=function(I,O){return I=I>>>0,O||we(I,1,this.length),this[I]},v.prototype.readUint16LE=v.prototype.readUInt16LE=function(I,O){return I=I>>>0,O||we(I,2,this.length),this[I]|this[I+1]<<8},v.prototype.readUint16BE=v.prototype.readUInt16BE=function(I,O){return I=I>>>0,O||we(I,2,this.length),this[I]<<8|this[I+1]},v.prototype.readUint32LE=v.prototype.readUInt32LE=function(I,O){return I=I>>>0,O||we(I,4,this.length),(this[I]|this[I+1]<<8|this[I+2]<<16)+this[I+3]*16777216},v.prototype.readUint32BE=v.prototype.readUInt32BE=function(I,O){return I=I>>>0,O||we(I,4,this.length),this[I]*16777216+(this[I+1]<<16|this[I+2]<<8|this[I+3])},v.prototype.readBigUInt64LE=Qe(function(I){I=I>>>0,ne(I,"offset");const O=this[I],oe=this[I+7];(O===void 0||oe===void 0)&&re(I,this.length-8);const he=O+this[++I]*2**8+this[++I]*2**16+this[++I]*2**24,Ee=this[++I]+this[++I]*2**8+this[++I]*2**16+oe*2**24;return BigInt(he)+(BigInt(Ee)<<BigInt(32))}),v.prototype.readBigUInt64BE=Qe(function(I){I=I>>>0,ne(I,"offset");const O=this[I],oe=this[I+7];(O===void 0||oe===void 0)&&re(I,this.length-8);const he=O*2**24+this[++I]*2**16+this[++I]*2**8+this[++I],Ee=this[++I]*2**24+this[++I]*2**16+this[++I]*2**8+oe;return(BigInt(he)<<BigInt(32))+BigInt(Ee)}),v.prototype.readIntLE=function(I,O,oe){I=I>>>0,O=O>>>0,oe||we(I,O,this.length);let he=this[I],Ee=1,Te=0;for(;++Te<O&&(Ee*=256);)he+=this[I+Te]*Ee;return Ee*=128,he>=Ee&&(he-=Math.pow(2,8*O)),he},v.prototype.readIntBE=function(I,O,oe){I=I>>>0,O=O>>>0,oe||we(I,O,this.length);let he=O,Ee=1,Te=this[I+--he];for(;he>0&&(Ee*=256);)Te+=this[I+--he]*Ee;return Ee*=128,Te>=Ee&&(Te-=Math.pow(2,8*O)),Te},v.prototype.readInt8=function(I,O){return I=I>>>0,O||we(I,1,this.length),this[I]&128?(255-this[I]+1)*-1:this[I]},v.prototype.readInt16LE=function(I,O){I=I>>>0,O||we(I,2,this.length);const oe=this[I]|this[I+1]<<8;return oe&32768?oe|4294901760:oe},v.prototype.readInt16BE=function(I,O){I=I>>>0,O||we(I,2,this.length);const oe=this[I+1]|this[I]<<8;return oe&32768?oe|4294901760:oe},v.prototype.readInt32LE=function(I,O){return I=I>>>0,O||we(I,4,this.length),this[I]|this[I+1]<<8|this[I+2]<<16|this[I+3]<<24},v.prototype.readInt32BE=function(I,O){return I=I>>>0,O||we(I,4,this.length),this[I]<<24|this[I+1]<<16|this[I+2]<<8|this[I+3]},v.prototype.readBigInt64LE=Qe(function(I){I=I>>>0,ne(I,"offset");const O=this[I],oe=this[I+7];(O===void 0||oe===void 0)&&re(I,this.length-8);const he=this[I+4]+this[I+5]*2**8+this[I+6]*2**16+(oe<<24);return(BigInt(he)<<BigInt(32))+BigInt(O+this[++I]*256+this[++I]*65536+this[++I]*16777216)}),v.prototype.readBigInt64BE=Qe(function(I){I=I>>>0,ne(I,"offset");const O=this[I],oe=this[I+7];(O===void 0||oe===void 0)&&re(I,this.length-8);const he=(O<<24)+this[++I]*2**16+this[++I]*2**8+this[++I];return(BigInt(he)<<BigInt(32))+BigInt(this[++I]*16777216+this[++I]*65536+this[++I]*256+oe)}),v.prototype.readFloatLE=function(I,O){return I=I>>>0,O||we(I,4,this.length),g.read(this,I,!0,23,4)},v.prototype.readFloatBE=function(I,O){return I=I>>>0,O||we(I,4,this.length),g.read(this,I,!1,23,4)},v.prototype.readDoubleLE=function(I,O){return I=I>>>0,O||we(I,8,this.length),g.read(this,I,!0,52,8)},v.prototype.readDoubleBE=function(I,O){return I=I>>>0,O||we(I,8,this.length),g.read(this,I,!1,52,8)};function be(K,I,O,oe,he,Ee){if(!v.isBuffer(K))throw new TypeError('"buffer" argument must be a Buffer instance');if(I>he||I<Ee)throw new RangeError('"value" argument is out of bounds');if(O+oe>K.length)throw new RangeError("Index out of range")}v.prototype.writeUintLE=v.prototype.writeUIntLE=function(I,O,oe,he){if(I=+I,O=O>>>0,oe=oe>>>0,!he){const Pe=Math.pow(2,8*oe)-1;be(this,I,O,oe,Pe,0)}let Ee=1,Te=0;for(this[O]=I&255;++Te<oe&&(Ee*=256);)this[O+Te]=I/Ee&255;return O+oe},v.prototype.writeUintBE=v.prototype.writeUIntBE=function(I,O,oe,he){if(I=+I,O=O>>>0,oe=oe>>>0,!he){const Pe=Math.pow(2,8*oe)-1;be(this,I,O,oe,Pe,0)}let Ee=oe-1,Te=1;for(this[O+Ee]=I&255;--Ee>=0&&(Te*=256);)this[O+Ee]=I/Te&255;return O+oe},v.prototype.writeUint8=v.prototype.writeUInt8=function(I,O,oe){return I=+I,O=O>>>0,oe||be(this,I,O,1,255,0),this[O]=I&255,O+1},v.prototype.writeUint16LE=v.prototype.writeUInt16LE=function(I,O,oe){return I=+I,O=O>>>0,oe||be(this,I,O,2,65535,0),this[O]=I&255,this[O+1]=I>>>8,O+2},v.prototype.writeUint16BE=v.prototype.writeUInt16BE=function(I,O,oe){return I=+I,O=O>>>0,oe||be(this,I,O,2,65535,0),this[O]=I>>>8,this[O+1]=I&255,O+2},v.prototype.writeUint32LE=v.prototype.writeUInt32LE=function(I,O,oe){return I=+I,O=O>>>0,oe||be(this,I,O,4,4294967295,0),this[O+3]=I>>>24,this[O+2]=I>>>16,this[O+1]=I>>>8,this[O]=I&255,O+4},v.prototype.writeUint32BE=v.prototype.writeUInt32BE=function(I,O,oe){return I=+I,O=O>>>0,oe||be(this,I,O,4,4294967295,0),this[O]=I>>>24,this[O+1]=I>>>16,this[O+2]=I>>>8,this[O+3]=I&255,O+4};function le(K,I,O,oe,he){Re(I,oe,he,K,O,7);let Ee=Number(I&BigInt(4294967295));K[O++]=Ee,Ee=Ee>>8,K[O++]=Ee,Ee=Ee>>8,K[O++]=Ee,Ee=Ee>>8,K[O++]=Ee;let Te=Number(I>>BigInt(32)&BigInt(4294967295));return K[O++]=Te,Te=Te>>8,K[O++]=Te,Te=Te>>8,K[O++]=Te,Te=Te>>8,K[O++]=Te,O}function pe(K,I,O,oe,he){Re(I,oe,he,K,O,7);let Ee=Number(I&BigInt(4294967295));K[O+7]=Ee,Ee=Ee>>8,K[O+6]=Ee,Ee=Ee>>8,K[O+5]=Ee,Ee=Ee>>8,K[O+4]=Ee;let Te=Number(I>>BigInt(32)&BigInt(4294967295));return K[O+3]=Te,Te=Te>>8,K[O+2]=Te,Te=Te>>8,K[O+1]=Te,Te=Te>>8,K[O]=Te,O+8}v.prototype.writeBigUInt64LE=Qe(function(I,O=0){return le(this,I,O,BigInt(0),BigInt("0xffffffffffffffff"))}),v.prototype.writeBigUInt64BE=Qe(function(I,O=0){return pe(this,I,O,BigInt(0),BigInt("0xffffffffffffffff"))}),v.prototype.writeIntLE=function(I,O,oe,he){if(I=+I,O=O>>>0,!he){const $e=Math.pow(2,8*oe-1);be(this,I,O,oe,$e-1,-$e)}let Ee=0,Te=1,Pe=0;for(this[O]=I&255;++Ee<oe&&(Te*=256);)I<0&&Pe===0&&this[O+Ee-1]!==0&&(Pe=1),this[O+Ee]=(I/Te>>0)-Pe&255;return O+oe},v.prototype.writeIntBE=function(I,O,oe,he){if(I=+I,O=O>>>0,!he){const $e=Math.pow(2,8*oe-1);be(this,I,O,oe,$e-1,-$e)}let Ee=oe-1,Te=1,Pe=0;for(this[O+Ee]=I&255;--Ee>=0&&(Te*=256);)I<0&&Pe===0&&this[O+Ee+1]!==0&&(Pe=1),this[O+Ee]=(I/Te>>0)-Pe&255;return O+oe},v.prototype.writeInt8=function(I,O,oe){return I=+I,O=O>>>0,oe||be(this,I,O,1,127,-128),I<0&&(I=255+I+1),this[O]=I&255,O+1},v.prototype.writeInt16LE=function(I,O,oe){return I=+I,O=O>>>0,oe||be(this,I,O,2,32767,-32768),this[O]=I&255,this[O+1]=I>>>8,O+2},v.prototype.writeInt16BE=function(I,O,oe){return I=+I,O=O>>>0,oe||be(this,I,O,2,32767,-32768),this[O]=I>>>8,this[O+1]=I&255,O+2},v.prototype.writeInt32LE=function(I,O,oe){return I=+I,O=O>>>0,oe||be(this,I,O,4,2147483647,-2147483648),this[O]=I&255,this[O+1]=I>>>8,this[O+2]=I>>>16,this[O+3]=I>>>24,O+4},v.prototype.writeInt32BE=function(I,O,oe){return I=+I,O=O>>>0,oe||be(this,I,O,4,2147483647,-2147483648),I<0&&(I=4294967295+I+1),this[O]=I>>>24,this[O+1]=I>>>16,this[O+2]=I>>>8,this[O+3]=I&255,O+4},v.prototype.writeBigInt64LE=Qe(function(I,O=0){return le(this,I,O,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),v.prototype.writeBigInt64BE=Qe(function(I,O=0){return pe(this,I,O,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function me(K,I,O,oe,he,Ee){if(O+oe>K.length)throw new RangeError("Index out of range");if(O<0)throw new RangeError("Index out of range")}function te(K,I,O,oe,he){return I=+I,O=O>>>0,he||me(K,I,O,4),g.write(K,I,O,oe,23,4),O+4}v.prototype.writeFloatLE=function(I,O,oe){return te(this,I,O,!0,oe)},v.prototype.writeFloatBE=function(I,O,oe){return te(this,I,O,!1,oe)};function de(K,I,O,oe,he){return I=+I,O=O>>>0,he||me(K,I,O,8),g.write(K,I,O,oe,52,8),O+8}v.prototype.writeDoubleLE=function(I,O,oe){return de(this,I,O,!0,oe)},v.prototype.writeDoubleBE=function(I,O,oe){return de(this,I,O,!1,oe)},v.prototype.copy=function(I,O,oe,he){if(!v.isBuffer(I))throw new TypeError("argument should be a Buffer");if(oe||(oe=0),!he&&he!==0&&(he=this.length),O>=I.length&&(O=I.length),O||(O=0),he>0&&he<oe&&(he=oe),he===oe||I.length===0||this.length===0)return 0;if(O<0)throw new RangeError("targetStart out of bounds");if(oe<0||oe>=this.length)throw new RangeError("Index out of range");if(he<0)throw new RangeError("sourceEnd out of bounds");he>this.length&&(he=this.length),I.length-O<he-oe&&(he=I.length-O+oe);const Ee=he-oe;return this===I&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(O,oe,he):Uint8Array.prototype.set.call(I,this.subarray(oe,he),O),Ee},v.prototype.fill=function(I,O,oe,he){if(typeof I=="string"){if(typeof O=="string"?(he=O,O=0,oe=this.length):typeof oe=="string"&&(he=oe,oe=this.length),he!==void 0&&typeof he!="string")throw new TypeError("encoding must be a string");if(typeof he=="string"&&!v.isEncoding(he))throw new TypeError("Unknown encoding: "+he);if(I.length===1){const Te=I.charCodeAt(0);(he==="utf8"&&Te<128||he==="latin1")&&(I=Te)}}else typeof I=="number"?I=I&255:typeof I=="boolean"&&(I=Number(I));if(O<0||this.length<O||this.length<oe)throw new RangeError("Out of range index");if(oe<=O)return this;O=O>>>0,oe=oe===void 0?this.length:oe>>>0,I||(I=0);let Ee;if(typeof I=="number")for(Ee=O;Ee<oe;++Ee)this[Ee]=I;else{const Te=v.isBuffer(I)?I:v.from(I,he),Pe=Te.length;if(Pe===0)throw new TypeError('The value "'+I+'" is invalid for argument "value"');for(Ee=0;Ee<oe-O;++Ee)this[Ee+O]=Te[Ee%Pe]}return this};const Z={};function Q(K,I,O){Z[K]=class extends O{constructor(){super(),Object.defineProperty(this,"message",{value:I.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${K}]`,this.stack,delete this.name}get code(){return K}set code(he){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:he,writable:!0})}toString(){return`${this.name} [${K}]: ${this.message}`}}}Q("ERR_BUFFER_OUT_OF_BOUNDS",function(K){return K?`${K} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Q("ERR_INVALID_ARG_TYPE",function(K,I){return`The "${K}" argument must be of type number. Received type ${typeof I}`},TypeError),Q("ERR_OUT_OF_RANGE",function(K,I,O){let oe=`The value of "${K}" is out of range.`,he=O;return Number.isInteger(O)&&Math.abs(O)>4294967296?he=ve(String(O)):typeof O=="bigint"&&(he=String(O),(O>BigInt(2)**BigInt(32)||O<-(BigInt(2)**BigInt(32)))&&(he=ve(he)),he+="n"),oe+=` It must be ${I}. Received ${he}`,oe},RangeError);function ve(K){let I="",O=K.length;const oe=K[0]==="-"?1:0;for(;O>=oe+4;O-=3)I=`_${K.slice(O-3,O)}${I}`;return`${K.slice(0,O)}${I}`}function Se(K,I,O){ne(I,"offset"),(K[I]===void 0||K[I+O]===void 0)&&re(I,K.length-(O+1))}function Re(K,I,O,oe,he,Ee){if(K>O||K<I){const Te=typeof I=="bigint"?"n":"";let Pe;throw Ee>3?I===0||I===BigInt(0)?Pe=`>= 0${Te} and < 2${Te} ** ${(Ee+1)*8}${Te}`:Pe=`>= -(2${Te} ** ${(Ee+1)*8-1}${Te}) and < 2 ** ${(Ee+1)*8-1}${Te}`:Pe=`>= ${I}${Te} and <= ${O}${Te}`,new Z.ERR_OUT_OF_RANGE("value",Pe,K)}Se(oe,he,Ee)}function ne(K,I){if(typeof K!="number")throw new Z.ERR_INVALID_ARG_TYPE(I,"number",K)}function re(K,I,O){throw Math.floor(K)!==K?(ne(K,O),new Z.ERR_OUT_OF_RANGE(O||"offset","an integer",K)):I<0?new Z.ERR_BUFFER_OUT_OF_BOUNDS:new Z.ERR_OUT_OF_RANGE(O||"offset",`>= ${O?1:0} and <= ${I}`,K)}const Ce=/[^+/0-9A-Za-z-_]/g;function Me(K){if(K=K.split("=")[0],K=K.trim().replace(Ce,""),K.length<2)return"";for(;K.length%4!==0;)K=K+"=";return K}function ke(K,I){I=I||1/0;let O;const oe=K.length;let he=null;const Ee=[];for(let Te=0;Te<oe;++Te){if(O=K.charCodeAt(Te),O>55295&&O<57344){if(!he){if(O>56319){(I-=3)>-1&&Ee.push(239,191,189);continue}else if(Te+1===oe){(I-=3)>-1&&Ee.push(239,191,189);continue}he=O;continue}if(O<56320){(I-=3)>-1&&Ee.push(239,191,189),he=O;continue}O=(he-55296<<10|O-56320)+65536}else he&&(I-=3)>-1&&Ee.push(239,191,189);if(he=null,O<128){if((I-=1)<0)break;Ee.push(O)}else if(O<2048){if((I-=2)<0)break;Ee.push(O>>6|192,O&63|128)}else if(O<65536){if((I-=3)<0)break;Ee.push(O>>12|224,O>>6&63|128,O&63|128)}else if(O<1114112){if((I-=4)<0)break;Ee.push(O>>18|240,O>>12&63|128,O>>6&63|128,O&63|128)}else throw new Error("Invalid code point")}return Ee}function Ae(K){const I=[];for(let O=0;O<K.length;++O)I.push(K.charCodeAt(O)&255);return I}function Be(K,I){let O,oe,he;const Ee=[];for(let Te=0;Te<K.length&&!((I-=2)<0);++Te)O=K.charCodeAt(Te),oe=O>>8,he=O%256,Ee.push(he),Ee.push(oe);return Ee}function et(K){return h.toByteArray(Me(K))}function Ke(K,I,O,oe){let he;for(he=0;he<oe&&!(he+O>=I.length||he>=K.length);++he)I[he+O]=K[he];return he}function Ze(K,I){return K instanceof I||K!=null&&K.constructor!=null&&K.constructor.name!=null&&K.constructor.name===I.name}function lt(K){return K!==K}const dt=function(){const K="0123456789abcdef",I=new Array(256);for(let O=0;O<16;++O){const oe=O*16;for(let he=0;he<16;++he)I[oe+he]=K[O]+K[he]}return I}();function Qe(K){return typeof BigInt=="undefined"?ut:K}function ut(){throw new Error("BigInt not supported")}},3703:(r,s)=>{/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */s.read=function(f,h,g,u,d){var a,b,v=d*8-u-1,w=(1<<v)-1,S=w>>1,E=-7,m=g?d-1:0,_=g?-1:1,T=f[h+m];for(m+=_,a=T&(1<<-E)-1,T>>=-E,E+=v;E>0;a=a*256+f[h+m],m+=_,E-=8);for(b=a&(1<<-E)-1,a>>=-E,E+=u;E>0;b=b*256+f[h+m],m+=_,E-=8);if(a===0)a=1-S;else{if(a===w)return b?NaN:(T?-1:1)*(1/0);b=b+Math.pow(2,u),a=a-S}return(T?-1:1)*b*Math.pow(2,a-u)},s.write=function(f,h,g,u,d,a){var b,v,w,S=a*8-d-1,E=(1<<S)-1,m=E>>1,_=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,T=u?0:a-1,M=u?1:-1,P=h<0||h===0&&1/h<0?1:0;for(h=Math.abs(h),isNaN(h)||h===1/0?(v=isNaN(h)?1:0,b=E):(b=Math.floor(Math.log(h)/Math.LN2),h*(w=Math.pow(2,-b))<1&&(b--,w*=2),b+m>=1?h+=_/w:h+=_*Math.pow(2,1-m),h*w>=2&&(b++,w/=2),b+m>=E?(v=0,b=E):b+m>=1?(v=(h*w-1)*Math.pow(2,d),b=b+m):(v=h*Math.pow(2,m-1)*Math.pow(2,d),b=0));d>=8;f[g+T]=v&255,T+=M,v/=256,d-=8);for(b=b<<d|v,S+=d;S>0;f[g+T]=b&255,T+=M,b/=256,S-=8);f[g+T-M]|=P*128}},1924:(r,s,f)=>{var h=f(210),g=f(5559),u=g(h("String.prototype.indexOf"));r.exports=function(a,b){var v=h(a,!!b);return typeof v=="function"&&u(a,".prototype.")>-1?g(v):v}},5559:(r,s,f)=>{var h=f(8612),g=f(210),u=g("%Function.prototype.apply%"),d=g("%Function.prototype.call%"),a=g("%Reflect.apply%",!0)||h.call(d,u),b=g("%Object.getOwnPropertyDescriptor%",!0),v=g("%Object.defineProperty%",!0),w=g("%Math.max%");if(v)try{v({},"a",{value:1})}catch{v=null}r.exports=function(m){var _=a(h,d,arguments);if(b&&v){var T=b(_,"length");T.configurable&&v(_,"length",{value:1+w(0,m.length-(arguments.length-1))})}return _};var S=function(){return a(h,u,arguments)};v?v(r.exports,"apply",{value:S}):r.exports.apply=S},5997:(r,s,f)=>{var h=f(4155),g=f(8764).Buffer,u=f(4620);f(2830).Stream,f(9539);var d=r.exports={},a=function(b){return(b+"").charCodeAt(0)};d.Flasher=function(b,v){var w=this;this.options=v||{},this.sp=b,this.signature=this.options.signature||"LUFACDC",this.options.debug&&this.sp.on("data",function(S){h.stdout.write(" -> ");for(var E=0;E<S.length;E++){var m=S.toString().substring(E,E+1);(m.charCodeAt(0)<32||m.charCodeAt(0)>126)&&(m="."),h.stdout.write(m+" ["+S.readUInt8(E).toString(16)+"] ")}h.stdout.write(`
`)}),this.c=function(S,E,m){return w.cmds.push({value:S,callback:function(_){E&&E(_)},expectedResponseLength:m}),this},this.flashChunkSize=0,this.bytes=[],this.cmds=[]},d.Flasher.prototype={run:function(b){var v=this;h.nextTick(function(){if(!v.running){var w=v.cmds.shift();if(w){running=!0,v.options.debug&&h.stdout.write("Send: "+w.value);var S=new g(0),E=function(m){S=g.concat([S,m]),(w.expectedResponseLength===void 0||w.expectedResponseLength<=S.length)&&(v.sp.removeListener("data",E),v.running=!1,w.callback(S),h.nextTick(function(){v.cmds.length>0?v.run(b):b&&b()}))};v.sp.on("data",E),v.sp.write(w.value)}}})},prepare:function(b){var v=this;this.c("S",function(w){w.toString()!==v.signature&&b(new Error("Invalid device signature; expecting: "+v.signature+" received: "+w.toString()))}).c("V").c("v").c("p").c("a").c("b",function(w){(w.toString()||"X")[0]!="Y"&&b(new Error("Buffered memory access not supported.")),v.flashChunkSize=w.readUInt16BE(1)}).c("t").c("TD").c("P").c("F").c("F").c("F").c("N").c("N").c("N").c("Q").c("Q").c("Q").c([a("A"),3,252]).c([a("g"),0,1,a("E")]).c([a("A"),3,255]).c([a("g"),0,1,a("E")]).c([a("A"),3,255]).c([a("g"),0,1,a("E")]).c([a("A"),3,255]).c([a("g"),0,1,a("E")]),this.run(function(){b(null,v)})},erase:function(b){this.c("e",function(){b&&b()}),this.run()},program:function(b,v){var w=this,S,E=[];this.totalBytes=0,this.c([a("A"),0,0],function(){S=u.parse(b),w.totalBytes=S.data.length,Array.prototype.push.apply(E,S.data),w.allBytes=E,w.options.debug&&console.log("programming",E.length,"bytes"),w.chunksSent=[];for(var m=0;m<E.length;m+=w.flashChunkSize){var _=Array.prototype.slice.call(S.data.slice(m,m+w.flashChunkSize));w.chunksSent.push(_),w.c([a("B"),_.length>>8&255,_.length&255,a("F")].concat(_))}}),this.run(function(){v&&v()})},verify:function(b){var v=this;this.c([a("A"),0,0],function(){var w=0,S=function(E){var m=null;if(w++,!v.allBytes.length){b&&b();return}var _=E.length,T=v.allBytes.splice(0,_);if(T.forEach(function(M,P){M!==E.readUInt8(P)&&(m=new Error("Firmware on the device does not match local data"))}),m)return b(m);h.nextTick(function(){var M=v.flashChunkSize;v.options.debug&&console.log(v.totalBytes-w*v.flashChunkSize),v.totalBytes-w*v.flashChunkSize<v.flashChunkSize&&(M=v.totalBytes-w*v.flashChunkSize),v.c([a("g"),M>>8&255,M&255,a("F")],S,M),v.run()})};v.options.debug&&console.log(`

Verifying flash..`),v.c([a("g"),v.flashChunkSize>>8&255,v.flashChunkSize&255,a("F")],S,v.flashChunkSize),v.run()}),v.run()},fuseCheck:function(b){this.options.debug&&console.log("checking fuses"),this.c("F").c("F").c("F").c("N").c("N").c("N").c("Q").c("Q").c("Q").c("L").c("E"),this.run(function(){b()})}},d.init=function(b,v,w){typeof v=="function"&&!w&&(w=v,v={});var S=new d.Flasher(b,v);S.prepare(w)}},2517:(r,s,f)=>{var h={};r.exports=h,h.themes={};var g=f(9539),u=h.styles=f(5784),d=Object.defineProperties,a=new RegExp(/[\r\n]+/g);h.supportsColor=f(6561).supportsColor,typeof h.enabled=="undefined"&&(h.enabled=h.supportsColor()!==!1),h.enable=function(){h.enabled=!0},h.disable=function(){h.enabled=!1},h.stripColors=h.strip=function(P){return(""+P).replace(/\x1B\[\d+m/g,"")},h.stylize=function(B,D){if(!h.enabled)return B+"";var L=u[D];return!L&&D in h?h[D](B):L.open+B+L.close};var b=/[|\\{}()[\]^$+*?.]/g,v=function(P){if(typeof P!="string")throw new TypeError("Expected a string");return P.replace(b,"\\$&")};function w(P){var B=function D(){return m.apply(D,arguments)};return B._styles=P,B.__proto__=E,B}var S=function(){var P={};return u.grey=u.gray,Object.keys(u).forEach(function(B){u[B].closeRe=new RegExp(v(u[B].close),"g"),P[B]={get:function(){return w(this._styles.concat(B))}}}),P}(),E=d(function(){},S);function m(){var P=Array.prototype.slice.call(arguments),B=P.map(function(ue){return ue!=null&&ue.constructor===String?ue:g.inspect(ue)}).join(" ");if(!h.enabled||!B)return B;for(var D=B.indexOf(`
`)!=-1,L=this._styles,X=L.length;X--;){var ie=u[L[X]];B=ie.open+B.replace(ie.closeRe,ie.open)+ie.close,D&&(B=B.replace(a,function(ue){return ie.close+ue+ie.open}))}return B}h.setTheme=function(P){if(typeof P=="string"){console.log("colors.setTheme now only accepts an object, not a string.  If you are trying to set a theme from a file, it is now your (the caller's) responsibility to require the file.  The old syntax looked like colors.setTheme(__dirname + '/../themes/generic-logging.js'); The new syntax looks like colors.setTheme(require(__dirname + '/../themes/generic-logging.js'));");return}for(var B in P)(function(D){h[D]=function(L){if(typeof P[D]=="object"){var X=L;for(var ie in P[D])X=h[P[D][ie]](X);return X}return h[P[D]](L)}})(B)};function _(){var P={};return Object.keys(S).forEach(function(B){P[B]={get:function(){return w([B])}}}),P}var T=function(B,D){var L=D.split("");return L=L.map(B),L.join("")};h.trap=f(5117),h.zalgo=f(1492),h.maps={},h.maps.america=f(6260)(h),h.maps.zebra=f(3270)(h),h.maps.rainbow=f(5920)(h),h.maps.random=f(2449)(h);for(var M in h.maps)(function(P){h[P]=function(B){return T(h.maps[P],B)}})(M);d(h,_())},5117:r=>{r.exports=function(f,h){var g="";f=f||"Run the trap, drop the bass",f=f.split("");var u={a:["@","\u0104","\u023A","\u0245","\u0394","\u039B","\u0414"],b:["\xDF","\u0181","\u0243","\u026E","\u03B2","\u0E3F"],c:["\xA9","\u023B","\u03FE"],d:["\xD0","\u018A","\u0500","\u0501","\u0502","\u0503"],e:["\xCB","\u0115","\u018E","\u0258","\u03A3","\u03BE","\u04BC","\u0A6C"],f:["\u04FA"],g:["\u0262"],h:["\u0126","\u0195","\u04A2","\u04BA","\u04C7","\u050A"],i:["\u0F0F"],j:["\u0134"],k:["\u0138","\u04A0","\u04C3","\u051E"],l:["\u0139"],m:["\u028D","\u04CD","\u04CE","\u0520","\u0521","\u0D69"],n:["\xD1","\u014B","\u019D","\u0376","\u03A0","\u048A"],o:["\xD8","\xF5","\xF8","\u01FE","\u0298","\u047A","\u05DD","\u06DD","\u0E4F"],p:["\u01F7","\u048E"],q:["\u09CD"],r:["\xAE","\u01A6","\u0210","\u024C","\u0280","\u042F"],s:["\xA7","\u03DE","\u03DF","\u03E8"],t:["\u0141","\u0166","\u0373"],u:["\u01B1","\u054D"],v:["\u05D8"],w:["\u0428","\u0460","\u047C","\u0D70"],x:["\u04B2","\u04FE","\u04FC","\u04FD"],y:["\xA5","\u04B0","\u04CB"],z:["\u01B5","\u0240"]};return f.forEach(function(d){d=d.toLowerCase();var a=u[d]||[" "],b=Math.floor(Math.random()*a.length);typeof u[d]!="undefined"?g+=u[d][b]:g+=d}),g}},1492:r=>{r.exports=function(f,h){f=f||"   he is here   ";var g={up:["\u030D","\u030E","\u0304","\u0305","\u033F","\u0311","\u0306","\u0310","\u0352","\u0357","\u0351","\u0307","\u0308","\u030A","\u0342","\u0313","\u0308","\u034A","\u034B","\u034C","\u0303","\u0302","\u030C","\u0350","\u0300","\u0301","\u030B","\u030F","\u0312","\u0313","\u0314","\u033D","\u0309","\u0363","\u0364","\u0365","\u0366","\u0367","\u0368","\u0369","\u036A","\u036B","\u036C","\u036D","\u036E","\u036F","\u033E","\u035B","\u0346","\u031A"],down:["\u0316","\u0317","\u0318","\u0319","\u031C","\u031D","\u031E","\u031F","\u0320","\u0324","\u0325","\u0326","\u0329","\u032A","\u032B","\u032C","\u032D","\u032E","\u032F","\u0330","\u0331","\u0332","\u0333","\u0339","\u033A","\u033B","\u033C","\u0345","\u0347","\u0348","\u0349","\u034D","\u034E","\u0353","\u0354","\u0355","\u0356","\u0359","\u035A","\u0323"],mid:["\u0315","\u031B","\u0300","\u0301","\u0358","\u0321","\u0322","\u0327","\u0328","\u0334","\u0335","\u0336","\u035C","\u035D","\u035E","\u035F","\u0360","\u0362","\u0338","\u0337","\u0361"," \u0489"]},u=[].concat(g.up,g.down,g.mid);function d(v){var w=Math.floor(Math.random()*v);return w}function a(v){var w=!1;return u.filter(function(S){w=S===v}),w}function b(v,w){var S="",E,m;w=w||{},w.up=typeof w.up!="undefined"?w.up:!0,w.mid=typeof w.mid!="undefined"?w.mid:!0,w.down=typeof w.down!="undefined"?w.down:!0,w.size=typeof w.size!="undefined"?w.size:"maxi",v=v.split("");for(m in v)if(!a(m)){switch(S=S+v[m],E={up:0,down:0,mid:0},w.size){case"mini":E.up=d(8),E.mid=d(2),E.down=d(8);break;case"maxi":E.up=d(16)+3,E.mid=d(4)+1,E.down=d(64)+3;break;default:E.up=d(8)+1,E.mid=d(6)/2,E.down=d(8)+1;break}var _=["up","mid","down"];for(var T in _)for(var M=_[T],P=0;P<=E[M];P++)w[M]&&(S=S+g[M][d(g[M].length)])}return S}return b(f,h)}},9883:(r,s,f)=>{var h=f(2517);r.exports=function(){var g=function(a,b){String.prototype.__defineGetter__(a,b)};g("strip",function(){return h.strip(this)}),g("stripColors",function(){return h.strip(this)}),g("trap",function(){return h.trap(this)}),g("zalgo",function(){return h.zalgo(this)}),g("zebra",function(){return h.zebra(this)}),g("rainbow",function(){return h.rainbow(this)}),g("random",function(){return h.random(this)}),g("america",function(){return h.america(this)});var u=Object.keys(h.styles);u.forEach(function(a){g(a,function(){return h.stylize(this,a)})});function d(a){var b=["__defineGetter__","__defineSetter__","__lookupGetter__","__lookupSetter__","charAt","constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf","charCodeAt","indexOf","lastIndexOf","length","localeCompare","match","repeat","replace","search","slice","split","substring","toLocaleLowerCase","toLocaleUpperCase","toLowerCase","toUpperCase","trim","trimLeft","trimRight"];Object.keys(a).forEach(function(v){if(b.indexOf(v)!==-1)console.log("warn: ".red+("String.prototype"+v).magenta+" is probably something you don't want to override.  Ignoring style name");else if(typeof a[v]=="string")h[v]=h[a[v]],g(v,function(){return h[v](this)});else{var w=function(S){for(var E=S||this,m=0;m<a[v].length;m++)E=h[a[v][m]](E);return E};g(v,w),h[v]=function(S){return w(S)}}})}h.setTheme=function(a){if(typeof a=="string"){console.log("colors.setTheme now only accepts an object, not a string. If you are trying to set a theme from a file, it is now your (the caller's) responsibility to require the file.  The old syntax looked like colors.setTheme(__dirname + '/../themes/generic-logging.js'); The new syntax looks like colors.setTheme(require(__dirname + '/../themes/generic-logging.js'));");return}else d(a)}}},3196:(r,s,f)=>{var h=f(2517);r.exports=h,f(9883)()},6260:r=>{r.exports=function(s){return function(f,h,g){if(f===" ")return f;switch(h%3){case 0:return s.red(f);case 1:return s.white(f);case 2:return s.blue(f)}}}},5920:r=>{r.exports=function(s){var f=["red","yellow","green","blue","magenta"];return function(h,g,u){return h===" "?h:s[f[g++%f.length]](h)}}},2449:r=>{r.exports=function(s){var f=["underline","inverse","grey","yellow","red","green","blue","white","cyan","magenta","brightYellow","brightRed","brightGreen","brightBlue","brightWhite","brightCyan","brightMagenta"];return function(h,g,u){return h===" "?h:s[f[Math.round(Math.random()*(f.length-2))]](h)}}},3270:r=>{r.exports=function(s){return function(f,h,g){return h%2===0?f:s.inverse(f)}}},5784:r=>{var s={};r.exports=s;var f={reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],inverse:[7,27],hidden:[8,28],strikethrough:[9,29],black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],gray:[90,39],grey:[90,39],brightRed:[91,39],brightGreen:[92,39],brightYellow:[93,39],brightBlue:[94,39],brightMagenta:[95,39],brightCyan:[96,39],brightWhite:[97,39],bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgGray:[100,49],bgGrey:[100,49],bgBrightRed:[101,49],bgBrightGreen:[102,49],bgBrightYellow:[103,49],bgBrightBlue:[104,49],bgBrightMagenta:[105,49],bgBrightCyan:[106,49],bgBrightWhite:[107,49],blackBG:[40,49],redBG:[41,49],greenBG:[42,49],yellowBG:[43,49],blueBG:[44,49],magentaBG:[45,49],cyanBG:[46,49],whiteBG:[47,49]};Object.keys(f).forEach(function(h){var g=f[h],u=s[h]=[];u.open="\x1B["+g[0]+"m",u.close="\x1B["+g[1]+"m"})},4340:(r,s,f)=>{var h=f(4155);r.exports=function(g,u){u=u||h.argv;var d=u.indexOf("--"),a=/^-{1,2}/.test(g)?"":"--",b=u.indexOf(a+g);return b!==-1&&(d===-1?!0:b<d)}},6561:(r,s,f)=>{var h=f(4155),g=f(7435),u=f(4340),d=h.env,a=void 0;u("no-color")||u("no-colors")||u("color=false")?a=!1:(u("color")||u("colors")||u("color=true")||u("color=always"))&&(a=!0),"FORCE_COLOR"in d&&(a=d.FORCE_COLOR.length===0||parseInt(d.FORCE_COLOR,10)!==0);function b(S){return S===0?!1:{level:S,hasBasic:!0,has256:S>=2,has16m:S>=3}}function v(S){if(a===!1)return 0;if(u("color=16m")||u("color=full")||u("color=truecolor"))return 3;if(u("color=256"))return 2;if(S&&!S.isTTY&&a!==!0)return 0;var E=a?1:0;if(h.platform==="win32"){var m=g.release().split(".");return Number(h.versions.node.split(".")[0])>=8&&Number(m[0])>=10&&Number(m[2])>=10586?Number(m[2])>=14931?3:2:1}if("CI"in d)return["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI"].some(function(T){return T in d})||d.CI_NAME==="codeship"?1:E;if("TEAMCITY_VERSION"in d)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(d.TEAMCITY_VERSION)?1:0;if("TERM_PROGRAM"in d){var _=parseInt((d.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(d.TERM_PROGRAM){case"iTerm.app":return _>=3?3:2;case"Hyper":return 3;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(d.TERM)?2:/^screen|^xterm|^vt100|^rxvt|color|ansi|cygwin|linux/i.test(d.TERM)||"COLORTERM"in d?1:(d.TERM==="dumb",E)}function w(S){var E=v(S);return b(E)}r.exports={supportsColor:w,stdout:w(h.stdout),stderr:w(h.stderr)}},8769:(r,s,f)=>{var h,g=SyntaxError,u=Function,d=TypeError,a=function(J){try{return Function('"use strict"; return ('+J+").constructor;")()}catch{}},b=Object.getOwnPropertyDescriptor;if(b)try{b({},"")}catch{b=null}var v=function(){throw new d},w=b?function(){try{return arguments.callee,v}catch{try{return b(arguments,"callee").get}catch{return v}}}():v,S=f(1405)(),E=Object.getPrototypeOf||function(J){return J.__proto__},m=a("async function* () {}"),_=m?m.prototype:h,T=_?_.prototype:h,M=typeof Uint8Array=="undefined"?h:E(Uint8Array),P={"%AggregateError%":typeof AggregateError=="undefined"?h:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?h:ArrayBuffer,"%ArrayIteratorPrototype%":S?E([][Symbol.iterator]()):h,"%AsyncFromSyncIteratorPrototype%":h,"%AsyncFunction%":a("async function () {}"),"%AsyncGenerator%":_,"%AsyncGeneratorFunction%":m,"%AsyncIteratorPrototype%":T?E(T):h,"%Atomics%":typeof Atomics=="undefined"?h:Atomics,"%BigInt%":typeof BigInt=="undefined"?h:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?h:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?h:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?h:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?h:FinalizationRegistry,"%Function%":u,"%GeneratorFunction%":a("function* () {}"),"%Int8Array%":typeof Int8Array=="undefined"?h:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?h:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?h:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":S?E(E([][Symbol.iterator]())):h,"%JSON%":typeof JSON=="object"?JSON:h,"%Map%":typeof Map=="undefined"?h:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!S?h:E(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?h:Promise,"%Proxy%":typeof Proxy=="undefined"?h:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?h:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?h:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!S?h:E(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?h:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":S?E(""[Symbol.iterator]()):h,"%Symbol%":S?Symbol:h,"%SyntaxError%":g,"%ThrowTypeError%":w,"%TypedArray%":M,"%TypeError%":d,"%Uint8Array%":typeof Uint8Array=="undefined"?h:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?h:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?h:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?h:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?h:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?h:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?h:WeakSet},B={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},D=f(8612),L=f(7642),X=D.call(Function.call,Array.prototype.concat),ie=D.call(Function.apply,Array.prototype.splice),ue=D.call(Function.call,String.prototype.replace),fe=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,q=/\\(\\)?/g,G=function(A){var C=[];return ue(A,fe,function(N,U,R,H){C[C.length]=R?ue(H,q,"$1"):U||N}),C},Y=function(A,C){var N=A,U;if(L(B,N)&&(U=B[N],N="%"+U[0]+"%"),L(P,N)){var R=P[N];if(typeof R=="undefined"&&!C)throw new d("intrinsic "+A+" exists, but is not available. Please file an issue!");return{alias:U,name:N,value:R}}throw new g("intrinsic "+A+" does not exist!")};r.exports=function(A,C){if(typeof A!="string"||A.length===0)throw new d("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof C!="boolean")throw new d('"allowMissing" argument must be a boolean');var N=G(A),U=N.length>0?N[0]:"",R=Y("%"+U+"%",C),H=R.name,W=R.value,ae=!1,ge=R.alias;ge&&(U=ge[0],ie(N,X([0,1],ge)));for(var xe=1,we=!0;xe<N.length;xe+=1){var be=N[xe];if((be==="constructor"||!we)&&(ae=!0),U+="."+be,H="%"+U+"%",L(P,H))W=P[H];else if(W!=null){if(b&&xe+1>=N.length){var le=b(W,be);if(we=!!le,!C&&!(be in W))throw new d("base intrinsic for "+A+" exists, but the property is not available.");we&&"get"in le&&!("originalValue"in le.get)?W=le.get:W=W[be]}else we=L(W,be),W=W[be];we&&!ae&&(P[H]=W)}}return W}},4079:(r,s,f)=>{var h=f(8769),g=h("%Object.getOwnPropertyDescriptor%");if(g)try{g([],"length")}catch{g=null}r.exports=g},7187:r=>{var s=typeof Reflect=="object"?Reflect:null,f=s&&typeof s.apply=="function"?s.apply:function(L,X,ie){return Function.prototype.apply.call(L,X,ie)},h;s&&typeof s.ownKeys=="function"?h=s.ownKeys:Object.getOwnPropertySymbols?h=function(L){return Object.getOwnPropertyNames(L).concat(Object.getOwnPropertySymbols(L))}:h=function(L){return Object.getOwnPropertyNames(L)};function g(D){console&&console.warn&&console.warn(D)}var u=Number.isNaN||function(L){return L!==L};function d(){d.init.call(this)}r.exports=d,r.exports.once=B,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._eventsCount=0,d.prototype._maxListeners=void 0;var a=10;function b(D){if(typeof D!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof D)}Object.defineProperty(d,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(D){if(typeof D!="number"||D<0||u(D))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+D+".");a=D}}),d.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},d.prototype.setMaxListeners=function(L){if(typeof L!="number"||L<0||u(L))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+L+".");return this._maxListeners=L,this};function v(D){return D._maxListeners===void 0?d.defaultMaxListeners:D._maxListeners}d.prototype.getMaxListeners=function(){return v(this)},d.prototype.emit=function(L){for(var X=[],ie=1;ie<arguments.length;ie++)X.push(arguments[ie]);var ue=L==="error",fe=this._events;if(fe!==void 0)ue=ue&&fe.error===void 0;else if(!ue)return!1;if(ue){var q;if(X.length>0&&(q=X[0]),q instanceof Error)throw q;var G=new Error("Unhandled error."+(q?" ("+q.message+")":""));throw G.context=q,G}var Y=fe[L];if(Y===void 0)return!1;if(typeof Y=="function")f(Y,this,X);else for(var J=Y.length,A=T(Y,J),ie=0;ie<J;++ie)f(A[ie],this,X);return!0};function w(D,L,X,ie){var ue,fe,q;if(b(X),fe=D._events,fe===void 0?(fe=D._events=Object.create(null),D._eventsCount=0):(fe.newListener!==void 0&&(D.emit("newListener",L,X.listener?X.listener:X),fe=D._events),q=fe[L]),q===void 0)q=fe[L]=X,++D._eventsCount;else if(typeof q=="function"?q=fe[L]=ie?[X,q]:[q,X]:ie?q.unshift(X):q.push(X),ue=v(D),ue>0&&q.length>ue&&!q.warned){q.warned=!0;var G=new Error("Possible EventEmitter memory leak detected. "+q.length+" "+String(L)+" listeners added. Use emitter.setMaxListeners() to increase limit");G.name="MaxListenersExceededWarning",G.emitter=D,G.type=L,G.count=q.length,g(G)}return D}d.prototype.addListener=function(L,X){return w(this,L,X,!1)},d.prototype.on=d.prototype.addListener,d.prototype.prependListener=function(L,X){return w(this,L,X,!0)};function S(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function E(D,L,X){var ie={fired:!1,wrapFn:void 0,target:D,type:L,listener:X},ue=S.bind(ie);return ue.listener=X,ie.wrapFn=ue,ue}d.prototype.once=function(L,X){return b(X),this.on(L,E(this,L,X)),this},d.prototype.prependOnceListener=function(L,X){return b(X),this.prependListener(L,E(this,L,X)),this},d.prototype.removeListener=function(L,X){var ie,ue,fe,q,G;if(b(X),ue=this._events,ue===void 0)return this;if(ie=ue[L],ie===void 0)return this;if(ie===X||ie.listener===X)--this._eventsCount===0?this._events=Object.create(null):(delete ue[L],ue.removeListener&&this.emit("removeListener",L,ie.listener||X));else if(typeof ie!="function"){for(fe=-1,q=ie.length-1;q>=0;q--)if(ie[q]===X||ie[q].listener===X){G=ie[q].listener,fe=q;break}if(fe<0)return this;fe===0?ie.shift():M(ie,fe),ie.length===1&&(ue[L]=ie[0]),ue.removeListener!==void 0&&this.emit("removeListener",L,G||X)}return this},d.prototype.off=d.prototype.removeListener,d.prototype.removeAllListeners=function(L){var X,ie,ue;if(ie=this._events,ie===void 0)return this;if(ie.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):ie[L]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete ie[L]),this;if(arguments.length===0){var fe=Object.keys(ie),q;for(ue=0;ue<fe.length;++ue)q=fe[ue],q!=="removeListener"&&this.removeAllListeners(q);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(X=ie[L],typeof X=="function")this.removeListener(L,X);else if(X!==void 0)for(ue=X.length-1;ue>=0;ue--)this.removeListener(L,X[ue]);return this};function m(D,L,X){var ie=D._events;if(ie===void 0)return[];var ue=ie[L];return ue===void 0?[]:typeof ue=="function"?X?[ue.listener||ue]:[ue]:X?P(ue):T(ue,ue.length)}d.prototype.listeners=function(L){return m(this,L,!0)},d.prototype.rawListeners=function(L){return m(this,L,!1)},d.listenerCount=function(D,L){return typeof D.listenerCount=="function"?D.listenerCount(L):_.call(D,L)},d.prototype.listenerCount=_;function _(D){var L=this._events;if(L!==void 0){var X=L[D];if(typeof X=="function")return 1;if(X!==void 0)return X.length}return 0}d.prototype.eventNames=function(){return this._eventsCount>0?h(this._events):[]};function T(D,L){for(var X=new Array(L),ie=0;ie<L;++ie)X[ie]=D[ie];return X}function M(D,L){for(;L+1<D.length;L++)D[L]=D[L+1];D.pop()}function P(D){for(var L=new Array(D.length),X=0;X<L.length;++X)L[X]=D[X].listener||D[X];return L}function B(D,L){return new Promise(function(X,ie){function ue(){fe!==void 0&&D.removeListener("error",fe),X([].slice.call(arguments))}var fe;L!=="error"&&(fe=function(G){D.removeListener(L,ue),ie(G)},D.once("error",fe)),D.once(L,ue)})}},9804:r=>{var s=Object.prototype.hasOwnProperty,f=Object.prototype.toString;r.exports=function(g,u,d){if(f.call(u)!=="[object Function]")throw new TypeError("iterator must be a function");var a=g.length;if(a===+a)for(var b=0;b<a;b++)u.call(d,g[b],b,g);else for(var v in g)s.call(g,v)&&u.call(d,g[v],v,g)}},7648:r=>{var s="Function.prototype.bind called on incompatible ",f=Array.prototype.slice,h=Object.prototype.toString,g="[object Function]";r.exports=function(d){var a=this;if(typeof a!="function"||h.call(a)!==g)throw new TypeError(s+a);for(var b=f.call(arguments,1),v,w=function(){if(this instanceof v){var T=a.apply(this,b.concat(f.call(arguments)));return Object(T)===T?T:this}else return a.apply(d,b.concat(f.call(arguments)))},S=Math.max(0,a.length-b.length),E=[],m=0;m<S;m++)E.push("$"+m);if(v=Function("binder","return function ("+E.join(",")+"){ return binder.apply(this,arguments); }")(w),a.prototype){var _=function(){};_.prototype=a.prototype,v.prototype=new _,_.prototype=null}return v}},8612:(r,s,f)=>{var h=f(7648);r.exports=Function.prototype.bind||h},210:(r,s,f)=>{var h,g=SyntaxError,u=Function,d=TypeError,a=function(A){try{return Function('"use strict"; return ('+A+").constructor;")()}catch{}},b=Object.getOwnPropertyDescriptor;if(b)try{b({},"")}catch{b=null}var v=function(){throw new d},w=b?function(){try{return arguments.callee,v}catch{try{return b(arguments,"callee").get}catch{return v}}}():v,S=f(1405)(),E=Object.getPrototypeOf||function(A){return A.__proto__},m=a("async function* () {}"),_=m?m.prototype:h,T=_?_.prototype:h,M=typeof Uint8Array=="undefined"?h:E(Uint8Array),P={"%AggregateError%":typeof AggregateError=="undefined"?h:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer=="undefined"?h:ArrayBuffer,"%ArrayIteratorPrototype%":S?E([][Symbol.iterator]()):h,"%AsyncFromSyncIteratorPrototype%":h,"%AsyncFunction%":a("async function () {}"),"%AsyncGenerator%":_,"%AsyncGeneratorFunction%":m,"%AsyncIteratorPrototype%":T?E(T):h,"%Atomics%":typeof Atomics=="undefined"?h:Atomics,"%BigInt%":typeof BigInt=="undefined"?h:BigInt,"%Boolean%":Boolean,"%DataView%":typeof DataView=="undefined"?h:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array=="undefined"?h:Float32Array,"%Float64Array%":typeof Float64Array=="undefined"?h:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry=="undefined"?h:FinalizationRegistry,"%Function%":u,"%GeneratorFunction%":a("function* () {}"),"%Int8Array%":typeof Int8Array=="undefined"?h:Int8Array,"%Int16Array%":typeof Int16Array=="undefined"?h:Int16Array,"%Int32Array%":typeof Int32Array=="undefined"?h:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":S?E(E([][Symbol.iterator]())):h,"%JSON%":typeof JSON=="object"?JSON:h,"%Map%":typeof Map=="undefined"?h:Map,"%MapIteratorPrototype%":typeof Map=="undefined"||!S?h:E(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise=="undefined"?h:Promise,"%Proxy%":typeof Proxy=="undefined"?h:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect=="undefined"?h:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set=="undefined"?h:Set,"%SetIteratorPrototype%":typeof Set=="undefined"||!S?h:E(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?h:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":S?E(""[Symbol.iterator]()):h,"%Symbol%":S?Symbol:h,"%SyntaxError%":g,"%ThrowTypeError%":w,"%TypedArray%":M,"%TypeError%":d,"%Uint8Array%":typeof Uint8Array=="undefined"?h:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?h:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array=="undefined"?h:Uint16Array,"%Uint32Array%":typeof Uint32Array=="undefined"?h:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap=="undefined"?h:WeakMap,"%WeakRef%":typeof WeakRef=="undefined"?h:WeakRef,"%WeakSet%":typeof WeakSet=="undefined"?h:WeakSet},B={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},D=f(8612),L=f(7642),X=D.call(Function.call,Array.prototype.concat),ie=D.call(Function.apply,Array.prototype.splice),ue=D.call(Function.call,String.prototype.replace),fe=D.call(Function.call,String.prototype.slice),q=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,G=/\\(\\)?/g,Y=function(C){var N=fe(C,0,1),U=fe(C,-1);if(N==="%"&&U!=="%")throw new g("invalid intrinsic syntax, expected closing `%`");if(U==="%"&&N!=="%")throw new g("invalid intrinsic syntax, expected opening `%`");var R=[];return ue(C,q,function(H,W,ae,ge){R[R.length]=ae?ue(ge,G,"$1"):W||H}),R},J=function(C,N){var U=C,R;if(L(B,U)&&(R=B[U],U="%"+R[0]+"%"),L(P,U)){var H=P[U];if(typeof H=="undefined"&&!N)throw new d("intrinsic "+C+" exists, but is not available. Please file an issue!");return{alias:R,name:U,value:H}}throw new g("intrinsic "+C+" does not exist!")};r.exports=function(C,N){if(typeof C!="string"||C.length===0)throw new d("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof N!="boolean")throw new d('"allowMissing" argument must be a boolean');var U=Y(C),R=U.length>0?U[0]:"",H=J("%"+R+"%",N),W=H.name,ae=H.value,ge=!1,xe=H.alias;xe&&(R=xe[0],ie(U,X([0,1],xe)));for(var we=1,be=!0;we<U.length;we+=1){var le=U[we],pe=fe(le,0,1),me=fe(le,-1);if((pe==='"'||pe==="'"||pe==="`"||me==='"'||me==="'"||me==="`")&&pe!==me)throw new g("property names with quotes must have matching quotes");if((le==="constructor"||!be)&&(ge=!0),R+="."+le,W="%"+R+"%",L(P,W))ae=P[W];else if(ae!=null){if(!(le in ae)){if(!N)throw new d("base intrinsic for "+C+" exists, but the property is not available.");return}if(b&&we+1>=U.length){var te=b(ae,le);be=!!te,be&&"get"in te&&!("originalValue"in te.get)?ae=te.get:ae=ae[le]}else be=L(ae,le),ae=ae[le];be&&!ge&&(P[W]=ae)}}return ae}},1405:(r,s,f)=>{var h=f.g.Symbol,g=f(5419);r.exports=function(){return typeof h!="function"||typeof Symbol!="function"||typeof h("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:g()}},5419:r=>{r.exports=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var f={},h=Symbol("test"),g=Object(h);if(typeof h=="string"||Object.prototype.toString.call(h)!=="[object Symbol]"||Object.prototype.toString.call(g)!=="[object Symbol]")return!1;var u=42;f[h]=u;for(h in f)return!1;if(typeof Object.keys=="function"&&Object.keys(f).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(f).length!==0)return!1;var d=Object.getOwnPropertySymbols(f);if(d.length!==1||d[0]!==h||!Object.prototype.propertyIsEnumerable.call(f,h))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var a=Object.getOwnPropertyDescriptor(f,h);if(a.value!==u||a.enumerable!==!0)return!1}return!0}},7642:(r,s,f)=>{var h=f(8612);r.exports=h.call(Function.call,Object.prototype.hasOwnProperty)},5717:r=>{typeof Object.create=="function"?r.exports=function(f,h){f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}})}:r.exports=function(f,h){f.super_=h;var g=function(){};g.prototype=h.prototype,f.prototype=new g,f.prototype.constructor=f}},4620:(r,s,f)=>{var h=f(8764).Buffer;const g=0,u=1,d=2,a=3,b=4,v=5,w=255;s.parse=function(E,m){E instanceof h&&(E=E.toString("ascii"));var _=h.alloc(m||8192),T=0,M=0,P=null,B=null,D=0,L=0;const X=11;for(;L+X<=E.length;){if(E.charAt(L++)!=":")throw new Error("Line "+(D+1)+" does not start with a colon (:).");D++;var ie=parseInt(E.substr(L,2),16);L+=2;var ue=parseInt(E.substr(L,4),16);L+=4;var fe=parseInt(E.substr(L,2),16);L+=2;var q=E.substr(L,ie*2),G=h.from(q,"hex");L+=ie*2;var Y=parseInt(E.substr(L,2),16);L+=2;for(var J=ie+(ue>>8)+ue+fe&255,A=0;A<ie;A++)J=J+G[A]&255;if(J=256-J&255,Y!=J)throw new Error("Invalid checksum on line "+D+": got "+Y+", but expected "+J);switch(fe){case g:var C=M+ue;if(C+ie>=_.length){var N=h.alloc((C+ie)*2);_.copy(N,0,0,T),_=N}C>T&&_.fill(w,T,C),G.copy(_,C),T=Math.max(T,C+ie);break;case u:if(ie!=0)throw new Error("Invalid EOF record on line "+D+".");return{data:_.slice(0,T),startSegmentAddress:P,startLinearAddress:B};case d:if(ie!=2||ue!=0)throw new Error("Invalid extended segment address record on line "+D+".");M=parseInt(q,16)<<4;break;case a:if(ie!=4||ue!=0)throw new Error("Invalid start segment address record on line "+D+".");P=parseInt(q,16);break;case b:if(ie!=2||ue!=0)throw new Error("Invalid extended linear address record on line "+D+".");M=parseInt(q,16)<<16;break;case v:if(ie!=4||ue!=0)throw new Error("Invalid start linear address record on line "+D+".");B=parseInt(q,16);break;default:throw new Error("Invalid record type ("+fe+") on line "+D)}E.charAt(L)=="\r"&&L++,E.charAt(L)==`
`&&L++}throw new Error("Unexpected end of input: missing or invalid EOF record.")}},2584:(r,s,f)=>{var h=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",g=f(1924),u=g("Object.prototype.toString"),d=function(w){return h&&w&&typeof w=="object"&&Symbol.toStringTag in w?!1:u(w)==="[object Arguments]"},a=function(w){return d(w)?!0:w!==null&&typeof w=="object"&&typeof w.length=="number"&&w.length>=0&&u(w)!=="[object Array]"&&u(w.callee)==="[object Function]"},b=function(){return d(arguments)}();d.isLegacyArguments=a,r.exports=b?d:a},8662:r=>{var s=Object.prototype.toString,f=Function.prototype.toString,h=/^\s*(?:function)?\*/,g=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol",u=Object.getPrototypeOf,d=function(){if(!g)return!1;try{return Function("return function*() {}")()}catch{}},a=d(),b=u&&a?u(a):!1;r.exports=function(w){if(typeof w!="function")return!1;if(h.test(f.call(w)))return!0;if(!g){var S=s.call(w);return S==="[object GeneratorFunction]"}return u&&u(w)===b}},5692:(r,s,f)=>{var h=f(9804),g=f(6314),u=f(1924),d=u("Object.prototype.toString"),a=f(1405)(),b=a&&typeof Symbol.toStringTag=="symbol",v=g(),w=u("Array.prototype.indexOf",!0)||function(P,B){for(var D=0;D<P.length;D+=1)if(P[D]===B)return D;return-1},S=u("String.prototype.slice"),E={},m=f(4079),_=Object.getPrototypeOf;b&&m&&_&&h(v,function(M){var P=new f.g[M];if(!(Symbol.toStringTag in P))throw new EvalError("this engine has support for Symbol.toStringTag, but "+M+" does not have the property! Please report this.");var B=_(P),D=m(B,Symbol.toStringTag);if(!D){var L=_(B);D=m(L,Symbol.toStringTag)}E[M]=D.get});var T=function(P){var B=!1;return h(E,function(D,L){if(!B)try{B=D.call(P)===L}catch{}}),B};r.exports=function(P){if(!P||typeof P!="object")return!1;if(!b){var B=S(d(P),8,-1);return w(v,B)>-1}return m?T(P):!1}},7435:(r,s)=>{s.endianness=function(){return"LE"},s.hostname=function(){return typeof location!="undefined"?location.hostname:""},s.loadavg=function(){return[]},s.uptime=function(){return 0},s.freemem=function(){return Number.MAX_VALUE},s.totalmem=function(){return Number.MAX_VALUE},s.cpus=function(){return[]},s.type=function(){return"Browser"},s.release=function(){return typeof navigator!="undefined"?navigator.appVersion:""},s.networkInterfaces=s.getNetworkInterfaces=function(){return{}},s.arch=function(){return"javascript"},s.platform=function(){return"browser"},s.tmpdir=s.tmpDir=function(){return"/tmp"},s.EOL=`
`,s.homedir=function(){return"/"}},4155:r=>{var s=r.exports={},f,h;function g(){throw new Error("setTimeout has not been defined")}function u(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?f=setTimeout:f=g}catch{f=g}try{typeof clearTimeout=="function"?h=clearTimeout:h=u}catch{h=u}})();function d(M){if(f===setTimeout)return setTimeout(M,0);if((f===g||!f)&&setTimeout)return f=setTimeout,setTimeout(M,0);try{return f(M,0)}catch{try{return f.call(null,M,0)}catch{return f.call(this,M,0)}}}function a(M){if(h===clearTimeout)return clearTimeout(M);if((h===u||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(M);try{return h(M)}catch{try{return h.call(null,M)}catch{return h.call(this,M)}}}var b=[],v=!1,w,S=-1;function E(){!v||!w||(v=!1,w.length?b=w.concat(b):S=-1,b.length&&m())}function m(){if(!v){var M=d(E);v=!0;for(var P=b.length;P;){for(w=b,b=[];++S<P;)w&&w[S].run();S=-1,P=b.length}w=null,v=!1,a(M)}}s.nextTick=function(M){var P=new Array(arguments.length-1);if(arguments.length>1)for(var B=1;B<arguments.length;B++)P[B-1]=arguments[B];b.push(new _(M,P)),b.length===1&&!v&&d(m)};function _(M,P){this.fun=M,this.array=P}_.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={};function T(){}s.on=T,s.addListener=T,s.once=T,s.off=T,s.removeListener=T,s.removeAllListeners=T,s.emit=T,s.prependListener=T,s.prependOnceListener=T,s.listeners=function(M){return[]},s.binding=function(M){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(M){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},9509:(r,s,f)=>{var h=f(8764),g=h.Buffer;function u(a,b){for(var v in a)b[v]=a[v]}g.from&&g.alloc&&g.allocUnsafe&&g.allocUnsafeSlow?r.exports=h:(u(h,s),s.Buffer=d);function d(a,b,v){return g(a,b,v)}u(g,d),d.from=function(a,b,v){if(typeof a=="number")throw new TypeError("Argument must not be a number");return g(a,b,v)},d.alloc=function(a,b,v){if(typeof a!="number")throw new TypeError("Argument must be a number");var w=g(a);return b!==void 0?typeof v=="string"?w.fill(b,v):w.fill(b):w.fill(0),w},d.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return g(a)},d.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return h.SlowBuffer(a)}},4777:(r,s,f)=>{var h=f(8764).Buffer,g=f(5190),u=f(4005),d=f(5269),a=1,b=6,v=16,w=17,S=19,E=29,m={timeout:200,stabDelay:100,cmdexeDelay:25,synchLoops:32,byteDelay:0,pollValue:83,pollIndex:3};function _(T){if(!(this instanceof _))return new _(T);var M=this;M.parser=u(T),M.constants=M.parser.constants,M.serialPort=T}_.prototype.sync=function(T,M){var P=this,B=1,D=h.from([a]);L();function L(){B=B+1,P.parser.send(D,function(X,ie){var ue;if(!X){var fe=ie.message;if(fe[0]!==d.CMD_SIGN_ON)X=new Error("command response was not CMD_SIGN_ON. "+fe[0]),X.code="E_CMD_ERROR";else if(fe[1]!==d.STATUS_CMD_OK)X=new Error("command status was not ok. "+fe[1]),X.code="E_CMD_STATUS";else{var q=fe[2];ue=fe.slice(3)+"",ue.length!=q}}if(X&&B<=T)return L();M(X,ue)})}},_.prototype.reset=function(T,M,P){var B=this;g.series([function(D){B.serialPort.set({rts:!0,dtr:!0},function(L){L?D(L):D()})},function(D){setTimeout(D,T)},function(D){B.serialPort.set({rts:!1,dtr:!1},function(L){L?D(L):D()})},function(D){setTimeout(D,M)}],function(D){P(D)})},_.prototype.verifySignature=function(T,M){this.getSignature(function(P,B){T.equals(B)?M():M(new Error("signature doesnt match. Found: "+B.toString("hex"),P))})},_.prototype.getSignature=function(T){var M=this,P=h.alloc(3);g.series([function(B){var D=4,L=4,X=0,ie=h.from([E,D,L,X,48,0,0,0]);M.parser.send(ie,function(ue,fe){if(fe&&fe.message&&fe.message.length>=6){var q=fe.message[5];P.writeUInt8(q,0)}B(ue)})},function(B){var D=4,L=4,X=0,ie=h.from([E,D,L,X,48,0,1,0]);M.parser.send(ie,function(ue,fe){if(fe&&fe.message&&fe.message.length>=6){var q=fe.message[5];P.writeUInt8(q,1)}B(ue)})},function(B){var D=4,L=4,X=0,ie=h.from([E,D,L,X,48,0,2,0]);M.parser.send(ie,function(ue,fe){if(fe&&fe.message&&fe.message.length>=6){var q=fe.message[5];P.writeUInt8(q,2)}B(ue)})}],function(B){T(B,P)})},_.prototype.enterProgrammingMode=function(T,M){var P=this,B=Array.prototype.slice.call(arguments);M=B.pop(),typeof M!="function"&&(M=null),T=typeof T!="function"&&T||{},T.timeout=T.timeout||m.timeout,T.stabDelay=T.stabDelay||m.stabDelay,T.cmdexeDelay=T.cmdexeDelay||m.cmdexeDelay,T.synchLoops=T.synchLoops||m.synchLoops,T.byteDelay=T.byteDelay||m.byteDelay,T.pollValue=T.pollValue||m.pollValue,T.pollIndex=T.pollIndex||m.pollIndex;var D=172,L=83,X=0,ie=0,ue=h.from([v,T.timeout,T.stabDelay,T.cmdexeDelay,T.synchLoops,T.byteDelay,T.pollValue,T.pollIndex,D,L,X,ie]);P.parser.send(ue,function(fe,q){M(fe)})},_.prototype.loadAddress=function(T,M){var P=this;msb=T>>24&255|128,xsb=T>>16&255,ysb=T>>8&255,lsb=T&255;var B=h.from([b,msb,xsb,ysb,lsb]);P.parser.send(B,function(D,L){M(D)})},_.prototype.loadPage=function(T,M){var P=this,B=T.length>>8,D=T.length&255,L=193,X=10,ie=64,ue=76,fe=32,q=0,G=0,Y=h.from([S,B,D,L,X,ie,ue,fe,q,G]);Y=h.concat([Y,T]),P.parser.send(Y,function(J,A){M(J)})},_.prototype.upload=function(T,M,P){var B=0,D,L,X=this;g.whilst(function(){return B<T.length},function(ie){g.series([function(ue){L=B>>1,ue()},function(ue){X.loadAddress(L,ue)},function(ue){D=T.slice(B,T.length>M?B+M:T.length-1),ue()},function(ue){X.loadPage(D,ue)},function(ue){B=B+D.length,setTimeout(ue,4)}],function(ue){ie(ue)})},function(ie){P(ie)})},_.prototype.exitProgrammingMode=function(T){var M=this,P=1,B=1,D=h.from([w,P,B]);M.parser.send(D,function(L,X){T(L)})},_.prototype.verify=function(T,M){M()},_.prototype.bootload=function(T,M,P){P()},r.exports=_},5269:r=>{r.exports.MESSAGE_START=27,r.exports.TOKEN=14,r.exports.CMD_SIGN_ON=1,r.exports.CMD_SET_PARAMETER=2,r.exports.CMD_GET_PARAMETER=3,r.exports.CMD_SET_DEVICE_PARAMETERS=4,r.exports.CMD_OSCCAL=5,r.exports.CMD_LOAD_ADDRESS=6,r.exports.CMD_FIRMWARE_UPGRADE=7,r.exports.CMD_ENTER_PROGMODE_ISP=16,r.exports.CMD_LEAVE_PROGMODE_ISP=17,r.exports.CMD_CHIP_ERASE_ISP=18,r.exports.CMD_PROGRAM_FLASH_ISP=19,r.exports.CMD_READ_FLASH_ISP=20,r.exports.CMD_PROGRAM_EEPROM_ISP=21,r.exports.CMD_READ_EEPROM_ISP=22,r.exports.CMD_PROGRAM_FUSE_ISP=23,r.exports.CMD_READ_FUSE_ISP=24,r.exports.CMD_PROGRAM_LOCK_ISP=25,r.exports.CMD_READ_LOCK_ISP=26,r.exports.CMD_READ_SIGNATURE_ISP=27,r.exports.CMD_READ_OSCCAL_ISP=28,r.exports.CMD_SPI_MULTI=29,r.exports.CMD_ENTER_PROGMODE_PP=32,r.exports.CMD_LEAVE_PROGMODE_PP=33,r.exports.CMD_CHIP_ERASE_PP=34,r.exports.CMD_PROGRAM_FLASH_PP=35,r.exports.CMD_READ_FLASH_PP=36,r.exports.CMD_PROGRAM_EEPROM_PP=37,r.exports.CMD_READ_EEPROM_PP=38,r.exports.CMD_PROGRAM_FUSE_PP=39,r.exports.CMD_READ_FUSE_PP=40,r.exports.CMD_PROGRAM_LOCK_PP=41,r.exports.CMD_READ_LOCK_PP=42,r.exports.CMD_READ_SIGNATURE_PP=43,r.exports.CMD_READ_OSCCAL_PP=44,r.exports.CMD_SET_CONTROL_STACK=45,r.exports.CMD_ENTER_PROGMODE_HVSP=48,r.exports.CMD_LEAVE_PROGMODE_HVSP=49,r.exports.CMD_CHIP_ERASE_HVSP=50,r.exports.CMD_PROGRAM_FLASH_HVSP=51,r.exports.CMD_READ_FLASH_HVSP=52,r.exports.CMD_PROGRAM_EEPROM_HVSP=53,r.exports.CMD_READ_EEPROM_HVSP=54,r.exports.CMD_PROGRAM_FUSE_HVSP=55,r.exports.CMD_READ_FUSE_HVSP=56,r.exports.CMD_PROGRAM_LOCK_HVSP=57,r.exports.CMD_READ_LOCK_HVSP=58,r.exports.CMD_READ_SIGNATURE_HVSP=59,r.exports.CMD_READ_OSCCAL_HVSP=60,r.exports.STATUS_CMD_OK=0,r.exports.STATUS_CMD_TOUT=128,r.exports.STATUS_RDY_BSY_TOUT=129,r.exports.STATUS_SET_PARAM_MISSING=130,r.exports.STATUS_CMD_FAILED=192,r.exports.STATUS_CKSUM_ERROR=193,r.exports.STATUS_CMD_UNKNOWN=201,r.exports.STATUS_BUILD_NUMBER_LOW=128,r.exports.STATUS_BUILD_NUMBER_HIGH=129,r.exports.STATUS_HW_VER=144,r.exports.STATUS_SW_MAJOR=145,r.exports.STATUS_SW_MINOR=146,r.exports.STATUS_VTARGET=148,r.exports.STATUS_VADJUST=149,r.exports.STATUS_OSC_PSCALE=150,r.exports.STATUS_OSC_CMATCH=151,r.exports.STATUS_SCK_DURATION=152,r.exports.STATUS_TOPCARD_DETECT=154,r.exports.STATUS_STATUS=156,r.exports.STATUS_DATA=157,r.exports.STATUS_RESET_POLARITY=158,r.exports.STATUS_CONTROLLER_INIT=159,r.exports.ANSWER_CKSUM_ERROR=176},4005:(r,s,f)=>{var h=f(8764).Buffer,g=f(5269),u=f(7187).EventEmitter;r.exports=function(a){var b=d(new u,{constants:g,port:a,boundOpen:!1,closed:!1,_inc:-1,_queue:[],_current:!1,states:["Start","GetSequenceNumber","GetMessageSize1","GetMessageSize2","GetToken","GetData","GetChecksum","Done"],state:0,pkt:!1,send:function(S,E){if(this.closed)return setImmediate(function(){var P=new Error("this parser is closed.");P.code="E_CLOSED",E(P)});h.isBuffer(S)||(S=h.from(S));var m=this._commandTimeout(S[0]),_=h.from([0,0]);_.writeUInt16BE(S.length,0);var T=h.concat([h.from([g.MESSAGE_START,this._seq(),_[0],_[1],g.TOKEN]),S]),M=this.checksum(T);this._queue.push({buf:h.concat([T,h.from([M])]),seq:this._inc,cb:E,timeout:m}),this._send()},checksum:function(S){for(var E=0,m=0;m<S.length;++m)E^=S[m];return E},_seq:function(){return this._inc++,this._inc>255&&(this._inc=0),this._inc},_commandTimeout:function(S){if(timeout=1e3,S===g.CMD_SIGN_ON)timeout=200;else for(var E=Object.keys(g),m=0;m<E.length;++m)if(g[E[m]]===S){(E[m].indexOf("CMD_READ")>-1||E[m].indexOf("PROGRAM_FLASH")>-1||E[m].indexOf("EEPROM")>-1)&&(timeout=5e3);break}return timeout},_send:function(){if(this.closed)return!1;if(!this._current&&!!this._queue.length){var S=typeof a.isOpen=="function"?a.isOpen():a.isOpen;if(!S){var _=this;this.boundOpen||a.once("open",function(){_._send()});return}var E=this._queue.shift(),m=this._current={timeout:!1,seq:E.seq,cb:E.cb};this._current,this.state=0;var _=this;this.port.write(E.buf),this.port.drain(function(){if(m!==_._current)return _.emit("log","current was no longer the current message after drain callback");m.timeout=setTimeout(function(){var T=new Error("stk500 timeout. "+E.timeout+"ms");T.code="E_TIMEOUT",_._resolveCurrent(T)},E.timeout)}),this.emit("rawinput",E.buf)}},_handle:function(S){var E=this._current;if(this.emit("raw",S),!E)return this.emit("log","notice","dropping data","data");for(var m=0;m<S.length;++m)this._stateMachine(S.readUInt8(m))},_pkt:function(){return{seq:-1,len:[],raw:[],message:[],checksum:0}},_stateMachine:function(S){var E=this.pkt;switch(this.state){case 0:if(E=this.pkt=this._pkt(),S!==27)return this.emit("log","parser","Invalid header byte expected 27 got: "+S);++this.state;break;case 1:if(S!==this._current.seq)return this.state=0,this.emit("log","parser","Invalid sequence number. back to start. got: "+S);E.seq=S,++this.state;break;case 2:E.len.push(S),++this.state;break;case 3:E.len.push(S),E.len=E.len[0]<<8|E.len[1],++this.state;break;case 4:if(S!==14)return this.state=0,E.error=new Error("Invalid message token byte. got: "+S),E.error.code="E_PARSE",this.emit("log","parser",this.pkt.error);++this.state,E.len||++this.state;break;case 5:E.len===0&&S===g.STATUS_CKSUM_ERROR&&(E.error=new Error("send checksum error"),E.error.code="E_STATUS_CKSUM"),E.message.push(S),--E.len==0&&++this.state;break;case 6:E.checksum=this.checksum(E.raw),E.checksum=E.checksum===S,E.checksum||(E.error=new Error("recv cecksum didn't match"),E.error.code="E_RECV_CKSUM"),E.message=h.from(E.message),this.emit("data",E),this.state++,E.len=E.message.length,delete E.raw,this._resolveCurrent(E.error?E.error:!1,E);break}E.raw&&E.raw.push(S)},_resolveCurrent:function(S,E){var m=this._current;this._current=!1;var _=!1;if((S.code=="E_PARSE"||S.code=="E_TIMEOUT"||this.closed)&&(_=this.queue,this.queue=[]),clearTimeout(m.timeout),m.cb(S,E),_){var T=S;for(this.closed||(T=new Error("a call queued before this call errored leaving the protocol in an upredictable state. timidly refusing to run queued commands."),T.code="E_DEPENDENT",T.prev_code=S.code);_.lenth;)_.shift()(S)}this._send()}});return a.on("data",v).once("error",w).once("close",w),b;function v(S){b._handle(S)}function w(S){b.closed=!0,a.removeListener("data",v),S||(S=new Error("serial closed."),S.code="E_CLOSED"),b._current&&b._resolveCurrent(S),this.emit("closed")}};function d(a,b){return Object.keys(b).forEach(function(v){a[v]=b[v]}),a}},5190:(r,s,f)=>{var h=f(4155),g,u;/*!
* async
* https://github.com/caolan/async
*
* Copyright 2010-2014 Caolan McMahon
* Released under the MIT license
*/(function(){var d={},a,b;a=this,a!=null&&(b=a.async),d.noConflict=function(){return a.async=b,d};function v(A){var C=!1;return function(){if(C)throw new Error("Callback was already called.");C=!0,A.apply(a,arguments)}}var w=Object.prototype.toString,S=Array.isArray||function(A){return w.call(A)==="[object Array]"},E=function(A,C){for(var N=0;N<A.length;N+=1)C(A[N],N,A)},m=function(A,C){if(A.map)return A.map(C);var N=[];return E(A,function(U,R,H){N.push(C(U,R,H))}),N},_=function(A,C,N){return A.reduce?A.reduce(C,N):(E(A,function(U,R,H){N=C(N,U,R,H)}),N)},T=function(A){if(Object.keys)return Object.keys(A);var C=[];for(var N in A)A.hasOwnProperty(N)&&C.push(N);return C};typeof h=="undefined"||!h.nextTick?typeof setImmediate=="function"?(d.nextTick=function(A){setImmediate(A)},d.setImmediate=d.nextTick):(d.nextTick=function(A){setTimeout(A,0)},d.setImmediate=d.nextTick):(d.nextTick=h.nextTick,typeof setImmediate!="undefined"?d.setImmediate=function(A){setImmediate(A)}:d.setImmediate=d.nextTick),d.each=function(A,C,N){if(N=N||function(){},!A.length)return N();var U=0;E(A,function(H){C(H,v(R))});function R(H){H?(N(H),N=function(){}):(U+=1,U>=A.length&&N())}},d.forEach=d.each,d.eachSeries=function(A,C,N){if(N=N||function(){},!A.length)return N();var U=0,R=function(){C(A[U],function(H){H?(N(H),N=function(){}):(U+=1,U>=A.length?N():R())})};R()},d.forEachSeries=d.eachSeries,d.eachLimit=function(A,C,N,U){var R=M(C);R.apply(null,[A,N,U])},d.forEachLimit=d.eachLimit;var M=function(A){return function(C,N,U){if(U=U||function(){},!C.length||A<=0)return U();var R=0,H=0,W=0;(function ae(){if(R>=C.length)return U();for(;W<A&&H<C.length;)H+=1,W+=1,N(C[H-1],function(ge){ge?(U(ge),U=function(){}):(R+=1,W-=1,R>=C.length?U():ae())})})()}},P=function(A){return function(){var C=Array.prototype.slice.call(arguments);return A.apply(null,[d.each].concat(C))}},B=function(A,C){return function(){var N=Array.prototype.slice.call(arguments);return C.apply(null,[M(A)].concat(N))}},D=function(A){return function(){var C=Array.prototype.slice.call(arguments);return A.apply(null,[d.eachSeries].concat(C))}},L=function(A,C,N,U){if(C=m(C,function(H,W){return{index:W,value:H}}),!U)A(C,function(H,W){N(H.value,function(ae){W(ae)})});else{var R=[];A(C,function(H,W){N(H.value,function(ae,ge){R[H.index]=ge,W(ae)})},function(H){U(H,R)})}};d.map=P(L),d.mapSeries=D(L),d.mapLimit=function(A,C,N,U){return X(C)(A,N,U)};var X=function(A){return B(A,L)};d.reduce=function(A,C,N,U){d.eachSeries(A,function(R,H){N(C,R,function(W,ae){C=ae,H(W)})},function(R){U(R,C)})},d.inject=d.reduce,d.foldl=d.reduce,d.reduceRight=function(A,C,N,U){var R=m(A,function(H){return H}).reverse();d.reduce(R,C,N,U)},d.foldr=d.reduceRight;var ie=function(A,C,N,U){var R=[];C=m(C,function(H,W){return{index:W,value:H}}),A(C,function(H,W){N(H.value,function(ae){ae&&R.push(H),W()})},function(H){U(m(R.sort(function(W,ae){return W.index-ae.index}),function(W){return W.value}))})};d.filter=P(ie),d.filterSeries=D(ie),d.select=d.filter,d.selectSeries=d.filterSeries;var ue=function(A,C,N,U){var R=[];C=m(C,function(H,W){return{index:W,value:H}}),A(C,function(H,W){N(H.value,function(ae){ae||R.push(H),W()})},function(H){U(m(R.sort(function(W,ae){return W.index-ae.index}),function(W){return W.value}))})};d.reject=P(ue),d.rejectSeries=D(ue);var fe=function(A,C,N,U){A(C,function(R,H){N(R,function(W){W?(U(R),U=function(){}):H()})},function(R){U()})};d.detect=P(fe),d.detectSeries=D(fe),d.some=function(A,C,N){d.each(A,function(U,R){C(U,function(H){H&&(N(!0),N=function(){}),R()})},function(U){N(!1)})},d.any=d.some,d.every=function(A,C,N){d.each(A,function(U,R){C(U,function(H){H||(N(!1),N=function(){}),R()})},function(U){N(!0)})},d.all=d.every,d.sortBy=function(A,C,N){d.map(A,function(U,R){C(U,function(H,W){H?R(H):R(null,{value:U,criteria:W})})},function(U,R){if(U)return N(U);var H=function(W,ae){var ge=W.criteria,xe=ae.criteria;return ge<xe?-1:ge>xe?1:0};N(null,m(R.sort(H),function(W){return W.value}))})},d.auto=function(A,C){C=C||function(){};var N=T(A),U=N.length;if(!U)return C();var R={},H=[],W=function(xe){H.unshift(xe)},ae=function(xe){for(var we=0;we<H.length;we+=1)if(H[we]===xe){H.splice(we,1);return}},ge=function(){U--,E(H.slice(0),function(xe){xe()})};W(function(){if(!U){var xe=C;C=function(){},xe(null,R)}}),E(N,function(xe){var we=S(A[xe])?A[xe]:[A[xe]],be=function(te){var de=Array.prototype.slice.call(arguments,1);if(de.length<=1&&(de=de[0]),te){var Z={};E(T(R),function(Q){Z[Q]=R[Q]}),Z[xe]=de,C(te,Z),C=function(){}}else R[xe]=de,d.setImmediate(ge)},le=we.slice(0,Math.abs(we.length-1))||[],pe=function(){return _(le,function(te,de){return te&&R.hasOwnProperty(de)},!0)&&!R.hasOwnProperty(xe)};if(pe())we[we.length-1](be,R);else{var me=function(){pe()&&(ae(me),we[we.length-1](be,R))};W(me)}})},d.retry=function(A,C,N){var U=5,R=[];typeof A=="function"&&(N=C,C=A,A=U),A=parseInt(A,10)||U;var H=function(W,ae){for(var ge=function(xe,we){return function(be){xe(function(le,pe){be(!le||we,{err:le,result:pe})},ae)}};A;)R.push(ge(C,!(A-=1)));d.series(R,function(xe,we){we=we[we.length-1],(W||N)(we.err,we.result)})};return N?H():H},d.waterfall=function(A,C){if(C=C||function(){},!S(A)){var N=new Error("First argument to waterfall must be an array of functions");return C(N)}if(!A.length)return C();var U=function(R){return function(H){if(H)C.apply(null,arguments),C=function(){};else{var W=Array.prototype.slice.call(arguments,1),ae=R.next();ae?W.push(U(ae)):W.push(C),d.setImmediate(function(){R.apply(null,W)})}}};U(d.iterator(A))()};var q=function(A,C,N){if(N=N||function(){},S(C))A.map(C,function(R,H){R&&R(function(W){var ae=Array.prototype.slice.call(arguments,1);ae.length<=1&&(ae=ae[0]),H.call(null,W,ae)})},N);else{var U={};A.each(T(C),function(R,H){C[R](function(W){var ae=Array.prototype.slice.call(arguments,1);ae.length<=1&&(ae=ae[0]),U[R]=ae,H(W)})},function(R){N(R,U)})}};d.parallel=function(A,C){q({map:d.map,each:d.each},A,C)},d.parallelLimit=function(A,C,N){q({map:X(C),each:M(C)},A,N)},d.series=function(A,C){if(C=C||function(){},S(A))d.mapSeries(A,function(U,R){U&&U(function(H){var W=Array.prototype.slice.call(arguments,1);W.length<=1&&(W=W[0]),R.call(null,H,W)})},C);else{var N={};d.eachSeries(T(A),function(U,R){A[U](function(H){var W=Array.prototype.slice.call(arguments,1);W.length<=1&&(W=W[0]),N[U]=W,R(H)})},function(U){C(U,N)})}},d.iterator=function(A){var C=function(N){var U=function(){return A.length&&A[N].apply(null,arguments),U.next()};return U.next=function(){return N<A.length-1?C(N+1):null},U};return C(0)},d.apply=function(A){var C=Array.prototype.slice.call(arguments,1);return function(){return A.apply(null,C.concat(Array.prototype.slice.call(arguments)))}};var G=function(A,C,N,U){var R=[];A(C,function(H,W){N(H,function(ae,ge){R=R.concat(ge||[]),W(ae)})},function(H){U(H,R)})};d.concat=P(G),d.concatSeries=D(G),d.whilst=function(A,C,N){A()?C(function(U){if(U)return N(U);d.whilst(A,C,N)}):N()},d.doWhilst=function(A,C,N){A(function(U){if(U)return N(U);var R=Array.prototype.slice.call(arguments,1);C.apply(null,R)?d.doWhilst(A,C,N):N()})},d.until=function(A,C,N){A()?N():C(function(U){if(U)return N(U);d.until(A,C,N)})},d.doUntil=function(A,C,N){A(function(U){if(U)return N(U);var R=Array.prototype.slice.call(arguments,1);C.apply(null,R)?N():d.doUntil(A,C,N)})},d.queue=function(A,C){C===void 0&&(C=1);function N(H,W,ae,ge){if(H.started||(H.started=!0),S(W)||(W=[W]),W.length==0)return d.setImmediate(function(){H.drain&&H.drain()});E(W,function(xe){var we={data:xe,callback:typeof ge=="function"?ge:null};ae?H.tasks.unshift(we):H.tasks.push(we),H.saturated&&H.tasks.length===H.concurrency&&H.saturated(),d.setImmediate(H.process)})}var U=0,R={tasks:[],concurrency:C,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(H,W){N(R,H,!1,W)},kill:function(){R.drain=null,R.tasks=[]},unshift:function(H,W){N(R,H,!0,W)},process:function(){if(!R.paused&&U<R.concurrency&&R.tasks.length){var H=R.tasks.shift();R.empty&&R.tasks.length===0&&R.empty(),U+=1;var W=function(){U-=1,H.callback&&H.callback.apply(H,arguments),R.drain&&R.tasks.length+U===0&&R.drain(),R.process()},ae=v(W);A(H.data,ae)}},length:function(){return R.tasks.length},running:function(){return U},idle:function(){return R.tasks.length+U===0},pause:function(){R.paused!==!0&&(R.paused=!0)},resume:function(){if(R.paused!==!1){R.paused=!1;for(var H=1;H<=R.concurrency;H++)d.setImmediate(R.process)}}};return R},d.priorityQueue=function(A,C){function N(W,ae){return W.priority-ae.priority}function U(W,ae,ge){for(var xe=-1,we=W.length-1;xe<we;){var be=xe+(we-xe+1>>>1);ge(ae,W[be])>=0?xe=be:we=be-1}return xe}function R(W,ae,ge,xe){if(W.started||(W.started=!0),S(ae)||(ae=[ae]),ae.length==0)return d.setImmediate(function(){W.drain&&W.drain()});E(ae,function(we){var be={data:we,priority:ge,callback:typeof xe=="function"?xe:null};W.tasks.splice(U(W.tasks,be,N)+1,0,be),W.saturated&&W.tasks.length===W.concurrency&&W.saturated(),d.setImmediate(W.process)})}var H=d.queue(A,C);return H.push=function(W,ae,ge){R(H,W,ae,ge)},delete H.unshift,H},d.cargo=function(A,C){var N=!1,U=[],R={tasks:U,payload:C,saturated:null,empty:null,drain:null,drained:!0,push:function(H,W){S(H)||(H=[H]),E(H,function(ae){U.push({data:ae,callback:typeof W=="function"?W:null}),R.drained=!1,R.saturated&&U.length===C&&R.saturated()}),d.setImmediate(R.process)},process:function H(){if(!N){if(U.length===0){R.drain&&!R.drained&&R.drain(),R.drained=!0;return}var W=typeof C=="number"?U.splice(0,C):U.splice(0,U.length),ae=m(W,function(ge){return ge.data});R.empty&&R.empty(),N=!0,A(ae,function(){N=!1;var ge=arguments;E(W,function(xe){xe.callback&&xe.callback.apply(null,ge)}),H()})}},length:function(){return U.length},running:function(){return N}};return R};var Y=function(A){return function(C){var N=Array.prototype.slice.call(arguments,1);C.apply(null,N.concat([function(U){var R=Array.prototype.slice.call(arguments,1);typeof console!="undefined"&&(U?console.error&&console.error(U):console[A]&&E(R,function(H){console[A](H)}))}]))}};d.log=Y("log"),d.dir=Y("dir"),d.memoize=function(A,C){var N={},U={};C=C||function(H){return H};var R=function(){var H=Array.prototype.slice.call(arguments),W=H.pop(),ae=C.apply(null,H);ae in N?d.nextTick(function(){W.apply(null,N[ae])}):ae in U?U[ae].push(W):(U[ae]=[W],A.apply(null,H.concat([function(){N[ae]=arguments;var ge=U[ae];delete U[ae];for(var xe=0,we=ge.length;xe<we;xe++)ge[xe].apply(null,arguments)}])))};return R.memo=N,R.unmemoized=A,R},d.unmemoize=function(A){return function(){return(A.unmemoized||A).apply(null,arguments)}},d.times=function(A,C,N){for(var U=[],R=0;R<A;R++)U.push(R);return d.map(U,C,N)},d.timesSeries=function(A,C,N){for(var U=[],R=0;R<A;R++)U.push(R);return d.mapSeries(U,C,N)},d.seq=function(){var A=arguments;return function(){var C=this,N=Array.prototype.slice.call(arguments),U=N.pop();d.reduce(A,N,function(R,H,W){H.apply(C,R.concat([function(){var ae=arguments[0],ge=Array.prototype.slice.call(arguments,1);W(ae,ge)}]))},function(R,H){U.apply(C,[R].concat(H))})}},d.compose=function(){return d.seq.apply(null,Array.prototype.reverse.call(arguments))};var J=function(A,C){var N=function(){var R=this,H=Array.prototype.slice.call(arguments),W=H.pop();return A(C,function(ae,ge){ae.apply(R,H.concat([ge]))},W)};if(arguments.length>2){var U=Array.prototype.slice.call(arguments,2);return N.apply(this,U)}else return N};d.applyEach=P(J),d.applyEachSeries=D(J),d.forever=function(A,C){function N(U){if(U){if(C)return C(U);throw U}A(N)}N()},r.exports?r.exports=d:(g=[],u=function(){return d}.apply(s,g),u!==void 0&&(r.exports=u))})()},4107:(r,s,f)=>{var h=f(8764).Buffer,g=f(4668),u=f(375),d=f(5270),a=function(b){this.opts=b||{},this.quiet=this.opts.quiet||!1,this.quiet?this.log=function(){}:typeof window=="object"?this.log=console.log.bind(window):this.log=console.log};a.prototype.sync=function(b,v,w,S){this.log("sync");var E=this,m=1,_={cmd:[u.Cmnd_STK_GET_SYNC],responseData:u.OK_RESPONSE,timeout:w};function T(){m=m+1,d(b,_,function(M,P){if(M&&m<=v)return M&&E.log(M),E.log("failed attempt again",m),T();E.log("sync complete",M,P,m),S(M,P)})}T()},a.prototype.verifySignature=function(b,v,w,S){this.log("verify signature");var E=this;let m=h.concat([h.from([u.Resp_STK_INSYNC]),v,h.from([u.Resp_STK_OK])]);var _={cmd:[u.Cmnd_STK_READ_SIGN],responseLength:m.length,timeout:w};d(b,_,function(T,M){M?E.log("confirm signature",T,M,M.toString("hex")):E.log("confirm signature",T,"no data"),S(T,M)})},a.prototype.getSignature=function(b,v,w){this.log("get signature");var S={cmd:[u.Cmnd_STK_READ_SIGN],responseLength:5,timeout:v};d(b,S,function(E,m){this.log("getSignature",E,m),w(E,m)})},a.prototype.setOptions=function(b,v,w,S){this.log("set device");var E=this,m={cmd:[u.Cmnd_STK_SET_DEVICE,v.devicecode||0,v.revision||0,v.progtype||0,v.parmode||0,v.polling||0,v.selftimed||0,v.lockbytes||0,v.fusebytes||0,v.flashpollval1||0,v.flashpollval2||0,v.eeprompollval1||0,v.eeprompollval2||0,v.pagesizehigh||0,v.pagesizelow||0,v.eepromsizehigh||0,v.eepromsizelow||0,v.flashsize4||0,v.flashsize3||0,v.flashsize2||0,v.flashsize1||0],responseData:u.OK_RESPONSE,timeout:w};d(b,m,function(_,T){if(E.log("setOptions",_,T),_)return S(_);S()})},a.prototype.enterProgrammingMode=function(b,v,w){this.log("send enter programming mode");var S=this,E={cmd:[u.Cmnd_STK_ENTER_PROGMODE],responseData:u.OK_RESPONSE,timeout:v};d(b,E,function(m,_){S.log("sent enter programming mode",m,_),w(m,_)})},a.prototype.loadAddress=function(b,v,w,S){this.log("load address");var E=this,m=v&255,_=v>>8&255,T={cmd:[u.Cmnd_STK_LOAD_ADDRESS,m,_],responseData:u.OK_RESPONSE,timeout:w};d(b,T,function(M,P){E.log("loaded address",M,P),S(M,P)})},a.prototype.loadPage=function(b,v,w,S){this.log("load page");var E=this,m=v.length&255,_=v.length>>8,T=h.concat([h.from([u.Cmnd_STK_PROG_PAGE,_,m,70]),v,h.from([u.Sync_CRC_EOP])]),M={cmd:T,responseData:u.OK_RESPONSE,timeout:w};d(b,M,function(P,B){E.log("loaded page",P,B),S(P,B)})},a.prototype.upload=function(b,v,w,S,E){this.log("program");var m=0,_,T,M=this;g.whilst(function(){return m<v.length},function(P){M.log("program page"),g.series([function(B){T=m>>1,B()},function(B){M.loadAddress(b,T,S,B)},function(B){_=v.slice(m,v.length>w?m+w:v.length-1),B()},function(B){M.loadPage(b,_,S,B)},function(B){M.log("programmed page"),m=m+_.length,setTimeout(B,4)}],function(B){M.log("page done"),P(B)})},function(P){M.log("upload done"),E(P)})},a.prototype.exitProgrammingMode=function(b,v,w){this.log("send leave programming mode");var S=this,E={cmd:[u.Cmnd_STK_LEAVE_PROGMODE],responseData:u.OK_RESPONSE,timeout:v};d(b,E,function(m,_){S.log("sent leave programming mode",m,_),w(m,_)})},a.prototype.verify=function(b,v,w,S,E){this.log("verify");var m=0,_,T,M=this;g.whilst(function(){return m<v.length},function(P){M.log("verify page"),g.series([function(B){T=m>>1,B()},function(B){M.loadAddress(b,T,S,B)},function(B){_=v.slice(m,v.length>w?m+w:v.length-1),B()},function(B){M.verifyPage(b,_,w,S,B)},function(B){M.log("verified page"),m=m+_.length,setTimeout(B,4)}],function(B){M.log("verify done"),P(B)})},function(P){M.log("verify done"),E(P)})},a.prototype.verifyPage=function(b,v,w,S,E){this.log("verify page");var m=this;let _=h.concat([h.from([u.Resp_STK_INSYNC]),v,h.from([u.Resp_STK_OK])]);var T=v.length>=w?w:v.length,M={cmd:[u.Cmnd_STK_READ_PAGE,T>>8&255,T&255,70],responseLength:_.length,timeout:S};d(b,M,function(P,B){m.log("confirm page",P,B,B.toString("hex")),E(P,B)})},a.prototype.bootload=function(b,v,w,S){var E={pagesizehigh:w.pagesizehigh<<8&255,pagesizelow:w.pagesizelow&255};g.series([this.sync.bind(this,b,3,w.timeout),this.sync.bind(this,b,3,w.timeout),this.sync.bind(this,b,3,w.timeout),this.verifySignature.bind(this,b,w.signature,w.timeout),this.setOptions.bind(this,b,E,w.timeout),this.enterProgrammingMode.bind(this,b,w.timeout),this.upload.bind(this,b,v,w.pageSize,w.timeout),this.verify.bind(this,b,v,w.pageSize,w.timeout),this.exitProgrammingMode.bind(this,b,w.timeout)],function(m){return S(m)})},r.exports=a},2310:(r,s,f)=>{var h=f(8764).Buffer,g=f(375),u=[g.Resp_STK_INSYNC];r.exports=function(d,a,b,v){var w=h.alloc(0),S=!1,E=null,m=function(T){for(var M=0;!S&&M<T.length;){var P=T[M];u.indexOf(P)!==-1&&(T=T.slice(M,T.length-M),S=!0),M++}if(S&&(w=h.concat([w,T])),w.length>b)return _(new Error("buffer overflow "+w.length+" > "+b));w.length==b&&_()},_=function(T){E&&clearTimeout(E),d.removeListener("data",m),v(T,w)};a&&a>0&&(E=setTimeout(function(){E=null,_(new Error("receiveData timeout after "+a+"ms"))},a)),d.on("data",m)}},5270:(r,s,f)=>{var h=f(8764).Buffer,g=f(2310),u=f(375);r.exports=function(d,a,b){var v=a.timeout||0;u.Resp_STK_INSYNC,u.Resp_STK_NOSYNC;var w=null,S=0,E;a.responseData&&a.responseData.length>0&&(w=a.responseData),w&&(S=w.length),a.responseLength&&(S=a.responseLength);var m=a.cmd;m instanceof Array&&(m=h.from(m.concat(u.Sync_CRC_EOP))),d.write(m,function(_){if(_)return E=new Error("Sending "+m.toString("hex")+": "+_.message),b(E);g(d,v,S,function(T,M){if(T)return E=new Error("Sending "+m.toString("hex")+": "+T.message),b(E);if(w&&!M.equals(w))return E=new Error(m+" response mismatch: "+M.toString("hex")+", "+w.toString("hex")),b(E);b(null,M)})})}},375:(r,s,f)=>{var h=f(8764).Buffer,g=20,u=16;r.exports={Cmnd_STK_GET_SYNC:48,Cmnd_STK_SET_DEVICE:66,Cmnd_STK_ENTER_PROGMODE:80,Cmnd_STK_LOAD_ADDRESS:85,Cmnd_STK_PROG_PAGE:100,Cmnd_STK_LEAVE_PROGMODE:81,Cmnd_STK_READ_SIGN:117,Sync_CRC_EOP:32,Resp_STK_OK:16,Resp_STK_INSYNC:20,Resp_STK_NOSYNC:21,Cmnd_STK_READ_PAGE:116,OK_RESPONSE:h.from([g,u])}},4668:(r,s,f)=>{var h=f(4155),g,u;/*!
* async
* https://github.com/caolan/async
*
* Copyright 2010-2014 Caolan McMahon
* Released under the MIT license
*/(function(){var d={},a,b;a=this,a!=null&&(b=a.async),d.noConflict=function(){return a.async=b,d};function v(A){var C=!1;return function(){if(C)throw new Error("Callback was already called.");C=!0,A.apply(a,arguments)}}var w=Object.prototype.toString,S=Array.isArray||function(A){return w.call(A)==="[object Array]"},E=function(A,C){for(var N=0;N<A.length;N+=1)C(A[N],N,A)},m=function(A,C){if(A.map)return A.map(C);var N=[];return E(A,function(U,R,H){N.push(C(U,R,H))}),N},_=function(A,C,N){return A.reduce?A.reduce(C,N):(E(A,function(U,R,H){N=C(N,U,R,H)}),N)},T=function(A){if(Object.keys)return Object.keys(A);var C=[];for(var N in A)A.hasOwnProperty(N)&&C.push(N);return C};typeof h=="undefined"||!h.nextTick?typeof setImmediate=="function"?(d.nextTick=function(A){setImmediate(A)},d.setImmediate=d.nextTick):(d.nextTick=function(A){setTimeout(A,0)},d.setImmediate=d.nextTick):(d.nextTick=h.nextTick,typeof setImmediate!="undefined"?d.setImmediate=function(A){setImmediate(A)}:d.setImmediate=d.nextTick),d.each=function(A,C,N){if(N=N||function(){},!A.length)return N();var U=0;E(A,function(H){C(H,v(R))});function R(H){H?(N(H),N=function(){}):(U+=1,U>=A.length&&N())}},d.forEach=d.each,d.eachSeries=function(A,C,N){if(N=N||function(){},!A.length)return N();var U=0,R=function(){C(A[U],function(H){H?(N(H),N=function(){}):(U+=1,U>=A.length?N():R())})};R()},d.forEachSeries=d.eachSeries,d.eachLimit=function(A,C,N,U){var R=M(C);R.apply(null,[A,N,U])},d.forEachLimit=d.eachLimit;var M=function(A){return function(C,N,U){if(U=U||function(){},!C.length||A<=0)return U();var R=0,H=0,W=0;(function ae(){if(R>=C.length)return U();for(;W<A&&H<C.length;)H+=1,W+=1,N(C[H-1],function(ge){ge?(U(ge),U=function(){}):(R+=1,W-=1,R>=C.length?U():ae())})})()}},P=function(A){return function(){var C=Array.prototype.slice.call(arguments);return A.apply(null,[d.each].concat(C))}},B=function(A,C){return function(){var N=Array.prototype.slice.call(arguments);return C.apply(null,[M(A)].concat(N))}},D=function(A){return function(){var C=Array.prototype.slice.call(arguments);return A.apply(null,[d.eachSeries].concat(C))}},L=function(A,C,N,U){if(C=m(C,function(H,W){return{index:W,value:H}}),!U)A(C,function(H,W){N(H.value,function(ae){W(ae)})});else{var R=[];A(C,function(H,W){N(H.value,function(ae,ge){R[H.index]=ge,W(ae)})},function(H){U(H,R)})}};d.map=P(L),d.mapSeries=D(L),d.mapLimit=function(A,C,N,U){return X(C)(A,N,U)};var X=function(A){return B(A,L)};d.reduce=function(A,C,N,U){d.eachSeries(A,function(R,H){N(C,R,function(W,ae){C=ae,H(W)})},function(R){U(R,C)})},d.inject=d.reduce,d.foldl=d.reduce,d.reduceRight=function(A,C,N,U){var R=m(A,function(H){return H}).reverse();d.reduce(R,C,N,U)},d.foldr=d.reduceRight;var ie=function(A,C,N,U){var R=[];C=m(C,function(H,W){return{index:W,value:H}}),A(C,function(H,W){N(H.value,function(ae){ae&&R.push(H),W()})},function(H){U(m(R.sort(function(W,ae){return W.index-ae.index}),function(W){return W.value}))})};d.filter=P(ie),d.filterSeries=D(ie),d.select=d.filter,d.selectSeries=d.filterSeries;var ue=function(A,C,N,U){var R=[];C=m(C,function(H,W){return{index:W,value:H}}),A(C,function(H,W){N(H.value,function(ae){ae||R.push(H),W()})},function(H){U(m(R.sort(function(W,ae){return W.index-ae.index}),function(W){return W.value}))})};d.reject=P(ue),d.rejectSeries=D(ue);var fe=function(A,C,N,U){A(C,function(R,H){N(R,function(W){W?(U(R),U=function(){}):H()})},function(R){U()})};d.detect=P(fe),d.detectSeries=D(fe),d.some=function(A,C,N){d.each(A,function(U,R){C(U,function(H){H&&(N(!0),N=function(){}),R()})},function(U){N(!1)})},d.any=d.some,d.every=function(A,C,N){d.each(A,function(U,R){C(U,function(H){H||(N(!1),N=function(){}),R()})},function(U){N(!0)})},d.all=d.every,d.sortBy=function(A,C,N){d.map(A,function(U,R){C(U,function(H,W){H?R(H):R(null,{value:U,criteria:W})})},function(U,R){if(U)return N(U);var H=function(W,ae){var ge=W.criteria,xe=ae.criteria;return ge<xe?-1:ge>xe?1:0};N(null,m(R.sort(H),function(W){return W.value}))})},d.auto=function(A,C){C=C||function(){};var N=T(A),U=N.length;if(!U)return C();var R={},H=[],W=function(xe){H.unshift(xe)},ae=function(xe){for(var we=0;we<H.length;we+=1)if(H[we]===xe){H.splice(we,1);return}},ge=function(){U--,E(H.slice(0),function(xe){xe()})};W(function(){if(!U){var xe=C;C=function(){},xe(null,R)}}),E(N,function(xe){var we=S(A[xe])?A[xe]:[A[xe]],be=function(te){var de=Array.prototype.slice.call(arguments,1);if(de.length<=1&&(de=de[0]),te){var Z={};E(T(R),function(Q){Z[Q]=R[Q]}),Z[xe]=de,C(te,Z),C=function(){}}else R[xe]=de,d.setImmediate(ge)},le=we.slice(0,Math.abs(we.length-1))||[],pe=function(){return _(le,function(te,de){return te&&R.hasOwnProperty(de)},!0)&&!R.hasOwnProperty(xe)};if(pe())we[we.length-1](be,R);else{var me=function(){pe()&&(ae(me),we[we.length-1](be,R))};W(me)}})},d.retry=function(A,C,N){var U=5,R=[];typeof A=="function"&&(N=C,C=A,A=U),A=parseInt(A,10)||U;var H=function(W,ae){for(var ge=function(xe,we){return function(be){xe(function(le,pe){be(!le||we,{err:le,result:pe})},ae)}};A;)R.push(ge(C,!(A-=1)));d.series(R,function(xe,we){we=we[we.length-1],(W||N)(we.err,we.result)})};return N?H():H},d.waterfall=function(A,C){if(C=C||function(){},!S(A)){var N=new Error("First argument to waterfall must be an array of functions");return C(N)}if(!A.length)return C();var U=function(R){return function(H){if(H)C.apply(null,arguments),C=function(){};else{var W=Array.prototype.slice.call(arguments,1),ae=R.next();ae?W.push(U(ae)):W.push(C),d.setImmediate(function(){R.apply(null,W)})}}};U(d.iterator(A))()};var q=function(A,C,N){if(N=N||function(){},S(C))A.map(C,function(R,H){R&&R(function(W){var ae=Array.prototype.slice.call(arguments,1);ae.length<=1&&(ae=ae[0]),H.call(null,W,ae)})},N);else{var U={};A.each(T(C),function(R,H){C[R](function(W){var ae=Array.prototype.slice.call(arguments,1);ae.length<=1&&(ae=ae[0]),U[R]=ae,H(W)})},function(R){N(R,U)})}};d.parallel=function(A,C){q({map:d.map,each:d.each},A,C)},d.parallelLimit=function(A,C,N){q({map:X(C),each:M(C)},A,N)},d.series=function(A,C){if(C=C||function(){},S(A))d.mapSeries(A,function(U,R){U&&U(function(H){var W=Array.prototype.slice.call(arguments,1);W.length<=1&&(W=W[0]),R.call(null,H,W)})},C);else{var N={};d.eachSeries(T(A),function(U,R){A[U](function(H){var W=Array.prototype.slice.call(arguments,1);W.length<=1&&(W=W[0]),N[U]=W,R(H)})},function(U){C(U,N)})}},d.iterator=function(A){var C=function(N){var U=function(){return A.length&&A[N].apply(null,arguments),U.next()};return U.next=function(){return N<A.length-1?C(N+1):null},U};return C(0)},d.apply=function(A){var C=Array.prototype.slice.call(arguments,1);return function(){return A.apply(null,C.concat(Array.prototype.slice.call(arguments)))}};var G=function(A,C,N,U){var R=[];A(C,function(H,W){N(H,function(ae,ge){R=R.concat(ge||[]),W(ae)})},function(H){U(H,R)})};d.concat=P(G),d.concatSeries=D(G),d.whilst=function(A,C,N){A()?C(function(U){if(U)return N(U);d.whilst(A,C,N)}):N()},d.doWhilst=function(A,C,N){A(function(U){if(U)return N(U);var R=Array.prototype.slice.call(arguments,1);C.apply(null,R)?d.doWhilst(A,C,N):N()})},d.until=function(A,C,N){A()?N():C(function(U){if(U)return N(U);d.until(A,C,N)})},d.doUntil=function(A,C,N){A(function(U){if(U)return N(U);var R=Array.prototype.slice.call(arguments,1);C.apply(null,R)?N():d.doUntil(A,C,N)})},d.queue=function(A,C){C===void 0&&(C=1);function N(H,W,ae,ge){if(H.started||(H.started=!0),S(W)||(W=[W]),W.length==0)return d.setImmediate(function(){H.drain&&H.drain()});E(W,function(xe){var we={data:xe,callback:typeof ge=="function"?ge:null};ae?H.tasks.unshift(we):H.tasks.push(we),H.saturated&&H.tasks.length===H.concurrency&&H.saturated(),d.setImmediate(H.process)})}var U=0,R={tasks:[],concurrency:C,saturated:null,empty:null,drain:null,started:!1,paused:!1,push:function(H,W){N(R,H,!1,W)},kill:function(){R.drain=null,R.tasks=[]},unshift:function(H,W){N(R,H,!0,W)},process:function(){if(!R.paused&&U<R.concurrency&&R.tasks.length){var H=R.tasks.shift();R.empty&&R.tasks.length===0&&R.empty(),U+=1;var W=function(){U-=1,H.callback&&H.callback.apply(H,arguments),R.drain&&R.tasks.length+U===0&&R.drain(),R.process()},ae=v(W);A(H.data,ae)}},length:function(){return R.tasks.length},running:function(){return U},idle:function(){return R.tasks.length+U===0},pause:function(){R.paused!==!0&&(R.paused=!0)},resume:function(){if(R.paused!==!1){R.paused=!1;for(var H=1;H<=R.concurrency;H++)d.setImmediate(R.process)}}};return R},d.priorityQueue=function(A,C){function N(W,ae){return W.priority-ae.priority}function U(W,ae,ge){for(var xe=-1,we=W.length-1;xe<we;){var be=xe+(we-xe+1>>>1);ge(ae,W[be])>=0?xe=be:we=be-1}return xe}function R(W,ae,ge,xe){if(W.started||(W.started=!0),S(ae)||(ae=[ae]),ae.length==0)return d.setImmediate(function(){W.drain&&W.drain()});E(ae,function(we){var be={data:we,priority:ge,callback:typeof xe=="function"?xe:null};W.tasks.splice(U(W.tasks,be,N)+1,0,be),W.saturated&&W.tasks.length===W.concurrency&&W.saturated(),d.setImmediate(W.process)})}var H=d.queue(A,C);return H.push=function(W,ae,ge){R(H,W,ae,ge)},delete H.unshift,H},d.cargo=function(A,C){var N=!1,U=[],R={tasks:U,payload:C,saturated:null,empty:null,drain:null,drained:!0,push:function(H,W){S(H)||(H=[H]),E(H,function(ae){U.push({data:ae,callback:typeof W=="function"?W:null}),R.drained=!1,R.saturated&&U.length===C&&R.saturated()}),d.setImmediate(R.process)},process:function H(){if(!N){if(U.length===0){R.drain&&!R.drained&&R.drain(),R.drained=!0;return}var W=typeof C=="number"?U.splice(0,C):U.splice(0,U.length),ae=m(W,function(ge){return ge.data});R.empty&&R.empty(),N=!0,A(ae,function(){N=!1;var ge=arguments;E(W,function(xe){xe.callback&&xe.callback.apply(null,ge)}),H()})}},length:function(){return U.length},running:function(){return N}};return R};var Y=function(A){return function(C){var N=Array.prototype.slice.call(arguments,1);C.apply(null,N.concat([function(U){var R=Array.prototype.slice.call(arguments,1);typeof console!="undefined"&&(U?console.error&&console.error(U):console[A]&&E(R,function(H){console[A](H)}))}]))}};d.log=Y("log"),d.dir=Y("dir"),d.memoize=function(A,C){var N={},U={};C=C||function(H){return H};var R=function(){var H=Array.prototype.slice.call(arguments),W=H.pop(),ae=C.apply(null,H);ae in N?d.nextTick(function(){W.apply(null,N[ae])}):ae in U?U[ae].push(W):(U[ae]=[W],A.apply(null,H.concat([function(){N[ae]=arguments;var ge=U[ae];delete U[ae];for(var xe=0,we=ge.length;xe<we;xe++)ge[xe].apply(null,arguments)}])))};return R.memo=N,R.unmemoized=A,R},d.unmemoize=function(A){return function(){return(A.unmemoized||A).apply(null,arguments)}},d.times=function(A,C,N){for(var U=[],R=0;R<A;R++)U.push(R);return d.map(U,C,N)},d.timesSeries=function(A,C,N){for(var U=[],R=0;R<A;R++)U.push(R);return d.mapSeries(U,C,N)},d.seq=function(){var A=arguments;return function(){var C=this,N=Array.prototype.slice.call(arguments),U=N.pop();d.reduce(A,N,function(R,H,W){H.apply(C,R.concat([function(){var ae=arguments[0],ge=Array.prototype.slice.call(arguments,1);W(ae,ge)}]))},function(R,H){U.apply(C,[R].concat(H))})}},d.compose=function(){return d.seq.apply(null,Array.prototype.reverse.call(arguments))};var J=function(A,C){var N=function(){var R=this,H=Array.prototype.slice.call(arguments),W=H.pop();return A(C,function(ae,ge){ae.apply(R,H.concat([ge]))},W)};if(arguments.length>2){var U=Array.prototype.slice.call(arguments,2);return N.apply(this,U)}else return N};d.applyEach=P(J),d.applyEachSeries=D(J),d.forever=function(A,C){function N(U){if(U){if(C)return C(U);throw U}A(N)}N()},r.exports?r.exports=d:(g=[],u=function(){return d}.apply(s,g),u!==void 0&&(r.exports=u))})()},2830:(r,s,f)=>{r.exports=u;var h=f(7187).EventEmitter,g=f(46);g(u,h),u.Readable=f(6577),u.Writable=f(323),u.Duplex=f(8656),u.Transform=f(4473),u.PassThrough=f(2366),u.finished=f(1086),u.pipeline=f(6472),u.Stream=u;function u(){h.call(this)}u.prototype.pipe=function(d,a){var b=this;function v(M){d.writable&&d.write(M)===!1&&b.pause&&b.pause()}b.on("data",v);function w(){b.readable&&b.resume&&b.resume()}d.on("drain",w),!d._isStdio&&(!a||a.end!==!1)&&(b.on("end",E),b.on("close",m));var S=!1;function E(){S||(S=!0,d.end())}function m(){S||(S=!0,typeof d.destroy=="function"&&d.destroy())}function _(M){if(T(),h.listenerCount(this,"error")===0)throw M}b.on("error",_),d.on("error",_);function T(){b.removeListener("data",v),d.removeListener("drain",w),b.removeListener("end",E),b.removeListener("close",m),b.removeListener("error",_),d.removeListener("error",_),b.removeListener("end",T),b.removeListener("close",T),d.removeListener("close",T)}return b.on("end",T),b.on("close",T),d.on("close",T),d.emit("pipe",b),d}},46:r=>{typeof Object.create=="function"?r.exports=function(f,h){h&&(f.super_=h,f.prototype=Object.create(h.prototype,{constructor:{value:f,enumerable:!1,writable:!0,configurable:!0}}))}:r.exports=function(f,h){if(h){f.super_=h;var g=function(){};g.prototype=h.prototype,f.prototype=new g,f.prototype.constructor=f}}},8106:r=>{function s(b,v){b.prototype=Object.create(v.prototype),b.prototype.constructor=b,b.__proto__=v}var f={};function h(b,v,w){w||(w=Error);function S(m,_,T){return typeof v=="string"?v:v(m,_,T)}var E=function(m){s(_,m);function _(T,M,P){return m.call(this,S(T,M,P))||this}return _}(w);E.prototype.name=w.name,E.prototype.code=b,f[b]=E}function g(b,v){if(Array.isArray(b)){var w=b.length;return b=b.map(function(S){return String(S)}),w>2?"one of ".concat(v," ").concat(b.slice(0,w-1).join(", "),", or ")+b[w-1]:w===2?"one of ".concat(v," ").concat(b[0]," or ").concat(b[1]):"of ".concat(v," ").concat(b[0])}else return"of ".concat(v," ").concat(String(b))}function u(b,v,w){return b.substr(!w||w<0?0:+w,v.length)===v}function d(b,v,w){return(w===void 0||w>b.length)&&(w=b.length),b.substring(w-v.length,w)===v}function a(b,v,w){return typeof w!="number"&&(w=0),w+v.length>b.length?!1:b.indexOf(v,w)!==-1}h("ERR_INVALID_OPT_VALUE",function(b,v){return'The value "'+v+'" is invalid for option "'+b+'"'},TypeError),h("ERR_INVALID_ARG_TYPE",function(b,v,w){var S;typeof v=="string"&&u(v,"not ")?(S="must not be",v=v.replace(/^not /,"")):S="must be";var E;if(d(b," argument"))E="The ".concat(b," ").concat(S," ").concat(g(v,"type"));else{var m=a(b,".")?"property":"argument";E='The "'.concat(b,'" ').concat(m," ").concat(S," ").concat(g(v,"type"))}return E+=". Received type ".concat(typeof w),E},TypeError),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),h("ERR_METHOD_NOT_IMPLEMENTED",function(b){return"The "+b+" method is not implemented"}),h("ERR_STREAM_PREMATURE_CLOSE","Premature close"),h("ERR_STREAM_DESTROYED",function(b){return"Cannot call "+b+" after a stream was destroyed"}),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),h("ERR_STREAM_WRITE_AFTER_END","write after end"),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_UNKNOWN_ENCODING",function(b){return"Unknown encoding: "+b},TypeError),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),r.exports.q=f},8656:(r,s,f)=>{var h=f(4155),g=Object.keys||function(m){var _=[];for(var T in m)_.push(T);return _};r.exports=w;var u=f(6577),d=f(323);f(46)(w,u);for(var a=g(d.prototype),b=0;b<a.length;b++){var v=a[b];w.prototype[v]||(w.prototype[v]=d.prototype[v])}function w(m){if(!(this instanceof w))return new w(m);u.call(this,m),d.call(this,m),this.allowHalfOpen=!0,m&&(m.readable===!1&&(this.readable=!1),m.writable===!1&&(this.writable=!1),m.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",S)))}Object.defineProperty(w.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(w.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(w.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function S(){this._writableState.ended||h.nextTick(E,this)}function E(m){m.end()}Object.defineProperty(w.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(_){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=_,this._writableState.destroyed=_)}})},2366:(r,s,f)=>{r.exports=g;var h=f(4473);f(46)(g,h);function g(u){if(!(this instanceof g))return new g(u);h.call(this,u)}g.prototype._transform=function(u,d,a){a(null,u)}},6577:(r,s,f)=>{var h=f(4155);r.exports=A;var g;A.ReadableState=J,f(7187).EventEmitter;var u=function(re,Ce){return re.listeners(Ce).length},d=f(3194),a=f(8764).Buffer,b=f.g.Uint8Array||function(){};function v(ne){return a.from(ne)}function w(ne){return a.isBuffer(ne)||ne instanceof b}var S=f(1758),E;S&&S.debuglog?E=S.debuglog("stream"):E=function(){};var m=f(9686),_=f(1029),T=f(94),M=T.getHighWaterMark,P=f(8106).q,B=P.ERR_INVALID_ARG_TYPE,D=P.ERR_STREAM_PUSH_AFTER_EOF,L=P.ERR_METHOD_NOT_IMPLEMENTED,X=P.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,ie,ue,fe;f(46)(A,d);var q=_.errorOrDestroy,G=["error","close","destroy","pause","resume"];function Y(ne,re,Ce){if(typeof ne.prependListener=="function")return ne.prependListener(re,Ce);!ne._events||!ne._events[re]?ne.on(re,Ce):Array.isArray(ne._events[re])?ne._events[re].unshift(Ce):ne._events[re]=[Ce,ne._events[re]]}function J(ne,re,Ce){g=g||f(8656),ne=ne||{},typeof Ce!="boolean"&&(Ce=re instanceof g),this.objectMode=!!ne.objectMode,Ce&&(this.objectMode=this.objectMode||!!ne.readableObjectMode),this.highWaterMark=M(this,ne,"readableHighWaterMark",Ce),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=ne.emitClose!==!1,this.autoDestroy=!!ne.autoDestroy,this.destroyed=!1,this.defaultEncoding=ne.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,ne.encoding&&(ie||(ie=f(2553).s),this.decoder=new ie(ne.encoding),this.encoding=ne.encoding)}function A(ne){if(g=g||f(8656),!(this instanceof A))return new A(ne);var re=this instanceof g;this._readableState=new J(ne,this,re),this.readable=!0,ne&&(typeof ne.read=="function"&&(this._read=ne.read),typeof ne.destroy=="function"&&(this._destroy=ne.destroy)),d.call(this)}Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(re){!this._readableState||(this._readableState.destroyed=re)}}),A.prototype.destroy=_.destroy,A.prototype._undestroy=_.undestroy,A.prototype._destroy=function(ne,re){re(ne)},A.prototype.push=function(ne,re){var Ce=this._readableState,Me;return Ce.objectMode?Me=!0:typeof ne=="string"&&(re=re||Ce.defaultEncoding,re!==Ce.encoding&&(ne=a.from(ne,re),re=""),Me=!0),C(this,ne,re,!1,Me)},A.prototype.unshift=function(ne){return C(this,ne,null,!0,!1)};function C(ne,re,Ce,Me,ke){E("readableAddChunk",re);var Ae=ne._readableState;if(re===null)Ae.reading=!1,ae(ne,Ae);else{var Be;if(ke||(Be=U(Ae,re)),Be)q(ne,Be);else if(Ae.objectMode||re&&re.length>0)if(typeof re!="string"&&!Ae.objectMode&&Object.getPrototypeOf(re)!==a.prototype&&(re=v(re)),Me)Ae.endEmitted?q(ne,new X):N(ne,Ae,re,!0);else if(Ae.ended)q(ne,new D);else{if(Ae.destroyed)return!1;Ae.reading=!1,Ae.decoder&&!Ce?(re=Ae.decoder.write(re),Ae.objectMode||re.length!==0?N(ne,Ae,re,!1):we(ne,Ae)):N(ne,Ae,re,!1)}else Me||(Ae.reading=!1,we(ne,Ae))}return!Ae.ended&&(Ae.length<Ae.highWaterMark||Ae.length===0)}function N(ne,re,Ce,Me){re.flowing&&re.length===0&&!re.sync?(re.awaitDrain=0,ne.emit("data",Ce)):(re.length+=re.objectMode?1:Ce.length,Me?re.buffer.unshift(Ce):re.buffer.push(Ce),re.needReadable&&ge(ne)),we(ne,re)}function U(ne,re){var Ce;return!w(re)&&typeof re!="string"&&re!==void 0&&!ne.objectMode&&(Ce=new B("chunk",["string","Buffer","Uint8Array"],re)),Ce}A.prototype.isPaused=function(){return this._readableState.flowing===!1},A.prototype.setEncoding=function(ne){ie||(ie=f(2553).s);var re=new ie(ne);this._readableState.decoder=re,this._readableState.encoding=this._readableState.decoder.encoding;for(var Ce=this._readableState.buffer.head,Me="";Ce!==null;)Me+=re.write(Ce.data),Ce=Ce.next;return this._readableState.buffer.clear(),Me!==""&&this._readableState.buffer.push(Me),this._readableState.length=Me.length,this};var R=1073741824;function H(ne){return ne>=R?ne=R:(ne--,ne|=ne>>>1,ne|=ne>>>2,ne|=ne>>>4,ne|=ne>>>8,ne|=ne>>>16,ne++),ne}function W(ne,re){return ne<=0||re.length===0&&re.ended?0:re.objectMode?1:ne!==ne?re.flowing&&re.length?re.buffer.head.data.length:re.length:(ne>re.highWaterMark&&(re.highWaterMark=H(ne)),ne<=re.length?ne:re.ended?re.length:(re.needReadable=!0,0))}A.prototype.read=function(ne){E("read",ne),ne=parseInt(ne,10);var re=this._readableState,Ce=ne;if(ne!==0&&(re.emittedReadable=!1),ne===0&&re.needReadable&&((re.highWaterMark!==0?re.length>=re.highWaterMark:re.length>0)||re.ended))return E("read: emitReadable",re.length,re.ended),re.length===0&&re.ended?ve(this):ge(this),null;if(ne=W(ne,re),ne===0&&re.ended)return re.length===0&&ve(this),null;var Me=re.needReadable;E("need readable",Me),(re.length===0||re.length-ne<re.highWaterMark)&&(Me=!0,E("length less than watermark",Me)),re.ended||re.reading?(Me=!1,E("reading or ended",Me)):Me&&(E("do read"),re.reading=!0,re.sync=!0,re.length===0&&(re.needReadable=!0),this._read(re.highWaterMark),re.sync=!1,re.reading||(ne=W(Ce,re)));var ke;return ne>0?ke=Q(ne,re):ke=null,ke===null?(re.needReadable=re.length<=re.highWaterMark,ne=0):(re.length-=ne,re.awaitDrain=0),re.length===0&&(re.ended||(re.needReadable=!0),Ce!==ne&&re.ended&&ve(this)),ke!==null&&this.emit("data",ke),ke};function ae(ne,re){if(E("onEofChunk"),!re.ended){if(re.decoder){var Ce=re.decoder.end();Ce&&Ce.length&&(re.buffer.push(Ce),re.length+=re.objectMode?1:Ce.length)}re.ended=!0,re.sync?ge(ne):(re.needReadable=!1,re.emittedReadable||(re.emittedReadable=!0,xe(ne)))}}function ge(ne){var re=ne._readableState;E("emitReadable",re.needReadable,re.emittedReadable),re.needReadable=!1,re.emittedReadable||(E("emitReadable",re.flowing),re.emittedReadable=!0,h.nextTick(xe,ne))}function xe(ne){var re=ne._readableState;E("emitReadable_",re.destroyed,re.length,re.ended),!re.destroyed&&(re.length||re.ended)&&(ne.emit("readable"),re.emittedReadable=!1),re.needReadable=!re.flowing&&!re.ended&&re.length<=re.highWaterMark,Z(ne)}function we(ne,re){re.readingMore||(re.readingMore=!0,h.nextTick(be,ne,re))}function be(ne,re){for(;!re.reading&&!re.ended&&(re.length<re.highWaterMark||re.flowing&&re.length===0);){var Ce=re.length;if(E("maybeReadMore read 0"),ne.read(0),Ce===re.length)break}re.readingMore=!1}A.prototype._read=function(ne){q(this,new L("_read()"))},A.prototype.pipe=function(ne,re){var Ce=this,Me=this._readableState;switch(Me.pipesCount){case 0:Me.pipes=ne;break;case 1:Me.pipes=[Me.pipes,ne];break;default:Me.pipes.push(ne);break}Me.pipesCount+=1,E("pipe count=%d opts=%j",Me.pipesCount,re);var ke=(!re||re.end!==!1)&&ne!==h.stdout&&ne!==h.stderr,Ae=ke?et:I;Me.endEmitted?h.nextTick(Ae):Ce.once("end",Ae),ne.on("unpipe",Be);function Be(O,oe){E("onunpipe"),O===Ce&&oe&&oe.hasUnpiped===!1&&(oe.hasUnpiped=!0,lt())}function et(){E("onend"),ne.end()}var Ke=le(Ce);ne.on("drain",Ke);var Ze=!1;function lt(){E("cleanup"),ne.removeListener("close",ut),ne.removeListener("finish",K),ne.removeListener("drain",Ke),ne.removeListener("error",Qe),ne.removeListener("unpipe",Be),Ce.removeListener("end",et),Ce.removeListener("end",I),Ce.removeListener("data",dt),Ze=!0,Me.awaitDrain&&(!ne._writableState||ne._writableState.needDrain)&&Ke()}Ce.on("data",dt);function dt(O){E("ondata");var oe=ne.write(O);E("dest.write",oe),oe===!1&&((Me.pipesCount===1&&Me.pipes===ne||Me.pipesCount>1&&Re(Me.pipes,ne)!==-1)&&!Ze&&(E("false write response, pause",Me.awaitDrain),Me.awaitDrain++),Ce.pause())}function Qe(O){E("onerror",O),I(),ne.removeListener("error",Qe),u(ne,"error")===0&&q(ne,O)}Y(ne,"error",Qe);function ut(){ne.removeListener("finish",K),I()}ne.once("close",ut);function K(){E("onfinish"),ne.removeListener("close",ut),I()}ne.once("finish",K);function I(){E("unpipe"),Ce.unpipe(ne)}return ne.emit("pipe",Ce),Me.flowing||(E("pipe resume"),Ce.resume()),ne};function le(ne){return function(){var Ce=ne._readableState;E("pipeOnDrain",Ce.awaitDrain),Ce.awaitDrain&&Ce.awaitDrain--,Ce.awaitDrain===0&&u(ne,"data")&&(Ce.flowing=!0,Z(ne))}}A.prototype.unpipe=function(ne){var re=this._readableState,Ce={hasUnpiped:!1};if(re.pipesCount===0)return this;if(re.pipesCount===1)return ne&&ne!==re.pipes?this:(ne||(ne=re.pipes),re.pipes=null,re.pipesCount=0,re.flowing=!1,ne&&ne.emit("unpipe",this,Ce),this);if(!ne){var Me=re.pipes,ke=re.pipesCount;re.pipes=null,re.pipesCount=0,re.flowing=!1;for(var Ae=0;Ae<ke;Ae++)Me[Ae].emit("unpipe",this,{hasUnpiped:!1});return this}var Be=Re(re.pipes,ne);return Be===-1?this:(re.pipes.splice(Be,1),re.pipesCount-=1,re.pipesCount===1&&(re.pipes=re.pipes[0]),ne.emit("unpipe",this,Ce),this)},A.prototype.on=function(ne,re){var Ce=d.prototype.on.call(this,ne,re),Me=this._readableState;return ne==="data"?(Me.readableListening=this.listenerCount("readable")>0,Me.flowing!==!1&&this.resume()):ne==="readable"&&!Me.endEmitted&&!Me.readableListening&&(Me.readableListening=Me.needReadable=!0,Me.flowing=!1,Me.emittedReadable=!1,E("on readable",Me.length,Me.reading),Me.length?ge(this):Me.reading||h.nextTick(me,this)),Ce},A.prototype.addListener=A.prototype.on,A.prototype.removeListener=function(ne,re){var Ce=d.prototype.removeListener.call(this,ne,re);return ne==="readable"&&h.nextTick(pe,this),Ce},A.prototype.removeAllListeners=function(ne){var re=d.prototype.removeAllListeners.apply(this,arguments);return(ne==="readable"||ne===void 0)&&h.nextTick(pe,this),re};function pe(ne){var re=ne._readableState;re.readableListening=ne.listenerCount("readable")>0,re.resumeScheduled&&!re.paused?re.flowing=!0:ne.listenerCount("data")>0&&ne.resume()}function me(ne){E("readable nexttick read 0"),ne.read(0)}A.prototype.resume=function(){var ne=this._readableState;return ne.flowing||(E("resume"),ne.flowing=!ne.readableListening,te(this,ne)),ne.paused=!1,this};function te(ne,re){re.resumeScheduled||(re.resumeScheduled=!0,h.nextTick(de,ne,re))}function de(ne,re){E("resume",re.reading),re.reading||ne.read(0),re.resumeScheduled=!1,ne.emit("resume"),Z(ne),re.flowing&&!re.reading&&ne.read(0)}A.prototype.pause=function(){return E("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(E("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function Z(ne){var re=ne._readableState;for(E("flow",re.flowing);re.flowing&&ne.read()!==null;);}A.prototype.wrap=function(ne){var re=this,Ce=this._readableState,Me=!1;ne.on("end",function(){if(E("wrapped end"),Ce.decoder&&!Ce.ended){var Be=Ce.decoder.end();Be&&Be.length&&re.push(Be)}re.push(null)}),ne.on("data",function(Be){if(E("wrapped data"),Ce.decoder&&(Be=Ce.decoder.write(Be)),!(Ce.objectMode&&Be==null)&&!(!Ce.objectMode&&(!Be||!Be.length))){var et=re.push(Be);et||(Me=!0,ne.pause())}});for(var ke in ne)this[ke]===void 0&&typeof ne[ke]=="function"&&(this[ke]=function(et){return function(){return ne[et].apply(ne,arguments)}}(ke));for(var Ae=0;Ae<G.length;Ae++)ne.on(G[Ae],this.emit.bind(this,G[Ae]));return this._read=function(Be){E("wrapped _read",Be),Me&&(Me=!1,ne.resume())},this},typeof Symbol=="function"&&(A.prototype[Symbol.asyncIterator]=function(){return ue===void 0&&(ue=f(828)),ue(this)}),Object.defineProperty(A.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(A.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(A.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(re){this._readableState&&(this._readableState.flowing=re)}}),A._fromList=Q,Object.defineProperty(A.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function Q(ne,re){if(re.length===0)return null;var Ce;return re.objectMode?Ce=re.buffer.shift():!ne||ne>=re.length?(re.decoder?Ce=re.buffer.join(""):re.buffer.length===1?Ce=re.buffer.first():Ce=re.buffer.concat(re.length),re.buffer.clear()):Ce=re.buffer.consume(ne,re.decoder),Ce}function ve(ne){var re=ne._readableState;E("endReadable",re.endEmitted),re.endEmitted||(re.ended=!0,h.nextTick(Se,re,ne))}function Se(ne,re){if(E("endReadableNT",ne.endEmitted,ne.length),!ne.endEmitted&&ne.length===0&&(ne.endEmitted=!0,re.readable=!1,re.emit("end"),ne.autoDestroy)){var Ce=re._writableState;(!Ce||Ce.autoDestroy&&Ce.finished)&&re.destroy()}}typeof Symbol=="function"&&(A.from=function(ne,re){return fe===void 0&&(fe=f(1265)),fe(A,ne,re)});function Re(ne,re){for(var Ce=0,Me=ne.length;Ce<Me;Ce++)if(ne[Ce]===re)return Ce;return-1}},4473:(r,s,f)=>{r.exports=w;var h=f(8106).q,g=h.ERR_METHOD_NOT_IMPLEMENTED,u=h.ERR_MULTIPLE_CALLBACK,d=h.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=h.ERR_TRANSFORM_WITH_LENGTH_0,b=f(8656);f(46)(w,b);function v(m,_){var T=this._transformState;T.transforming=!1;var M=T.writecb;if(M===null)return this.emit("error",new u);T.writechunk=null,T.writecb=null,_!=null&&this.push(_),M(m);var P=this._readableState;P.reading=!1,(P.needReadable||P.length<P.highWaterMark)&&this._read(P.highWaterMark)}function w(m){if(!(this instanceof w))return new w(m);b.call(this,m),this._transformState={afterTransform:v.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,m&&(typeof m.transform=="function"&&(this._transform=m.transform),typeof m.flush=="function"&&(this._flush=m.flush)),this.on("prefinish",S)}function S(){var m=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(_,T){E(m,_,T)}):E(this,null,null)}w.prototype.push=function(m,_){return this._transformState.needTransform=!1,b.prototype.push.call(this,m,_)},w.prototype._transform=function(m,_,T){T(new g("_transform()"))},w.prototype._write=function(m,_,T){var M=this._transformState;if(M.writecb=T,M.writechunk=m,M.writeencoding=_,!M.transforming){var P=this._readableState;(M.needTransform||P.needReadable||P.length<P.highWaterMark)&&this._read(P.highWaterMark)}},w.prototype._read=function(m){var _=this._transformState;_.writechunk!==null&&!_.transforming?(_.transforming=!0,this._transform(_.writechunk,_.writeencoding,_.afterTransform)):_.needTransform=!0},w.prototype._destroy=function(m,_){b.prototype._destroy.call(this,m,function(T){_(T)})};function E(m,_,T){if(_)return m.emit("error",_);if(T!=null&&m.push(T),m._writableState.length)throw new a;if(m._transformState.transforming)throw new d;return m.push(null)}},323:(r,s,f)=>{var h=f(4155);r.exports=J;function g(Z){var Q=this;this.next=null,this.entry=null,this.finish=function(){de(Q,Z)}}var u;J.WritableState=G;var d={deprecate:f(4927)},a=f(3194),b=f(8764).Buffer,v=f.g.Uint8Array||function(){};function w(Z){return b.from(Z)}function S(Z){return b.isBuffer(Z)||Z instanceof v}var E=f(1029),m=f(94),_=m.getHighWaterMark,T=f(8106).q,M=T.ERR_INVALID_ARG_TYPE,P=T.ERR_METHOD_NOT_IMPLEMENTED,B=T.ERR_MULTIPLE_CALLBACK,D=T.ERR_STREAM_CANNOT_PIPE,L=T.ERR_STREAM_DESTROYED,X=T.ERR_STREAM_NULL_VALUES,ie=T.ERR_STREAM_WRITE_AFTER_END,ue=T.ERR_UNKNOWN_ENCODING,fe=E.errorOrDestroy;f(46)(J,a);function q(){}function G(Z,Q,ve){u=u||f(8656),Z=Z||{},typeof ve!="boolean"&&(ve=Q instanceof u),this.objectMode=!!Z.objectMode,ve&&(this.objectMode=this.objectMode||!!Z.writableObjectMode),this.highWaterMark=_(this,Z,"writableHighWaterMark",ve),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var Se=Z.decodeStrings===!1;this.decodeStrings=!Se,this.defaultEncoding=Z.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(Re){ae(Q,Re)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=Z.emitClose!==!1,this.autoDestroy=!!Z.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new g(this)}G.prototype.getBuffer=function(){for(var Q=this.bufferedRequest,ve=[];Q;)ve.push(Q),Q=Q.next;return ve},function(){try{Object.defineProperty(G.prototype,"buffer",{get:d.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var Y;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(Y=Function.prototype[Symbol.hasInstance],Object.defineProperty(J,Symbol.hasInstance,{value:function(Q){return Y.call(this,Q)?!0:this!==J?!1:Q&&Q._writableState instanceof G}})):Y=function(Q){return Q instanceof this};function J(Z){u=u||f(8656);var Q=this instanceof u;if(!Q&&!Y.call(J,this))return new J(Z);this._writableState=new G(Z,this,Q),this.writable=!0,Z&&(typeof Z.write=="function"&&(this._write=Z.write),typeof Z.writev=="function"&&(this._writev=Z.writev),typeof Z.destroy=="function"&&(this._destroy=Z.destroy),typeof Z.final=="function"&&(this._final=Z.final)),a.call(this)}J.prototype.pipe=function(){fe(this,new D)};function A(Z,Q){var ve=new ie;fe(Z,ve),h.nextTick(Q,ve)}function C(Z,Q,ve,Se){var Re;return ve===null?Re=new X:typeof ve!="string"&&!Q.objectMode&&(Re=new M("chunk",["string","Buffer"],ve)),Re?(fe(Z,Re),h.nextTick(Se,Re),!1):!0}J.prototype.write=function(Z,Q,ve){var Se=this._writableState,Re=!1,ne=!Se.objectMode&&S(Z);return ne&&!b.isBuffer(Z)&&(Z=w(Z)),typeof Q=="function"&&(ve=Q,Q=null),ne?Q="buffer":Q||(Q=Se.defaultEncoding),typeof ve!="function"&&(ve=q),Se.ending?A(this,ve):(ne||C(this,Se,Z,ve))&&(Se.pendingcb++,Re=U(this,Se,ne,Z,Q,ve)),Re},J.prototype.cork=function(){this._writableState.corked++},J.prototype.uncork=function(){var Z=this._writableState;Z.corked&&(Z.corked--,!Z.writing&&!Z.corked&&!Z.bufferProcessing&&Z.bufferedRequest&&we(this,Z))},J.prototype.setDefaultEncoding=function(Q){if(typeof Q=="string"&&(Q=Q.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((Q+"").toLowerCase())>-1))throw new ue(Q);return this._writableState.defaultEncoding=Q,this},Object.defineProperty(J.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function N(Z,Q,ve){return!Z.objectMode&&Z.decodeStrings!==!1&&typeof Q=="string"&&(Q=b.from(Q,ve)),Q}Object.defineProperty(J.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function U(Z,Q,ve,Se,Re,ne){if(!ve){var re=N(Q,Se,Re);Se!==re&&(ve=!0,Re="buffer",Se=re)}var Ce=Q.objectMode?1:Se.length;Q.length+=Ce;var Me=Q.length<Q.highWaterMark;if(Me||(Q.needDrain=!0),Q.writing||Q.corked){var ke=Q.lastBufferedRequest;Q.lastBufferedRequest={chunk:Se,encoding:Re,isBuf:ve,callback:ne,next:null},ke?ke.next=Q.lastBufferedRequest:Q.bufferedRequest=Q.lastBufferedRequest,Q.bufferedRequestCount+=1}else R(Z,Q,!1,Ce,Se,Re,ne);return Me}function R(Z,Q,ve,Se,Re,ne,re){Q.writelen=Se,Q.writecb=re,Q.writing=!0,Q.sync=!0,Q.destroyed?Q.onwrite(new L("write")):ve?Z._writev(Re,Q.onwrite):Z._write(Re,ne,Q.onwrite),Q.sync=!1}function H(Z,Q,ve,Se,Re){--Q.pendingcb,ve?(h.nextTick(Re,Se),h.nextTick(me,Z,Q),Z._writableState.errorEmitted=!0,fe(Z,Se)):(Re(Se),Z._writableState.errorEmitted=!0,fe(Z,Se),me(Z,Q))}function W(Z){Z.writing=!1,Z.writecb=null,Z.length-=Z.writelen,Z.writelen=0}function ae(Z,Q){var ve=Z._writableState,Se=ve.sync,Re=ve.writecb;if(typeof Re!="function")throw new B;if(W(ve),Q)H(Z,ve,Se,Q,Re);else{var ne=be(ve)||Z.destroyed;!ne&&!ve.corked&&!ve.bufferProcessing&&ve.bufferedRequest&&we(Z,ve),Se?h.nextTick(ge,Z,ve,ne,Re):ge(Z,ve,ne,Re)}}function ge(Z,Q,ve,Se){ve||xe(Z,Q),Q.pendingcb--,Se(),me(Z,Q)}function xe(Z,Q){Q.length===0&&Q.needDrain&&(Q.needDrain=!1,Z.emit("drain"))}function we(Z,Q){Q.bufferProcessing=!0;var ve=Q.bufferedRequest;if(Z._writev&&ve&&ve.next){var Se=Q.bufferedRequestCount,Re=new Array(Se),ne=Q.corkedRequestsFree;ne.entry=ve;for(var re=0,Ce=!0;ve;)Re[re]=ve,ve.isBuf||(Ce=!1),ve=ve.next,re+=1;Re.allBuffers=Ce,R(Z,Q,!0,Q.length,Re,"",ne.finish),Q.pendingcb++,Q.lastBufferedRequest=null,ne.next?(Q.corkedRequestsFree=ne.next,ne.next=null):Q.corkedRequestsFree=new g(Q),Q.bufferedRequestCount=0}else{for(;ve;){var Me=ve.chunk,ke=ve.encoding,Ae=ve.callback,Be=Q.objectMode?1:Me.length;if(R(Z,Q,!1,Be,Me,ke,Ae),ve=ve.next,Q.bufferedRequestCount--,Q.writing)break}ve===null&&(Q.lastBufferedRequest=null)}Q.bufferedRequest=ve,Q.bufferProcessing=!1}J.prototype._write=function(Z,Q,ve){ve(new P("_write()"))},J.prototype._writev=null,J.prototype.end=function(Z,Q,ve){var Se=this._writableState;return typeof Z=="function"?(ve=Z,Z=null,Q=null):typeof Q=="function"&&(ve=Q,Q=null),Z!=null&&this.write(Z,Q),Se.corked&&(Se.corked=1,this.uncork()),Se.ending||te(this,Se,ve),this},Object.defineProperty(J.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function be(Z){return Z.ending&&Z.length===0&&Z.bufferedRequest===null&&!Z.finished&&!Z.writing}function le(Z,Q){Z._final(function(ve){Q.pendingcb--,ve&&fe(Z,ve),Q.prefinished=!0,Z.emit("prefinish"),me(Z,Q)})}function pe(Z,Q){!Q.prefinished&&!Q.finalCalled&&(typeof Z._final=="function"&&!Q.destroyed?(Q.pendingcb++,Q.finalCalled=!0,h.nextTick(le,Z,Q)):(Q.prefinished=!0,Z.emit("prefinish")))}function me(Z,Q){var ve=be(Q);if(ve&&(pe(Z,Q),Q.pendingcb===0&&(Q.finished=!0,Z.emit("finish"),Q.autoDestroy))){var Se=Z._readableState;(!Se||Se.autoDestroy&&Se.endEmitted)&&Z.destroy()}return ve}function te(Z,Q,ve){Q.ending=!0,me(Z,Q),ve&&(Q.finished?h.nextTick(ve):Z.once("finish",ve)),Q.ended=!0,Z.writable=!1}function de(Z,Q,ve){var Se=Z.entry;for(Z.entry=null;Se;){var Re=Se.callback;Q.pendingcb--,Re(ve),Se=Se.next}Q.corkedRequestsFree.next=Z}Object.defineProperty(J.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(Q){!this._writableState||(this._writableState.destroyed=Q)}}),J.prototype.destroy=E.destroy,J.prototype._undestroy=E.undestroy,J.prototype._destroy=function(Z,Q){Q(Z)}},828:(r,s,f)=>{var h=f(4155),g;function u(X,ie,ue){return ie in X?Object.defineProperty(X,ie,{value:ue,enumerable:!0,configurable:!0,writable:!0}):X[ie]=ue,X}var d=f(1086),a=Symbol("lastResolve"),b=Symbol("lastReject"),v=Symbol("error"),w=Symbol("ended"),S=Symbol("lastPromise"),E=Symbol("handlePromise"),m=Symbol("stream");function _(X,ie){return{value:X,done:ie}}function T(X){var ie=X[a];if(ie!==null){var ue=X[m].read();ue!==null&&(X[S]=null,X[a]=null,X[b]=null,ie(_(ue,!1)))}}function M(X){h.nextTick(T,X)}function P(X,ie){return function(ue,fe){X.then(function(){if(ie[w]){ue(_(void 0,!0));return}ie[E](ue,fe)},fe)}}var B=Object.getPrototypeOf(function(){}),D=Object.setPrototypeOf((g={get stream(){return this[m]},next:function(){var ie=this,ue=this[v];if(ue!==null)return Promise.reject(ue);if(this[w])return Promise.resolve(_(void 0,!0));if(this[m].destroyed)return new Promise(function(Y,J){h.nextTick(function(){ie[v]?J(ie[v]):Y(_(void 0,!0))})});var fe=this[S],q;if(fe)q=new Promise(P(fe,this));else{var G=this[m].read();if(G!==null)return Promise.resolve(_(G,!1));q=new Promise(this[E])}return this[S]=q,q}},u(g,Symbol.asyncIterator,function(){return this}),u(g,"return",function(){var ie=this;return new Promise(function(ue,fe){ie[m].destroy(null,function(q){if(q){fe(q);return}ue(_(void 0,!0))})})}),g),B),L=function(ie){var ue,fe=Object.create(D,(ue={},u(ue,m,{value:ie,writable:!0}),u(ue,a,{value:null,writable:!0}),u(ue,b,{value:null,writable:!0}),u(ue,v,{value:null,writable:!0}),u(ue,w,{value:ie._readableState.endEmitted,writable:!0}),u(ue,E,{value:function(G,Y){var J=fe[m].read();J?(fe[S]=null,fe[a]=null,fe[b]=null,G(_(J,!1))):(fe[a]=G,fe[b]=Y)},writable:!0}),ue));return fe[S]=null,d(ie,function(q){if(q&&q.code!=="ERR_STREAM_PREMATURE_CLOSE"){var G=fe[b];G!==null&&(fe[S]=null,fe[a]=null,fe[b]=null,G(q)),fe[v]=q;return}var Y=fe[a];Y!==null&&(fe[S]=null,fe[a]=null,fe[b]=null,Y(_(void 0,!0))),fe[w]=!0}),ie.on("readable",M.bind(null,fe)),fe};r.exports=L},9686:(r,s,f)=>{function h(T,M){var P=Object.keys(T);if(Object.getOwnPropertySymbols){var B=Object.getOwnPropertySymbols(T);M&&(B=B.filter(function(D){return Object.getOwnPropertyDescriptor(T,D).enumerable})),P.push.apply(P,B)}return P}function g(T){for(var M=1;M<arguments.length;M++){var P=arguments[M]!=null?arguments[M]:{};M%2?h(Object(P),!0).forEach(function(B){u(T,B,P[B])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(P)):h(Object(P)).forEach(function(B){Object.defineProperty(T,B,Object.getOwnPropertyDescriptor(P,B))})}return T}function u(T,M,P){return M in T?Object.defineProperty(T,M,{value:P,enumerable:!0,configurable:!0,writable:!0}):T[M]=P,T}function d(T,M){if(!(T instanceof M))throw new TypeError("Cannot call a class as a function")}function a(T,M){for(var P=0;P<M.length;P++){var B=M[P];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(T,B.key,B)}}function b(T,M,P){return M&&a(T.prototype,M),P&&a(T,P),T}var v=f(8764),w=v.Buffer,S=f(1758),E=S.inspect,m=E&&E.custom||"inspect";function _(T,M,P){w.prototype.copy.call(T,M,P)}r.exports=function(){function T(){d(this,T),this.head=null,this.tail=null,this.length=0}return b(T,[{key:"push",value:function(P){var B={data:P,next:null};this.length>0?this.tail.next=B:this.head=B,this.tail=B,++this.length}},{key:"unshift",value:function(P){var B={data:P,next:this.head};this.length===0&&(this.tail=B),this.head=B,++this.length}},{key:"shift",value:function(){if(this.length!==0){var P=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,P}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(P){if(this.length===0)return"";for(var B=this.head,D=""+B.data;B=B.next;)D+=P+B.data;return D}},{key:"concat",value:function(P){if(this.length===0)return w.alloc(0);for(var B=w.allocUnsafe(P>>>0),D=this.head,L=0;D;)_(D.data,B,L),L+=D.data.length,D=D.next;return B}},{key:"consume",value:function(P,B){var D;return P<this.head.data.length?(D=this.head.data.slice(0,P),this.head.data=this.head.data.slice(P)):P===this.head.data.length?D=this.shift():D=B?this._getString(P):this._getBuffer(P),D}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(P){var B=this.head,D=1,L=B.data;for(P-=L.length;B=B.next;){var X=B.data,ie=P>X.length?X.length:P;if(ie===X.length?L+=X:L+=X.slice(0,P),P-=ie,P===0){ie===X.length?(++D,B.next?this.head=B.next:this.head=this.tail=null):(this.head=B,B.data=X.slice(ie));break}++D}return this.length-=D,L}},{key:"_getBuffer",value:function(P){var B=w.allocUnsafe(P),D=this.head,L=1;for(D.data.copy(B),P-=D.data.length;D=D.next;){var X=D.data,ie=P>X.length?X.length:P;if(X.copy(B,B.length-P,0,ie),P-=ie,P===0){ie===X.length?(++L,D.next?this.head=D.next:this.head=this.tail=null):(this.head=D,D.data=X.slice(ie));break}++L}return this.length-=L,B}},{key:m,value:function(P,B){return E(this,g({},B,{depth:0,customInspect:!1}))}}]),T}()},1029:(r,s,f)=>{var h=f(4155);function g(w,S){var E=this,m=this._readableState&&this._readableState.destroyed,_=this._writableState&&this._writableState.destroyed;return m||_?(S?S(w):w&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,h.nextTick(b,this,w)):h.nextTick(b,this,w)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(w||null,function(T){!S&&T?E._writableState?E._writableState.errorEmitted?h.nextTick(d,E):(E._writableState.errorEmitted=!0,h.nextTick(u,E,T)):h.nextTick(u,E,T):S?(h.nextTick(d,E),S(T)):h.nextTick(d,E)}),this)}function u(w,S){b(w,S),d(w)}function d(w){w._writableState&&!w._writableState.emitClose||w._readableState&&!w._readableState.emitClose||w.emit("close")}function a(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function b(w,S){w.emit("error",S)}function v(w,S){var E=w._readableState,m=w._writableState;E&&E.autoDestroy||m&&m.autoDestroy?w.destroy(S):w.emit("error",S)}r.exports={destroy:g,undestroy:a,errorOrDestroy:v}},1086:(r,s,f)=>{var h=f(8106).q.ERR_STREAM_PREMATURE_CLOSE;function g(b){var v=!1;return function(){if(!v){v=!0;for(var w=arguments.length,S=new Array(w),E=0;E<w;E++)S[E]=arguments[E];b.apply(this,S)}}}function u(){}function d(b){return b.setHeader&&typeof b.abort=="function"}function a(b,v,w){if(typeof v=="function")return a(b,null,v);v||(v={}),w=g(w||u);var S=v.readable||v.readable!==!1&&b.readable,E=v.writable||v.writable!==!1&&b.writable,m=function(){b.writable||T()},_=b._writableState&&b._writableState.finished,T=function(){E=!1,_=!0,S||w.call(b)},M=b._readableState&&b._readableState.endEmitted,P=function(){S=!1,M=!0,E||w.call(b)},B=function(ie){w.call(b,ie)},D=function(){var ie;if(S&&!M)return(!b._readableState||!b._readableState.ended)&&(ie=new h),w.call(b,ie);if(E&&!_)return(!b._writableState||!b._writableState.ended)&&(ie=new h),w.call(b,ie)},L=function(){b.req.on("finish",T)};return d(b)?(b.on("complete",T),b.on("abort",D),b.req?L():b.on("request",L)):E&&!b._writableState&&(b.on("end",m),b.on("close",m)),b.on("end",P),b.on("finish",T),v.error!==!1&&b.on("error",B),b.on("close",D),function(){b.removeListener("complete",T),b.removeListener("abort",D),b.removeListener("request",L),b.req&&b.req.removeListener("finish",T),b.removeListener("end",m),b.removeListener("close",m),b.removeListener("finish",T),b.removeListener("end",P),b.removeListener("error",B),b.removeListener("close",D)}}r.exports=a},1265:r=>{r.exports=function(){throw new Error("Readable.from is not available in the browser")}},6472:(r,s,f)=>{var h;function g(T){var M=!1;return function(){M||(M=!0,T.apply(void 0,arguments))}}var u=f(8106).q,d=u.ERR_MISSING_ARGS,a=u.ERR_STREAM_DESTROYED;function b(T){if(T)throw T}function v(T){return T.setHeader&&typeof T.abort=="function"}function w(T,M,P,B){B=g(B);var D=!1;T.on("close",function(){D=!0}),h===void 0&&(h=f(1086)),h(T,{readable:M,writable:P},function(X){if(X)return B(X);D=!0,B()});var L=!1;return function(X){if(!D&&!L){if(L=!0,v(T))return T.abort();if(typeof T.destroy=="function")return T.destroy();B(X||new a("pipe"))}}}function S(T){T()}function E(T,M){return T.pipe(M)}function m(T){return!T.length||typeof T[T.length-1]!="function"?b:T.pop()}function _(){for(var T=arguments.length,M=new Array(T),P=0;P<T;P++)M[P]=arguments[P];var B=m(M);if(Array.isArray(M[0])&&(M=M[0]),M.length<2)throw new d("streams");var D,L=M.map(function(X,ie){var ue=ie<M.length-1,fe=ie>0;return w(X,ue,fe,function(q){D||(D=q),q&&L.forEach(S),!ue&&(L.forEach(S),B(D))})});return M.reduce(E)}r.exports=_},94:(r,s,f)=>{var h=f(8106).q.ERR_INVALID_OPT_VALUE;function g(d,a,b){return d.highWaterMark!=null?d.highWaterMark:a?d[b]:null}function u(d,a,b,v){var w=g(a,v,b);if(w!=null){if(!(isFinite(w)&&Math.floor(w)===w)||w<0){var S=v?b:"highWaterMark";throw new h(S,w)}return Math.floor(w)}return d.objectMode?16:16384}r.exports={getHighWaterMark:u}},3194:(r,s,f)=>{r.exports=f(7187).EventEmitter},2553:(r,s,f)=>{var h=f(9509).Buffer,g=h.isEncoding||function(L){switch(L=""+L,L&&L.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function u(L){if(!L)return"utf8";for(var X;;)switch(L){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return L;default:if(X)return;L=(""+L).toLowerCase(),X=!0}}function d(L){var X=u(L);if(typeof X!="string"&&(h.isEncoding===g||!g(L)))throw new Error("Unknown encoding: "+L);return X||L}s.s=a;function a(L){this.encoding=d(L);var X;switch(this.encoding){case"utf16le":this.text=_,this.end=T,X=4;break;case"utf8":this.fillLast=S,X=4;break;case"base64":this.text=M,this.end=P,X=3;break;default:this.write=B,this.end=D;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=h.allocUnsafe(X)}a.prototype.write=function(L){if(L.length===0)return"";var X,ie;if(this.lastNeed){if(X=this.fillLast(L),X===void 0)return"";ie=this.lastNeed,this.lastNeed=0}else ie=0;return ie<L.length?X?X+this.text(L,ie):this.text(L,ie):X||""},a.prototype.end=m,a.prototype.text=E,a.prototype.fillLast=function(L){if(this.lastNeed<=L.length)return L.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);L.copy(this.lastChar,this.lastTotal-this.lastNeed,0,L.length),this.lastNeed-=L.length};function b(L){return L<=127?0:L>>5===6?2:L>>4===14?3:L>>3===30?4:L>>6===2?-1:-2}function v(L,X,ie){var ue=X.length-1;if(ue<ie)return 0;var fe=b(X[ue]);return fe>=0?(fe>0&&(L.lastNeed=fe-1),fe):--ue<ie||fe===-2?0:(fe=b(X[ue]),fe>=0?(fe>0&&(L.lastNeed=fe-2),fe):--ue<ie||fe===-2?0:(fe=b(X[ue]),fe>=0?(fe>0&&(fe===2?fe=0:L.lastNeed=fe-3),fe):0))}function w(L,X,ie){if((X[0]&192)!==128)return L.lastNeed=0,"\uFFFD";if(L.lastNeed>1&&X.length>1){if((X[1]&192)!==128)return L.lastNeed=1,"\uFFFD";if(L.lastNeed>2&&X.length>2&&(X[2]&192)!==128)return L.lastNeed=2,"\uFFFD"}}function S(L){var X=this.lastTotal-this.lastNeed,ie=w(this,L);if(ie!==void 0)return ie;if(this.lastNeed<=L.length)return L.copy(this.lastChar,X,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);L.copy(this.lastChar,X,0,L.length),this.lastNeed-=L.length}function E(L,X){var ie=v(this,L,X);if(!this.lastNeed)return L.toString("utf8",X);this.lastTotal=ie;var ue=L.length-(ie-this.lastNeed);return L.copy(this.lastChar,0,ue),L.toString("utf8",X,ue)}function m(L){var X=L&&L.length?this.write(L):"";return this.lastNeed?X+"\uFFFD":X}function _(L,X){if((L.length-X)%2===0){var ie=L.toString("utf16le",X);if(ie){var ue=ie.charCodeAt(ie.length-1);if(ue>=55296&&ue<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=L[L.length-2],this.lastChar[1]=L[L.length-1],ie.slice(0,-1)}return ie}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=L[L.length-1],L.toString("utf16le",X,L.length-1)}function T(L){var X=L&&L.length?this.write(L):"";if(this.lastNeed){var ie=this.lastTotal-this.lastNeed;return X+this.lastChar.toString("utf16le",0,ie)}return X}function M(L,X){var ie=(L.length-X)%3;return ie===0?L.toString("base64",X):(this.lastNeed=3-ie,this.lastTotal=3,ie===1?this.lastChar[0]=L[L.length-1]:(this.lastChar[0]=L[L.length-2],this.lastChar[1]=L[L.length-1]),L.toString("base64",X,L.length-ie))}function P(L){var X=L&&L.length?this.write(L):"";return this.lastNeed?X+this.lastChar.toString("base64",0,3-this.lastNeed):X}function B(L){return L.toString(this.encoding)}function D(L){return L&&L.length?this.write(L):""}},4927:(r,s,f)=>{r.exports=h;function h(u,d){if(g("noDeprecation"))return u;var a=!1;function b(){if(!a){if(g("throwDeprecation"))throw new Error(d);g("traceDeprecation")?console.trace(d):console.warn(d),a=!0}return u.apply(this,arguments)}return b}function g(u){try{if(!f.g.localStorage)return!1}catch{return!1}var d=f.g.localStorage[u];return d==null?!1:String(d).toLowerCase()==="true"}},384:r=>{r.exports=function(f){return f&&typeof f=="object"&&typeof f.copy=="function"&&typeof f.fill=="function"&&typeof f.readUInt8=="function"}},5955:(r,s,f)=>{var h=f(2584),g=f(8662),u=f(6430),d=f(5692);function a(Ae){return Ae.call.bind(Ae)}var b=typeof BigInt!="undefined",v=typeof Symbol!="undefined",w=a(Object.prototype.toString),S=a(Number.prototype.valueOf),E=a(String.prototype.valueOf),m=a(Boolean.prototype.valueOf);if(b)var _=a(BigInt.prototype.valueOf);if(v)var T=a(Symbol.prototype.valueOf);function M(Ae,Be){if(typeof Ae!="object")return!1;try{return Be(Ae),!0}catch{return!1}}s.isArgumentsObject=h,s.isGeneratorFunction=g,s.isTypedArray=d;function P(Ae){return typeof Promise!="undefined"&&Ae instanceof Promise||Ae!==null&&typeof Ae=="object"&&typeof Ae.then=="function"&&typeof Ae.catch=="function"}s.isPromise=P;function B(Ae){return typeof ArrayBuffer!="undefined"&&ArrayBuffer.isView?ArrayBuffer.isView(Ae):d(Ae)||le(Ae)}s.isArrayBufferView=B;function D(Ae){return u(Ae)==="Uint8Array"}s.isUint8Array=D;function L(Ae){return u(Ae)==="Uint8ClampedArray"}s.isUint8ClampedArray=L;function X(Ae){return u(Ae)==="Uint16Array"}s.isUint16Array=X;function ie(Ae){return u(Ae)==="Uint32Array"}s.isUint32Array=ie;function ue(Ae){return u(Ae)==="Int8Array"}s.isInt8Array=ue;function fe(Ae){return u(Ae)==="Int16Array"}s.isInt16Array=fe;function q(Ae){return u(Ae)==="Int32Array"}s.isInt32Array=q;function G(Ae){return u(Ae)==="Float32Array"}s.isFloat32Array=G;function Y(Ae){return u(Ae)==="Float64Array"}s.isFloat64Array=Y;function J(Ae){return u(Ae)==="BigInt64Array"}s.isBigInt64Array=J;function A(Ae){return u(Ae)==="BigUint64Array"}s.isBigUint64Array=A;function C(Ae){return w(Ae)==="[object Map]"}C.working=typeof Map!="undefined"&&C(new Map);function N(Ae){return typeof Map=="undefined"?!1:C.working?C(Ae):Ae instanceof Map}s.isMap=N;function U(Ae){return w(Ae)==="[object Set]"}U.working=typeof Set!="undefined"&&U(new Set);function R(Ae){return typeof Set=="undefined"?!1:U.working?U(Ae):Ae instanceof Set}s.isSet=R;function H(Ae){return w(Ae)==="[object WeakMap]"}H.working=typeof WeakMap!="undefined"&&H(new WeakMap);function W(Ae){return typeof WeakMap=="undefined"?!1:H.working?H(Ae):Ae instanceof WeakMap}s.isWeakMap=W;function ae(Ae){return w(Ae)==="[object WeakSet]"}ae.working=typeof WeakSet!="undefined"&&ae(new WeakSet);function ge(Ae){return ae(Ae)}s.isWeakSet=ge;function xe(Ae){return w(Ae)==="[object ArrayBuffer]"}xe.working=typeof ArrayBuffer!="undefined"&&xe(new ArrayBuffer);function we(Ae){return typeof ArrayBuffer=="undefined"?!1:xe.working?xe(Ae):Ae instanceof ArrayBuffer}s.isArrayBuffer=we;function be(Ae){return w(Ae)==="[object DataView]"}be.working=typeof ArrayBuffer!="undefined"&&typeof DataView!="undefined"&&be(new DataView(new ArrayBuffer(1),0,1));function le(Ae){return typeof DataView=="undefined"?!1:be.working?be(Ae):Ae instanceof DataView}s.isDataView=le;function pe(Ae){return w(Ae)==="[object SharedArrayBuffer]"}pe.working=typeof SharedArrayBuffer!="undefined"&&pe(new SharedArrayBuffer);function me(Ae){return typeof SharedArrayBuffer=="undefined"?!1:pe.working?pe(Ae):Ae instanceof SharedArrayBuffer}s.isSharedArrayBuffer=me;function te(Ae){return w(Ae)==="[object AsyncFunction]"}s.isAsyncFunction=te;function de(Ae){return w(Ae)==="[object Map Iterator]"}s.isMapIterator=de;function Z(Ae){return w(Ae)==="[object Set Iterator]"}s.isSetIterator=Z;function Q(Ae){return w(Ae)==="[object Generator]"}s.isGeneratorObject=Q;function ve(Ae){return w(Ae)==="[object WebAssembly.Module]"}s.isWebAssemblyCompiledModule=ve;function Se(Ae){return M(Ae,S)}s.isNumberObject=Se;function Re(Ae){return M(Ae,E)}s.isStringObject=Re;function ne(Ae){return M(Ae,m)}s.isBooleanObject=ne;function re(Ae){return b&&M(Ae,_)}s.isBigIntObject=re;function Ce(Ae){return v&&M(Ae,T)}s.isSymbolObject=Ce;function Me(Ae){return Se(Ae)||Re(Ae)||ne(Ae)||re(Ae)||Ce(Ae)}s.isBoxedPrimitive=Me;function ke(Ae){return typeof Uint8Array!="undefined"&&(we(Ae)||me(Ae))}s.isAnyArrayBuffer=ke,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(Ae){Object.defineProperty(s,Ae,{enumerable:!1,value:function(){throw new Error(Ae+" is not supported in userland")}})})},9539:(r,s,f)=>{var h=f(4155),g=Object.getOwnPropertyDescriptors||function(pe){for(var me=Object.keys(pe),te={},de=0;de<me.length;de++)te[me[de]]=Object.getOwnPropertyDescriptor(pe,me[de]);return te},u=/%[sdj%]/g;s.format=function(le){if(!fe(le)){for(var pe=[],me=0;me<arguments.length;me++)pe.push(v(arguments[me]));return pe.join(" ")}for(var me=1,te=arguments,de=te.length,Z=String(le).replace(u,function(ve){if(ve==="%%")return"%";if(me>=de)return ve;switch(ve){case"%s":return String(te[me++]);case"%d":return Number(te[me++]);case"%j":try{return JSON.stringify(te[me++])}catch{return"[Circular]"}default:return ve}}),Q=te[me];me<de;Q=te[++me])X(Q)||!J(Q)?Z+=" "+Q:Z+=" "+v(Q);return Z},s.deprecate=function(le,pe){if(typeof h!="undefined"&&h.noDeprecation===!0)return le;if(typeof h=="undefined")return function(){return s.deprecate(le,pe).apply(this,arguments)};var me=!1;function te(){if(!me){if(h.throwDeprecation)throw new Error(pe);h.traceDeprecation?console.trace(pe):console.error(pe),me=!0}return le.apply(this,arguments)}return te};var d={},a=/^$/;if({}.NODE_DEBUG){var b={}.NODE_DEBUG;b=b.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),a=new RegExp("^"+b+"$","i")}s.debuglog=function(le){if(le=le.toUpperCase(),!d[le])if(a.test(le)){var pe=h.pid;d[le]=function(){var me=s.format.apply(s,arguments);console.error("%s %d: %s",le,pe,me)}}else d[le]=function(){};return d[le]};function v(le,pe){var me={seen:[],stylize:S};return arguments.length>=3&&(me.depth=arguments[2]),arguments.length>=4&&(me.colors=arguments[3]),L(pe)?me.showHidden=pe:pe&&s._extend(me,pe),G(me.showHidden)&&(me.showHidden=!1),G(me.depth)&&(me.depth=2),G(me.colors)&&(me.colors=!1),G(me.customInspect)&&(me.customInspect=!0),me.colors&&(me.stylize=w),m(me,le,me.depth)}s.inspect=v,v.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},v.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function w(le,pe){var me=v.styles[pe];return me?"\x1B["+v.colors[me][0]+"m"+le+"\x1B["+v.colors[me][1]+"m":le}function S(le,pe){return le}function E(le){var pe={};return le.forEach(function(me,te){pe[me]=!0}),pe}function m(le,pe,me){if(le.customInspect&&pe&&N(pe.inspect)&&pe.inspect!==s.inspect&&!(pe.constructor&&pe.constructor.prototype===pe)){var te=pe.inspect(me,le);return fe(te)||(te=m(le,te,me)),te}var de=_(le,pe);if(de)return de;var Z=Object.keys(pe),Q=E(Z);if(le.showHidden&&(Z=Object.getOwnPropertyNames(pe)),C(pe)&&(Z.indexOf("message")>=0||Z.indexOf("description")>=0))return T(pe);if(Z.length===0){if(N(pe)){var ve=pe.name?": "+pe.name:"";return le.stylize("[Function"+ve+"]","special")}if(Y(pe))return le.stylize(RegExp.prototype.toString.call(pe),"regexp");if(A(pe))return le.stylize(Date.prototype.toString.call(pe),"date");if(C(pe))return T(pe)}var Se="",Re=!1,ne=["{","}"];if(D(pe)&&(Re=!0,ne=["[","]"]),N(pe)){var re=pe.name?": "+pe.name:"";Se=" [Function"+re+"]"}if(Y(pe)&&(Se=" "+RegExp.prototype.toString.call(pe)),A(pe)&&(Se=" "+Date.prototype.toUTCString.call(pe)),C(pe)&&(Se=" "+T(pe)),Z.length===0&&(!Re||pe.length==0))return ne[0]+Se+ne[1];if(me<0)return Y(pe)?le.stylize(RegExp.prototype.toString.call(pe),"regexp"):le.stylize("[Object]","special");le.seen.push(pe);var Ce;return Re?Ce=M(le,pe,me,Q,Z):Ce=Z.map(function(Me){return P(le,pe,me,Q,Me,Re)}),le.seen.pop(),B(Ce,Se,ne)}function _(le,pe){if(G(pe))return le.stylize("undefined","undefined");if(fe(pe)){var me="'"+JSON.stringify(pe).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return le.stylize(me,"string")}if(ue(pe))return le.stylize(""+pe,"number");if(L(pe))return le.stylize(""+pe,"boolean");if(X(pe))return le.stylize("null","null")}function T(le){return"["+Error.prototype.toString.call(le)+"]"}function M(le,pe,me,te,de){for(var Z=[],Q=0,ve=pe.length;Q<ve;++Q)ge(pe,String(Q))?Z.push(P(le,pe,me,te,String(Q),!0)):Z.push("");return de.forEach(function(Se){Se.match(/^\d+$/)||Z.push(P(le,pe,me,te,Se,!0))}),Z}function P(le,pe,me,te,de,Z){var Q,ve,Se;if(Se=Object.getOwnPropertyDescriptor(pe,de)||{value:pe[de]},Se.get?Se.set?ve=le.stylize("[Getter/Setter]","special"):ve=le.stylize("[Getter]","special"):Se.set&&(ve=le.stylize("[Setter]","special")),ge(te,de)||(Q="["+de+"]"),ve||(le.seen.indexOf(Se.value)<0?(X(me)?ve=m(le,Se.value,null):ve=m(le,Se.value,me-1),ve.indexOf(`
`)>-1&&(Z?ve=ve.split(`
`).map(function(Re){return"  "+Re}).join(`
`).substr(2):ve=`
`+ve.split(`
`).map(function(Re){return"   "+Re}).join(`
`))):ve=le.stylize("[Circular]","special")),G(Q)){if(Z&&de.match(/^\d+$/))return ve;Q=JSON.stringify(""+de),Q.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(Q=Q.substr(1,Q.length-2),Q=le.stylize(Q,"name")):(Q=Q.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),Q=le.stylize(Q,"string"))}return Q+": "+ve}function B(le,pe,me){var te=le.reduce(function(de,Z){return Z.indexOf(`
`)>=0,de+Z.replace(/\u001b\[\d\d?m/g,"").length+1},0);return te>60?me[0]+(pe===""?"":pe+`
 `)+" "+le.join(`,
  `)+" "+me[1]:me[0]+pe+" "+le.join(", ")+" "+me[1]}s.types=f(5955);function D(le){return Array.isArray(le)}s.isArray=D;function L(le){return typeof le=="boolean"}s.isBoolean=L;function X(le){return le===null}s.isNull=X;function ie(le){return le==null}s.isNullOrUndefined=ie;function ue(le){return typeof le=="number"}s.isNumber=ue;function fe(le){return typeof le=="string"}s.isString=fe;function q(le){return typeof le=="symbol"}s.isSymbol=q;function G(le){return le===void 0}s.isUndefined=G;function Y(le){return J(le)&&R(le)==="[object RegExp]"}s.isRegExp=Y,s.types.isRegExp=Y;function J(le){return typeof le=="object"&&le!==null}s.isObject=J;function A(le){return J(le)&&R(le)==="[object Date]"}s.isDate=A,s.types.isDate=A;function C(le){return J(le)&&(R(le)==="[object Error]"||le instanceof Error)}s.isError=C,s.types.isNativeError=C;function N(le){return typeof le=="function"}s.isFunction=N;function U(le){return le===null||typeof le=="boolean"||typeof le=="number"||typeof le=="string"||typeof le=="symbol"||typeof le=="undefined"}s.isPrimitive=U,s.isBuffer=f(384);function R(le){return Object.prototype.toString.call(le)}function H(le){return le<10?"0"+le.toString(10):le.toString(10)}var W=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ae(){var le=new Date,pe=[H(le.getHours()),H(le.getMinutes()),H(le.getSeconds())].join(":");return[le.getDate(),W[le.getMonth()],pe].join(" ")}s.log=function(){console.log("%s - %s",ae(),s.format.apply(s,arguments))},s.inherits=f(5717),s._extend=function(le,pe){if(!pe||!J(pe))return le;for(var me=Object.keys(pe),te=me.length;te--;)le[me[te]]=pe[me[te]];return le};function ge(le,pe){return Object.prototype.hasOwnProperty.call(le,pe)}var xe=typeof Symbol!="undefined"?Symbol("util.promisify.custom"):void 0;s.promisify=function(pe){if(typeof pe!="function")throw new TypeError('The "original" argument must be of type Function');if(xe&&pe[xe]){var me=pe[xe];if(typeof me!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(me,xe,{value:me,enumerable:!1,writable:!1,configurable:!0}),me}function me(){for(var te,de,Z=new Promise(function(Se,Re){te=Se,de=Re}),Q=[],ve=0;ve<arguments.length;ve++)Q.push(arguments[ve]);Q.push(function(Se,Re){Se?de(Se):te(Re)});try{pe.apply(this,Q)}catch(Se){de(Se)}return Z}return Object.setPrototypeOf(me,Object.getPrototypeOf(pe)),xe&&Object.defineProperty(me,xe,{value:me,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(me,g(pe))},s.promisify.custom=xe;function we(le,pe){if(!le){var me=new Error("Promise was rejected with a falsy value");me.reason=le,le=me}return pe(le)}function be(le){if(typeof le!="function")throw new TypeError('The "original" argument must be of type Function');function pe(){for(var me=[],te=0;te<arguments.length;te++)me.push(arguments[te]);var de=me.pop();if(typeof de!="function")throw new TypeError("The last argument must be of type Function");var Z=this,Q=function(){return de.apply(Z,arguments)};le.apply(this,me).then(function(ve){h.nextTick(Q.bind(null,null,ve))},function(ve){h.nextTick(we.bind(null,ve,Q))})}return Object.setPrototypeOf(pe,Object.getPrototypeOf(le)),Object.defineProperties(pe,g(le)),pe}s.callbackify=be},6430:(r,s,f)=>{var h=f(9804),g=f(6314),u=f(1924),d=u("Object.prototype.toString"),a=f(1405)(),b=a&&typeof Symbol.toStringTag=="symbol",v=g(),w=u("String.prototype.slice"),S={},E=f(4079),m=Object.getPrototypeOf;b&&E&&m&&h(v,function(M){if(typeof f.g[M]=="function"){var P=new f.g[M];if(!(Symbol.toStringTag in P))throw new EvalError("this engine has support for Symbol.toStringTag, but "+M+" does not have the property! Please report this.");var B=m(P),D=E(B,Symbol.toStringTag);if(!D){var L=m(B);D=E(L,Symbol.toStringTag)}S[M]=D.get}});var _=function(P){var B=!1;return h(S,function(D,L){if(!B)try{var X=D.call(P);X===L&&(B=X)}catch{}}),B},T=f(5692);r.exports=function(P){return T(P)?b?_(P):w(d(P),8,-1):!1}},594:()=>{},6615:()=>{},1758:()=>{}},o={};function t(r){if(o[r])return o[r].exports;var s=o[r]={id:r,loaded:!1,exports:{}};return e[r].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}return t.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),t.nmd=r=>(r.paths=[],r.children||(r.children=[]),r),t(8860)})();function getContent(){return new Promise(async(e,o)=>{const t=await fetch("./hex/StandardFirmata.hex");e(t.arrayBuffer())})}async function flash(){const e=await getContent();console.log(e),console.log("filecontents",e);const o="uno";new AvrgirlArduino({board:o,debug:!0}).flash(e,r=>{r?console.error(r,r.message):console.info("done correctly.")})}function get_each_context(e,o,t){const r=e.slice();return r[7]=o[t],r}function create_default_slot_2$1(e){let o;return{c(){o=text("sidebar")},m(t,r){insert(t,o,r)},d(t){t&&detach(o)}}}function create_each_block(e){let o,t=e[7]+"",r,s;return{c(){o=element("li"),r=text(t),s=space()},m(f,h){insert(f,o,h),append(o,r),append(o,s)},p(f,h){h&1&&t!==(t=f[7]+"")&&set_data(r,t)},d(f){f&&detach(o)}}}function create_default_slot_1$1(e){let o,t,r,s,f,h,g,u,d,a,b,v,w,S,E,m=e[0],_=[];for(let T=0;T<m.length;T+=1)_[T]=create_each_block(get_each_context(e,m,T));return{c(){o=element("button"),o.textContent="start",t=space(),r=element("button"),r.textContent="toggle led",s=space(),f=element("button"),f.textContent="read AD",h=space(),g=element("button"),g.textContent="reset",u=space(),d=element("button"),d.textContent="close",a=space(),b=element("button"),b.textContent="flash",v=space(),w=element("ul");for(let T=0;T<_.length;T+=1)_[T].c();attr(o,"class","btn btn-primary"),attr(r,"class","btn btn-primary"),attr(f,"class","btn btn-primary"),attr(g,"class","btn btn-primary"),attr(d,"class","btn btn-primary"),attr(b,"class","btn btn-primary")},m(T,M){insert(T,o,M),insert(T,t,M),insert(T,r,M),insert(T,s,M),insert(T,f,M),insert(T,h,M),insert(T,g,M),insert(T,u,M),insert(T,d,M),insert(T,a,M),insert(T,b,M),insert(T,v,M),insert(T,w,M);for(let P=0;P<_.length;P+=1)_[P].m(w,null);S||(E=[listen(o,"click",e[1]),listen(r,"click",e[2]),listen(f,"click",e[3]),listen(g,"click",e[4]),listen(d,"click",e[5]),listen(b,"click",e[6])],S=!0)},p(T,M){if(M&1){m=T[0];let P;for(P=0;P<m.length;P+=1){const B=get_each_context(T,m,P);_[P]?_[P].p(B,M):(_[P]=create_each_block(B),_[P].c(),_[P].m(w,null))}for(;P<_.length;P+=1)_[P].d(1);_.length=m.length}},d(T){T&&detach(o),T&&detach(t),T&&detach(r),T&&detach(s),T&&detach(f),T&&detach(h),T&&detach(g),T&&detach(u),T&&detach(d),T&&detach(a),T&&detach(b),T&&detach(v),T&&detach(w),destroy_each(_,T),S=!1,run_all(E)}}}function create_default_slot$1(e){let o,t,r,s;return o=new Col({props:{class:"border",$$slots:{default:[create_default_slot_2$1]},$$scope:{ctx:e}}}),r=new Col({props:{$$slots:{default:[create_default_slot_1$1]},$$scope:{ctx:e}}}),{c(){create_component(o.$$.fragment),t=space(),create_component(r.$$.fragment)},m(f,h){mount_component(o,f,h),insert(f,t,h),mount_component(r,f,h),s=!0},p(f,h){const g={};h&1024&&(g.$$scope={dirty:h,ctx:f}),o.$set(g);const u={};h&1025&&(u.$$scope={dirty:h,ctx:f}),r.$set(u)},i(f){s||(transition_in(o.$$.fragment,f),transition_in(r.$$.fragment,f),s=!0)},o(f){transition_out(o.$$.fragment,f),transition_out(r.$$.fragment,f),s=!1},d(f){destroy_component(o,f),f&&detach(t),destroy_component(r,f)}}}function create_fragment$2(e){let o,t,r,s;return o=new Styles({}),r=new Row({props:{$$slots:{default:[create_default_slot$1]},$$scope:{ctx:e}}}),{c(){create_component(o.$$.fragment),t=space(),create_component(r.$$.fragment)},m(f,h){mount_component(o,f,h),insert(f,t,h),mount_component(r,f,h),s=!0},p(f,[h]){const g={};h&1025&&(g.$$scope={dirty:h,ctx:f}),r.$set(g)},i(f){s||(transition_in(o.$$.fragment,f),transition_in(r.$$.fragment,f),s=!0)},o(f){transition_out(o.$$.fragment,f),transition_out(r.$$.fragment,f),s=!1},d(f){destroy_component(o,f),f&&detach(t),destroy_component(r,f)}}}function instance$1(e,o,t){let r=[];return ws.responseReceived$.subscribe(a=>{t(0,r=[...r,a.toString()])}),[r,()=>{ws.requestPort()},()=>{firmata.toggleLed()},()=>{firmata.readADC()},()=>{firmata.reset()},()=>{ws.close()},()=>{flash()}]}class Serial extends SvelteComponent{constructor(o){super(),init(this,o,instance$1,create_fragment$2,safe_not_equal,{})}}var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var dist={exports:{}},jsuites={exports:{}};(function(e,o){(function(t,r){e.exports=r()})(commonjsGlobal,function(){var t={},r="4.14.2",s=function(){document.jsuitesComponents=[];var u=function(D,L){return D[L.type]&&D[L.type]==L||D.component&&D.component==L?!0:D.parentNode?u(D.parentNode,L):!1},d=function(D){if(document.jsuitesComponents&&document.jsuitesComponents.length>0)for(var L=0;L<document.jsuitesComponents.length;L++)document.jsuitesComponents[L]&&!u(D,document.jsuitesComponents[L])&&document.jsuitesComponents[L].close()},a=15,b=null,v=!1,w={x:null,y:null},S=document.createElement("div");S.classList.add("jtooltip");var E=function(D){var L=t.findElement(D.target,"jpanel");if(L&&!L.classList.contains("readonly")){L.focus();var X=D.target.getBoundingClientRect();v={e:L,x:D.clientX,y:D.clientY,w:X.width,h:X.height,d:L.style.cursor,resizing:!!L.style.cursor,actioned:!1},L.style.width||(L.style.width=X.width+"px"),L.style.height||(L.style.height=X.height+"px");var ie=window.getSelection();if(ie.rangeCount)for(var ue=0;ue<ie.rangeCount;ue++)ie.removeRange(ie.getRangeAt(ue));D.preventDefault(),D.stopPropagation()}else v=!1;if(D.changedTouches&&D.changedTouches[0])var fe=D.changedTouches[0].clientX,q=D.changedTouches[0].clientY;else var fe=D.clientX,q=D.clientY;var G=D.path||D.composedPath&&D.composedPath();if(G)b=G[0];else{if(D.target&&D.target.shadowRoot)var Y=D.target.shadowRoot;else var Y=document;b=Y.elementFromPoint(fe,q)}d(b)},m=function(D){v&&v.e&&(typeof v.e.refresh=="function"&&w.actioned&&v.e.refresh(),v.e.style.cursor=""),w={x:null,y:null},v=!1},_=function(D){if(v){var L=D.clientX||D.pageX,X=D.clientY||D.pageY;if(v.resizing){var G=null,Y=null;if(v.d=="e-resize"||v.d=="ne-resize"||v.d=="se-resize")if(G=v.w+(L-v.x),v.e.style.width=G+"px",D.shiftKey){var J=(L-v.x)*(v.h/v.w);Y=v.h+J,v.e.style.height=Y+"px"}else var J=!1;J||(v.d=="s-resize"||v.d=="se-resize"||v.d=="sw-resize")&&(Y=v.h+(X-v.y),v.e.style.height=Y+"px"),typeof v.e.refresh=="function"&&(w.actioned=!0,v.e.refresh("dimensions",G,Y))}else{w.x==null&&w.y==null&&(w.x=L,w.y=X);var ie=L-w.x,ue=X-w.y,fe=v.e.offsetTop+ue,q=v.e.offsetLeft+ie;v.e.style.top=fe+"px",v.e.style.left=q+"px",v.e.style.cursor="move",w.x=L,w.y=X,typeof v.e.refresh=="function"&&(w.actioned=!0,v.e.refresh("position",fe,q))}}else{var A=t.findElement(D.target,"jpanel");if(A&&A.getAttribute("tabindex")){var C=A.getBoundingClientRect();D.clientY-C.top<a?C.width-(D.clientX-C.left)<a?A.style.cursor="ne-resize":D.clientX-C.left<a?A.style.cursor="nw-resize":A.style.cursor="n-resize":C.height-(D.clientY-C.top)<a?C.width-(D.clientX-C.left)<a?A.style.cursor="se-resize":D.clientX-C.left<a?A.style.cursor="sw-resize":A.style.cursor="s-resize":C.width-(D.clientX-C.left)<a?A.style.cursor="e-resize":D.clientX-C.left<a?A.style.cursor="w-resize":A.style.cursor=""}}},T=function(D){var L=D.target.getAttribute("data-tooltip");if(L){if(S.innerText=L,D.changedTouches&&D.changedTouches[0])var X=D.changedTouches[0].clientX,ie=D.changedTouches[0].clientY;else var X=D.clientX,ie=D.clientY;S.style.top=ie+"px",S.style.left=X+"px",document.body.appendChild(S)}else S.innerText&&(S.innerText="",document.body.removeChild(S))},M=function(D){var L=t.findElement(D.target,"jpanel");L&&typeof L.dblclick=="function"&&L.dblclick(D)},P=function(D){var L=document.activeElement;if(L&&typeof L.contextmenu=="function")L.contextmenu(D),D.preventDefault(),D.stopImmediatePropagation();else if(L=t.findElement(D.target,function(ie){return ie.tagName&&ie.getAttribute("aria-contextmenu-id")}),L){var X=document.querySelector("#"+L);X?(X.contextmenu.open(D),D.preventDefault(),D.stopImmediatePropagation()):console.error("JSUITES: contextmenu id not found: "+L)}},B=function(D){var L=document.activeElement;L&&D.key=="Delete"&&typeof L.delete=="function"&&(L.delete(),D.preventDefault(),D.stopImmediatePropagation()),document.jsuitesComponents&&document.jsuitesComponents.length&&(L=document.jsuitesComponents[document.jsuitesComponents.length-1])&&D.key=="Escape"&&typeof L.close=="function"&&(L.close(),D.preventDefault(),D.stopImmediatePropagation())};document.addEventListener("mouseup",m),document.addEventListener("mousedown",E),document.addEventListener("mousemove",_),document.addEventListener("mouseover",T),document.addEventListener("dblclick",M),document.addEventListener("keydown",B),document.addEventListener("contextmenu",P)};typeof document!="undefined"&&!document.jsuitesComponents&&s(),t.version=r,t.setExtensions=function(u){if(typeof u=="object")for(var d=Object.keys(u),a=0;a<d.length;a++)t[d[a]]=u[d[a]]},t.tracking=function(u,d){if(d==!0)document.jsuitesComponents=document.jsuitesComponents.filter(function(b){return b!==null}),setTimeout(function(){document.jsuitesComponents.push(u)},0);else{var a=document.jsuitesComponents.indexOf(u);a>=0&&document.jsuitesComponents.splice(a,1)}},t.path=function(u,d){if(u=u.split("."),u.length){for(var a=this,b=null;u.length>1;)if(b=u.shift(),a.hasOwnProperty(b))a=a[b];else{if(d===void 0)return;a[b]={},a=a[b]}if(b=u.shift(),d!==void 0)return a[b]=d,!0;if(a)return a[b]}return!1},t.setDictionary=function(u){document.dictionary||(document.dictionary={});for(var d=Object.keys(u),a=0;a<d.length;a++)document.dictionary[d[a]]=u[d[a]];for(var b=null,a=0;a<t.calendar.weekdays.length;a++)b=t.translate(t.calendar.weekdays[a]),t.calendar.weekdays[a]&&(t.calendar.weekdays[a]=b,t.calendar.weekdaysShort[a]=b.substr(0,3));for(var a=0;a<t.calendar.months.length;a++)b=t.translate(t.calendar.months[a]),b&&(t.calendar.months[a]=b,t.calendar.monthsShort[a]=b.substr(0,3))},t.translate=function(u){return document.dictionary&&document.dictionary[u]||u},t.ajax=function(u,d){if(Array.isArray(u)){var a={instance:[],complete:d};if(u.length>0)for(var b=0;b<u.length;b++)u[b].multiple=a,a.instance.push(t.ajax(u[b]));return a}if(u.data||(u.data={}),u.type&&(u.method=u.type),u.method||(u.method="GET"),u.dataType||(u.dataType="json"),u.data){var v=function(T,M){var P=[];if(T){var B=Object.keys(T);if(B.length)for(var D=0;D<B.length;D++){if(M)var L=M+"["+B[D]+"]";else var L=B[D];if(T[L]instanceof FileList)P[L]=T[B[D]];else if(T[B[D]]===null||T[B[D]]===void 0)P[L]="";else if(typeof T[B[D]]=="object")for(var X=v(T[B[D]],L),ie=Object.keys(X),ue=0;ue<ie.length;ue++)P[ie[ue]]=X[ie[ue]];else P[L]=T[B[D]]}}return P},w=v(u.data),S=Object.keys(w);if(u.method=="GET"){if(S.length){for(var E=[],b=0;b<S.length;b++)E.push(S[b]+"="+encodeURIComponent(w[S[b]]));u.url.indexOf("?")<0&&(u.url+="?"),u.url+=E.join("&")}}else for(var E=new FormData,b=0;b<S.length;b++)if(w[S[b]]instanceof FileList){if(w[S[b]].length)for(var m=0;m<w[S[b]].length;m++)E.append(S[b],w[S[b]][m],w[S[b]][m].name)}else E.append(S[b],w[S[b]])}var _=new XMLHttpRequest;return _.open(u.method,u.url,!0),_.setRequestHeader("X-Requested-With","XMLHttpRequest"),u.contentType&&_.setRequestHeader("Content-Type",u.contentType),u.method=="POST"?_.setRequestHeader("Accept","application/json"):u.dataType=="blob"?_.responseType="blob":u.contentType||(u.dataType=="json"?_.setRequestHeader("Content-Type","text/json"):u.dataType=="html"&&_.setRequestHeader("Content-Type","text/html")),u.cache!=!0&&(_.setRequestHeader("pragma","no-cache"),_.setRequestHeader("cache-control","no-cache")),u.withCredentials==!0&&(_.withCredentials=!0),typeof u.beforeSend=="function"&&u.beforeSend(_),typeof t.ajax.beforeSend=="function"&&t.ajax.beforeSend(_),document.ajax&&typeof document.ajax.beforeSend=="function"&&document.ajax.beforeSend(_),_.onload=function(){if(_.status===200)if(u.dataType=="json")try{var T=JSON.parse(_.responseText);u.success&&typeof u.success=="function"&&u.success(T)}catch(P){u.error&&typeof u.error=="function"&&u.error(P,T)}else{if(u.dataType=="blob")var T=_.response;else var T=_.responseText;u.success&&typeof u.success=="function"&&u.success(T)}else u.error&&typeof u.error=="function"&&u.error(_.responseText,_.status);if(t.ajax.queue&&t.ajax.queue.length>0&&t.ajax.send(t.ajax.queue.shift()),t.ajax.requests&&t.ajax.requests.length){var M=t.ajax.requests.indexOf(_);if(t.ajax.requests.splice(M,1),t.ajax.requests.length||u.complete&&typeof u.complete=="function"&&u.complete(T),u.group&&t.ajax.oncomplete&&typeof t.ajax.oncomplete[u.group]=="function"&&(t.ajax.pending(u.group)||(t.ajax.oncomplete[u.group](),t.ajax.oncomplete[u.group]=null)),u.multiple&&u.multiple.instance){var M=u.multiple.instance.indexOf(_);u.multiple.instance.splice(M,1),u.multiple.instance.length||u.multiple.complete&&typeof u.multiple.complete=="function"&&u.multiple.complete(T)}}},_.options=u,_.data=E,u.queue==!0&&t.ajax.requests.length>0?t.ajax.queue.push(_):t.ajax.send(_),_},t.ajax.send=function(u){u.data?Array.isArray(u.data)?u.send(u.data.join("&")):u.send(u.data):u.send(),t.ajax.requests.push(u)},t.ajax.exists=function(u,d){var a=new XMLHttpRequest;a.open("HEAD",u,!1),a.send(),a.status&&d(a.status)},t.ajax.pending=function(u){var d=0,a=t.ajax.requests;if(a&&a.length)for(var b=0;b<a.length;b++)(!u||u==a[b].options.group)&&d++;return d},t.ajax.oncomplete={},t.ajax.requests=[],t.ajax.queue=[],t.alert=function(u){t.getWindowWidth()<800&&t.dialog?t.dialog.open({title:"Alert",message:u}):alert(u)},t.animation={},t.animation.slideLeft=function(u,d,a){d==!0?(u.classList.add("slide-left-in"),setTimeout(function(){u.classList.remove("slide-left-in"),typeof a=="function"&&a()},400)):(u.classList.add("slide-left-out"),setTimeout(function(){u.classList.remove("slide-left-out"),typeof a=="function"&&a()},400))},t.animation.slideRight=function(u,d,a){d==!0?(u.classList.add("slide-right-in"),setTimeout(function(){u.classList.remove("slide-right-in"),typeof a=="function"&&a()},400)):(u.classList.add("slide-right-out"),setTimeout(function(){u.classList.remove("slide-right-out"),typeof a=="function"&&a()},400))},t.animation.slideTop=function(u,d,a){d==!0?(u.classList.add("slide-top-in"),setTimeout(function(){u.classList.remove("slide-top-in"),typeof a=="function"&&a()},400)):(u.classList.add("slide-top-out"),setTimeout(function(){u.classList.remove("slide-top-out"),typeof a=="function"&&a()},400))},t.animation.slideBottom=function(u,d,a){d==!0?(u.classList.add("slide-bottom-in"),setTimeout(function(){u.classList.remove("slide-bottom-in"),typeof a=="function"&&a()},400)):(u.classList.add("slide-bottom-out"),setTimeout(function(){u.classList.remove("slide-bottom-out"),typeof a=="function"&&a()},100))},t.animation.fadeIn=function(u,d){u.style.display="",u.classList.add("fade-in"),setTimeout(function(){u.classList.remove("fade-in"),typeof d=="function"&&d()},2e3)},t.animation.fadeOut=function(u,d){u.classList.add("fade-out"),setTimeout(function(){u.style.display="none",u.classList.remove("fade-out"),typeof d=="function"&&d()},1e3)},t.calendar=function(u,d){if(u.calendar)return u.calendar.setOptions(d,!0);var a={type:"calendar"};a.options={},a.date=null,a.setOptions=function(Y,J){var A={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:t.calendar.monthsShort,monthsFull:t.calendar.months,weekdays:t.calendar.weekdays,textDone:t.translate("Done"),textReset:t.translate("Reset"),textUpdate:t.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null};for(var C in A)Y&&Y.hasOwnProperty(C)?a.options[C]=Y[C]:(typeof a.options[C]=="undefined"||J===!0)&&(a.options[C]=A[C]);if(a.options.resetButton==!1?E.style.display="none":E.style.display="",a.options.readonly?u.setAttribute("readonly","readonly"):u.removeAttribute("readonly"),a.options.placeholder?u.setAttribute("placeholder",a.options.placeholder):u.removeAttribute("placeholder"),t.isNumeric(a.options.value)&&a.options.value>0&&(a.options.value=t.calendar.numToDate(a.options.value),a.options.dataType="numeric"),E.innerHTML=a.options.textReset,m.innerHTML=a.options.textDone,ue.innerHTML=a.options.textUpdate,u.setAttribute("data-mask",a.options.format.toLowerCase()),!a.options.value&&a.options.today)var N=t.calendar.now();else var N=a.options.value;return N&&(a.options.value=null,a.setValue(N)),a},a.open=function(Y){if(!S.classList.contains("jcalendar-focus")&&!S.classList.contains("jcalendar-inline")){if(t.calendar.current=a,t.tracking(a,!0),a.getDays(),a.options.type=="year-month-picker"&&a.getMonths(),a.options.time&&(fe.value=a.date[3],q.value=a.date[4]),S.classList.add("jcalendar-focus"),t.getWindowWidth()<800||a.options.fullscreen)S.classList.add("jcalendar-fullsize"),t.animation.slideBottom(T,1);else{S.classList.remove("jcalendar-fullsize");var J=u.getBoundingClientRect(),A=T.getBoundingClientRect();if(a.options.position)_.style.position="fixed",window.innerHeight<J.bottom+A.height?_.style.top=J.top-(A.height+2)+"px":_.style.top=J.top+J.height+2+"px",_.style.left=J.left+"px";else{if(window.innerHeight<J.bottom+A.height){var C=-1*(J.height+A.height+2);C+J.top<0&&(C=-1*(J.top+J.height)),_.style.top=C+"px"}else _.style.top=2+"px";if(window.innerWidth<J.left+A.width){var C=window.innerWidth-(J.left+A.width+20);_.style.left=C+"px"}else _.style.left="0px"}}typeof a.options.onopen=="function"&&a.options.onopen(u)}},a.close=function(Y,J){if(S.classList.contains("jcalendar-focus")){if(J!==!1){var A=S.querySelector(".jcalendar-selected");if(typeof J=="string")var C=J;else if(!A||A.classList.contains("jcalendar-disabled"))var C=a.options.value;else var C=a.getValue();a.setValue(C)}!Y&&typeof a.options.onclose=="function"&&a.options.onclose(u),S.classList.remove("jcalendar-focus"),t.tracking(a,!1),t.calendar.current=null}return a.options.value},a.prev=function(){a.options.mode=="years"?(a.date[0]=a.date[0]-12,a.getYears()):a.options.mode=="months"?(a.date[0]=parseInt(a.date[0])-1,a.getMonths()):(a.date[1]<2?(a.date[0]=a.date[0]-1,a.date[1]=12):a.date[1]=a.date[1]-1,a.getDays())},a.next=function(){a.options.mode=="years"?(a.date[0]=parseInt(a.date[0])+12,a.getYears()):a.options.mode=="months"?(a.date[0]=parseInt(a.date[0])+1,a.getMonths()):(a.date[1]>11?(a.date[0]=parseInt(a.date[0])+1,a.date[1]=1):a.date[1]=parseInt(a.date[1])+1,a.getDays())},a.setToday=function(){var Y=new Date().toISOString().substr(0,10);return a.setValue(Y),Y},a.setValue=function(Y){Y||(Y=""+Y);var J=Y,A=a.options.value;if(A!=J){if(J){a.setLabel(J,a.options);var N=J.split(" ");N[1]||(N[1]="00:00:00");var C=N[1].split(":"),N=N[0].split("-"),U=parseInt(N[0]),R=parseInt(N[1]),H=parseInt(N[2]),W=parseInt(C[0]),ae=parseInt(C[1]);a.date=[U,R,H,W,ae,0];var Y=a.setLabel(J,a.options)}else{a.date=null;var Y=""}a.options.value=J,typeof a.options.onchange=="function"&&a.options.onchange(u,J,A),u.value!=Y&&(u.value=Y,typeof u.oninput=="function"&&u.oninput({type:"input",target:u,value:u.value}))}a.getDays()},a.getValue=function(){return a.date?a.options.time?t.two(a.date[0])+"-"+t.two(a.date[1])+"-"+t.two(a.date[2])+" "+t.two(a.date[3])+":"+t.two(a.date[4])+":"+t.two(0):t.two(a.date[0])+"-"+t.two(a.date[1])+"-"+t.two(a.date[2])+" "+t.two(0)+":"+t.two(0)+":"+t.two(0):""},a.update=function(Y,J){if(!Y.classList.contains("jcalendar-disabled")){var A=S.querySelector(".jcalendar-selected");A&&A.classList.remove("jcalendar-selected"),Y.classList.add("jcalendar-selected"),Y.classList.contains("jcalendar-set-month")?(a.date[1]=J,a.date[2]=1):a.date[2]=Y.innerText,a.options.time?(a.date[3]=fe.value,a.date[4]=q.value):a.close()}w()},a.reset=function(){a.setValue(""),a.date=null,a.close(!1,!1)},a.getDays=function(){a.options.mode="days";var W=new Date,Y=a.date&&t.isNumeric(a.date[0])?a.date[0]:parseInt(W.getFullYear()),J=a.date&&t.isNumeric(a.date[1])?a.date[1]:parseInt(W.getMonth())+1,A=a.date&&t.isNumeric(a.date[2])?a.date[2]:parseInt(W.getDate()),C=a.date&&t.isNumeric(a.date[3])?a.date[3]:parseInt(W.getHours()),N=a.date&&t.isNumeric(a.date[4])?a.date[4]:parseInt(W.getMinutes());a.date=[Y,J,A,C,N,0],M.innerHTML=Y,P.innerHTML=a.options.months[J-1];var U=W.getMonth()==J-1&&W.getFullYear()==Y,R=W.getDate(),W=new Date(Y,J,0,0,0),H=W.getDate(),W=new Date(Y,J-1,0,0,0),ae=W.getDay()+1,be=a.options.startingDay||0;ae=ae-be,D.innerHTML="";var ge=document.createElement("tr");ge.setAttribute("align","center"),D.appendChild(ge);for(var xe=0;xe<7;xe++){var we=document.createElement("td");we.classList.add("jcalendar-weekday"),we.innerHTML=a.options.weekdays[be].substr(0,1),ge.appendChild(we),be++,be>6&&(be=0)}for(var be=0,le=0,pe=0;pe<6;pe++){var ge=document.createElement("tr");ge.setAttribute("align","center");for(var me=!0,xe=0;xe<7;xe++){var we=document.createElement("td");if(we.classList.add("jcalendar-set-day"),be>=ae&&be<ae+H){le++,we.innerHTML=le,le==A&&we.classList.add("jcalendar-selected"),U&&R==le&&(we.style.fontWeight="bold");var te=t.calendar.now(new Date(Y,J-1,le),!0);if(a.options.validRange){if(!a.options.validRange[0]||te>=a.options.validRange[0])var de=!0;else var de=!1;if(!a.options.validRange[1]||te<=a.options.validRange[1])var Z=!0;else var Z=!1;de&&Z||we.classList.add("jcalendar-disabled")}me=!1}ge.appendChild(we),be++}me==!1&&D.appendChild(ge)}a.options.time?X.style.display="":X.style.display="none",w()},a.getMonths=function(){a.options.mode="months";var Y=a.options.months;a.options.value;var J=new Date,A=parseInt(J.getFullYear()),C=parseInt(J.getMonth())+1,N=a.date&&t.isNumeric(a.date[0])?a.date[0]:A,U=a.date&&t.isNumeric(a.date[1])?a.date[1]:C;M.innerHTML=a.date[0],P.innerHTML=Y[U-1];var R=document.createElement("table");R.setAttribute("width","100%");for(var H=null,W=0;W<12;W++){if(!(W%4)){var H=document.createElement("tr");H.setAttribute("align","center"),R.appendChild(H)}var ae=document.createElement("td");if(ae.classList.add("jcalendar-set-month"),ae.setAttribute("data-value",W+1),ae.innerText=Y[W],a.options.validRange){var ge=N+"-"+t.two(W+1);if(!a.options.validRange[0]||ge>=a.options.validRange[0].substr(0,7))var xe=!0;else var xe=!1;if(!a.options.validRange[1]||ge<=a.options.validRange[1].substr(0,7))var we=!0;else var we=!1;xe&&we||ae.classList.add("jcalendar-disabled")}W+1==U&&ae.classList.add("jcalendar-selected"),A==N&&W+1==C&&(ae.style.fontWeight="bold"),H.appendChild(ae)}D.innerHTML='<tr><td colspan="7"></td></tr>',D.children[0].children[0].appendChild(R),w()},a.getYears=function(){a.options.mode="years";for(var Y=new Date,J=Y.getFullYear(),A=a.date&&t.isNumeric(a.date[0])?a.date[0]:parseInt(Y.getFullYear()),C=[],N=0;N<25;N++)C[N]=parseInt(a.date[0])+(N-12);var U=document.createElement("table");U.setAttribute("width","100%");for(var N=0;N<25;N++){if(!(N%5)){var R=document.createElement("tr");R.setAttribute("align","center"),U.appendChild(R)}var H=document.createElement("td");H.classList.add("jcalendar-set-year"),H.innerText=C[N],A==C[N]&&H.classList.add("jcalendar-selected"),J==C[N]&&(H.style.fontWeight="bold"),R.appendChild(H)}D.innerHTML='<tr><td colspan="7"></td></tr>',D.firstChild.firstChild.appendChild(U),w()},a.setLabel=function(Y,J){return t.calendar.getDateString(Y,J)},a.fromFormatted=function(Y,J){return t.calendar.extractDateFromString(Y,J)};var b=function(Y){var J=t.findElement(Y.target,"jcalendar-container");if(J){var A=Y.target.className;if(A=="jcalendar-prev")a.prev();else if(A=="jcalendar-next")a.next();else if(A=="jcalendar-month")a.getMonths();else if(A=="jcalendar-year")a.getYears();else if(A=="jcalendar-set-year")a.date[0]=Y.target.innerText,a.options.type=="year-month-picker"?a.getMonths():a.getDays();else if(Y.target.classList.contains("jcalendar-set-month")){var C=parseInt(Y.target.getAttribute("data-value"));a.options.type=="year-month-picker"?a.update(Y.target,C):(a.date[1]=C,a.getDays())}else A=="jcalendar-confirm"||A=="jcalendar-update"||A=="jcalendar-close"?a.close():A=="jcalendar-backdrop"?a.close(!1,!1):A=="jcalendar-reset"?a.reset():Y.target.classList.contains("jcalendar-set-day")&&Y.target.innerText&&a.update(Y.target)}else a.close()},v=function(Y){if(Y.target.value&&Y.target.value.length>3){var J=t.calendar.extractDateFromString(Y.target.value,a.options.format);J&&a.setValue(J)}},w=function(){var Y=S.querySelector(".jcalendar-selected");Y&&Y.classList.contains("jcalendar-disabled")?(ue.setAttribute("disabled","disabled"),fe.setAttribute("disabled","disabled"),q.setAttribute("disabled","disabled")):(ue.removeAttribute("disabled"),fe.removeAttribute("disabled"),q.removeAttribute("disabled")),typeof a.options.onupdate=="function"&&a.options.onupdate(u,a.getValue())},S=null,E=null,m=null,_=null,T=null,M=null,P=null,B=null,D=null,L=null,X=null,ie=null,ue=null,fe=null,q=null,G=function(){u.tagName=="INPUT"&&u.value&&(d.value=u.value),E=document.createElement("div"),E.className="jcalendar-reset",m=document.createElement("div"),m.className="jcalendar-confirm",L=document.createElement("div"),L.className="jcalendar-controls",L.style.borderBottom="1px solid #ddd",L.appendChild(E),L.appendChild(m),_=document.createElement("div"),_.className="jcalendar-container",T=document.createElement("div"),T.className="jcalendar-content",_.appendChild(T),u.tagName=="DIV"?(S=u,S.classList.add("jcalendar-inline")):(T.appendChild(L),S=document.createElement("div"),S.className="jcalendar"),S.classList.add("jcalendar-container"),S.appendChild(_);var Y=document.createElement("div");Y.className="jcalendar-table",T.appendChild(Y);var J=document.createElement("td");J.setAttribute("colspan","2"),J.className="jcalendar-prev",M=document.createElement("span"),M.className="jcalendar-year",P=document.createElement("span"),P.className="jcalendar-month";var A=document.createElement("td");A.className="jcalendar-header",A.setAttribute("colspan","3"),A.appendChild(P),A.appendChild(M);var C=document.createElement("td");C.setAttribute("colspan","2"),C.className="jcalendar-next";var N=document.createElement("thead"),U=document.createElement("tr");U.appendChild(J),U.appendChild(A),U.appendChild(C),N.appendChild(U),B=document.createElement("table"),D=document.createElement("tbody"),B.setAttribute("cellpadding","0"),B.setAttribute("cellspacing","0"),B.appendChild(N),B.appendChild(D),Y.appendChild(B),fe=document.createElement("select"),fe.className="jcalendar-select",fe.onchange=function(){a.date[3]=this.value,typeof a.options.onupdate=="function"&&a.options.onupdate(u,a.getValue())};for(var R=0;R<24;R++){var H=document.createElement("option");H.value=R,H.innerHTML=t.two(R),fe.appendChild(H)}q=document.createElement("select"),q.className="jcalendar-select",q.onchange=function(){a.date[4]=this.value,typeof a.options.onupdate=="function"&&a.options.onupdate(u,a.getValue())};for(var R=0;R<60;R++){var H=document.createElement("option");H.value=R,H.innerHTML=t.two(R),q.appendChild(H)}var W=document.createElement("div");W.className="jcalendar-controls",X=document.createElement("div"),X.className="jcalendar-time",X.style.maxWidth="140px",X.appendChild(fe),X.appendChild(q),ue=document.createElement("button"),ue.setAttribute("type","button"),ue.className="jcalendar-update",ie=document.createElement("div"),ie.style.flexGrow="10",ie.appendChild(ue),W.appendChild(X),u.tagName=="INPUT"&&W.appendChild(ie),T.appendChild(W);var ae=document.createElement("div");ae.className="jcalendar-backdrop",S.appendChild(ae),u.addEventListener("keyup",v),S.addEventListener("swipeleft",function(ge){t.animation.slideLeft(B,0,function(){a.next(),t.animation.slideRight(B,1)}),ge.preventDefault(),ge.stopPropagation()}),S.addEventListener("swiperight",function(ge){t.animation.slideRight(B,0,function(){a.prev(),t.animation.slideLeft(B,1)}),ge.preventDefault(),ge.stopPropagation()}),u.onmouseup=function(){a.open()},"ontouchend"in document.documentElement?S.addEventListener("touchend",b):S.addEventListener("mouseup",b),t.calendar.hasEvents||(t.calendar.hasEvents=!0,document.addEventListener("keydown",t.calendar.keydown)),a.setOptions(d),u.tagName=="INPUT"?(u.parentNode.insertBefore(S,u.nextSibling),u.setAttribute("autocomplete","off"),u.classList.add("jcalendar-input"),u.value=a.setLabel(a.getValue(),a.options)):(a.getDays(),a.options.time&&(fe.value=a.date[3],q.value=a.date[4])),a.options.opened==!0&&a.open(),u.change=a.setValue,u.val=function(ge){if(ge===void 0)return a.getValue();a.setValue(ge)},u.calendar=S.calendar=a};return G(),a},t.calendar.keydown=function(u){var d=null;(d=t.calendar.current)&&(u.which==13?d.close(!1,!0):u.which==27&&d.close(!1,!1))},t.calendar.prettify=function(u,d){if(!d)var d={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"};var a=new Date,b=new Date(u),v=parseInt((a-b)/1e3/60);if(String.prototype.format=function(S){return this.replace("{0}",S)},v==0)var w=d.justNow;else if(v<90)var w=d.xMinutesAgo.format(v);else if(v<1440)var w=d.xHoursAgo.format(Math.round(v/60));else if(v<20160)var w=d.xDaysAgo.format(Math.round(v/1440));else if(v<43200)var w=d.xWeeksAgo.format(Math.round(v/10080));else if(v<1036800)var w=d.xMonthsAgo.format(Math.round(v/43200));else var w=d.xYearsAgo.format(Math.round(v/525600));return w},t.calendar.prettifyAll=function(){for(var u=document.querySelectorAll(".prettydate"),d=0;d<u.length;d++)u[d].getAttribute("data-date")?u[d].innerHTML=t.calendar.prettify(u[d].getAttribute("data-date")):u[d].innerHTML&&(u[d].setAttribute("title",u[d].innerHTML),u[d].setAttribute("data-date",u[d].innerHTML),u[d].innerHTML=t.calendar.prettify(u[d].innerHTML))},t.calendar.now=function(u,d){if(Array.isArray(u))var a=u[0],b=u[1],v=u[2],w=u[3],S=u[4],E=u[5];else{if(!u)var u=new Date;var a=u.getFullYear(),b=u.getMonth()+1,v=u.getDate(),w=u.getHours(),S=u.getMinutes(),E=u.getSeconds()}return d==!0?t.two(a)+"-"+t.two(b)+"-"+t.two(v):t.two(a)+"-"+t.two(b)+"-"+t.two(v)+" "+t.two(w)+":"+t.two(S)+":"+t.two(E)},t.calendar.toArray=function(u){var a=u.split(u.indexOf("T")!==-1?"T":" "),d=a[1],a=a[0].split("-"),b=parseInt(a[0]),v=parseInt(a[1]),w=parseInt(a[2]);if(d)var d=d.split(":"),S=parseInt(d[0]),E=parseInt(d[1]);else var S=0,E=0;return[b,v,w,S,E,0]},t.calendar.extractDateFromString=function(u,d){if(u>0&&Number(u)==u){var a=new Date(Math.round((u-25569)*86400*1e3));return a.getFullYear()+"-"+t.two(a.getMonth())+"-"+t.two(a.getDate())+" 00:00:00"}var b=t.mask(u,{mask:d},!0);return b.date[0]&&b.date[1]?(b.date[2]||(b.date[2]=1),b.date[0]+"-"+t.two(b.date[1])+"-"+t.two(b.date[2])+" "+t.two(b.date[3])+":"+t.two(b.date[4])+":"+t.two(b.date[5])):""};var f=Date.UTC(1900,0,0),h=Date.UTC(1900,1,29),g=864e5;return t.calendar.dateToNum=function(u){typeof u=="string"&&(u=new Date(u+"  GMT+0"));var d=u.getTime();return d>=h&&(d+=g),d-=f,d/g},t.calendar.numToDate=function(u){var d=f+u*g;d>=h&&(d-=g);const a=new Date(d);var b=[a.getUTCFullYear(),a.getUTCMonth()+1,a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds()];return t.calendar.now(b)},t.calendar.getDateString=function(u,d){if(!d)var d={};if(d&&typeof d=="object")var a=d.format;else var a=d;if(a||(a="YYYY-MM-DD"),typeof u=="number"&&a.indexOf("[h]")>=0){var b=parseFloat(24*Number(u));if(a.indexOf("mm")>=0){var v=(""+b).split(".");if(v[1]){var w=60*parseFloat("0."+v[1]);w=parseFloat(w.toFixed(2))}else var w=0;b=parseInt(v[0])+":"+t.two(w)}return b}u instanceof Date?u=t.calendar.now(u):u&&t.isNumeric(u)&&(u=t.calendar.numToDate(u));for(var S=["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."],E=new RegExp(S.join("|"),"gi"),m=a.match(E),_=0;_<m.length;_++)m[_].toUpperCase()=="MM"&&(m[_-1]&&m[_-1].toUpperCase().indexOf("H")>=0||m[_-2]&&m[_-2].toUpperCase().indexOf("H")>=0||m[_+1]&&m[_+1].toUpperCase().indexOf("S")>=0||m[_+2]&&m[_+2].toUpperCase().indexOf("S")>=0)&&(m[_]="mi");var T={tokens:m};if(u){var w=""+u,M=w.indexOf("T")!==-1?"T":" ";w=w.split(M);var v=0,P=0,B=0;if(w[1]&&(v=w[1].split(":"),P=v[1]?v[1]:0,B=v[2]?v[2]:0,v=v[0]?v[0]:0),w=w[0].split("-"),w[0]&&w[1]&&w[2]&&w[0]>0&&w[1]>0&&w[1]<13&&w[2]>0&&w[2]<32){T.data=[w[0],w[1],w[2],v,P,B],T.value=[];for(var D=new Date(T.data[0],T.data[1]-1,T.data[2],T.data[3],T.data[4],T.data[5]),L=function(ue){var fe=this.tokens[ue],q=fe.toUpperCase(),G=null;q==="YYYY"?G=this.data[0]:q==="YYY"?G=this.data[0].substring(1,4):q==="YY"?G=this.data[0].substring(2,4):q==="Y"?G=this.data[0].substring(3,4):fe==="MON"?G=t.calendar.months[D.getMonth()].substr(0,3).toUpperCase():fe==="mon"?G=t.calendar.months[D.getMonth()].substr(0,3).toLowerCase():fe==="MONTH"?G=t.calendar.months[D.getMonth()].toUpperCase():fe==="month"?G=t.calendar.months[D.getMonth()].toLowerCase():q==="MMMMM"?G=t.calendar.months[D.getMonth()].substr(0,1):q==="MMMM"||fe==="Month"?G=t.calendar.months[D.getMonth()]:q==="MMM"||fe=="Mon"?G=t.calendar.months[D.getMonth()].substr(0,3):q==="MM"?G=t.two(this.data[1]):q==="M"?G=D.getMonth()+1:fe==="DAY"?G=t.calendar.weekdays[D.getDay()].toUpperCase():fe==="day"?G=t.calendar.weekdays[D.getDay()].toLowerCase():q==="DDDD"||fe=="Day"?G=t.calendar.weekdays[D.getDay()]:q==="DDD"?G=t.calendar.weekdays[D.getDay()].substr(0,3):q==="DD"?G=t.two(this.data[2]):q==="D"?G=this.data[2]:q==="Q"?G=Math.floor((D.getMonth()+3)/3):q==="HH24"||q==="HH"?G=t.two(this.data[3]):q==="HH12"?this.data[3]>12?G=t.two(this.data[3]-12):G=t.two(this.data[3]):q==="H"?G=this.data[3]:q==="MI"?G=t.two(this.data[4]):q==="SS"?G=t.two(this.data[5]):q==="MS"?G=D.getMilliseconds():q==="AM/PM"?this.data[3]>=12?G="PM":G="AM":q==="WD"&&(G=t.calendar.weekdays[D.getDay()]),G===null?this.value[ue]=this.tokens[ue]:this.value[ue]=G},_=0;_<T.tokens.length;_++)L.call(T,_);u=T.value.join("")}else u=""}return u},t.calendar.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],t.calendar.months=["January","February","March","April","May","June","July","August","September","October","November","December"],t.calendar.weekdaysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],t.calendar.monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t.color=function(u,d){if(u.color)return u.color.setOptions(d,!0);var a={type:"color"};a.options={};var b=null,v=null,w=null,S=null,E=null,m=null,_=null;a.setOptions=function(C,N){var U={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};C||(C={}),C&&!C.palette&&(C.palette=t.palette());for(var R in U)C&&C.hasOwnProperty(R)?a.options[R]=C[R]:(typeof a.options[R]=="undefined"||N===!0)&&(a.options[R]=U[R]);return S&&(S.innerHTML=a.options.resetLabel),E&&(E.innerHTML=a.options.doneLabel),a.options.palette&&_&&_.updateContent(0,D()),typeof a.options.value=="string"&&(u.value=a.options.value,u.tagName==="INPUT"&&(u.style.color=u.value,u.style.backgroundColor=u.value)),a.options.placeholder?u.setAttribute("placeholder",a.options.placeholder):u.getAttribute("placeholder")&&u.removeAttribute("placeholder"),a},a.select=function(C){var N=b.querySelector(".jcolor-selected");N&&N.classList.remove("jcolor-selected"),a.values[C]&&a.values[C].classList.add("jcolor-selected"),a.options.value=C},a.open=function(){if(!b.classList.contains("jcolor-focus")){t.tracking(a,!0),b.classList.add("jcolor-focus"),a.options.value&&a.select(a.options.value),w.style.marginTop="",w.style.marginLeft="";var C=w.getBoundingClientRect(),N=t.getWindowWidth(),U=t.getWindowHeight();if(N<800||a.options.fullscreen==!0?(w.classList.add("jcolor-fullscreen"),t.animation.slideBottom(w,1),v.style.display="block"):(w.classList.contains("jcolor-fullscreen")&&(w.classList.remove("jcolor-fullscreen"),v.style.display=""),a.options.position?w.style.position="fixed":w.style.position="",C.left+C.width>N&&(w.style.marginLeft=-1*(C.left+C.width-(N-20))+"px"),C.top+C.height>U&&(w.style.marginTop=-1*(C.top+C.height-(U-20))+"px")),typeof a.options.onopen=="function"&&a.options.onopen(u),_.setBorder(_.getActive()),a.options.value){var R=B(a.options.value);G.forEach(function(H,W){H.value=R[W],H.dispatchEvent(new Event("input"))})}}},a.close=function(C){return b.classList.contains("jcolor-focus")&&(b.classList.remove("jcolor-focus"),v.style.display="",!C&&typeof a.options.onclose=="function"&&a.options.onclose(u),t.tracking(a,!1)),a.options.value},a.setValue=function(C){C||(C=""),C!=a.options.value&&(a.options.value=C,q=C,a.select(C),typeof a.options.onchange=="function"&&a.options.onchange(u,C),u.value!=a.options.value&&(u.value=a.options.value,u.tagName==="INPUT"&&(u.style.color=u.value,u.style.backgroundColor=u.value),typeof u.oninput=="function"&&u.oninput({type:"input",target:u,value:u.value})),a.options.closeOnChange==!0&&a.close())},a.getValue=function(){return a.options.value};var T=function(C){var N=C.toString(16);return N.length===1?"0"+N:N},M=function(C,N,U){return"#"+T(C)+T(N)+T(U)},P=function(C){return parseInt("0x"+C)},B=function(C){return[P(C.substr(1,2)),P(C.substr(3,2)),P(C.substr(5,2))]},D=function(){var C=document.createElement("div");C.className="jcolor-grid",a.values=[];var N=document.createElement("table");N.setAttribute("cellpadding","7"),N.setAttribute("cellspacing","0");for(var U=0;U<a.options.palette.length;U++){for(var R=document.createElement("tr"),H=0;H<a.options.palette[U].length;H++){var W=document.createElement("td"),ae=a.options.palette[U][H];ae.length<7&&ae.substr(0,1)!=="#"&&(ae="#"+ae),W.style.backgroundColor=ae,W.setAttribute("data-value",ae),W.innerHTML="",R.appendChild(W),a.options.value==ae&&W.classList.add("jcolor-selected"),a.values[ae]=W}N.appendChild(R)}return C.appendChild(N),C},L=document.createElement("canvas");L.width=200,L.height=160;var X=L.getContext("2d"),ie=function(){var C=m.firstChild.getBoundingClientRect();L.width=C.width-14,ue()},ue=function(){var C=X.createLinearGradient(0,0,L.width,0);C.addColorStop(0,"rgb(255,0,0)"),C.addColorStop(.15,"rgb(255,0,255)"),C.addColorStop(.33,"rgb(0,0,255)"),C.addColorStop(.49,"rgb(0,255,255)"),C.addColorStop(.67,"rgb(0,255,0)"),C.addColorStop(.84,"rgb(255,255,0)"),C.addColorStop(1,"rgb(255,0,0)"),X.fillStyle=C,X.fillRect(0,0,L.width,L.height),C=X.createLinearGradient(0,0,0,L.height),C.addColorStop(0,"rgba(255,255,255,1)"),C.addColorStop(.5,"rgba(255,255,255,0)"),C.addColorStop(.5,"rgba(0,0,0,0)"),C.addColorStop(1,"rgba(0,0,0,1)"),X.fillStyle=C,X.fillRect(0,0,L.width,L.height)},fe=function(){var C=document.createElement("div");C.className="jcolor-hsl";var N=document.createElement("div");N.className="jcolor-point";var U=document.createElement("div");U.appendChild(L),U.appendChild(N),C.appendChild(U);var R=function(H,W,ae){if(H===1){var ge=C.getBoundingClientRect(),xe=W-ge.left,we=ae-ge.top;xe<0&&(xe=0),we<0&&(we=0),xe>ge.width&&(xe=ge.width),we>ge.height&&(we=ge.height),N.style.left=xe+"px",N.style.top=we+"px";var be=X.getImageData(xe,we,1,1).data;q=M(be[0],be[1],be[2])}};return C.addEventListener("mousedown",function(H){R(H.buttons,H.clientX,H.clientY)}),C.addEventListener("mousemove",function(H){R(H.buttons,H.clientX,H.clientY)}),C.addEventListener("touchmove",function(H){R(1,H.changedTouches[0].clientX,H.changedTouches[0].clientY)}),C},q="",G=[],Y=function(){if(q!=="")for(var C=0;C<G.length;C++){var N=B(q);N[C]=0;var U="linear-gradient(90deg, rgb(";U+=N.join(", "),U+="), rgb(",N[C]=255,U+=N.join(", "),U+="))",G[C].style.backgroundImage=U}},J=function(){var C=document.createElement("div");C.className="jcolor-sliders";var N=document.createElement("div"),U=function(ae){var ge=document.createElement("div");ge.className="jcolor-sliders-input-container";var xe=document.createElement("label");xe.innerText=ae;var we=document.createElement("div");we.className="jcolor-sliders-input-subcontainer";var be=document.createElement("input");be.type="range",be.min=0,be.max=255,be.value=0,ge.appendChild(xe),we.appendChild(be);var le=document.createElement("div");return le.innerText=be.value,be.addEventListener("input",function(){le.innerText=be.value}),we.appendChild(le),ge.appendChild(we),N.appendChild(ge),be};G=[U("Red"),U("Green"),U("Blue")],C.appendChild(N);var R=document.createElement("div");R.className="jcolor-sliders-final-color";var H=document.createElement("div");H.style.visibility="hidden",H.innerText="a",R.appendChild(H);var W=function(){var ae=M(parseInt(G[0].value),parseInt(G[1].value),parseInt(G[2].value));H.innerText=ae,H.style.color=ae,H.style.removeProperty("visibility"),q=ae};return G.forEach(function(ae){ae.addEventListener("input",function(){W(),Y()})}),C.appendChild(R),C},A=function(){a.setOptions(d),u.tagName=="INPUT"&&(u.classList.add("jcolor-input"),u.readOnly=!0),b=document.createElement("div"),b.className="jcolor",v=document.createElement("div"),v.className="jcolor-backdrop",b.appendChild(v),w=document.createElement("div"),w.className="jcolor-content";var C=document.createElement("div");C.className="jcolor-controls",w.appendChild(C),S=document.createElement("div"),S.className="jcolor-reset",S.innerHTML=a.options.resetLabel,C.appendChild(S),E=document.createElement("div"),E.className="jcolor-close",E.innerHTML=a.options.doneLabel,C.appendChild(E),m=document.createElement("div"),w.appendChild(m),_=t.tabs(m,{animation:!0,data:[{title:"Grid",contentElement:D()},{title:"Spectrum",contentElement:fe()},{title:"Sliders",contentElement:J()}],onchange:function(N,U,R){if(R===1)ie();else{var H=q!==""?q:a.getValue();if(R===2&&H){var W=B(H);G.forEach(function(ae,ge){ae.value=W[ge],ae.dispatchEvent(new Event("input"))})}}},palette:"modern"}),b.appendChild(w),u.tagName=="INPUT"?u.parentNode.insertBefore(b,u.nextSibling):u.appendChild(b),b.addEventListener("click",function(N){if(N.target.tagName=="TD"){var U=N.target.getAttribute("data-value");U&&a.setValue(U)}else N.target.classList.contains("jcolor-reset")?(a.setValue(""),a.close()):N.target.classList.contains("jcolor-close")?(_.getActive()>0&&a.setValue(q),a.close()):N.target.classList.contains("jcolor-backdrop")?a.close():a.open()}),u.addEventListener("mouseup",function(N){a.open()}),window.addEventListener("resize",function(){b.classList.contains("jcolor-focus")&&_.getActive()==1&&ie()}),a.options.opened==!0&&a.open(),u.change=a.setValue,u.val=function(N){if(N===void 0)return a.getValue();a.setValue(N)},u.color=a,b.color=a};return a.toHex=function(C){var N=function(U){return("0"+parseInt(U).toString(16)).slice(-2)};return/^#[0-9A-F]{6}$/i.test(C)?C:(C=C.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/),"#"+N(C[1])+N(C[2])+N(C[3]))},A(),a},t.contextmenu=function(u,d){var a={type:"contextmenu"};a.options={};var b={items:null,onclick:null};for(var v in b)d&&d.hasOwnProperty(v)?a.options[v]=d[v]:a.options[v]=b[v];u.classList.add("jcontextmenu"),a.open=function(E,m){if(m&&(a.options.items=m,a.create(m)),t.contextmenu.current&&t.contextmenu.current.close(),t.tracking(a,!0),u.classList.add("jcontextmenu-focus"),t.contextmenu.current=a,a.options.items&&a.options.items.length>0||u.children.length){if(E.target)if(E.changedTouches&&E.changedTouches[0])_=E.changedTouches[0].clientX,T=E.changedTouches[0].clientY;else var _=E.clientX,T=E.clientY;else var _=E.x,T=E.y;var M=u.getBoundingClientRect();if(window.innerHeight<T+M.height){var P=T-M.height;P<0&&(P=0),u.style.top=P+"px"}else u.style.top=T+"px";window.innerWidth<_+M.width?_-M.width>0?u.style.left=_-M.width+"px":u.style.left="10px":u.style.left=_+"px"}},a.isOpened=function(){return!!u.classList.contains("jcontextmenu-focus")},a.close=function(){u.classList.contains("jcontextmenu-focus")&&u.classList.remove("jcontextmenu-focus"),t.tracking(a,!1)},a.create=function(E){u.innerHTML="";var m=w();u.appendChild(m);for(var _=0;_<E.length;_++){var T=S(E[_]);u.appendChild(T)}};function w(){var E=document.createElement("div");E.classList.add("header"),E.addEventListener("click",function(T){T.preventDefault(),T.stopPropagation()});var m=document.createElement("a");m.classList.add("title"),m.innerHTML=t.translate("Menu"),E.appendChild(m);var _=document.createElement("a");return _.classList.add("close"),_.innerHTML=t.translate("close"),_.addEventListener("click",function(T){a.close()}),E.appendChild(_),E}function S(E){if(E.type&&(E.type=="line"||E.type=="divisor"))var m=document.createElement("hr");else{var m=document.createElement("div"),_=document.createElement("a");if(_.innerHTML=E.title,E.tooltip&&m.setAttribute("title",E.tooltip),E.icon&&m.setAttribute("data-icon",E.icon),E.id&&(m.id=E.id),E.disabled?m.className="jcontextmenu-disabled":E.onclick&&(m.method=E.onclick,m.addEventListener("mousedown",function(ie){ie.preventDefault()}),m.addEventListener("mouseup",function(ie){this.method(this,ie)})),m.appendChild(_),E.submenu){var T=document.createElement("span");T.innerHTML="&#9658;",m.appendChild(T),m.classList.add("jcontexthassubmenu");var M=document.createElement("div");M.classList.add("jcontextmenu"),M.setAttribute("tabindex","900");for(var P=E.submenu,B=0;B<P.length;B++){var D=S(P[B]);M.appendChild(D)}m.appendChild(M)}else if(E.shortcut){var L=document.createElement("span");L.innerHTML=E.shortcut,m.appendChild(L)}}return m}return typeof a.options.onclick=="function"&&u.addEventListener("click",function(E){a.options.onclick(a,E)}),a.options.items&&a.create(a.options.items),window.addEventListener("mousewheel",function(){a.close()}),u.contextmenu=a,a},t.dropdown=function(u,d){if(u.dropdown)return u.dropdown.setOptions(d,!0);var a={type:"dropdown"};a.options={};var b=function(G,Y){G&&G.length&&(a.options.sortResults!==!1&&(typeof a.options.sortResults=="function"?G.sort(a.options.sortResults):G.sort(v)),a.setData(G)),typeof a.options.onload=="function"&&a.options.onload(u,a,G,Y),Y&&S(Y),Y==null&&(a.options.value=""),u.value=a.options.value,a.options.opened==!0&&a.open()},v=function(G,Y){var J,A;return typeof G=="string"?J=G:G.text?J=G.text:G.name&&(J=G.name),typeof Y=="string"?A=Y:Y.text?A=Y.text:Y.name&&(A=Y.name),typeof J=="string"||typeof A=="string"?(typeof J!="string"&&(J=""+J),typeof A!="string"&&(A=""+A),J.localeCompare(A)):J-A},w=function(){a.value={};for(var G=0;G<a.items.length;G++)a.items[G].selected==!0&&(a.items[G].element&&a.items[G].element.classList.remove("jdropdown-selected"),a.items[G].selected=null);a.options.value=""},S=function(G){if(w(),G!==null)if(!G)typeof a.value[""]!="undefined"&&(a.value[""]="");else{Array.isArray(G)||(G=(""+G).split(";"));for(var Y=0;Y<G.length;Y++)a.value[G[Y]]=""}for(var Y=0;Y<a.items.length;Y++)typeof a.value[E(Y)]!="undefined"&&(a.items[Y].element&&a.items[Y].element.classList.add("jdropdown-selected"),a.items[Y].selected=!0,a.value[E(Y)]=m(Y));a.options.value=Object.keys(a.value).join(";"),a.header.value=a.getText()},E=function(G,Y){if(a.options.format)var J="id";else var J="value";return a.items[G]?Y!==void 0?a.items[G].data[J]=Y:a.items[G].data[J]:""},m=function(G,Y){if(a.options.format)var J="name";else var J="text";return a.items[G]?Y!==void 0?a.items[G].data[J]=Y:a.items[G].data[J]:""},_=function(){return Object.keys(a.value)},T=function(){for(var G=[],Y=Object.keys(a.value),J=0;J<Y.length;J++)G.push(a.value[Y[J]]);return G};a.setOptions=function(G,Y){G||(G={});var J={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,sortResults:!1,autofocus:!1};for(var A in J)G&&G.hasOwnProperty(A)?a.options[A]=G[A]:(typeof a.options[A]=="undefined"||Y===!0)&&(a.options[A]=J[A]);return(a.options.remoteSearch==!0||a.options.type==="searchbar")&&(a.options.autocomplete=!0),a.options.newOptions==!0?a.header.classList.add("jdropdown-add"):a.header.classList.remove("jdropdown-add"),a.options.autocomplete==!0?a.header.removeAttribute("readonly"):a.header.setAttribute("readonly","readonly"),a.options.placeholder?a.header.setAttribute("placeholder",a.options.placeholder):a.header.removeAttribute("placeholder"),u.classList.remove("jdropdown-searchbar"),u.classList.remove("jdropdown-picker"),u.classList.remove("jdropdown-list"),a.options.type=="searchbar"?u.classList.add("jdropdown-searchbar"):a.options.type=="list"?u.classList.add("jdropdown-list"):a.options.type=="picker"?u.classList.add("jdropdown-picker"):t.getWindowWidth()<800?a.options.autocomplete?(u.classList.add("jdropdown-searchbar"),a.options.type="searchbar"):(u.classList.add("jdropdown-picker"),a.options.type="picker"):(a.options.width?(u.style.width=a.options.width,u.style.minWidth=a.options.width):(u.style.removeProperty("width"),u.style.removeProperty("min-width")),u.classList.add("jdropdown-default"),a.options.type="default"),a.options.type=="searchbar"?M.appendChild(D):P.insertBefore(D,P.firstChild),a.options.url&&!G.data?t.ajax({url:a.options.url,method:"GET",dataType:"json",success:function(C){C&&b(C,a.options.value)}}):b(a.options.data,a.options.value),a};var M=null,P=null,B=null,D=null,L=null,X=null,ie=null,ue=function(){if(d||(d={}),u.tagName=="SELECT"){var G=t.dropdown.extractFromDom(u,d);u=G.el,d=G.options}!d.placeholder&&u.getAttribute("placeholder")&&(d.placeholder=u.getAttribute("placeholder")),a.value={},a.items=[],a.groups=[],a.search="",a.results=null,u.classList.add("jdropdown"),M=document.createElement("div"),M.className="jdropdown-container-header",a.header=document.createElement("input"),a.header.className="jdropdown-header",a.header.type="text",a.header.setAttribute("autocomplete","off"),a.header.onfocus=function(){typeof a.options.onfocus=="function"&&a.options.onfocus(u)},a.header.onblur=function(){typeof a.options.onblur=="function"&&a.options.onblur(u)},a.header.onkeyup=function(Y){a.options.autocomplete==!0&&!ie?(a.search!=a.header.value.trim()&&(ie=setTimeout(function(){a.find(a.header.value.trim()),ie=null},400)),u.classList.contains("jdropdown-focus")||a.open()):a.options.autocomplete||a.next(Y.key)},t.dropdown.hasEvents||(t.dropdown.hasEvents=!0,document.addEventListener("keydown",t.dropdown.keydown)),P=document.createElement("div"),P.className="jdropdown-container",B=document.createElement("div"),B.className="jdropdown-content",D=document.createElement("div"),D.className="jdropdown-close",D.innerHTML="Done",L=document.createElement("div"),L.className="jdropdown-reset",L.innerHTML="x",L.onclick=function(){a.reset(),a.close()},X=document.createElement("div"),X.className="jdropdown-backdrop",M.appendChild(a.header),P.appendChild(B),u.appendChild(M),u.appendChild(P),u.appendChild(X),a.setOptions(d),"ontouchsend"in document.documentElement?u.addEventListener("touchsend",t.dropdown.mouseup):u.addEventListener("mouseup",t.dropdown.mouseup),a.options.lazyLoading==!0&&t.lazyLoading(B,{loadUp:a.loadUp,loadDown:a.loadDown}),B.onwheel=function(Y){Y.stopPropagation()},u.change=a.setValue,u.val=function(Y){if(Y===void 0)return a.getValue(!!a.options.multiple);a.setValue(Y)},u.dropdown=a};a.getUrl=function(){return a.options.url},a.setUrl=function(G,Y){a.options.url=G,t.ajax({url:a.options.url,method:"GET",dataType:"json",success:function(J){a.setData(J),typeof Y=="function"&&Y(a)}})},a.setId=function(G,Y){if(a.options.format)var J="id";else var J="value";typeof G=="object"?G[J]=Y:a.items[G].data[J]=Y},a.add=function(G,Y){if(!G){var J=a.options.autocomplete==!0?a.header.value:"",G=prompt(t.translate("Add A New Option"),J);if(!G)return!1}if(Y||(Y=t.guid()),a.options.format)var A={id:Y,name:G};else var A={value:Y,text:G};if(typeof a.options.onbeforeinsert=="function"){var C=a.options.onbeforeinsert(a,A);if(C===!1)return!1;C&&(A=C)}a.options.data.push(A);var N=a.createItem(A);return B.appendChild(N.element),typeof a.options.oninsert=="function"&&a.options.oninsert(a,A,N),B.style.display=="none"&&(B.style.display=""),a.results&&a.results.push(N),A},a.createItem=function(G,Y,J){a.options.format?(!G.id&&G.value!==void 0&&(G.id=G.value),!G.name&&G.text!==void 0&&(G.name=G.text)):(!G.value&&G.id!==void 0&&(G.value=G.id),!G.text&&G.name!==void 0&&(G.text=G.name));var A={};if(A.element=document.createElement("div"),A.element.className="jdropdown-item",A.element.indexValue=a.items.length,A.data=G,Y&&(A.group=Y),G.id&&A.element.setAttribute("id",G.id),G.disabled==!0&&A.element.setAttribute("data-disabled",!0),G.tooltip&&A.element.setAttribute("title",G.tooltip),G.image){var C=document.createElement("img");C.className="jdropdown-image",C.src=G.image,G.title||C.classList.add("jdropdown-image-small"),A.element.appendChild(C)}else if(G.icon){var N=document.createElement("span");N.className="jdropdown-icon material-icons",N.innerText=G.icon,G.title||N.classList.add("jdropdown-icon-small"),G.color&&(N.style.color=G.color),A.element.appendChild(N)}else if(G.color){var U=document.createElement("div");U.className="jdropdown-color",U.style.backgroundColor=G.color,A.element.appendChild(U)}if(a.options.format)var R=G.name;else var R=G.text;var H=document.createElement("div");if(H.className="jdropdown-description",H.innerHTML=R||"&nbsp;",G.title){var W=document.createElement("div");W.className="jdropdown-title",W.innerText=G.title,H.appendChild(W)}if(a.options.format)var ae=G.id;else var ae=G.value;return a.value[ae]&&(A.element.classList.add("jdropdown-selected"),A.selected=!0),a.items.push(A),A.element.appendChild(H),A},a.appendData=function(G){if(G.length){for(var Y=[],J=[],A=0;A<G.length;A++)G[A].group?(J[G[A].group]||(J[G[A].group]=[]),J[G[A].group].push(A)):Y.push(A);var C=0,N=Object.keys(J);if(N.length>0)for(var A=0;A<N.length;A++){var U=document.createElement("div");U.className="jdropdown-group";var R=document.createElement("div");R.className="jdropdown-group-name",R.innerHTML=N[A];var H=document.createElement("i");H.className="jdropdown-group-arrow jdropdown-group-arrow-down",R.appendChild(H);var W=document.createElement("div");W.className="jdropdown-group-items";for(var ae=0;ae<J[N[A]].length;ae++){var ge=a.createItem(G[J[N[A]][ae]],U,N[A]);(a.options.lazyLoading==!1||C<200)&&(W.appendChild(ge.element),C++)}U.appendChild(R),U.appendChild(W),a.groups.push(U),W.children.length>0&&B.appendChild(U)}if(Y.length)for(var A=0;A<Y.length;A++){var ge=a.createItem(G[Y[A]]);(a.options.lazyLoading==!1||C<200)&&(B.appendChild(ge.element),C++)}}},a.setData=function(G){if(w(),B.innerHTML="",a.header.value="",a.items=[],G&&G.length){for(var Y=0;Y<G.length;Y++)typeof G[Y]!="object"&&(a.options.format?G[Y]={id:G[Y],name:G[Y]}:G[Y]={value:G[Y],text:G[Y]});a.appendData(G),a.options.data=G}else a.options.data=[];a.close()},a.getData=function(){return a.options.data},a.getPosition=function(G){for(var Y=0;Y<a.items.length;Y++)if(E(Y)==G)return Y;return!1},a.getText=function(G){var Y=T();return G?Y:Y.join("; ")},a.getValue=function(G){var Y=_();return G?Y:Y.join(";")};var fe=function(G){u.value!=a.options.value&&(u.value=a.options.value,typeof u.oninput=="function"&&u.oninput({type:"input",target:u,value:u.value})),typeof a.options.onchange=="function"&&a.options.onchange(u,a,G,a.options.value)};a.setValue=function(G){var Y=a.getValue();Array.isArray(G)&&(G=G.join(";")),Y!==G&&(S(G),fe(Y))},a.resetSelected=function(){a.setValue(null)},a.selectIndex=function(J,Y){var J=parseInt(J);if(a.items&&a.items[J]&&(Y===!0||a.items[J].data.disabled!==!0))if(a.setCursor(J,!1),!a.options.multiple)a.items[J].selected?a.setValue(null):a.setValue(E(J)),a.close();else{var A=a.options.value;a.items[J].selected?(a.items[J].element.classList.remove("jdropdown-selected"),a.items[J].selected=!1,delete a.value[E(J)]):(a.items[J].element.classList.add("jdropdown-selected"),a.items[J].selected=!0,a.value[E(J)]=m(J)),a.options.value=Object.keys(a.value).join(";"),a.options.autocomplete==!1&&(a.header.value=T().join("; ")),fe(A)}},a.selectItem=function(G){a.selectIndex(G.indexValue)};var q=function(G,Y){for(var J=0;J<Y.length;J++)if(a.options.format){if(Y[J].id==G)return!0}else if(Y[J].value==G)return!0;return!1};return a.find=function(G){if(a.search==G.trim())return!1;if(a.search=G,a.setCursor(),a.groups.length)for(var Y=0;Y<a.groups.length;Y++)a.groups[Y].lastChild.innerHTML="";if(B.innerHTML="",a.options.remoteSearch==!0){a.results=null;var J=a.options.url+(a.options.url.indexOf("?")>0?"&":"?")+"q="+G;t.ajax({url:J,method:"GET",dataType:"json",success:function(W){a.items=[];var ae=Object.keys(a.value);if(ae.length)for(var ge=0;ge<ae.length;ge++)q(ae[ge],W)||(a.options.format?W.unshift({id:ae[ge],name:a.value[ae[ge]]}):W.unshift({value:ae[ge],text:a.value[ae[ge]]}));a.appendData(W),W.length?B.style.display="":B.style.display="none"}})}else{G=new RegExp(G,"gi");for(var A=[],Y=0;Y<a.items.length;Y++){var C=m(Y),N=a.items[Y].data.title||"",U=a.items[Y].data.group||"",R=a.items[Y].data.synonym||"";R&&(R=R.join(" ")),(G==null||a.items[Y].selected==!0||C.match(G)||N.match(G)||U.match(G)||R.match(G))&&A.push(a.items[Y])}if(!A.length)B.style.display="none",a.results=null;else{B.style.display="",a.results=A;var H=A.length||0;a.options.lazyLoading==!0&&H>200&&(H=200);for(var Y=0;Y<H;Y++)a.results[Y].group?(a.results[Y].group.parentNode||B.appendChild(a.results[Y].group),a.results[Y].group.lastChild.appendChild(a.results[Y].element)):B.appendChild(a.results[Y].element)}}a.options.autofocus==!0&&a.first()},a.open=function(){if(!u.classList.contains("jdropdown-focus")){t.dropdown.current=a,t.tracking(a,!0),u.classList.add("jdropdown-focus"),t.getWindowWidth()<800&&(a.options.type==null||a.options.type=="picker")&&t.animation.slideBottom(P,1),a.options.autocomplete==!0&&(a.header.value=a.search,a.header.focus());var G=_();if(G[0]){var Y=a.getPosition(G[0]);Y!==!1&&a.setCursor(Y)}if(!a.options.type||a.options.type=="default"){var J=u.getBoundingClientRect(),A=P.getBoundingClientRect();a.options.position?(P.style.position="fixed",window.innerHeight<J.bottom+A.height?(P.style.top="",P.style.bottom=window.innerHeight-J.top+1+"px"):(P.style.top=J.bottom+"px",P.style.bottom=""),P.style.left=J.left+"px"):window.innerHeight<J.bottom+A.height?(P.style.top="",P.style.bottom=J.height+1+"px"):(P.style.top="",P.style.bottom=""),P.style.minWidth=J.width+"px",a.options.maxWidth&&(P.style.maxWidth=a.options.maxWidth),!a.items.length&&a.options.autocomplete==!0?B.style.display="none":B.style.display=""}}typeof a.options.onopen=="function"&&a.options.onopen(u)},a.close=function(G){return u.classList.contains("jdropdown-focus")&&(a.header.value=a.getText(),a.setCursor(),!G&&typeof a.options.onclose=="function"&&a.options.onclose(u),a.header.blur&&a.header.blur(),u.classList.remove("jdropdown-focus"),t.tracking(a,!1),t.dropdown.current=null),a.getValue()},a.setCursor=function(G,Y){if(a.currentIndex!=null&&a.items&&a.items[a.currentIndex]&&a.items[a.currentIndex].element.classList.remove("jdropdown-cursor"),G==null)a.currentIndex=null;else if(G=parseInt(G),a.items[G].element.parentNode&&(a.items[G].element.classList.add("jdropdown-cursor"),a.currentIndex=G,Y!==!1&&a.items[a.currentIndex].element)){B.scrollTop;var J=a.items[a.currentIndex].element;B.scrollTop=J.offsetTop-J.scrollTop+J.clientTop-95}},a.resetCursor=a.setCursor,a.updateCursor=a.setCursor,a.reset=function(){a.setCursor(),a.setValue(null)},a.first=function(){a.options.lazyLoading===!0&&a.loadFirst();var G=B.querySelectorAll(".jdropdown-item");if(G.length){var Y=G[0].indexValue;a.setCursor(Y)}},a.last=function(){a.options.lazyLoading===!0&&a.loadLast();var G=B.querySelectorAll(".jdropdown-item");if(G.length){var Y=G[G.length-1].indexValue;a.setCursor(Y)}},a.next=function(G){var Y=null;if(G){if(G.length==1){var J=a.currentIndex||-1;G=G.toLowerCase();var A=null,C=null,N=B.querySelectorAll(".jdropdown-item");if(N.length){for(var U=0;U<N.length;U++)if(N[U].indexValue>J&&(A=a.items[N[U].indexValue])&&(C=A.element.innerText[0])&&(C=C.toLowerCase(),G==C)){Y=N[U].indexValue;break}a.setCursor(Y)}}}else if(a.currentIndex==null||a.currentIndex==null)a.first();else{var R=a.items[a.currentIndex].element,H=R.nextElementSibling;H?(H.classList.contains("jdropdown-group")&&(H=H.lastChild.firstChild),Y=H.indexValue):R.parentNode.classList.contains("jdropdown-group-items")&&((H=R.parentNode.parentNode.nextElementSibling)&&(H.classList.contains("jdropdown-group")?H=H.lastChild.firstChild:H.classList.contains("jdropdown-item")?Y=H.indexValue:H=null),H&&(Y=H.indexValue)),Y!==null&&a.setCursor(Y)}},a.prev=function(){var G=null;if(a.currentIndex===null)a.first();else{var Y=a.items[a.currentIndex].element,J=Y.previousElementSibling;J?(J.classList.contains("jdropdown-group")&&(J=J.lastChild.lastChild),G=J.indexValue):Y.parentNode.classList.contains("jdropdown-group-items")&&((J=Y.parentNode.parentNode.previousElementSibling)&&(J.classList.contains("jdropdown-group")?J=J.lastChild.lastChild:J.classList.contains("jdropdown-item")?G=J.indexValue:J=null),J&&(G=J.indexValue))}G!==null&&a.setCursor(G)},a.loadFirst=function(){if(a.results)var G=a.results;else var G=a.items;var Y=G.length||0;a.options.lazyLoading==!0&&Y>200&&(Y=200),B.innerHTML="";for(var J=0;J<Y;J++)G[J].group?(G[J].group.parentNode||B.appendChild(G[J].group),G[J].group.lastChild.appendChild(G[J].element)):B.appendChild(G[J].element);B.scrollTop=0},a.loadLast=function(){if(a.results)var G=a.results;else var G=a.items;var Y=G.length;if(Y>200){Y=Y-200,B.innerHTML="";for(var J=Y;J<G.length;J++)G[J].group?(G[J].group.parentNode||B.appendChild(G[J].group),G[J].group.lastChild.appendChild(G[J].element)):B.appendChild(G[J].element);B.scrollTop=B.scrollHeight}},a.loadUp=function(){var G=!1;if(a.results)var Y=a.results;else var Y=a.items;var J=B.querySelectorAll(".jdropdown-item"),A=J[0].indexValue;A=a.items[A];var C=Y.indexOf(A)-1;if(C>0){for(var N=0;C>0&&Y[C]&&N<200;)Y[C].group?(Y[C].group.parentNode||B.insertBefore(Y[C].group,B.firstChild),Y[C].group.lastChild.insertBefore(Y[C].element,Y[C].group.lastChild.firstChild)):B.insertBefore(Y[C].element,B.firstChild),C--,N++;G=!0}return G},a.loadDown=function(){var G=!1;if(a.results)var Y=a.results;else var Y=a.items;var J=B.querySelectorAll(".jdropdown-item"),A=J[J.length-1].indexValue;A=a.items[A];var C=Y.indexOf(A)+1;if(C<Y.length){for(var N=0;C<Y.length&&Y[C]&&N<200;)Y[C].group?(Y[C].group.parentNode||B.appendChild(Y[C].group),Y[C].group.lastChild.appendChild(Y[C].element)):B.appendChild(Y[C].element),C++,N++;G=!0}return G},ue(),a},t.dropdown.keydown=function(u){var d=null;if(d=t.dropdown.current){if(u.which==13||u.which==9)d.header.value&&d.currentIndex==null&&d.options.newOptions?d.add():(d.currentIndex==null&&d.options.autocomplete==!0&&d.header.value!=""&&d.find(d.header.value),d.selectIndex(d.currentIndex));else if(u.which==38)d.currentIndex==null?d.first():d.currentIndex>0&&d.prev(),u.preventDefault();else if(u.which==40)d.currentIndex==null?d.first():d.currentIndex+1<d.items.length&&d.next(),u.preventDefault();else if(u.which==36)d.first(),u.target.classList.contains("jdropdown-header")||u.preventDefault();else if(u.which==35)d.last(),u.target.classList.contains("jdropdown-header")||u.preventDefault();else if(u.which==27)d.close();else if(u.which==33){if(d.currentIndex==null)d.first();else if(d.currentIndex>0)for(var a=0;a<7;a++)d.prev();u.preventDefault()}else if(u.which==34){if(d.currentIndex==null)d.first();else if(d.currentIndex+1<d.items.length)for(var a=0;a<7;a++)d.next();u.preventDefault()}}},t.dropdown.mouseup=function(u){var d=t.findElement(u.target,"jdropdown");if(d){var a=d.dropdown;if(u.target.classList.contains("jdropdown-header"))if(d.classList.contains("jdropdown-focus")&&d.classList.contains("jdropdown-default")){var b=d.getBoundingClientRect();if(u.changedTouches&&u.changedTouches[0]){var v=u.changedTouches[0].clientX;u.changedTouches[0].clientY}else{var v=u.clientX;u.clientY}b.width-(v-b.left)<30?u.target.classList.contains("jdropdown-add")?a.add():a.close():a.options.autocomplete==!1&&a.close()}else a.open();else if(u.target.classList.contains("jdropdown-group-name")){var w=u.target.nextSibling.children;if(u.target.nextSibling.style.display!="none")for(var S=0;S<w.length;S++)w[S].style.display!="none"&&a.selectItem(w[S])}else u.target.classList.contains("jdropdown-group-arrow")?u.target.classList.contains("jdropdown-group-arrow-down")?(u.target.classList.remove("jdropdown-group-arrow-down"),u.target.classList.add("jdropdown-group-arrow-up"),u.target.parentNode.nextSibling.style.display="none"):(u.target.classList.remove("jdropdown-group-arrow-up"),u.target.classList.add("jdropdown-group-arrow-down"),u.target.parentNode.nextSibling.style.display=""):u.target.classList.contains("jdropdown-item")?a.selectItem(u.target):u.target.classList.contains("jdropdown-image")||u.target.classList.contains("jdropdown-description")?a.selectItem(u.target.parentNode):u.target.classList.contains("jdropdown-title")?a.selectItem(u.target.parentNode.parentNode):(u.target.classList.contains("jdropdown-close")||u.target.classList.contains("jdropdown-backdrop"))&&a.close()}},t.dropdown.extractFromDom=function(u,d){var a=u;if(d||(d={}),u.getAttribute("multiple")&&(!d||d.multiple==null)&&(d.multiple=!0),u.getAttribute("placeholder")&&(!d||d.placeholder==null)&&(d.placeholder=u.getAttribute("placeholder")),u.getAttribute("data-autocomplete")&&(!d||d.autocomplete==null)&&(d.autocomplete=!0),(!d||d.width==null)&&(d.width=u.offsetWidth),u.value&&(!d||d.value==null)&&(d.value=u.value),!d||d.data==null){d.data=[];for(var b=0;b<u.children.length;b++)if(u.children[b].tagName=="OPTGROUP")for(var v=0;v<u.children[b].children.length;v++)d.data.push({value:u.children[b].children[v].value,text:u.children[b].children[v].innerHTML,group:u.children[b].getAttribute("label")});else d.data.push({value:u.children[b].value,text:u.children[b].innerHTML})}(!d||d.onchange==null)&&(d.onchange=function(S,E,m,_){d.multiple==!0?obj.items[E].classList.contains("jdropdown-selected")?a.options[E].setAttribute("selected","selected"):a.options[E].removeAttribute("selected"):a.value=_});var w=document.createElement("div");return u.parentNode.insertBefore(w,u),u.style.display="none",u=w,{el:u,options:d}},t.editor=function(u,d){var a={type:"editor"};a.options={};var b={value:null,snippet:null,toolbar:null,remoteParser:null,placeholder:null,parseURL:!1,filterPaste:!0,dropZone:!1,dropAsSnippet:!1,acceptImages:!1,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,border:!0,padding:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null,userSearch:null};for(var v in b)d&&d.hasOwnProperty(v)?a.options[v]=d[v]:a.options[v]=b[v];var w=null,S=null,E=[];u.innerHTML="",a.el=u,typeof a.options.onclick=="function"&&(u.onclick=function(te){a.options.onclick(u,a,te)}),u.classList.add("jeditor-container"),a.options.padding==!0&&u.classList.add("jeditor-padding"),a.options.border==!1&&(u.style.border="0px");var m=document.createElement("div");m.className="jsnippet",m.setAttribute("contenteditable",!1);var _=document.createElement("div");_.className="jeditor-toolbar";var T=document.createElement("div");if(T.setAttribute("contenteditable",!0),T.setAttribute("spellcheck",!1),T.className="jeditor",a.options.placeholder&&T.setAttribute("data-placeholder",a.options.placeholder),(a.options.maxHeight||a.options.height)&&(T.style.overflowY="auto",a.options.maxHeight&&(T.style.maxHeight=a.options.maxHeight),a.options.height&&(T.style.height=a.options.height)),a.options.value)var M=a.options.value;else var M=u.innerHTML?u.innerHTML:"";if(!M)var M="";var P=function(te){typeof a.options.onchange=="function"&&a.options.onchange(u,a,te),a.options.value=a.getData(),u.value!=a.options.value&&(u.value=a.options.value,typeof u.oninput=="function"&&u.oninput({type:"input",target:u,value:u.value}))},B=function(){var te=window.getSelection?window.getSelection():document.selection,de=te.getRangeAt(0);de.deleteContents();var Z=document.createElement("a");Z.innerText="@",Z.searchable=!0,de.insertNode(Z);var Q=de.getBoundingClientRect();de.collapse(!1),pe.style.position="fixed",pe.style.top=Q.top+Q.height+10+"px",pe.style.left=Q.left+2+"px"},D=function(te){var de=document.createElement("div");de.innerHTML=te;var Z=de.querySelectorAll("img");if(Z.length)for(var Q=0;Q<Z.length;Q++)a.addImage(Z[Q].src)},L=function(te){var de,Z;window.getSelection&&(de=window.getSelection(),de.rangeCount&&(Z=de.getRangeAt(0),Z.toString(),Z.deleteContents(),Z.insertNode(te),Z.setStartAfter(te),Z.setEndAfter(te),de.removeAllRanges(),de.addRange(Z)))},X=function(){var te=null;if(te=m.children[0]){te.classList.contains("jslider-grid")||te.classList.add("jslider-grid");var de=te.children.length;te.setAttribute("data-number",de>4?4:de),de>4?te.setAttribute("data-total",de-4):te.removeAttribute("data-total")}},ie=function(te){m.innerHTML||ue({}),m.children[0].appendChild(te),X()},ue=function(te){m.innerHTML="";for(var de=["image","title","description","host","url"],Z=0;Z<de.length;Z++){var Q=document.createElement("div");if(Q.className="jsnippet-"+de[Z],Q.setAttribute("data-k",de[Z]),m.appendChild(Q),te[de[Z]])if(de[Z]=="image"){Array.isArray(te.image)||(te.image=[te.image]);for(var ve=0;ve<te.image.length;ve++){var Se=document.createElement("img");Se.src=te.image[ve],Q.appendChild(Se)}}else Q.innerHTML=te[de[Z]]}T.appendChild(document.createElement("br")),T.appendChild(m)},fe=function(){clearTimeout(w),w=setTimeout(function(){var te=T.querySelector(".jsnippet");if(!te){var de=T.innerHTML.replace(/\n/g," "),Z=document.createElement("div");Z.innerHTML=de;var Q=Z.innerText,ve=t.editor.detectUrl(Q);if(ve)if(ve[0].substr(-3)=="jpg"||ve[0].substr(-3)=="png"||ve[0].substr(-3)=="gif")a.addImage(ve[0],!0);else{var Se=t.editor.youtubeParser(ve[0]);a.parseWebsite(ve[0],Se)}}},1e3)};a.parseContent=function(){fe()},a.parseWebsite=function(te,de){if(!a.options.remoteParser)console.log("The remoteParser is not defined");else{if(de)var te="https://www.youtube.com/watch?v="+de;var Z={title:"",description:"",image:"",host:te.split("/")[2],url:te};t.ajax({url:a.options.remoteParser+encodeURI(te.trim()),method:"GET",dataType:"json",success:function(Q){Q.title&&(Z.title=Q.title),Q.description&&(Z.description=Q.description),Q.host&&(Z.host=Q.host),Q.url&&(Z.url=Q.url),ue(Z),Q.image?a.addImage(Q.image,!0):Q["og:image"]&&a.addImage(Q["og:image"],!0)}})}},a.setData=function(te){typeof te=="object"?T.innerHTML=te.content:T.innerHTML=te,a.options.focus&&t.editor.setCursor(T,!0),E=[]},a.getFiles=function(){for(var te=T.querySelectorAll(".jfile"),de=[],Z=0;Z<te.length;Z++)E[te[Z].src]&&de.push(E[te[Z].src]);return de},a.getText=function(){return T.innerText},a.getData=function(te){if(te){var de={content:""};if(m.innerHTML){de.snippet={};for(var Z=0;Z<m.children.length;Z++){var Q=m.children[Z].getAttribute("data-k");if(Q)if(Q=="image"){de.snippet.image||(de.snippet.image=[]);for(var ve=0;ve<m.children[Z].children.length;ve++)de.snippet.image.push(m.children[Z].children[ve].getAttribute("src"))}else de.snippet[Q]=m.children[Z].innerHTML}}var Se=Object.keys(E);if(Se.length){de.files=[];for(var Z=0;Z<Se.length;Z++)de.files.push(E[Se[Z]])}if(pe){var Re=T.querySelectorAll("a[data-user]");if(Re.length){de.users=[];for(var Z=0;Z<Re.length;Z++){var ne=Re[Z].getAttribute("data-user");ne&&de.users.push(ne)}de.users=de.users.join(",")}}var re=document.createElement("div");re.innerHTML=T.innerHTML;var Ce=re.querySelector(".jsnippet");Ce&&Ce.remove();var Me=re.innerHTML;Me=Me.replace(/<br>/g,`
`),Me=Me.replace(/<\/div>/g,`</div>
`),Me=Me.replace(/<(?:.|\n)*?>/gm,""),de.content=Me.trim()}else var de=T.innerHTML;return de},a.reset=function(){T.innerHTML="",m.innerHTML="",E=[]},a.addPdf=function(te){if(te.result.substr(0,4)!="data")console.error("Invalid source");else{var de=document.createElement("canvas");de.width=60,de.height=60;var Z=new Image,Q=de.getContext("2d");Q.drawImage(Z,0,0,de.width,de.height),de.toBlob(function(ve){var Se=document.createElement("img");Se.src=window.URL.createObjectURL(ve),Se.title=te.name,Se.className="jfile pdf",E[Se.src]={file:Se.src,extension:"pdf",content:te.result},L(Se)})}},a.addImage=function(te,de){if(te||(te=""),te.substr(0,4)!="data"&&!a.options.remoteParser)console.error("remoteParser not defined in your initialization");else{if(te.substr(0,4)=="data"){var Z=te.split(";");Z=Z[0].split("/"),Z=Z[1]}else{var Z=te.substr(te.lastIndexOf(".")+1);te=a.options.remoteParser+te}var Q=new Image;Q.onload=function(){var Se=document.createElement("canvas");Se.width=Q.width,Se.height=Q.height;var Re=Se.getContext("2d");Re.drawImage(Q,0,0,Se.width,Se.height),Se.toBlob(function(ne){var re=document.createElement("img");re.src=window.URL.createObjectURL(ne),re.classList.add("jfile"),re.setAttribute("tabindex","900"),E[re.src]={file:re.src,extension:Z,content:Se.toDataURL()},a.options.dropAsSnippet||de?(ie(re),E[re.src].snippet=!0):L(re),P()})},Q.src=te}},a.addFile=function(te){for(var de=[],Z=0;Z<te.length;Z++)if(te[Z].size>a.options.maxFileSize)alert("The file is too big");else{var Q=te[Z].type.split("/");Q[0]=="image"?Q=1:Q[1]=="pdf"?Q=2:Q=0,Q?(de[Z]=new FileReader,de[Z].index=Z,de[Z].type=Q,de[Z].name=te[Z].name,de[Z].date=te[Z].lastModified,de[Z].size=te[Z].size,de[Z].addEventListener("load",function(ve){ve.target.type==2?a.options.acceptFiles==!0&&a.addPdf(ve.target):a.addImage(ve.target.result)},!1),de[Z].readAsDataURL(te[Z])):alert("The extension is not allowed")}},a.destroy=function(){T.removeEventListener("mouseup",q),T.removeEventListener("mousedown",G),T.removeEventListener("mousemove",Y),T.removeEventListener("keyup",J),T.removeEventListener("keydown",A),T.removeEventListener("dragstart",ae),T.removeEventListener("dragenter",ge),T.removeEventListener("dragover",xe),T.removeEventListener("drop",we),T.removeEventListener("paste",W),T.removeEventListener("blur",be),T.removeEventListener("focus",le),u.editor=null,u.classList.remove("jeditor-container"),_.remove(),m.remove(),T.remove()};var q=function(te){S&&S.e&&S.e.classList.remove("resizing"),S=!1},G=function(te){var de=function(Se){var Re=Se.getBoundingClientRect();Re.width-(te.clientX-Re.left)<40&&te.clientY-Re.top<40&&(Se.innerHTML="",Se.remove())};if(te.target.tagName=="IMG")if(te.target.style.cursor){var Z=te.target.getBoundingClientRect();S={e:te.target,x:te.clientX,y:te.clientY,w:Z.width,h:Z.height,d:te.target.style.cursor},te.target.width||(te.target.width=Z.width+"px"),te.target.height||(te.target.height=Z.height+"px");var Q=window.getSelection();if(Q.rangeCount)for(var ve=0;ve<Q.rangeCount;ve++)Q.removeRange(Q.getRangeAt(ve));te.target.classList.add("resizing")}else S=!0;else te.target.classList.contains("jsnippet")?de(te.target):te.target.parentNode.classList.contains("jsnippet")&&de(te.target.parentNode),S=!0},Y=function(te){if(te.target.tagName=="IMG"&&!te.target.parentNode.classList.contains("jsnippet-image")&&a.options.allowImageResize==!0&&te.target.getAttribute("tabindex")){var de=te.target.getBoundingClientRect();te.clientY-de.top<5?de.width-(te.clientX-de.left)<5?te.target.style.cursor="ne-resize":te.clientX-de.left<5?te.target.style.cursor="nw-resize":te.target.style.cursor="n-resize":de.height-(te.clientY-de.top)<5?de.width-(te.clientX-de.left)<5?te.target.style.cursor="se-resize":te.clientX-de.left<5?te.target.style.cursor="sw-resize":te.target.style.cursor="s-resize":de.width-(te.clientX-de.left)<5?te.target.style.cursor="e-resize":te.clientX-de.left<5?te.target.style.cursor="w-resize":te.target.style.cursor=""}if(te.which==1&&S&&S.d){if(S.d=="e-resize"||S.d=="ne-resize"||S.d=="se-resize")if(S.e.width=S.w+(te.clientX-S.x),te.shiftKey){var Z=(te.clientX-S.x)*(S.h/S.w);S.e.height=S.h+Z}else var Z=null;Z||(S.d=="s-resize"||S.d=="se-resize"||S.d=="sw-resize")&&(te.shiftKey||(S.e.height=S.h+(te.clientY-S.y)))}},J=function(te){if(T.innerHTML||(T.innerHTML="<div><br></div>"),pe){var de=t.getNode();de&&(de.searchable===!0?de.innerText&&de.innerText.substr(0,1)=="@"&&me(de.innerText.substr(1)):de.searchable===!1&&de.innerText!==de.getAttribute("data-label")&&(de.searchable=!0,de.removeAttribute("href")))}typeof a.options.onkeyup=="function"&&a.options.onkeyup(u,a,te)},A=function(te){a.options.parseURL==!0&&fe(),pe&&(te.key=="@"?(B(),te.preventDefault()):me.isOpened()&&me.keydown(te)),typeof a.options.onkeydown=="function"&&a.options.onkeydown(u,a,te),te.key=="Delete"&&te.target.tagName=="IMG"&&te.target.parentNode.classList.contains("jsnippet-image")&&(te.target.remove(),X())},C=[HTMLUnknownElement,HTMLAudioElement,HTMLEmbedElement,HTMLIFrameElement,HTMLTextAreaElement,HTMLInputElement,HTMLScriptElement],N=["width","height","align","border","src","tabindex"],U=["color","font-weight","font-size","background","background-color","margin"],R=function(te){if(te.attributes&&te.attributes.length){var de=null,Z=te.getAttribute("style");if(Z){de=[];for(var Q=Z.split(";"),ve=0;ve<Q.length;ve++){var Se=Q[ve].trim().split(":");if(U.indexOf(Se[0].trim())>=0){var Re=Se.shift(),Se=Se.join(":");de.push(Re+":"+Se)}}}te.tagName.toUpperCase()=="IMG"&&(!a.options.acceptImages||!te.src?te.parentNode.removeChild(te):(te.setAttribute("tabindex","900"),a.addImage(te.src)));var ne=[],re=te.attributes.length-1;if(re>0){for(var Ce=re;Ce>=0;Ce--)ne.push(te.attributes[Ce].name);ne.forEach(function(Me){N.indexOf(Me)==-1&&te.removeAttribute(Me)})}te.style="",de&&de.length&&te.setAttribute("style",de.join(";"))}if(te.children.length)for(var Ce=0;Ce<te.children.length;Ce++)R(te.children[Ce]);C.indexOf(te.constructor)>=0&&te.remove()},H=function(te){te&&(te=te.replace(new RegExp("<!--(.*?)-->","gsi"),""));var de=new DOMParser,Z=de.parseFromString(te,"text/html");R(Z);var Q=document.createElement("span");return Q.innerHTML=Z.firstChild.innerHTML,Q},W=function(te){if(a.options.filterPaste==!0){if(te.clipboardData||te.originalEvent.clipboardData)var de=(te.originalEvent||te).clipboardData.getData("text/html"),Z=(te.originalEvent||te).clipboardData.getData("text/plain"),Q=(te.originalEvent||te).clipboardData.files;else if(window.clipboardData)var de=window.clipboardData.getData("Html"),Z=window.clipboardData.getData("Text"),Q=window.clipboardData.files;if(Q.length)a.addFile(Q);else if(!de)de=Z.split(`\r
`),te.target.innerText?(de=de.map(function(Se){return"<div>"+Se+"</div>"}),document.execCommand("insertHtml",!1,de.join(""))):de.map(function(Se){var Re=document.createElement("div");Re.innerText=Se,T.appendChild(Re)});else{var ve=H(de);document.execCommand("insertHtml",!1,ve.innerHTML)}te.preventDefault()}},ae=function(te){S&&S.e&&te.preventDefault()},ge=function(te){S||a.options.dropZone==!1||(u.classList.add("jeditor-dragging"),te.preventDefault())},xe=function(te){S||a.options.dropZone==!1||(w&&clearTimeout(w),w=setTimeout(function(){u.classList.remove("jeditor-dragging")},100),te.preventDefault())},we=function(te){if(!(S||a.options.dropZone==!1)){var de=null;document.caretRangeFromPoint?de=document.caretRangeFromPoint(te.clientX,te.clientY):te.rangeParent&&(de=document.createRange(),de.setStart(te.rangeParent,te.rangeOffset));var Z=window.getSelection();Z.removeAllRanges(),Z.addRange(de),Z.anchorNode.parentNode.focus();var Q=(te.originalEvent||te).dataTransfer.getData("text/html"),ve=(te.originalEvent||te).dataTransfer.getData("text/plain"),Se=(te.originalEvent||te).dataTransfer.files;Se.length?a.addFile(Se):ve&&D(Q),u.classList.remove("jeditor-dragging"),te.preventDefault()}},be=function(te){pe&&me.isOpened()&&me.close(),typeof a.options.onblur=="function"&&a.options.onblur(u,a,te),P(te)},le=function(te){typeof a.options.onfocus=="function"&&a.options.onfocus(u,a,te)};T.addEventListener("mouseup",q),T.addEventListener("mousedown",G),T.addEventListener("mousemove",Y),T.addEventListener("keyup",J),T.addEventListener("keydown",A),T.addEventListener("dragstart",ae),T.addEventListener("dragenter",ge),T.addEventListener("dragover",xe),T.addEventListener("drop",we),T.addEventListener("paste",W),T.addEventListener("focus",le),T.addEventListener("blur",be),typeof a.options.onload=="function"&&a.options.onload(u,a,T),T.innerHTML=M,u.appendChild(T),a.options.snippet&&ue(a.options.snippet),a.options.toolbar==null&&(a.options.toolbar=t.editor.getDefaultToolbar()),a.options.toolbar&&(u.appendChild(_),t.toolbar(_,{container:!0,responsive:!0,items:a.options.toolbar}));var pe=null,me=null;return a.options.userSearch&&(pe=document.createElement("div"),u.appendChild(pe),me=t.search(pe,{data:a.options.userSearch,placeholder:t.translate("Type the name a user"),onselect:function(te,de,Z,Q){if(me.isOpened()){var ve=t.getNode();ve&&ve.searchable==!0&&ve.innerText.trim()&&ve.innerText.substr(1)&&(ve.innerText="@"+Z,ve.href="/"+Z,ve.setAttribute("data-user",Q),ve.setAttribute("data-label",ve.innerText),ve.searchable=!1,t.focus(ve))}}})),a.options.focus&&t.editor.setCursor(T,a.options.focus=="initial"),u.change=a.setData,u.val=function(te){if(te===void 0){var de=u.getAttribute("data-html")!=="true";return a.getData(de)}else a.setData(te)},u.editor=a,a},t.editor.setCursor=function(u,d){u.focus(),document.execCommand("selectAll");var a=window.getSelection(),b=a.getRangeAt(0);if(d==!0)var v=b.startContainer,w=0;else var v=b.endContainer,w=v.length;b.setStart(v,w),b.setEnd(v,w),a.removeAllRanges(),a.addRange(b)},t.editor.getDomain=function(u){return u.replace("http://","").replace("https://","").replace("www.","").split(/[/?#]/)[0].split(/:/g)[0]},t.editor.detectUrl=function(u){var d=/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig,a=u.match(d);return a&&a[0].substr(0,3)=="www"&&(a[0]="http://"+a[0]),a},t.editor.youtubeParser=function(u){var d=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,a=u.match(d);return a&&a[7].length==11?a[7]:!1},t.editor.getDefaultToolbar=function(){return[{content:"undo",onclick:function(){document.execCommand("undo")}},{content:"redo",onclick:function(){document.execCommand("redo")}},{type:"divisor"},{content:"format_bold",onclick:function(u,d,a){document.execCommand("bold"),document.queryCommandState("bold")?a.classList.add("selected"):a.classList.remove("selected")}},{content:"format_italic",onclick:function(u,d,a){document.execCommand("italic"),document.queryCommandState("italic")?a.classList.add("selected"):a.classList.remove("selected")}},{content:"format_underline",onclick:function(u,d,a){document.execCommand("underline"),document.queryCommandState("underline")?a.classList.add("selected"):a.classList.remove("selected")}},{type:"divisor"},{content:"format_list_bulleted",onclick:function(u,d,a){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?a.classList.add("selected"):a.classList.remove("selected")}},{content:"format_list_numbered",onclick:function(u,d,a){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?a.classList.add("selected"):a.classList.remove("selected")}},{content:"format_indent_increase",onclick:function(u,d,a){document.execCommand("indent",!0,null),document.queryCommandState("indent")?a.classList.add("selected"):a.classList.remove("selected")}},{content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}]},t.form=function(u,d){var a={};a.options={};var b={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(E,m){t.alert(m)}};for(var v in b)d&&d.hasOwnProperty(v)?a.options[v]=d[v]:a.options[v]=b[v];a.options.validations||(a.options.validations={}),a.options.submitButton||(a.options.submitButton=u.querySelector("input[type=submit]")),a.options.submitButton&&a.options.url&&(a.options.submitButton.onclick=function(){a.save()}),a.options.validations.email||(a.options.validations.email=t.validations.email),a.options.validations.length||(a.options.validations.length=t.validations.length),a.options.validations.required||(a.options.validations.required=t.validations.required),a.setUrl=function(E){a.options.url=E},a.load=function(){t.ajax({url:a.options.url,method:"GET",dataType:"json",queue:!0,success:function(E){if(typeof a.options.onbeforeload=="function"){var m=a.options.onbeforeload(u,E);m&&(E=m)}t.form.setElements(u,E),typeof a.options.onload=="function"&&a.options.onload(u,E)}})},a.save=function(){var E=a.validate();if(E)a.options.onerror(u,E);else{var m=t.form.getElements(u,!0);if(typeof a.options.onbeforesave=="function"){var m=a.options.onbeforesave(u,m);if(m===!1)return}t.ajax({url:a.options.url,method:"POST",dataType:"json",data:m,success:function(_){typeof a.options.onsave=="function"&&a.options.onsave(u,m,_)}})}},a.remove=function(){if(typeof a.options.onbeforeremove=="function"){var E=a.options.onbeforeremove(u,a);if(E===!1)return!1}t.ajax({url:a.options.url,method:"DELETE",dataType:"json",success:function(m){typeof a.options.onremove=="function"&&a.options.onremove(u,a,m),a.reset()}})};var w=function(E){E.classList.add("error"),a.options.submitButton&&a.options.submitButton.setAttribute("disabled",!0);var m=E.getAttribute("data-error")||"There is an error in the form";return E.setAttribute("title",m),m},S=function(E){var m=!1;E.classList.remove("error"),E.removeAttribute("title");for(var _=u.querySelectorAll("input, select, textarea, div[name]"),T=0;T<_.length;T++)_[T].getAttribute("data-validation")&&_[T].classList.contains("error")&&(m=!0);a.options.submitButton&&(m?a.options.submitButton.setAttribute("disabled",!0):a.options.submitButton.removeAttribute("disabled"))};return a.validateElement=function(E){var m=!1,_=t.form.getValue(E),T=E.getAttribute("data-validation");return typeof a.options.validations[T]=="function"&&!a.options.validations[T](_,E)?m=w(E):E.classList.contains("error")&&S(E),m},a.reset=function(){for(var E=u.querySelectorAll("input, select, textarea, div[name]"),m=0;m<E.length;m++)E[m].getAttribute("name")&&(E[m].type=="checkbox"||E[m].type=="radio"?E[m].checked=!1:typeof E[m].val=="function"?E[m].val(""):E[m].value="")},a.validate=function(){for(var E=[],m=u.querySelectorAll("input, select, textarea, div[name]"),_=0;_<m.length;_++)if(m[_].getAttribute("data-validation")){var T=a.validateElement(m[_]);T&&E.push(T)}return E.length>0?E.join("<br>"):!1},a.getError=function(){return!!a.validation()},a.setHash=function(){return a.getHash(t.form.getElements(u))},a.getHash=function(E){var m=0,_,T;if(E.length===0)return m;for(_=0;_<E.length;_++)T=E.charCodeAt(_),m=(m<<5)-m+T,m|=0;return m},a.isChanged=function(){var E=a.setHash();return a.options.currentHash!=E},a.resetTracker=function(){a.options.currentHash=a.setHash(),a.options.ignore=!1},a.setIgnore=function(E){a.options.ignore=!!E},setTimeout(function(){a.options.currentHash=a.setHash()},1e3),u.addEventListener("keyup",function(E){E.target.getAttribute("data-validation")&&a.validateElement(E.target)}),t.form.hasEvents||(window.addEventListener("beforeunload",function(E){if(a.isChanged()&&a.options.ignore==!1){var m=a.options.message?a.options.message:"o/";return m?(typeof E=="undefined"&&(E=window.event),E&&(E.returnValue=m),m):void 0}}),t.form.hasEvents=!0),u.form=a,a},t.form.getValue=function(u){var d=null;if(u.type=="checkbox")u.checked==!0&&(d=u.value||!0);else if(u.type=="radio")u.checked==!0&&(d=u.value);else if(u.type=="file")d=u.files;else if(u.tagName=="select"&&u.multiple==!0){d=[];for(var a=u.querySelectorAll("options[selected]"),b=0;b<a.length;b++)d.push(a[b].value)}else typeof u.val=="function"?d=u.val():d=u.value||"";return d},t.form.getElements=function(u,d){for(var a={},b=null,v=u.querySelectorAll("input, select, textarea, div[name]"),w=0;w<v.length;w++)(b=v[w].getAttribute("name"))&&(a[b]=t.form.getValue(v[w])||"");return d==!0?a:JSON.stringify(a)},t.form.setElements=function(u,d){for(var a=null,b=null,v=u.querySelectorAll("input, select, textarea, div[name]"),w=0;w<v.length;w++){var S=v[w].getAttribute("type");if(a=v[w].getAttribute("name")){if(a=a.replace(new RegExp(/\[(.*?)\]/ig),".$1"),b=null,a.match(/\./)){var E=t.path.call(d,a)||"";typeof E!="undefined"&&(b=E)}else typeof d[a]!="undefined"&&(b=d[a]);b!==null&&(S=="checkbox"||S=="radio"?v[w].checked=!!b:S=="file"||(typeof v[w].val=="function"?v[w].val(b):v[w].value=b))}}},t.tracker=t.form,t.focus=function(u){if(u.innerText.length){var d=document.createRange(),a=window.getSelection(),b=u.childNodes[u.childNodes.length-1];d.setStart(b,b.length),d.collapse(!0),a.removeAllRanges(),a.addRange(d),u.scrollLeft=u.scrollWidth}},t.isNumeric=function(u){return typeof u=="string"&&(u=u.trim()),!isNaN(u)&&u!==null&&u!==""},t.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(u){var d=Math.random()*16|0,a=u=="x"?d:d&3|8;return a.toString(16)})},t.getNode=function(){var u=document.getSelection().anchorNode;return u?u.nodeType==3?u.parentNode:u:null},t.hash=function(u){var d=0,a,b;if(u.length===0)return d;for(a=0;a<u.length;a++)b=u.charCodeAt(a),b>32&&(d=(d<<5)-d+b,d|=0);return d},t.randomColor=function(u){var d=-.25,a=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");a.length<6&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]);var b=[],v,w;for(w=0;w<3;w++)v=parseInt(a.substr(w*2,2),16),v=Math.round(Math.min(Math.max(0,v+v*d),255)).toString(16),b.push(("00"+v).substr(v.length));return u==!0?"#"+t.two(b[0].toString(16))+t.two(b[1].toString(16))+t.two(b[2].toString(16)):b},t.getWindowWidth=function(){var u=window,d=document,a=d.documentElement,b=d.getElementsByTagName("body")[0],v=u.innerWidth||a.clientWidth||b.clientWidth;return v},t.getWindowHeight=function(){var u=window,d=document,a=d.documentElement,b=d.getElementsByTagName("body")[0],v=u.innerHeight||a.clientHeight||b.clientHeight;return v},t.getPosition=function(u){if(u.changedTouches&&u.changedTouches[0])var d=u.changedTouches[0].pageX,a=u.changedTouches[0].pageY;else var d=window.Event?u.pageX:u.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),a=window.Event?u.pageY:u.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[d,a]},t.click=function(u){if(u.click)u.click();else{var d=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});u.dispatchEvent(d)}},t.findElement=function(u,d){var a=!1;function b(v){v&&!a&&(typeof d=="function"?a=d(v):typeof d=="string"&&v.classList&&v.classList.contains(d)&&(a=v)),v.parentNode&&!a&&b(v.parentNode)}return b(u),a},t.two=function(u){return u=""+u,u.length==1&&(u="0"+u),u},t.sha512=function(ge){function d(be,le){this.highOrder=be,this.lowOrder=le}var a=[new d(1779033703,4089235720),new d(3144134277,2227873595),new d(1013904242,4271175723),new d(2773480762,1595750129),new d(1359893119,2917565137),new d(2600822924,725511199),new d(528734635,4215389547),new d(1541459225,327033209)],b=[new d(1116352408,3609767458),new d(1899447441,602891725),new d(3049323471,3964484399),new d(3921009573,2173295548),new d(961987163,4081628472),new d(1508970993,3053834265),new d(2453635748,2937671579),new d(2870763221,3664609560),new d(3624381080,2734883394),new d(310598401,1164996542),new d(607225278,1323610764),new d(1426881987,3590304994),new d(1925078388,4068182383),new d(2162078206,991336113),new d(2614888103,633803317),new d(3248222580,3479774868),new d(3835390401,2666613458),new d(4022224774,944711139),new d(264347078,2341262773),new d(604807628,2007800933),new d(770255983,1495990901),new d(1249150122,1856431235),new d(1555081692,3175218132),new d(1996064986,2198950837),new d(2554220882,3999719339),new d(2821834349,766784016),new d(2952996808,2566594879),new d(3210313671,3203337956),new d(3336571891,1034457026),new d(3584528711,2466948901),new d(113926993,3758326383),new d(338241895,168717936),new d(666307205,1188179964),new d(773529912,1546045734),new d(1294757372,1522805485),new d(1396182291,2643833823),new d(1695183700,2343527390),new d(1986661051,1014477480),new d(2177026350,1206759142),new d(2456956037,344077627),new d(2730485921,1290863460),new d(2820302411,3158454273),new d(3259730800,3505952657),new d(3345764771,106217008),new d(3516065817,3606008344),new d(3600352804,1432725776),new d(4094571909,1467031594),new d(275423344,851169720),new d(430227734,3100823752),new d(506948616,1363258195),new d(659060556,3750685593),new d(883997877,3785050280),new d(958139571,3318307427),new d(1322822218,3812723403),new d(1537002063,2003034995),new d(1747873779,3602036899),new d(1955562222,1575990012),new d(2024104815,1125592928),new d(2227730452,2716904306),new d(2361852424,442776044),new d(2428436474,593698344),new d(2756734187,3733110249),new d(3204031479,2999351573),new d(3329325298,3815920427),new d(3391569614,3928383900),new d(3515267271,566280711),new d(3940187606,3454069534),new d(4118630271,4000239992),new d(116418474,1914138554),new d(174292421,2731055270),new d(289380356,3203993006),new d(460393269,320620315),new d(685471733,587496836),new d(852142971,1086792851),new d(1017036298,365543100),new d(1126000580,2618297676),new d(1288033470,3409855158),new d(1501505948,4234509866),new d(1607167915,987167468),new d(1816402316,1246189591)],v=new Array(64),w,S,E,m,_,T,M,P,B,D,L,X,ie=8;function ue(be){return unescape(encodeURIComponent(be))}function fe(be){for(var le=[],pe=(1<<ie)-1,me=be.length*ie,te=0;te<me;te+=ie)le[te>>5]|=(be.charCodeAt(te/ie)&pe)<<32-ie-te%32;return le}function q(be){for(var le="0123456789abcdef",pe="",me=be.length*4,te,de=0;de<me;de+=1)te=be[de>>2]>>(3-de%4)*8,pe+=le.charAt(te>>4&15)+le.charAt(te&15);return pe}function G(be,le){var pe,me,te,de;return pe=(be.lowOrder&65535)+(le.lowOrder&65535),me=(be.lowOrder>>>16)+(le.lowOrder>>>16)+(pe>>>16),te=(me&65535)<<16|pe&65535,pe=(be.highOrder&65535)+(le.highOrder&65535)+(me>>>16),me=(be.highOrder>>>16)+(le.highOrder>>>16)+(pe>>>16),de=(me&65535)<<16|pe&65535,new d(de,te)}function Y(be,le,pe,me){var te,de,Z,Q;return te=(be.lowOrder&65535)+(le.lowOrder&65535)+(pe.lowOrder&65535)+(me.lowOrder&65535),de=(be.lowOrder>>>16)+(le.lowOrder>>>16)+(pe.lowOrder>>>16)+(me.lowOrder>>>16)+(te>>>16),Z=(de&65535)<<16|te&65535,te=(be.highOrder&65535)+(le.highOrder&65535)+(pe.highOrder&65535)+(me.highOrder&65535)+(de>>>16),de=(be.highOrder>>>16)+(le.highOrder>>>16)+(pe.highOrder>>>16)+(me.highOrder>>>16)+(te>>>16),Q=(de&65535)<<16|te&65535,new d(Q,Z)}function J(be,le,pe,me,te){var de,Z,Q,ve;return de=(be.lowOrder&65535)+(le.lowOrder&65535)+(pe.lowOrder&65535)+(me.lowOrder&65535)+(te.lowOrder&65535),Z=(be.lowOrder>>>16)+(le.lowOrder>>>16)+(pe.lowOrder>>>16)+(me.lowOrder>>>16)+(te.lowOrder>>>16)+(de>>>16),Q=(Z&65535)<<16|de&65535,de=(be.highOrder&65535)+(le.highOrder&65535)+(pe.highOrder&65535)+(me.highOrder&65535)+(te.highOrder&65535)+(Z>>>16),Z=(be.highOrder>>>16)+(le.highOrder>>>16)+(pe.highOrder>>>16)+(me.highOrder>>>16)+(te.highOrder>>>16)+(de>>>16),ve=(Z&65535)<<16|de&65535,new d(ve,Q)}function A(be,le,pe){return new d(be.highOrder&le.highOrder^be.highOrder&pe.highOrder^le.highOrder&pe.highOrder,be.lowOrder&le.lowOrder^be.lowOrder&pe.lowOrder^le.lowOrder&pe.lowOrder)}function C(be,le,pe){return new d(be.highOrder&le.highOrder^~be.highOrder&pe.highOrder,be.lowOrder&le.lowOrder^~be.lowOrder&pe.lowOrder)}function N(be,le){return le<=32?new d(be.highOrder>>>le|be.lowOrder<<32-le,be.lowOrder>>>le|be.highOrder<<32-le):new d(be.lowOrder>>>le|be.highOrder<<32-le,be.highOrder>>>le|be.lowOrder<<32-le)}function U(be){var le=N(be,28),pe=N(be,34),me=N(be,39);return new d(le.highOrder^pe.highOrder^me.highOrder,le.lowOrder^pe.lowOrder^me.lowOrder)}function R(be){var le=N(be,14),pe=N(be,18),me=N(be,41);return new d(le.highOrder^pe.highOrder^me.highOrder,le.lowOrder^pe.lowOrder^me.lowOrder)}function H(be){var le=N(be,1),pe=N(be,8),me=ae(be,7);return new d(le.highOrder^pe.highOrder^me.highOrder,le.lowOrder^pe.lowOrder^me.lowOrder)}function W(be){var le=N(be,19),pe=N(be,61),me=ae(be,6);return new d(le.highOrder^pe.highOrder^me.highOrder,le.lowOrder^pe.lowOrder^me.lowOrder)}function ae(be,le){return le<=32?new d(be.highOrder>>>le,be.lowOrder>>>le|be.highOrder<<32-le):new d(0,be.highOrder<<32-le)}var ge=ue(ge),xe=ge.length*ie;ge=fe(ge),ge[xe>>5]|=128<<24-xe%32,ge[(xe+128>>10<<5)+31]=xe;for(var B=0;B<ge.length;B+=32){w=a[0],S=a[1],E=a[2],m=a[3],_=a[4],T=a[5],M=a[6],P=a[7];for(var D=0;D<80;D++)D<16?v[D]=new d(ge[D*2+B],ge[D*2+B+1]):v[D]=Y(W(v[D-2]),v[D-7],H(v[D-15]),v[D-16]),L=J(P,R(_),C(_,T,M),b[D],v[D]),X=G(U(w),A(w,S,E)),P=M,M=T,T=_,_=G(m,L),m=E,E=S,S=w,w=G(L,X);a[0]=G(w,a[0]),a[1]=G(S,a[1]),a[2]=G(E,a[2]),a[3]=G(m,a[3]),a[4]=G(_,a[4]),a[5]=G(T,a[5]),a[6]=G(M,a[6]),a[7]=G(P,a[7])}for(var we=[],B=0;B<a.length;B++)we.push(a[B].highOrder),we.push(a[B].lowOrder);return q(we)},t.login||(t.login={},t.login.sha512=t.sha512),t.image=t.upload=function(u,d){var a={};a.options={};var b={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null,text:{extensionNotAllowed:"The extension is not allowed"}};for(var v in b)d&&d.hasOwnProperty(v)?a.options[v]=d[v]:a.options[v]=b[v];a.options.multiple==!0&&u.setAttribute("data-multiple",!0),u.content=[],u.classList.add("jupload"),a.options.input==!0&&u.classList.add("input"),a.add=function(m){if(a.options.multiple==!1&&(u.content=[],u.innerText=""),a.options.type=="image"){var _=document.createElement("img");_.setAttribute("src",m.file),_.setAttribute("tabindex",-1),u.getAttribute("name")||(_.className="jfile",_.content=m),u.appendChild(_)}else{if(m.name)var T=m.name;else var T=m.file;var M=document.createElement("div");M.innerText=T||a.options.type,M.classList.add("jupload-item"),M.setAttribute("tabindex",-1),u.appendChild(M)}m.content&&(m.file=t.guid()),u.content.push(m),typeof a.options.onchange=="function"&&a.options.onchange(u,m)},a.addFromFile=function(m){var _=m.type.split("/");if(_[0]==a.options.type){var T=new FileReader;T.addEventListener("load",function(M){var P={file:M.srcElement.result,extension:m.name.substr(m.name.lastIndexOf(".")+1),name:m.name,size:m.size,lastmodified:m.lastModified,content:M.srcElement.result};a.add(P)}),T.readAsDataURL(m)}else alert(a.options.text.extensionNotAllowed)},a.addFromUrl=function(m){if(m.substr(0,4)!="data"&&!a.options.remoteParser)console.error("remoteParser not defined in your initialization");else if(m.substr(0,4)=="data"){var _=m.split(";");_=_[0].split("/");var T=_[0].replace("data:","");if(T==a.options.type){var M={file:m,name:"",extension:_[1],content:m};a.add(M)}else alert(a.options.text.extensionNotAllowed)}else{var _=m.substr(m.lastIndexOf(".")+1);m=a.options.remoteParser+m,t.ajax({url:m,type:"GET",dataType:"blob",success:function(B){}})}};var w=a.options.type+"/"+a.options.extension,S=document.createElement("input");S.type="file",S.setAttribute("accept",w),S.onchange=function(){for(var m=0;m<this.files.length;m++)a.addFromFile(this.files[m])},a.options.multiple==!0&&S.setAttribute("multiple",!0);var E=null;return u.addEventListener("click",function(m){E=null,!u.children.length||m.target===u?t.click(S):m.target.parentNode==u&&(E=m.target)}),u.addEventListener("dblclick",function(m){t.click(S)}),u.addEventListener("dragenter",function(m){u.style.border="1px dashed #000"}),u.addEventListener("dragleave",function(m){u.style.border="1px solid #eee"}),u.addEventListener("dragstop",function(m){u.style.border="1px solid #eee"}),u.addEventListener("dragover",function(m){m.preventDefault()}),u.addEventListener("keydown",function(m){if(E&&m.which==46){var _=Array.prototype.indexOf.call(u.children,E);_>=0&&(u.content.splice(_,1),E.remove(),E=null)}}),u.addEventListener("drop",function(m){m.preventDefault(),m.stopPropagation();var _=(m.originalEvent||m).dataTransfer.getData("text/html"),T=(m.originalEvent||m).dataTransfer.files;if(T.length)for(var M=0;M<m.dataTransfer.files.length;M++)a.addFromFile(m.dataTransfer.files[M]);else if(_){a.options.multiple==!1&&(u.innerText="");var P=document.createElement("div");P.innerHTML=_;var B=P.querySelectorAll("img");if(B.length)for(var M=0;M<B.length;M++)a.addFromUrl(B[M].src)}return u.style.border="1px solid #eee",!1}),u.val=function(m){if(m===void 0)return u.content&&u.content.length?u.content:null;if(u.innerText="",u.content=[],m)if(Array.isArray(m))for(var _=0;_<m.length;_++)typeof m[_]=="string"?a.add({file:m[_]}):a.add(m[_]);else typeof m=="string"&&a.add({file:m})},u.upload=u.image=a,a},t.image.create=function(u){var d=document.createElement("img");return d.setAttribute("src",u.file),d.className="jfile",d.setAttribute("tabindex",-1),d.content=u,d},t.lazyLoading=function(u,d){var a={};(!d.loadUp||typeof d.loadUp!="function")&&(d.loadUp=function(){return!1}),(!d.loadDown||typeof d.loadDown!="function")&&(d.loadDown=function(){return!1}),d.timer||(d.timer=100);var b=null,v=function(w){if(b==null){var S=!1,E=u.scrollTop;u.scrollTop+u.clientHeight*2>=u.scrollHeight?d.loadDown()&&(E==u.scrollTop&&(u.scrollTop=u.scrollTop-u.clientHeight),S=!0):u.scrollTop<=u.clientHeight&&d.loadUp()&&(E==u.scrollTop&&(u.scrollTop=u.scrollTop+u.clientHeight),S=!0),b=setTimeout(function(){b=null},d.timer),S&&typeof d.onupdate=="function"&&d.onupdate()}};return u.onscroll=function(w){v()},u.onwheel=function(w){v()},a},t.loading=function(){var u={},d=null;return u.show=function(){d||(d=document.createElement("div"),d.className="jloading"),document.body.appendChild(d)},u.hide=function(){d&&d.parentNode&&document.body.removeChild(d)},u}(),t.mask=function(){var u={text:["@"],currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","HH24","HH12","HH","\\[H\\]","H","AM/PM","PM","AM","MI","SS","MS","MONTH","MON","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},d=function(){if(this.mask.toLowerCase().indexOf("[h]")!==-1){var A=0;this.date[4]&&(A=parseFloat(this.date[4]/60));var C=parseInt(this.date[3])+A;C/=24}else!(this.date[0]&&this.date[1]&&this.date[2])&&(this.date[3]||this.date[4])?C=t.two(this.date[3])+":"+t.two(this.date[4])+":"+t.two(this.date[5]):(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),C=t.two(this.date[0])+"-"+t.two(this.date[1])+"-"+t.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(C+=" "+t.two(this.date[3])+":"+t.two(this.date[4])+":"+t.two(this.date[5])));return C},a=function(A){return A===null||A===""||A===void 0},G=function(A){return(""+A).chartAt(0)=="="},b=function(A){return A==="currency"||A==="percentage"||A==="numeric"},v=function(A){if(A&&Number(A)==A)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var C=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=C[1]}else{A||(A=this.mask);var N=new RegExp("0{1}(.{1})0+","ig"),C=N.exec(A);if(C&&C[1]&&C[1].length==1)return this.options.decimal=C[1],C[1];var N=new RegExp("#{1}(.{1})#+","ig"),C=N.exec(A);C&&C[1]&&C[1].length==1?C[1]===","?this.options.decimal=".":this.options.decimal=",":this.options.decimal="1.1".toLocaleString().substring(1,2)}return this.options.decimal?this.options.decimal:null},w=function(A,C){if(A=="")return"";C||(C=v.call(this)),A=(""+A).split(C);var N=A[0].match(/[-]+/g);if(N&&N.length?N=!0:N=!1,A[0]=A[0].match(/[0-9]+/g),A[0]?(N&&A[0].unshift("-"),A[0]=A[0].join("")):N&&(A[0]="-"),A[0]||A[1])A[1]!==void 0&&(A[1]=A[1].match(/[0-9]+/g),A[1]?A[1]=A[1].join(""):A[1]="");else return"";return A},S=function(A,C){if(A=="")return"";var N=v.call(this),U=this.options;if(A=w.call(this,A),A=="")return"";if(A[0]){var R=parseFloat(A[0]+".1");U.style=="percent"&&(R/=100)}else var R=null;if((A[0]=="-"||A[0]=="-00")&&!A[1]&&C&&C.inputType=="deleteContentBackward")return"";var H=new Intl.NumberFormat(this.locale,U).format(R);if(H=H.split(N),typeof H[1]!="undefined"){var W=H[1].replace(/[0-9]*/g,"");W&&(H[2]=W)}return A[1]!==void 0?H[1]=N+A[1]:H[1]="",H.join("")},E=function(A,C){var N=T.call(A);if(!!N){v.call(this);var U=S.call(this,N,C),R=U.length-N.length,H=_.call(A)+R;T.call(A,U,H,!0)}},m=function(A){var C=w.call(this,A);return C?(C[0]==="-"&&(C[0]="-0"),parseFloat(C.join("."))):null},_=function(A,C){if(A===void 0)if(this.tagName=="DIV"){var N=0,U=window.getSelection();if(U&&U.rangeCount!==0){var R=U.getRangeAt(0),H=R.cloneRange();H.selectNodeContents(this),H.setEnd(R.endContainer,R.endOffset),N=H.toString().length}return N}else return this.selectionStart;else{var W=T.call(this);if(C){for(var H=null,ae=0;ae<W.length;ae++)(W[ae].match(/[\-0-9]/g)||W[ae]=="."||W[ae]==",")&&(H=ae);H===null&&(H=W.indexOf(" ")),A>=H&&(A=H+1)}if(A>W.length&&(A=W.length),A)if(this.tagName=="DIV"){var U=window.getSelection(),R=document.createRange();this.childNodes[0]&&(R.setStart(this.childNodes[0],A),U.removeAllRanges(),U.addRange(R))}else this.selectionStart=A,this.selectionEnd=A}},T=function(A,C,N){if(this.tagName=="DIV")if(A===void 0){var A=this.innerText;return this.value&&this.value.length>A.length&&(A=this.value),A}else this.innerText!==A&&(this.innerText=A,C&&_.call(this,C,N));else{if(A===void 0)return this.value;this.value!==A&&(this.value=A,C&&_.call(this,C,N))}},M=t.calendar.weekdays,P=t.calendar.weekdaysShort,B=t.calendar.months,D=t.calendar.monthsShort,L={YEAR:function(A,C){var N=""+new Date().getFullYear();if(typeof this.values[this.index]=="undefined"&&(this.values[this.index]=""),parseInt(A)>=0&&parseInt(A)<=10&&this.values[this.index].length<C&&(this.values[this.index]+=A),this.values[this.index].length==C){if(C==2)var N=N.substr(0,2)+this.values[this.index];else if(C==3)var N=N.substr(0,1)+this.values[this.index];else if(C==4)var N=this.values[this.index];this.date[0]=N,this.index++}},YYYY:function(A){L.YEAR.call(this,A,4)},YYY:function(A){L.YEAR.call(this,A,3)},YY:function(A){L.YEAR.call(this,A,2)},FIND:function(A,C){a(this.values[this.index])&&(this.values[this.index]="");for(var N=0,U=0,R=(this.values[this.index]+A).toLowerCase(),H=0;H<C.length;H++)C[H].toLowerCase().indexOf(R)==0&&(N=H,U++);if(U>1)this.values[this.index]+=A;else if(U==1){var W=C[N].length-this.values[this.index].length-1;return this.position+=W,this.values[this.index]=C[N],this.index++,N}},MMM:function(A){var C=L.FIND.call(this,A,D);C!==void 0&&(this.date[1]=C+1)},MMMM:function(A){var C=L.FIND.call(this,A,B);C!==void 0&&(this.date[1]=C+1)},MMMMM:function(A){a(this.values[this.index])&&(this.values[this.index]="");for(var C=(this.values[this.index]+A).toLowerCase(),N=0;N<B.length;N++)if(B[N][0].toLowerCase().indexOf(C)==0){this.values[this.index]=B[N][0],this.date[1]=N+1,this.index++;break}},MM:function(A){a(this.values[this.index])?parseInt(A)>1&&parseInt(A)<10?(this.date[1]=this.values[this.index]="0"+A,this.index++):parseInt(A)<2&&(this.values[this.index]=A):this.values[this.index]==1&&parseInt(A)<3?(this.date[1]=this.values[this.index]+=A,this.index++):this.values[this.index]==0&&parseInt(A)>0&&parseInt(A)<10&&(this.date[1]=this.values[this.index]+=A,this.index++)},M:function(A){var C=!1;if(parseInt(A)>=0&&parseInt(A)<10)if(a(this.values[this.index]))this.values[this.index]=A,A>1&&(this.date[1]=this.values[this.index],this.index++);else if(this.values[this.index]==1&&parseInt(A)<3)this.date[1]=this.values[this.index]+=A,this.index++;else if(this.values[this.index]==0&&parseInt(A)>0)this.date[1]=this.values[this.index]+=A,this.index++;else var C=!0;else var C=!0;if(C==!0){var N=parseInt(this.values[this.index]);N>0&&N<12&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},D:function(A){var C=!1;if(parseInt(A)>=0&&parseInt(A)<10)if(a(this.values[this.index]))this.values[this.index]=A,parseInt(A)>3&&(this.date[2]=this.values[this.index],this.index++);else if(this.values[this.index]==3&&parseInt(A)<2)this.date[2]=this.values[this.index]+=A,this.index++;else if(this.values[this.index]==1||this.values[this.index]==2)this.date[2]=this.values[this.index]+=A,this.index++;else if(this.values[this.index]==0&&parseInt(A)>0)this.date[2]=this.values[this.index]+=A,this.index++;else var C=!0;else var C=!0;if(C==!0){var N=parseInt(this.values[this.index]);N>0&&N<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(A){a(this.values[this.index])?parseInt(A)>3&&parseInt(A)<10?(this.date[2]=this.values[this.index]="0"+A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):this.values[this.index]==3&&parseInt(A)<2?(this.date[2]=this.values[this.index]+=A,this.index++):(this.values[this.index]==1||this.values[this.index]==2)&&parseInt(A)<10?(this.date[2]=this.values[this.index]+=A,this.index++):this.values[this.index]==0&&parseInt(A)>0&&parseInt(A)<10&&(this.date[2]=this.values[this.index]+=A,this.index++)},DDD:function(A){L.FIND.call(this,A,P)},DDDD:function(A){L.FIND.call(this,A,M)},HH12:function(A,C){a(this.values[this.index])?parseInt(A)>1&&parseInt(A)<10?(C&&(A=0+A),this.date[3]=this.values[this.index]=A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):this.values[this.index]==1&&parseInt(A)<3?(this.date[3]=this.values[this.index]+=A,this.index++):this.values[this.index]<1&&parseInt(A)<10&&(this.date[3]=this.values[this.index]+=A,this.index++)},HH24:function(A,C){parseInt(A)>=0&&parseInt(A)<10&&(this.values[this.index]==null||this.values[this.index]==""?parseInt(A)>2&&parseInt(A)<10?(C&&(A=0+A),this.date[3]=this.values[this.index]=A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):this.values[this.index]==2&&parseInt(A)<4?(this.date[3]=this.values[this.index]+=A,this.index++):this.values[this.index]<2&&parseInt(A)<10&&(this.date[3]=this.values[this.index]+=A,this.index++))},HH:function(A){L.HH24.call(this,A,1)},H:function(A){L.HH24.call(this,A,0)},"\\[H\\]":function(A){this.values[this.index]==null&&(this.values[this.index]=""),A.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=A:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(A,C){this.values[this.index]==null||this.values[this.index]==""?parseInt(A)>5&&parseInt(A)<10?(this.date[C]=this.values[this.index]="0"+A,this.index++):parseInt(A)<10&&(this.values[this.index]=A):parseInt(A)<10&&(this.date[C]=this.values[this.index]+=A,this.index++)},MI:function(A){L.N60.call(this,A,4)},SS:function(A){L.N60.call(this,A,5)},"AM/PM":function(A){this.values[this.index]="",A&&(this.date[3]>12?this.values[this.index]="PM":this.values[this.index]="AM"),this.index++},WD:function(A){typeof this.values[this.index]=="undefined"&&(this.values[this.index]=""),parseInt(A)>=0&&parseInt(A)<7&&(this.values[this.index]=A),this.value[this.index].length==1&&this.index++},"0{1}(.{1}0+)?":function(A){var C=v.call(this),N=!1;a(this.values[this.index])?this.values[this.index]="":this.values[this.index]=="-"&&(N=!0);var U=w.call(this,this.values[this.index],C);U&&(this.values[this.index]=U.join(C)),parseInt(A)>=0&&parseInt(A)<10?(this.values[this.index]=="0"&&A>0?this.values[this.index]="":this.values[this.index]=="-0"&&A>0&&(this.values[this.index]="-"),(this.values[this.index]!="0"&&this.values[this.index]!="-0"||A==C)&&(this.values[this.index]+=A)):C&&A==C?this.values[this.index].indexOf(C)==-1&&(this.values[this.index]||(this.values[this.index]="0"),this.values[this.index]+=A):A=="-"&&(N=!0),N===!0&&this.values[this.index][0]!=="-"&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(A){L["0{1}(.{1}0+)?"].call(this,A),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&this.values[this.index].indexOf("%")==-1&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(A){L["0{1}(.{1}0+)?"].call(this,A);var C=v.call(this),N=this.tokens[this.index].substr(1,1),U=this.values[this.index][0]==="-",R=w.call(this,this.values[this.index],C);if(R!==""){var H=R[0].match(/[0-9]/g);if(H){H=H.join("");for(var W=[],ae=0,ge=H.length-1;ge>=0;ge--)W.push(H[ge]),ae++,ae%3||W.push(N);W=W.reverse(),R[0]=W.join(""),R[0].substr(0,1)==N&&(R[0]=R[0].substr(1))}else R[0]="";this.values[this.index]=R.join(C),U&&(this.values[this.index]="-"+this.values[this.index])}},0:function(A){A.match(/[0-9]/g)&&(this.values[this.index]=A,this.index++)},"[0-9a-zA-Z$]+":function(A){a(this.values[this.index])&&(this.values[this.index]="");var C=this.tokens[this.index],N=this.values[this.index],U=N.length;C[U]==A?(this.values[this.index]+=A,this.values[this.index]==C&&this.index++):(this.values[this.index]=C,this.index++,A.match(/[\-0-9]/g)&&this.position--)},A:function(A){A.match(/[a-zA-Z]/gi)&&(this.values[this.index]=A,this.index++)},".":function(A){L["[0-9a-zA-Z$]+"].call(this,A)},"@":function(A){a(this.values[this.index])&&(this.values[this.index]=""),this.values[this.index]+=A}},X=function(A){if(this.type=="general")var C=[].concat(u.general);else var C=[].concat(u.currency,u.datetime,u.percentage,u.numeric,u.text,u.general);var N=new RegExp(C.join("|"),"gi");return A.match(N)},ie=function(A){if(this.type)if(this.type=="text")var C=["text"];else if(this.type=="general")var C=["general"];else if(this.type=="datetime")var C=["numeric","datetime","general"];else var C=["currency","percentage","numeric","general"];else var C=Object.keys(u);for(var N=0;N<C.length;N++)for(var U=C[N],R=0;R<u[U].length;R++){var H=new RegExp(u[U][R],"gi"),W=A.match(H);if(W)return{type:U,method:u[U][R]}}},ue=function(A){for(var C=[],N=0;N<A.length;N++){var U=ie.call(this,A[N]);U?C.push(U.method):C.push(null)}for(var N=0;N<C.length;N++)C[N]=="MM"&&(C[N-1]&&C[N-1].indexOf("H")>=0||C[N-2]&&C[N-2].indexOf("H")>=0||C[N+1]&&C[N+1].indexOf("S")>=0||C[N+2]&&C[N+2].indexOf("S")>=0)&&(C[N]="MI");return C},fe=function(A){var C=ie.call(this,A);if(C)var N=C.type;if(N){for(var U=0,R=X.call(this,A),H=0;H<R.length;H++)C=ie.call(this,R[H]),C&&b(C.type)&&U++;U>1&&(N="general")}return N},q=function(){typeof L[this.methods[this.index]]=="function"?(L[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},G=function(A){var C=(""+A)[0];return C=="="},Y=function(A){return(""+ +A).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(C,N,U,R,H){return H<0?N+"0."+Array(1-H-U.length).join(0)+U+R:N+U+R+Array(H-R.length+1).join(0)})},J=function(A,C,N){var U=null,R={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if(typeof A=="object"){if(R.input=A.target,R.value=T.call(A.target),R.caret=_.call(A.target),(U=A.target.getAttribute("data-mask"))&&(R.mask=U),(U=A.target.getAttribute("data-type"))&&(R.type=U),A.target.mask?(A.target.mask.options&&(R.options=A.target.mask.options),A.target.mask.locale&&(R.locale=A.target.mask.locale)):(U=A.target.getAttribute("data-locale"))&&(R.locale=U,R.mask&&(R.options.style=R.mask)),A.target.attributes&&A.target.attributes.length)for(var H=0;H<A.target.attributes.length;H++){var W=A.target.attributes[H].name,ae=A.target.attributes[H].value;W.substr(0,4)=="data"&&(R.options[W.substr(5)]=ae)}}else{if(typeof C=="string")R.mask=C;else for(var W=Object.keys(C),H=0;H<W.length;H++)R[W[H]]=C[W[H]];typeof A=="number"&&(v.call(R,R.mask),A=(""+A).replace(".",R.options.decimal)),R.value=A,R.input&&(T.call(R.input,A),t.focus(R.input),R.caret=_.call(R.input))}if(!G(R.value)&&(R.mask||R.locale)){if(R.mask){if(R.mask=R.mask.replace(new RegExp(/\[h]/),"|h|"),R.mask=R.mask.replace(new RegExp(/\[.*?\]/),""),R.mask=R.mask.replace(new RegExp(/\|h\|/),"[h]"),R.mask.indexOf(";")!==-1){var U=R.mask.split(";");R.mask=U[0]}if(R.mask.indexOf("##")!==-1){var ge=R.mask.split(";");ge[0]&&(ge[0]=ge[0].replace("*","	"),ge[0]=ge[0].replace(new RegExp(/_-/g)," "),ge[0]=ge[0].replace(new RegExp(/_/g),""),ge[0]=ge[0].replace("##0.###","##0.000"),ge[0]=ge[0].replace("##0.##","##0.00"),ge[0]=ge[0].replace("##0.#","##0.0"),ge[0]=ge[0].replace("##0,###","##0,000"),ge[0]=ge[0].replace("##0,##","##0,00"),ge[0]=ge[0].replace("##0,#","##0,0")),R.mask=ge[0]}R.type||(R.type=fe.call(R,R.mask)),R.tokens=X.call(R,R.mask)}if(typeof A!="object"||!A.inputType||!A.inputType.indexOf("insert")||!A.inputType.indexOf("delete"))if(R.locale)if(R.input)E.call(R,R.input,A);else var xe=S.call(R,R.value);else{for(R.methods=ue.call(R,R.tokens);R.position<R.value.length&&typeof R.tokens[R.index]!="undefined";)q.call(R);var xe=R.values.join("");if(b(R.type)&&xe!==""){for(;typeof R.tokens[R.index]!="undefined";){var U=ie.call(R,R.tokens[R.index]);U&&U.type=="general"&&(R.values[R.index]=R.tokens[R.index]),R.index++}var we=!0}else var we=!1;if(xe=R.values.join(""),R.input){if(U=xe.length-R.value.length,U>0)var be=R.caret+U;else var be=R.caret;T.call(R.input,xe,be,we)}}if(R.input){var le=null;b(R.type)?(R.number=m.call(R,T.call(R.input)),R.type=="percentage"?le=R.number/100:le=R.number):R.type=="datetime"&&(le=d.call(R),R.date[0]&&R.date[1]&&R.date[2]&&R.input.setAttribute("data-completed",!0)),le&&R.input.setAttribute("data-value",le)}if(xe!==void 0)return N?R:xe}};return J.getType=fe,J.prepare=function(A,C){return C||(C={}),X.call(C,A)},J.apply=function(A){var C=T.call(A.target);A.key.length==1&&(C+=A.key),T.call(A.target,J(C,A.target.getAttribute("data-mask")))},J.run=function(A,C,N){return J(A,{mask:C,decimal:N})},J.extract=function(A,C,N){if(a(A))return A;if(typeof C!="object")return W;if(C=Object.assign({},C),C.options||(C.options={}),!C.mask&&C.format&&(C.mask=C.format),C.mask){if(C.mask.indexOf(";")!==-1){var U=C.mask.split(";");C.mask=U[0]}C.mask=C.mask.replace(new RegExp(/\[.*?\]/),"")}v.call(C,C.mask);var R=null;if(C.type=="percent"||C.options.style=="percent"?R="percentage":C.mask&&(R=fe.call(C,C.mask)),R==="general"){var H=J(A,C,!0);W=A}else if(R==="datetime"){if(A instanceof Date)var U=t.calendar.getDateString(W,C.mask);var H=J(A,C,!0);if(t.isNumeric(A))W=A;else{var W=d.call(H),U=t.calendar.now(H.date);W=t.calendar.dateToNum(U)}}else{var W=m.call(C,A);R=="percentage"&&(W/=100);var H=C}return H.value=W,!H.type&&R&&(H.type=R),N?H:W},J.render=function(A,C,N){if(a(A)||typeof C!="object")return A;if(C=Object.assign({},C),C.options||(C.options={}),!C.mask&&C.format&&(C.mask=C.format),C.mask){if(C.mask.indexOf(";")!==-1){var U=C.mask.split(";");C.mask=U[0]}C.mask=C.mask.replace(new RegExp(/\[h]/),"|h|"),C.mask=C.mask.replace(new RegExp(/\[.*?\]/),""),C.mask=C.mask.replace(new RegExp(/\|h\|/),"[h]")}var R=null;C.type=="percent"||C.options.style=="percent"?R="percentage":C.mask?R=fe.call(C,C.mask):A instanceof Date&&(R="datetime");var H=!1;if(R=="datetime"||C.type=="calendar"){var U=t.calendar.getDateString(A,C.mask);U&&(A=U),C.mask&&N&&(H=!0)}else if(R=="percentage"&&(A*=100),typeof A=="number"){var U=null;if(C.mask&&N){var W=v.call(C,C.mask);C.mask.indexOf(W)!==-1?(W=C.mask.split(W),W=""+W[1].match(/[0-9]+/g),W=W.length,U=A.toFixed(W)):U=A.toFixed(0)}else if(C.locale&&N){var W=(""+A).split(".");if(C.options){typeof W[1]=="undefined"&&(W[1]="");var ge=W[1].length;if(C.options.minimumFractionDigits>ge)for(var ae=0;ae<C.options.minimumFractionDigits-ge;ae++)W[1]+="0"}W[1].length?U=W.join("."):U=W[0];var ge=W[1].length;C.options&&C.options.maximumFractionDigits<ge&&(U=parseFloat(U).toFixed(C.options.maximumFractionDigits))}else U=Y(A);U!==null&&(A=U,v.call(C,C.mask),C.options.decimal&&(A=A.replace(".",C.options.decimal)))}else C.mask&&N&&(H=!0);if(H){var xe=C.mask.length-A.length;if(xe>0)for(var ae=0;ae<xe;ae++)A+=" "}if(A=J(A,C),N&&R==="numeric"){var we=C.mask.match(new RegExp(/^[0]+$/gm));if(we&&we.length===1){var be=we[0].length;if(be>3)for(A=""+A;A.length<be;)A="0"+A}}return A},J.set=function(A,C){if(C){A.setAttribute("data-mask",C);var N=new Event("input",{bubbles:!0,cancelable:!0});A.dispatchEvent(N)}},typeof document!="undefined"&&document.addEventListener("input",function(A){(A.target.getAttribute("data-mask")||A.target.mask)&&J(A)}),J}(),t.modal=function(u,d){var a={};a.options={};var b={url:null,onopen:null,onclose:null,closed:!1,width:null,height:null,title:null,padding:null,backdrop:!0};for(var v in b)d&&d.hasOwnProperty(v)?a.options[v]=d[v]:a.options[v]=b[v];!a.options.title&&u.getAttribute("title")&&(a.options.title=u.getAttribute("title"));for(var w=document.createElement("div");u.children[0];)w.appendChild(u.children[0]);for(a.content=document.createElement("div"),a.content.className="jmodal_content",a.content.innerHTML=u.innerHTML;w.children[0];)a.content.appendChild(w.children[0]);if(a.container=document.createElement("div"),a.container.className="jmodal",a.container.appendChild(a.content),a.options.padding&&(a.content.style.padding=a.options.padding),a.options.width&&(a.container.style.width=a.options.width),a.options.height&&(a.container.style.height=a.options.height),a.options.title?a.container.setAttribute("title",a.options.title):a.container.classList.add("no-title"),u.innerHTML="",u.style.display="none",u.appendChild(a.container),a.options.backdrop){var S=document.createElement("div");S.className="jmodal_backdrop",S.onclick=function(){a.close()},u.appendChild(S)}if(a.open=function(){u.style.display="block";var m=a.container.getBoundingClientRect();t.getWindowWidth()<m.width?(a.container.style.top="",a.container.style.left="",a.container.classList.add("jmodal_fullscreen"),t.animation.slideBottom(a.container,1)):a.options.backdrop&&(S.style.display="block"),typeof a.options.onopen=="function"&&a.options.onopen(u,a)},a.resetPosition=function(){a.container.style.top="",a.container.style.left=""},a.isOpen=function(){return u.style.display!="none"},a.close=function(){a.isOpen()&&(u.style.display="none",a.options.backdrop&&(S.style.display=""),a.container.classList.remove("jmodal_fullscreen"),typeof a.options.onclose=="function"&&a.options.onclose(u,a))},!t.modal.hasEvents){var E=null;document.addEventListener("keydown",function(m){if(m.which==27)for(var _=document.querySelectorAll(".jmodal"),T=0;T<_.length;T++)_[T].parentNode.modal.close()}),document.addEventListener("mouseup",function(m){var _=t.findElement(m.target,"jmodal");if(_){var T=_.getBoundingClientRect();if(m.changedTouches&&m.changedTouches[0])var M=m.changedTouches[0].clientX,P=m.changedTouches[0].clientY;else var M=m.clientX,P=m.clientY;T.width-(M-T.left)<50&&P-T.top<50&&_.parentNode.modal.close()}E&&(E.element.style.cursor="auto",E=null)}),document.addEventListener("mousedown",function(m){var _=t.findElement(m.target,"jmodal");if(_){var T=_.getBoundingClientRect();if(m.changedTouches&&m.changedTouches[0])var M=m.changedTouches[0].clientX,P=m.changedTouches[0].clientY;else var M=m.clientX,P=m.clientY;T.width-(M-T.left)<50&&P-T.top<50||m.target.getAttribute("title")&&P-T.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),E={left:T.left,top:T.top,x:m.clientX,y:m.clientY,width:T.width,height:T.height,element:_})}}),document.addEventListener("mousemove",function(m){if(E){if(m=m||window.event,m.buttons)var _=m.buttons;else if(m.button)var _=m.button;else var _=m.which;_?(E.element.style.top=E.top+(m.clientY-E.y)+E.height/2+"px",E.element.style.left=E.left+(m.clientX-E.x)+E.width/2+"px",E.element.style.cursor="move"):E.element.style.cursor="auto"}}),t.modal.hasEvents=!0}return a.options.url?t.ajax({url:a.options.url,method:"GET",dataType:"text/html",success:function(m){a.content.innerHTML=m,a.options.closed||a.open()}}):a.options.closed||a.open(),u.modal=a,a},t.notification=function(u){var d={};d.options={};var a={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var b in a)u&&u.hasOwnProperty(b)?d.options[b]=u[b]:d.options[b]=a[b];var v=document.createElement("div");v.className="jnotification",d.options.error&&v.classList.add("jnotification-error");var w=document.createElement("div");w.className="jnotification-container",v.appendChild(w);var S=document.createElement("div");S.className="jnotification-header",w.appendChild(S);var E=document.createElement("div");if(E.className="jnotification-image",S.appendChild(E),d.options.icon){var m=document.createElement("img");m.src=d.options.icon,E.appendChild(m)}var _=document.createElement("div");if(_.className="jnotification-name",_.innerHTML=d.options.name,S.appendChild(_),d.options.closeable==!0){var T=document.createElement("div");T.className="jnotification-close",T.onclick=function(){d.hide()},S.appendChild(T)}var M=document.createElement("div");M.className="jnotification-date",S.appendChild(M);var P=document.createElement("div");if(P.className="jnotification-content",w.appendChild(P),d.options.title){var B=document.createElement("div");B.className="jnotification-title",B.innerHTML=d.options.title,P.appendChild(B)}var D=document.createElement("div");if(D.className="jnotification-message",D.innerHTML=d.options.message,P.appendChild(D),d.show=function(){document.body.appendChild(v),t.getWindowWidth()>800?t.animation.fadeIn(v):t.animation.slideTop(v,1)},d.hide=function(){t.getWindowWidth()>800?t.animation.fadeOut(v,function(){v.parentNode&&(v.parentNode.removeChild(v),L&&clearTimeout(L))}):t.animation.slideTop(v,0,function(){v.parentNode&&(v.parentNode.removeChild(v),L&&clearTimeout(L))})},d.show(),d.options.autoHide==!0)var L=setTimeout(function(){d.hide()},d.options.timeout);return t.getWindowWidth()<800&&v.addEventListener("swipeup",function(X){d.hide(),X.preventDefault(),X.stopPropagation()}),d},t.notification.isVisible=function(){var u=document.querySelector(".jnotification");return!!(u&&u.parentNode)},t.palette=function(){var u={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]],chart:[["#C1D37F","#4C5454","#FFD275","#66586F","#D05D5B","#C96480","#95BF8F","#6EA240","#0F0F0E","#EB8258","#95A3B3","#995D81"]]},d=function(a){return u[a]?u[a]:u.material};return d.get=function(a){return u[a]?u[a]:u},d.set=function(a,b){u[a]=b},d}(),t.picker=function(u,d){if(u.picker)return u.picker.setOptions(d,!0);var a={type:"picker"};a.options={};var b=null,v=null,w=function(){v.innerHTML="";for(var E=Object.keys(a.options.data),m=0;m<E.length;m++){var _=document.createElement("div");_.classList.add("jpicker-item"),_.k=E[m],_.v=a.options.data[E[m]],_.innerHTML=a.getLabel(E[m]),v.appendChild(_)}};a.setOptions=function(E,m){var _={value:0,data:null,render:null,onchange:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,content:!1,columns:null,height:null};E&&E.options&&(E.data=E.options);for(var T in _)E&&E.hasOwnProperty(T)?a.options[T]=E[T]:(typeof a.options[T]=="undefined"||m===!0)&&(a.options[T]=_[T]);return a.options.header===!1?b.style.display="none":b.style.display="",a.options.width?b.style.width=parseInt(a.options.width)+"px":b.style.width="",a.options.height?(v.style.maxHeight=a.options.height+"px",v.style.overflow="scroll"):v.style.overflow="",a.options.columns>0&&(v.classList.add("jpicker-columns"),v.style.width=a.options.width?a.options.width:36*a.options.columns+"px"),isNaN(a.options.value)&&(a.options.value="0"),w(),a.setValue(a.options.value),a},a.getValue=function(){return a.options.value},a.setValue=function(E){a.setLabel(E),a.options.value=String(E),u.value!=a.options.value&&(u.value=a.options.value,typeof u.oninput=="function"&&u.oninput({type:"input",target:u,value:u.value})),v.children[E].getAttribute("type")!=="generic"&&a.close()},a.getLabel=function(E){var m=a.options.data[E]||null;return typeof a.options.render=="function"&&(m=a.options.render(m)),m},a.setLabel=function(E){if(a.options.content)var m='<i class="material-icons">'+a.options.content+"</i>";else var m=a.getLabel(E);b.innerHTML=m},a.open=function(){if(!u.classList.contains("jpicker-focus")){t.tracking(a,!0),u.classList.add("jpicker-focus"),u.focus();var E=0,m=0;v.style.marginLeft="";var _=b.getBoundingClientRect(),T=v.getBoundingClientRect();window.innerHeight<_.bottom+T.height?E=-1*(T.height+4):E=_.height+4,a.options.right===!0&&(m=-1*T.width+_.width),T.left+m<0&&(m=m+T.left+10),T.left+T.width>window.innerWidth&&(m=-1*(10+T.left+T.width-window.innerWidth)),v.style.marginTop=parseInt(E)+"px",v.style.marginLeft=parseInt(m)+"px",typeof a.options.onopen=="function"&&a.options.onopen(u,a)}},a.close=function(){u.classList.contains("jpicker-focus")&&(u.classList.remove("jpicker-focus"),t.tracking(a,!1),typeof a.options.onclose=="function"&&a.options.onclose(u,a))};var S=function(){u.classList.add("jpicker"),u.setAttribute("tabindex","900"),u.onmousedown=function(E){u.classList.contains("jpicker-focus")||a.open()},b=document.createElement("div"),b.classList.add("jpicker-header"),v=document.createElement("div"),v.classList.add("jpicker-content"),v.onclick=function(E){var m=t.findElement(E.target,"jpicker-item");m&&m.parentNode===v&&(a.setValue(m.k),typeof a.options.onchange=="function"&&a.options.onchange.call(a,u,a,m.v,m.v,m.k,E))},u.appendChild(b),u.appendChild(v),u.value=d.value||0,a.setOptions(d),typeof a.options.onload=="function"&&a.options.onload(u,a),u.change=a.setValue,u.val=function(E){if(E===void 0)return a.getValue();a.setValue(E)},u.picker=a};return S(),a},t.progressbar=function(u,d){var a={};a.options={};var b={value:0,onchange:null,width:null};for(var v in b)d&&d.hasOwnProperty(v)?a.options[v]=d[v]:a.options[v]=b[v];u.classList.add("jprogressbar"),u.setAttribute("tabindex",1),u.setAttribute("data-value",a.options.value);var w=document.createElement("div");w.style.width=a.options.value+"%",w.style.color="#fff",u.appendChild(w),a.options.width&&(u.style.width=a.options.width),a.setValue=function(E){E=parseInt(E),a.options.value=E,w.style.width=E+"%",u.setAttribute("data-value",E+"%"),E<6?u.style.color="#000":u.style.color="#fff",a.options.value=E,typeof a.options.onchange=="function"&&a.options.onchange(u,E),u.value!=a.options.value&&(u.value=a.options.value,typeof u.oninput=="function"&&u.oninput({type:"input",target:u,value:u.value}))},a.getValue=function(){return a.options.value};var S=function(E){if(E.which){var m=u.getBoundingClientRect();if(E.changedTouches&&E.changedTouches[0]){var _=E.changedTouches[0].clientX;E.changedTouches[0].clientY}else{var _=E.clientX;E.clientY}a.setValue(Math.round((_-m.left)/m.width*100))}};return"touchstart"in document.documentElement?(u.addEventListener("touchstart",S),u.addEventListener("touchend",S)):(u.addEventListener("mousedown",S),u.addEventListener("mousemove",S)),u.change=a.setValue,u.val=function(E){if(E===void 0)return a.getValue();a.setValue(E)},u.progressbar=a,a},t.rating=function(u,d){if(u.rating)return u.rating.setOptions(d,!0);var a={};a.options={},a.setOptions=function(v,w){var S={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var E in S)v&&v.hasOwnProperty(E)?a.options[E]=v[E]:(typeof a.options[E]=="undefined"||w===!0)&&(a.options[E]=S[E]);u.innerHTML="";for(var m=0;m<a.options.number;m++){var _=document.createElement("div");_.setAttribute("data-index",m+1),_.setAttribute("title",a.options.tooltip[m]),u.appendChild(_)}if(a.options.value)for(var m=0;m<a.options.number;m++)m<a.options.value&&u.children[m].classList.add("jrating-selected");return a},a.setValue=function(v){for(var w=0;w<a.options.number;w++)w<v?u.children[w].classList.add("jrating-selected"):(u.children[w].classList.remove("jrating-over"),u.children[w].classList.remove("jrating-selected"));a.options.value=v,typeof a.options.onchange=="function"&&a.options.onchange(u,v),u.value!=a.options.value&&(u.value=a.options.value,typeof u.oninput=="function"&&u.oninput({type:"input",target:u,value:u.value}))},a.getValue=function(){return a.options.value};var b=function(){a.setOptions(d),u.classList.add("jrating"),u.addEventListener("click",function(v){var w=v.target.getAttribute("data-index");w!=null&&(w==a.options.value?a.setValue(0):a.setValue(w))}),u.addEventListener("mouseover",function(v){for(var w=v.target.getAttribute("data-index"),S=0;S<a.options.number;S++)S<w?u.children[S].classList.add("jrating-over"):u.children[S].classList.remove("jrating-over")}),u.addEventListener("mouseout",function(v){for(var w=0;w<a.options.number;w++)u.children[w].classList.remove("jrating-over")}),u.change=a.setValue,u.val=function(v){if(v===void 0)return a.getValue();a.setValue(v)},u.rating=a};return b(),a},t.search=function(u,d){if(u.search)return u.search;var a=null,b=function(_){if(_.target.classList.contains("jsearch_item"))var T=_.target;else var T=_.target.parentNode;E.selectIndex(T),_.preventDefault()},v=function(_){if(m.innerHTML="",!_.length)u.style.display="";else{u.style.display="block";for(var T=_.length<11?_.length:10,M=0;M<T;M++){if(typeof _[M]=="string")var P=_[M],B=_[M];else{var P=_[M].text;!P&&_[M].name&&(P=_[M].name);var B=_[M].value;!B&&_[M].id&&(B=_[M].id)}var D=document.createElement("div");D.setAttribute("data-value",B),D.setAttribute("data-text",P),D.className="jsearch_item",_[M].id&&D.setAttribute("id",_[M].id),E.options.forceSelect&&M==0&&D.classList.add("selected");var L=document.createElement("img");_[M].image?L.src=_[M].image:L.style.display="none",D.appendChild(L);var X=document.createElement("div");X.innerHTML=P,D.appendChild(X),m.appendChild(D)}}},w=function(_){if(_!=E.terms)if(E.terms=_,E.options.forceSelect?a=0:a=null,Array.isArray(E.options.data)){var T=function(P){if(typeof P=="string"){if((""+P).toLowerCase().search(_.toLowerCase())>=0)return!0}else for(var B in P){var D=P[B];if((""+D).toLowerCase().search(_.toLowerCase())>=0)return!0}return!1},M=E.options.data.filter(function(P){return T(P)});v(M)}else t.ajax({url:E.options.data+_,method:"GET",dataType:"json",success:function(P){v(P)}})},S=null,E=function(_){S&&clearTimeout(S),S=setTimeout(function(){w(_)},500)};d.forceSelect===null&&(d.forceSelect=!0),E.options={data:d.data||null,input:d.input||null,searchByNode:d.searchByNode||null,onselect:d.onselect||null,forceSelect:d.forceSelect,onbeforesearch:d.onbeforesearch||null},E.selectIndex=function(_){var T=_.getAttribute("id"),M=_.getAttribute("data-text"),P=_.getAttribute("data-value");typeof E.options.onselect=="function"&&E.options.onselect(E,M,P,T),E.close()},E.open=function(){u.style.display="block"},E.close=function(){S&&clearTimeout(S),E.terms="",m.innerHTML="",u.style.display=""},E.isOpened=function(){return!!u.style.display},E.keydown=function(_){E.isOpened()&&(_.key=="Enter"?a!==null&&m.children[a]?(E.selectIndex(m.children[a]),_.preventDefault()):E.close():_.key==="ArrowUp"?(a!==null&&m.children[0]&&(m.children[a].classList.remove("selected"),!E.options.forceSelect&&a===0?a=null:(a=Math.max(0,a-1),m.children[a].classList.add("selected"))),_.preventDefault()):_.key==="ArrowDown"&&(a==null?a=-1:m.children[a].classList.remove("selected"),a<9&&m.children[a+1]&&a++,m.children[a].classList.add("selected"),_.preventDefault()))},E.keyup=function(_){if(E.options.searchByNode){var M=t.getNode();if(M)var T=M.innerText}else if(E.options.input.tagName==="DIV")var T=E.options.input.innerText;else var T=E.options.input.value;if(typeof E.options.onbeforesearch=="function"){var P=E.options.onbeforesearch(E,T);if(P)T=P;else if(P===!1)return}E(T)},E.options.input&&(E.options.input.addEventListener("keyup",E.keyup),E.options.input.addEventListener("keydown",E.keydown));var m=document.createElement("div");return m.classList.add("jsearch_container"),m.onmousedown=b,u.appendChild(m),u.classList.add("jsearch"),u.search=E,E},t.slider=function(u,d){var a={};if(a.options={},a.currentImage=null,d&&(a.options=d),u.setAttribute("tabindex","900"),a.options.items=[],!u.classList.contains("jslider")){if(u.classList.add("jslider"),u.classList.add("unselectable"),a.options.height&&(u.style.minHeight=a.options.height),a.options.width&&(u.style.width=a.options.width),a.options.grid){u.classList.add("jslider-grid");var b=u.children.length;b>4&&u.setAttribute("data-total",b-4),u.setAttribute("data-number",b>4?4:b)}var v=document.createElement("div");if(v.classList.add("jslider-counter"),u.children.length>0)for(var w=0;w<u.children.length;w++){a.options.items.push(u.children[w]);var S=document.createElement("div");S.onclick=function(){var M=Array.prototype.slice.call(v.children).indexOf(this);a.show(a.currentImage=a.options.items[M])},v.appendChild(S)}var E=document.createElement("div");E.className="jslider-caption";var m=document.createElement("div"),_=document.createElement("div");_.className="jslider-close",_.innerHTML="",_.onclick=function(){a.close()},m.appendChild(E),m.appendChild(_)}a.updateCounter=function(M){for(var P=0;P<v.children.length;P++)if(v.children[P].classList.contains("jslider-counter-focus")){v.children[P].classList.remove("jslider-counter-focus");break}v.children[M].classList.add("jslider-counter-focus")},a.show=function(M){if(!M)var M=u.children[0];u.classList.add("jslider-focus"),u.classList.remove("jslider-grid"),u.appendChild(m),u.appendChild(v);var P=a.options.items.indexOf(M);a.updateCounter(P);for(var B=0;B<u.children.length;B++)u.children[B].style.display="";M.style.display="block",M.previousElementSibling?u.classList.add("jslider-left"):u.classList.remove("jslider-left"),M.nextElementSibling&&M.nextElementSibling.tagName=="IMG"?u.classList.add("jslider-right"):u.classList.remove("jslider-right"),a.currentImage=M,a.currentImage.offsetHeight>a.currentImage.offsetWidth&&a.currentImage.classList.add("jslider-vertical"),m.children[0].innerText=a.currentImage.getAttribute("title")},a.open=function(){a.show(),typeof a.options.onopen=="function"&&a.options.onopen(u)},a.close=function(){u.classList.remove("jslider-focus"),u.classList.remove("jslider-left"),u.classList.remove("jslider-right"),a.options.grid&&u.classList.add("jslider-grid");for(var M=0;M<u.children.length;M++)u.children[M].style.display="";v.remove(),m.remove(),a.currentImage=null,typeof a.options.onclose=="function"&&a.options.onclose(u)},a.reset=function(){u.innerHTML=""},a.next=function(){var M=a.currentImage.nextElementSibling;M&&M.tagName==="IMG"&&a.show(a.currentImage.nextElementSibling)},a.prev=function(){a.currentImage.previousElementSibling&&a.show(a.currentImage.previousElementSibling)};var T=function(M){if(M.target.tagName=="IMG")a.show(M.target);else if(!M.target.classList.contains("jslider-close")&&!(M.target.parentNode.classList.contains("jslider-counter")||M.target.classList.contains("jslider-counter"))){var P=M.offsetX||M.changedTouches[0].clientX;M.target.clientWidth-P<40?a.next():P<40&&a.prev()}};return"ontouchend"in document.documentElement?u.addEventListener("touchend",T):u.addEventListener("mouseup",T),u.addEventListener("swipeleft",function(M){a.next(),M.preventDefault(),M.stopPropagation()}),u.addEventListener("swiperight",function(M){a.prev(),M.preventDefault(),M.stopPropagation()}),u.addEventListener("keydown",function(M){M.which==27&&a.close()}),u.slider=a,a},t.sorting=function(u,d){var a={};a.options={};var b={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},v=null;for(var w in b)d&&d.hasOwnProperty(w)?a.options[w]=d[w]:a.options[w]=b[w];u.classList.add("jsorting"),u.addEventListener("dragstart",function(m){var _=Array.prototype.indexOf.call(m.target.parentNode.children,m.target);v={element:m.target,o:_,d:_},m.target.style.opacity="0.25",typeof a.options.ondragstart=="function"&&a.options.ondragstart(u,m.target,m)}),u.addEventListener("dragover",function(m){if(m.preventDefault(),S(m.target)&&v&&m.target.getAttribute("draggable")=="true"&&v.element!=m.target){if(a.options.direction)var _=m.target.clientWidth/2>m.offsetX;else var _=m.target.clientHeight/2>m.offsetY;_?m.target.parentNode.insertBefore(v.element,m.target):m.target.parentNode.insertBefore(v.element,m.target.nextSibling),v.d=Array.prototype.indexOf.call(m.target.parentNode.children,v.element)}}),u.addEventListener("dragleave",function(m){m.preventDefault()}),u.addEventListener("dragend",function(m){m.preventDefault(),v&&(typeof a.options.ondragend=="function"&&a.options.ondragend(u,v.element,m),v.o<v.d?m.target.parentNode.insertBefore(v.element,m.target.parentNode.children[v.o]):m.target.parentNode.insertBefore(v.element,m.target.parentNode.children[v.o].nextSibling),v.element.style.opacity="",v=null)}),u.addEventListener("drop",function(m){m.preventDefault(),v&&v.o!=v.d&&typeof a.options.ondrop=="function"&&a.options.ondrop(u,v.o,v.d,v.element,m.target,m),v.element.style.opacity="",v=null});for(var S=function(m){var _=!1;function T(M){M.className&&M.classList.contains("jsorting")&&(_=!0),_||T(M.parentNode)}return T(m),_},E=0;E<u.children.length;E++)u.children[E].hasAttribute("draggable")||u.children[E].setAttribute("draggable","true");return u.val=function(){for(var m=null,_=[],T=0;T<u.children.length;T++)(m=u.children[T].getAttribute("data-id"))&&_.push(m);return _},u},t.tabs=function(u,d){var a={};a.options={};var b={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null,maxWidth:null};for(var v in b)d&&d.hasOwnProperty(v)?a.options[v]=d[v]:a.options[v]=b[v];u.classList.add("jtabs");var w=null,S=null,E=null,m=function(B){a.options.animation&&setTimeout(function(){var D=a.headers.children[B].getBoundingClientRect();a.options.palette=="modern"?(E.style.width=D.width-4+"px",E.style.left=a.headers.children[B].offsetLeft+2+"px"):(E.style.width=D.width+"px",E.style.left=a.headers.children[B].offsetLeft+"px"),a.options.position=="bottom"?E.style.top="0px":E.style.bottom="0px"},150)},_=function(B){typeof a.headers.scrollTo=="function"?a.headers.scrollTo({left:B,behavior:"smooth"}):a.headers.scrollLeft=B,B<=1?w.classList.add("disabled"):w.classList.remove("disabled"),B>=a.headers.scrollWidth-a.headers.offsetWidth?S.classList.add("disabled"):S.classList.remove("disabled"),a.headers.scrollWidth<=a.headers.offsetWidth?(w.style.display="none",S.style.display="none"):(w.style.display="",S.style.display="")};if(a.setBorder=m,a.open=function(B){for(var D=null,L=0;L<a.headers.children.length;L++)a.headers.children[L].classList.contains("jtabs-selected")&&(D=L),a.headers.children[L].classList.remove("jtabs-selected"),a.content.children[L]&&a.content.children[L].classList.remove("jtabs-selected");if(a.headers.children[B].classList.add("jtabs-selected"),a.content.children[B]&&a.content.children[B].classList.add("jtabs-selected"),D!=B&&typeof a.options.onchange=="function"&&a.content.children[B]&&a.options.onchange(u,a,B,a.headers.children[B],a.content.children[B]),a.options.hideHeaders==!0&&a.headers.children.length<3&&a.options.allowCreate==!1)a.headers.parentNode.style.display="none";else{m(B),a.headers.parentNode.style.display="";var X=a.headers.children[B].offsetLeft,ie=X+a.headers.children[B].offsetWidth,ue=a.headers.scrollLeft,fe=ue+a.headers.offsetWidth;ue<=X&&fe>=ie||_(X-1)}},a.selectIndex=function(B){var D=Array.prototype.indexOf.call(a.headers.children,B);return D>=0&&a.open(D),D},a.rename=function(B,D){D||(D=prompt("New title",a.headers.children[B].innerText)),a.headers.children[B].innerText=D,a.open(B)},a.create=function(B,D){if(typeof a.options.onbeforecreate=="function"){var L=a.options.onbeforecreate(u);if(L===!1)return!1;B=L}var X=a.appendElement(B);return typeof a.options.oncreate=="function"&&a.options.oncreate(u,X),m(),X},a.remove=function(B){return a.deleteElement(B)},a.nextNumber=function(){for(var B=0,D=0;D<a.headers.children.length;D++){var L=a.headers.children[D].innerText.match(/[0-9].*/);L>B&&(B=parseInt(L))}return B?B++:B=1,B},a.deleteElement=function(B){if(a.headers.children[B])a.headers.removeChild(a.headers.children[B]),a.content.removeChild(a.content.children[B]);else return!1;a.open(0),typeof a.options.ondelete=="function"&&a.options.ondelete(u,B)},a.appendElement=function(B,D){if(!B)var B=prompt("Title?","");if(B){var L=document.createElement("div");a.content.appendChild(L);var X=document.createElement("div");return X.innerHTML=B,X.content=L,a.headers.insertBefore(X,a.headers.lastChild),a.options.allowChangePosition&&X.setAttribute("draggable","true"),a.selectIndex(X),typeof D=="function"&&D(L,X),L}},a.getActive=function(){for(var B=0;B<a.headers.children.length;B++)if(a.headers.children[B].classList.contains("jtabs-selected"))return B;return 0},a.updateContent=function(B,D){if(typeof D!="string")var L=D;else{var L=document.createElement("div");L.innerHTML=D}a.content.children[B].classList.contains("jtabs-selected")&&D.classList.add("jtabs-selected"),a.content.replaceChild(D,a.content.children[B]),m()},a.updatePosition=function(B,D){B>D?a.content.insertBefore(a.content.children[B],a.content.children[D]):a.content.insertBefore(a.content.children[B],a.content.children[D].nextSibling),a.open(D),typeof a.options.onchangeposition=="function"&&a.options.onchangeposition(a.headers,B,D)},a.move=function(B,D){B>D?a.headers.insertBefore(a.headers.children[B],a.headers.children[D]):a.headers.insertBefore(a.headers.children[B],a.headers.children[D].nextSibling),a.updatePosition(B,D)},a.setBorder=m,a.init=function(){u.innerHTML="",a.headers=document.createElement("div"),a.content=document.createElement("div"),a.headers.classList.add("jtabs-headers"),a.content.classList.add("jtabs-content"),a.options.palette?u.classList.add("jtabs-modern"):u.classList.remove("jtabs-modern"),a.options.padding&&(a.content.style.padding=parseInt(a.options.padding)+"px");var B=document.createElement("div");B.className="jtabs-headers-container",B.appendChild(a.headers),a.options.maxWidth&&(B.style.maxWidth=parseInt(a.options.maxWidth)+"px");var D=document.createElement("div");if(D.className="jtabs-controls",D.setAttribute("draggable","false"),B.appendChild(D),a.options.position=="bottom"?(u.appendChild(a.content),u.appendChild(B)):(u.appendChild(B),u.appendChild(a.content)),a.options.allowCreate==!0){var L=document.createElement("div");L.className="jtabs-add",L.onclick=function(){a.create()},D.appendChild(L)}w=document.createElement("div"),w.className="jtabs-prev",w.onclick=function(){_(a.headers.scrollLeft-a.headers.offsetWidth)},D.appendChild(w),S=document.createElement("div"),S.className="jtabs-next",S.onclick=function(){_(a.headers.scrollLeft+a.headers.offsetWidth)},D.appendChild(S);for(var X=0;X<a.options.data.length;X++){if(a.options.data[X].titleElement)var ie=a.options.data[X].titleElement;else var ie=document.createElement("div");if(a.options.data[X].icon){var ue=document.createElement("div"),fe=document.createElement("i");fe.classList.add("material-icons"),fe.innerHTML=a.options.data[X].icon,ue.appendChild(fe),ie.appendChild(ue)}if(a.options.data[X].title){var q=document.createTextNode(a.options.data[X].title);ie.appendChild(q)}if(a.options.data[X].width&&(ie.style.width=a.options.data[X].width),a.options.data[X].contentElement)var G=a.options.data[X].contentElement;else{var G=document.createElement("div");G.innerHTML=a.options.data[X].content}a.headers.appendChild(ie),a.content.appendChild(G)}E=document.createElement("div"),E.className="jtabs-border",a.headers.appendChild(E),a.options.animation&&u.classList.add("jtabs-animation"),a.headers.addEventListener("click",function(Y){if(Y.target.parentNode.classList.contains("jtabs-headers"))var J=Y.target;else if(Y.target.tagName=="I")var J=Y.target.parentNode.parentNode;else var J=Y.target.parentNode;var A=a.selectIndex(J);typeof a.options.onclick=="function"&&a.options.onclick(u,a,A,a.headers.children[A],a.content.children[A])}),a.headers.addEventListener("contextmenu",function(Y){a.selectIndex(Y.target)}),a.headers.children.length&&a.open(0),_(0),a.options.allowChangePosition==!0&&t.sorting(a.headers,{direction:1,ondrop:function(Y,J,A){a.updatePosition(J,A)}}),typeof a.options.onload=="function"&&a.options.onload(u,a)},u.children[0]&&u.children[0].children.length)for(var T=0;T<u.children[0].children.length;T++){var M=a.options.data&&a.options.data[T]?a.options.data[T]:{};u.children[1]&&u.children[1].children[T]?(M.titleElement=u.children[0].children[T],M.contentElement=u.children[1].children[T]):M.contentElement=u.children[0].children[T],a.options.data[T]=M}var P=!1;if(a.options.data)for(var T=0;T<a.options.data.length;T++)a.options.data[T].url&&(t.ajax({url:a.options.data[T].url,type:"GET",dataType:"text/html",index:T,success:function(D){a.options.data[this.index].content=D},complete:function(){a.init()}}),P=!0);return P||a.init(),u.tabs=a,a},t.tags=function(u,d){if(u.tags)return u.tags.setOptions(d,!0);var a={type:"tags"};a.options={};var b=function(){return!!(a.options.limit&&u.children.length>=a.options.limit)},v=null,w=null;a.setOptions=function(q,G){var Y={value:"",limit:null,limitMessage:null,search:null,placeholder:null,validation:null,onbeforepaste:null,onbeforechange:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null,colors:null};for(var J in Y)q&&q.hasOwnProperty(J)?a.options[J]=q[J]:(typeof a.options[J]=="undefined"||G===!0)&&(a.options[J]=Y[J]);return a.options.placeholder?u.setAttribute("data-placeholder",a.options.placeholder):u.removeAttribute("data-placeholder"),u.placeholder=a.options.placeholder,a.setValue(a.options.value),_(),a.options.search?w||(w=document.createElement("div"),u.parentNode.insertBefore(w,u.nextSibling),v=t.search(w,{data:a.options.search,onselect:function(A,C,N){a.selectIndex(C,N)}})):w&&(v=null,w.remove(),w=null),a},a.add=function(q,G){if(typeof a.options.onbeforechange=="function"){var Y=a.options.onbeforechange(u,a,a.options.value,q);if(Y===!1)return!1;Y!=null&&(q=Y)}if(v&&v.close(),b())typeof a.options.onlimit=="function"?a.options.onlimit(a,a.options.limit):a.options.limitMessage&&alert(a.options.limitMessage+" "+a.options.limit);else{var J=t.getNode();if(J&&J.parentNode&&J.parentNode.classList.contains("jtags")&&J.nextSibling&&!(J.nextSibling.innerText&&J.nextSibling.innerText.trim()))A=J.nextSibling;else{if(u.lastChild&&(u.lastChild.innerText.trim()||u.removeChild(u.lastChild)),!q||typeof q=="string")var A=E(q,q,J);else for(var C=0;C<=q.length;C++)if(!b()){if(!q[C]||typeof q[C]=="string")var N=q[C]||"",U=null;else var N=q[C].text,U=q[C].value;var A=E(N,U)}m()}G&&S(A)}},a.setLimit=function(q){for(a.options.limit=q,u.children.length-q;u.children.length>q;)u.removeChild(u.lastChild)},a.remove=function(q){q.parentNode.removeChild(q),u.children.length?m():a.add("",!0)},a.getData=function(){for(var q=[],G=0;G<u.children.length;G++){var Y=u.children[G].innerText.replace(`
`,""),J=u.children[G].getAttribute("data-value");J||(J=Y),(Y||J)&&q.push({text:Y,value:J})}return q},a.getValue=function(q){var G=null;if(q!=null)G=u.children[q].getAttribute("data-value"),G||(G=u.children[q].innerText.replace(`
`,""));else{for(var Y=[],J=0;J<u.children.length;J++)G=u.children[J].innerText.replace(`
`,""),G&&Y.push(a.getValue(J));G=Y.join(",")}return G},a.setValue=function(q){if(!q)a.reset();else if(u.value!=q)if(Array.isArray(q))a.add(q);else{var G=(""+q).trim(),Y=M(G);u.innerHTML="",a.add(Y)}},a.reset=function(){u.classList.add("jtags-empty"),u.innerHTML="<div></div>",m()},a.isValid=function(){for(var q=0,G=0;G<u.children.length;G++)u.children[G].classList.contains("jtags_error")&&q++;return q==0},a.selectIndex=function(q,G){var Y=t.getNode();Y&&(Y.innerText=q,G&&Y.setAttribute("data-value",G),Y.classList.remove("jtags_error"),b()||a.add("",!0))},a.search=function(q){q.innerText},a.destroy=function(){u.removeEventListener("mouseup",X),u.removeEventListener("keydown",B),u.removeEventListener("keyup",D),u.removeEventListener("paste",L),u.removeEventListener("focus",ie),u.removeEventListener("blur",ue),u.parentNode.removeChild(u)};var S=function(q){if(u.children.length>1){var G=document.createRange(),Y=window.getSelection();if(!q)var q=u.childNodes[u.childNodes.length-1];G.setStart(q,q.length),G.collapse(!0),Y.removeAllRanges(),Y.addRange(G),u.scrollLeft=u.scrollWidth}},E=function(q,G,Y){var J=document.createElement("div");return J.innerHTML=q||"",G&&J.setAttribute("data-value",G),Y&&Y.parentNode.classList.contains("jtags")?u.insertBefore(J,Y.nextSibling):u.appendChild(J),J},m=function(){var q=a.getValue();q!=a.options.value&&(a.options.value=q,typeof a.options.onchange=="function"&&a.options.onchange(u,a,a.options.value),u.value!=a.options.value&&(u.value=a.options.value,typeof u.oninput=="function"&&u.oninput({type:"input",target:u,value:u.value}))),_()},_=function(){for(var q=0;q<u.children.length;q++)a.getValue(q)?(u.children[q].classList.add("jtags_label"),typeof a.options.validation=="function"&&a.getValue(q)?a.options.validation(u.children[q],u.children[q].innerText,u.children[q].getAttribute("data-value"))?u.children[q].classList.remove("jtags_error"):u.children[q].classList.add("jtags_error"):u.children[q].classList.remove("jtags_error")):u.children[q].classList.remove("jtags_label");T()},T=function(){u.innerText.trim()?u.classList.remove("jtags-empty"):(u.innerHTML="<div></div>",u.classList.add("jtags-empty"))},M=function(q){var G=[],Y="";if(q=q.trim(),q){for(var J=0;J<q.length;J++)q[J]==","||q[J]==";"||q[J]==`
`?Y&&(G.push(Y.trim()),Y=""):Y+=q[J];Y&&G.push(Y)}return G},P=0,B=function(q){if(P=window.getSelection().anchorOffset,T(),q.key==="Tab"||q.key===";"||q.key===","){var G=window.getSelection().anchorOffset;G>1&&(b()?typeof a.options.onlimit=="function"&&a.options.onlimit(a,a.options.limit):a.add("",!0)),q.preventDefault()}else if(q.key=="Enter"){if(!v||!v.isOpened()){var G=window.getSelection().anchorOffset;G>1&&(b()||a.add("",!0)),q.preventDefault()}}else q.key=="Backspace"&&u.children.length==1&&window.getSelection().anchorOffset<1&&q.preventDefault();v&&v.keydown(q)},D=function(q){if(q.which==39){var G=window.getSelection().anchorOffset;G>1&&G==P&&a.add("",!0)}else q.which==13||q.which==38||q.which==40?q.preventDefault():v&&v.keyup(q);_()},L=function(q){if(q.clipboardData||q.originalEvent.clipboardData)var G=(q.originalEvent||q).clipboardData.getData("text/plain");else if(window.clipboardData)var G=window.clipboardData.getData("Text");var Y=M(G);if(typeof a.options.onbeforepaste=="function"){var J=a.options.onbeforepaste(u,a,Y);if(J===!1)return q.preventDefault(),!1;J&&(Y=J)}Y.length>1?(a.add(Y,!0),q.preventDefault()):Y[0]&&(document.execCommand("insertText",!1,Y[0]),q.preventDefault())},X=function(q){if(q.target.parentNode&&q.target.parentNode.classList.contains("jtags")&&(q.target.classList.contains("jtags_label")||q.target.classList.contains("jtags_error"))){var G=q.target.getBoundingClientRect();G.width-(q.clientX-G.left)<16&&a.remove(q.target)}q.target==u&&S()},ie=function(){u.classList.contains("jtags-focus")||((!u.children.length||a.getValue(u.children.length-1))&&(b()||E("")),typeof a.options.onfocus=="function"&&a.options.onfocus(u,a,a.getValue()),u.classList.add("jtags-focus"))},ue=function(){if(u.classList.contains("jtags-focus")){v&&v.close();for(var q=0;q<u.children.length-1;q++)a.getValue(q)||u.removeChild(u.children[q]);m(),u.classList.remove("jtags-focus"),typeof a.options.onblur=="function"&&a.options.onblur(u,a,a.getValue())}},fe=function(){"touchend"in document.documentElement?u.addEventListener("touchend",X):u.addEventListener("mouseup",X),u.addEventListener("keydown",B),u.addEventListener("keyup",D),u.addEventListener("paste",L),u.addEventListener("focus",ie),u.addEventListener("blur",ue),u.setAttribute("contenteditable",!0),u.classList.add("jtags"),a.setOptions(d),typeof a.options.onload=="function"&&a.options.onload(u,a),u.change=a.setValue,u.val=function(q){if(q===void 0)return a.getValue();a.setValue(q)},u.tags=a};return fe(),a},t.toolbar=function(u,d){var a={type:"toolbar"};a.options={};var b={app:null,container:!1,badge:!1,title:!1,responsive:!1,maxWidth:null,bottom:!0,items:[]};for(var v in b)d&&d.hasOwnProperty(v)?a.options[v]=d[v]:a.options[v]=b[v];!u&&d.app&&d.app.el&&(u=document.createElement("div"),d.app.el.appendChild(u));var w=document.createElement("div");w.classList.add("jtoolbar-item"),w.classList.add("jtoolbar-arrow");var S=document.createElement("div");S.classList.add("jtoolbar-floating"),w.appendChild(S),a.selectItem=function(m){for(var _=E.children,T=0;T<_.length;T++)m!=_[T]&&_[T].classList.remove("jtoolbar-selected");m.classList.add("jtoolbar-selected")},a.hide=function(){t.animation.slideBottom(u,0,function(){u.style.display="none"})},a.show=function(){u.style.display="",t.animation.slideBottom(u,1)},a.get=function(){return u},a.setBadge=function(m,_){E.children[m].children[1].firstChild.innerHTML=_},a.destroy=function(){toolbar.remove(),u.innerHTML=""},a.update=function(m,_){for(var T=0;T<E.children.length;T++){var M=E.children[T];typeof M.updateState=="function"&&M.updateState(u,a,M,m,_)}for(var T=0;T<S.children.length;T++){var M=S.children[T];typeof M.updateState=="function"&&M.updateState(u,a,M,m,_)}},a.create=function(m){E.innerHTML="";for(var _=0;_<m.length;_++){var T=document.createElement("div");if(T.classList.add("jtoolbar-item"),m[_].width&&(T.style.width=parseInt(m[_].width)+"px"),m[_].k&&(T.k=m[_].k),m[_].tooltip&&T.setAttribute("title",m[_].tooltip),m[_].id&&T.setAttribute("id",m[_].id),m[_].updateState&&(T.updateState=m[_].updateState),m[_].active&&T.classList.add("jtoolbar-active"),m[_].type=="select"||m[_].type=="dropdown")t.picker(T,m[_]);else if(m[_].type=="divisor")T.classList.add("jtoolbar-divisor");else if(m[_].type=="label")T.classList.add("jtoolbar-label"),T.innerHTML=m[_].content;else{var M=document.createElement("i");if(typeof m[_].class=="undefined")M.classList.add("material-icons");else for(var P=m[_].class.split(" "),B=0;B<P.length;B++)M.classList.add(P[B]);if(M.innerHTML=m[_].content?m[_].content:"",T.appendChild(M),a.options.badge==!0){var D=document.createElement("div");D.classList.add("jbadge");var L=document.createElement("div");L.innerHTML=m[_].badge?m[_].badge:"",D.appendChild(L),T.appendChild(D)}if(m[_].title)if(a.options.title==!0){var X=document.createElement("span");X.innerHTML=m[_].title,T.appendChild(X)}else T.setAttribute("title",m[_].title);a.options.app&&m[_].route&&(T.route=m[_].route,T.onclick=function(){a.options.app.pages(this.route)},a.options.app.pages(m[_].route,{toolbarItem:T,closed:!0}))}m[_].onclick&&(T.onclick=m[_].onclick.bind(m[_],u,a,T)),E.appendChild(T)}setTimeout(function(){a.refresh()},0)},a.open=function(){w.classList.add("jtoolbar-arrow-selected"),u.getBoundingClientRect();var m=S.getBoundingClientRect();m.bottom>window.innerHeight||a.options.bottom?S.style.bottom="0":S.style.removeProperty("bottom"),S.style.right="0",w.children[0].focus(),t.tracking(a,!0)},a.close=function(){w.classList.remove("jtoolbar-arrow-selected"),t.tracking(a,!1)},a.refresh=function(){if(a.options.responsive==!0){var m=u.parentNode.getBoundingClientRect();a.options.maxWidth||(a.options.maxWidth=m.width);var _=parseInt(a.options.maxWidth);for(w.parentNode&&w.parentNode.removeChild(w);S.firstChild;)E.appendChild(S.firstChild);if(_<E.offsetWidth)for(_-=50;E.lastChild&&_<E.offsetWidth;)S.insertBefore(E.lastChild,S.firstChild);S.children.length>0&&E.appendChild(w)}},a.setReadonly=function(m){m=m?"add":"remove",u.classList[m]("jtoolbar-readonly")},u.onclick=function(m){var _=t.findElement(m.target,"jtoolbar-item");_&&a.selectItem(_),m.target.classList.contains("jtoolbar-arrow")&&a.open()},window.addEventListener("resize",function(){a.refresh()}),u.classList.add("jtoolbar"),u.innerHTML="",a.options.container==!0&&u.classList.add("jtoolbar-container");var E=document.createElement("div");return u.appendChild(E),a.options.app&&u.classList.add("jtoolbar-mobile"),a.create(a.options.items),u.toolbar=a,a},t.validations=function(){var u=function(w){return!isNaN(w)&&w!==null&&w!==""},d={between:function(w,S){return w>=S[0]&&w<=S[1]},"not between":function(w,S){return w<S[0]||w>S[1]},"<":function(w,S){return w<S[0]},"<=":function(w,S){return w<=S[0]},">":function(w,S){return w>S[0]},">=":function(w,S){return w>=S[0]},"=":function(w,S){return w==S[0]},"!=":function(w,S){return w!=S[0]}},a={"valid date":function(){return!0},"=":function(w,S){return w===S[0]},"<":function(w,S){return w<S[0]},"<=":function(w,S){return w<=S[0]},">":function(w,S){return w>S[0]},">=":function(w,S){return w>=S[0]},between:function(w,S){return w>=S[0]&&w<=S[1]},"not between":function(w,S){return w<S[0]||w>S[1]}},b={contains:function(w,S){return w.includes(S[0])},"not contains":function(w,S){return!w.includes(S[0])},"begins with":function(w,S){return w.startsWith(S[0])},"ends with":function(w,S){return w.endsWith(S[0])},"=":function(w,S){return w===S[0]},"valid email":function(w){var S=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return S.test(w)},"valid url":function(w){var S=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return S.test(w)}},v=function(w,S){return typeof v[S.type]=="function"?S.allowBlank&&w===""?!0:v[S.type](w,S):null};return v.url=function(){var w=new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/ig);return!!w.test(data)},v.email=function(w){var S=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!!(w&&S.test(w))},v.required=function(w){return!!w.trim()},v.exist=function(w,S){return!!w.toString()},v["not exist"]=function(w,S){return!w.toString()},v.number=function(w,S){if(!u(w))return!1;if(!S||!S.criteria)return!0;if(!d[S.criteria])return!1;var E=S.value.map(function(m){return parseFloat(m)});return d[S.criteria](w,E)},v.login=function(w){var S=new RegExp(/^[a-zA-Z0-9\_\-\.\s+]+$/);return!!(w&&S.test(w))},v.list=function(w,S){var E=typeof w;if(E!=="string"&&E!=="number")return!1;if(typeof S.value[0]=="string")var m=S.value[0].split(",");else var m=S.value[0];var _=m.findIndex(function(M){return M==w});return _>-1},v.date=function(w,S){if(new Date(w)=="Invalid Date")return!1;if(!S||!S.criteria)return!0;if(!a[S.criteria])return!1;var E=S.value.map(function(m){return new Date(m).getTime()});return a[S.criteria](new Date(w).getTime(),E)},v.text=function(w,S){return typeof w!="string"?!1:!S||!S.criteria?!0:b[S.criteria]?b[S.criteria](w,S.value):!1},v.textLength=function(w,S){return w=w.toString(),v.number(w.length,S)},v}(),t})})(jsuites);(function(module,exports){var formula=function(){var error=function(){var e={};return e.nil=new Error("#NULL!"),e.div0=new Error("#DIV/0!"),e.value=new Error("#VALUE!"),e.ref=new Error("#REF!"),e.name=new Error("#NAME?"),e.num=new Error("#NUM!"),e.na=new Error("#N/A"),e.error=new Error("#ERROR!"),e.data=new Error("#GETTING_DATA"),e}(),utils=function(){var e={};e.flattenShallow=function(t){return!t||!t.reduce?t:t.reduce(function(r,s){var f=Array.isArray(r),h=Array.isArray(s);return f&&h?r.concat(s):f?(r.push(s),r):h?[r].concat(s):[r,s]})},e.isFlat=function(t){if(!t)return!1;for(var r=0;r<t.length;++r)if(Array.isArray(t[r]))return!1;return!0},e.flatten=function(){for(var t=e.argsToArray.apply(null,arguments);!e.isFlat(t);)t=e.flattenShallow(t);return t},e.argsToArray=function(t){var r=[];return e.arrayEach(t,function(s){r.push(s)}),r},e.numbers=function(){var t=this.flatten.apply(null,arguments);return t.filter(function(r){return typeof r=="number"})},e.cleanFloat=function(t){var r=1e14;return Math.round(t*r)/r},e.parseBool=function(t){if(typeof t=="boolean"||t instanceof Error)return t;if(typeof t=="number")return t!==0;if(typeof t=="string"){var r=t.toUpperCase();if(r==="TRUE")return!0;if(r==="FALSE")return!1}return t instanceof Date&&!isNaN(t)?!0:error.value},e.parseNumber=function(t){return t===void 0||t===""||isNaN(t)?error.value:parseFloat(t)},e.parseNumberArray=function(t){var r;if(!t||(r=t.length)===0)return error.value;for(var s;r--;){if(s=e.parseNumber(t[r]),s===error.value)return s;t[r]=s}return t},e.parseMatrix=function(t){if(!t||t.length===0)return error.value;for(var r,s=0;s<t.length;s++)if(r=e.parseNumberArray(t[s]),t[s]=r,r instanceof Error)return r;return t};var o=new Date(Date.UTC(1900,0,1));return e.parseDate=function(t){if(!isNaN(t)){if(t instanceof Date)return new Date(t);var r=parseInt(t,10);return r<0?error.num:r<=60?new Date(o.getTime()+(r-1)*864e5):new Date(o.getTime()+(r-2)*864e5)}return typeof t=="string"&&(t=new Date(t),!isNaN(t))?t:error.value},e.parseDateArray=function(t){for(var r=t.length,s;r--;){if(s=this.parseDate(t[r]),s===error.value)return s;t[r]=s}return t},e.anyIsError=function(){for(var t=arguments.length;t--;)if(arguments[t]instanceof Error)return!0;return!1},e.arrayValuesToNumbers=function(t){for(var r=t.length,s;r--;)if(s=t[r],typeof s!="number"){if(s===!0){t[r]=1;continue}if(s===!1){t[r]=0;continue}if(typeof s=="string"){var f=this.parseNumber(s);f instanceof Error?t[r]=0:t[r]=f}}return t},e.rest=function(t,r){return r=r||1,!t||typeof t.slice!="function"?t:t.slice(r)},e.initial=function(t,r){return r=r||1,!t||typeof t.slice!="function"?t:t.slice(0,t.length-r)},e.arrayEach=function(t,r){for(var s=-1,f=t.length;++s<f&&r(t[s],s,t)!==!1;);return t},e.transpose=function(t){return t?t[0].map(function(r,s){return t.map(function(f){return f[s]})}):error.value},e}(),met={};met.datetime=function(){var e={},o=new Date(1900,0,1),t=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];e.DATE=function(s,f,h){if(s=utils.parseNumber(s),f=utils.parseNumber(f),h=utils.parseNumber(h),utils.anyIsError(s,f,h))return error.value;if(s<0||f<0||h<0)return error.num;var g=new Date(s,f-1,h);return g},e.DATEVALUE=function(s){if(typeof s!="string")return error.value;var f=Date.parse(s);return isNaN(f)?error.value:f<=-22038912e5?(f-o)/864e5+1:(f-o)/864e5+2},e.DAY=function(s){var f=utils.parseDate(s);return f instanceof Error?f:f.getDate()},e.DAYS=function(s,f){return s=utils.parseDate(s),f=utils.parseDate(f),s instanceof Error?s:f instanceof Error?f:r(s)-r(f)},e.DAYS360=function(s,f,h){},e.EDATE=function(s,f){return s=utils.parseDate(s),s instanceof Error?s:isNaN(f)?error.value:(f=parseInt(f,10),s.setMonth(s.getMonth()+f),r(s))},e.EOMONTH=function(s,f){return s=utils.parseDate(s),s instanceof Error?s:isNaN(f)?error.value:(f=parseInt(f,10),r(new Date(s.getFullYear(),s.getMonth()+f+1,0)))},e.HOUR=function(s){return s=utils.parseDate(s),s instanceof Error?s:s.getHours()},e.INTERVAL=function(s){if(typeof s!="number"&&typeof s!="string")return error.value;s=parseInt(s,10);var f=Math.floor(s/94608e4);s=s%94608e4;var h=Math.floor(s/2592e3);s=s%2592e3;var g=Math.floor(s/86400);s=s%86400;var u=Math.floor(s/3600);s=s%3600;var d=Math.floor(s/60);s=s%60;var a=s;return f=f>0?f+"Y":"",h=h>0?h+"M":"",g=g>0?g+"D":"",u=u>0?u+"H":"",d=d>0?d+"M":"",a=a>0?a+"S":"","P"+f+h+g+"T"+u+d+a},e.ISOWEEKNUM=function(s){if(s=utils.parseDate(s),s instanceof Error)return s;s.setHours(0,0,0),s.setDate(s.getDate()+4-(s.getDay()||7));var f=new Date(s.getFullYear(),0,1);return Math.ceil(((s-f)/864e5+1)/7)},e.MINUTE=function(s){return s=utils.parseDate(s),s instanceof Error?s:s.getMinutes()},e.MONTH=function(s){return s=utils.parseDate(s),s instanceof Error?s:s.getMonth()+1},e.NETWORKDAYS=function(s,f,h){},e.NETWORKDAYS.INTL=function(s,f,h,g){},e.NOW=function(){return new Date},e.SECOND=function(s){return s=utils.parseDate(s),s instanceof Error?s:s.getSeconds()},e.TIME=function(s,f,h){return s=utils.parseNumber(s),f=utils.parseNumber(f),h=utils.parseNumber(h),utils.anyIsError(s,f,h)?error.value:s<0||f<0||h<0?error.num:(3600*s+60*f+h)/86400},e.TIMEVALUE=function(s){return s=utils.parseDate(s),s instanceof Error?s:(3600*s.getHours()+60*s.getMinutes()+s.getSeconds())/86400},e.TODAY=function(){return new Date},e.WEEKDAY=function(s,f){if(s=utils.parseDate(s),s instanceof Error)return s;f===void 0&&(f=1);var h=s.getDay();return t[f][h]},e.WEEKNUM=function(s,f){},e.WORKDAY=function(s,f,h){},e.WORKDAY.INTL=function(s,f,h,g){},e.YEAR=function(s){return s=utils.parseDate(s),s instanceof Error?s:s.getFullYear()},e.YEARFRAC=function(s,f,h){};function r(s){var f=s>-22038912e5?2:1;return(s-o)/864e5+f}return e}(),met.database=function(){var exports={};function compact(e){if(!e)return e;for(var o=[],t=0;t<e.length;++t)!e[t]||o.push(e[t]);return o}exports.FINDFIELD=function(e,o){for(var t=null,r=0;r<e.length;r++)if(e[r][0]===o){t=r;break}return t==null?error.value:t};function findResultIndex(database,criterias){for(var matches={},i=1;i<database[0].length;++i)matches[i]=!0;var maxCriteriaLength=criterias[0].length;for(i=1;i<criterias.length;++i)criterias[i].length>maxCriteriaLength&&(maxCriteriaLength=criterias[i].length);for(var k=1;k<database.length;++k)for(var l=1;l<database[k].length;++l){for(var currentCriteriaResult=!1,hasMatchingCriteria=!1,j=0;j<criterias.length;++j){var criteria=criterias[j];if(!(criteria.length<maxCriteriaLength)){var criteriaField=criteria[0];if(database[k][0]===criteriaField){hasMatchingCriteria=!0;for(var p=1;p<criteria.length;++p)currentCriteriaResult=currentCriteriaResult||eval(database[k][l]+criteria[p])}}}hasMatchingCriteria&&(matches[l]=matches[l]&&currentCriteriaResult)}for(var result=[],n=0;n<database[0].length;++n)matches[n]&&result.push(n-1);return result}return exports.DAVERAGE=function(e,o,t){if(isNaN(o)&&typeof o!="string")return error.value;var r=findResultIndex(e,t),s=[];if(typeof o=="string"){var f=exports.FINDFIELD(e,o);s=utils.rest(e[f])}else s=utils.rest(e[o]);for(var h=0,g=0;g<r.length;g++)h+=s[r[g]];return r.length===0?error.div0:h/r.length},exports.DCOUNT=function(e,o,t){},exports.DCOUNTA=function(e,o,t){},exports.DGET=function(e,o,t){if(isNaN(o)&&typeof o!="string")return error.value;var r=findResultIndex(e,t),s=[];if(typeof o=="string"){var f=exports.FINDFIELD(e,o);s=utils.rest(e[f])}else s=utils.rest(e[o]);return r.length===0?error.value:r.length>1?error.num:s[r[0]]},exports.DMAX=function(e,o,t){if(isNaN(o)&&typeof o!="string")return error.value;var r=findResultIndex(e,t),s=[];if(typeof o=="string"){var f=exports.FINDFIELD(e,o);s=utils.rest(e[f])}else s=utils.rest(e[o]);for(var h=s[r[0]],g=1;g<r.length;g++)h<s[r[g]]&&(h=s[r[g]]);return h},exports.DMIN=function(e,o,t){if(isNaN(o)&&typeof o!="string")return error.value;var r=findResultIndex(e,t),s=[];if(typeof o=="string"){var f=exports.FINDFIELD(e,o);s=utils.rest(e[f])}else s=utils.rest(e[o]);for(var h=s[r[0]],g=1;g<r.length;g++)h>s[r[g]]&&(h=s[r[g]]);return h},exports.DPRODUCT=function(e,o,t){if(isNaN(o)&&typeof o!="string")return error.value;var r=findResultIndex(e,t),s=[];if(typeof o=="string"){var f=exports.FINDFIELD(e,o);s=utils.rest(e[f])}else s=utils.rest(e[o]);for(var h=[],g=0;g<r.length;g++)h[g]=s[r[g]];h=compact(h);var u=1;for(g=0;g<h.length;g++)u*=h[g];return u},exports.DSTDEV=function(e,o,t){},exports.DSTDEVP=function(e,o,t){},exports.DSUM=function(e,o,t){},exports.DVAR=function(e,o,t){},exports.DVARP=function(e,o,t){},exports.MATCH=function(e,o,t){if(!e&&!o||(arguments.length===2&&(t=1),!(o instanceof Array))||t!==-1&&t!==0&&t!==1)return error.na;for(var r,s,f=0;f<o.length;f++)if(t===1){if(o[f]===e)return f+1;o[f]<e&&(s?o[f]>s&&(r=f+1,s=o[f]):(r=f+1,s=o[f]))}else if(t===0){if(typeof e=="string"){if(e=e.replace(/\?/g,"."),o[f].toLowerCase().match(e.toLowerCase()))return f+1}else if(o[f]===e)return f+1}else if(t===-1){if(o[f]===e)return f+1;o[f]>e&&(s?o[f]<s&&(r=f+1,s=o[f]):(r=f+1,s=o[f]))}return r||error.na},exports}(),met.engineering=function(){var e={};function o(t){return/^[01]{1,10}$/.test(t)}return e.BESSELI=function(t,r){},e.BESSELJ=function(t,r){},e.BESSELK=function(t,r){},e.BESSELY=function(t,r){},e.BIN2DEC=function(t){if(!o(t))return error.num;var r=parseInt(t,2),s=t.toString();return s.length===10&&s.substring(0,1)==="1"?parseInt(s.substring(1),2)-512:r},e.BIN2HEX=function(t,r){if(!o(t))return error.num;var s=t.toString();if(s.length===10&&s.substring(0,1)==="1")return(0xfffffffe00+parseInt(s.substring(1),2)).toString(16);var f=parseInt(t,2).toString(16);return r===void 0?f:isNaN(r)?error.value:r<0?error.num:(r=Math.floor(r),r>=f.length?REPT("0",r-f.length)+f:error.num)},e.BIN2OCT=function(t,r){if(!o(t))return error.num;var s=t.toString();if(s.length===10&&s.substring(0,1)==="1")return(1073741312+parseInt(s.substring(1),2)).toString(8);var f=parseInt(t,2).toString(8);return r===void 0?f:isNaN(r)?error.value:r<0?error.num:(r=Math.floor(r),r>=f.length?REPT("0",r-f.length)+f:error.num)},e.BITAND=function(t,r){return t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(t,r)?error.value:t<0||r<0||Math.floor(t)!==t||Math.floor(r)!==r||t>0xffffffffffff||r>0xffffffffffff?error.num:t&r},e.BITLSHIFT=function(t,r){return t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(t,r)?error.value:t<0||Math.floor(t)!==t||t>0xffffffffffff||Math.abs(r)>53?error.num:r>=0?t<<r:t>>-r},e.BITOR=function(t,r){return t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(t,r)?error.value:t<0||r<0||Math.floor(t)!==t||Math.floor(r)!==r||t>0xffffffffffff||r>0xffffffffffff?error.num:t|r},e.BITRSHIFT=function(t,r){return t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(t,r)?error.value:t<0||Math.floor(t)!==t||t>0xffffffffffff||Math.abs(r)>53?error.num:r>=0?t>>r:t<<-r},e.BITXOR=function(t,r){return t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(t,r)?error.value:t<0||r<0||Math.floor(t)!==t||Math.floor(r)!==r||t>0xffffffffffff||r>0xffffffffffff?error.num:t^r},e.COMPLEX=function(t,r,s){if(t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(t,r))return t;if(s=s===void 0?"i":s,s!=="i"&&s!=="j")return error.value;if(t===0&&r===0)return 0;if(t===0)return r===1?s:r.toString()+s;if(r===0)return t.toString();var f=r>0?"+":"";return t.toString()+f+(r===1?s:r.toString()+s)},e.CONVERT=function(t,r,s){if(t=utils.parseNumber(t),t instanceof Error)return t;for(var f=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xE5ngstr\xF6m","\xC5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xE5ngstr\xF6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,416818182544058e-5],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,758660370370369e-22],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","\xB0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519538e-3],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03A9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xE4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xE5ngstr\xF6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988110336e-6],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],h={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,1152921504606847e3,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},g={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},u=null,d=null,a=r,b=s,v=1,w=1,S,E=0;E<f.length;E++)S=f[E][2]===null?[]:f[E][2],(f[E][1]===a||S.indexOf(a)>=0)&&(u=f[E]),(f[E][1]===b||S.indexOf(b)>=0)&&(d=f[E]);if(u===null){var m=h[r.substring(0,2)],_=g[r.substring(0,1)];r.substring(0,2)==="da"&&(_=["dekao",10,"da"]),m?(v=m[2],a=r.substring(2)):_&&(v=_[1],a=r.substring(_[2].length));for(var T=0;T<f.length;T++)S=f[T][2]===null?[]:f[T][2],(f[T][1]===a||S.indexOf(a)>=0)&&(u=f[T])}if(d===null){var M=h[s.substring(0,2)],P=g[s.substring(0,1)];s.substring(0,2)==="da"&&(P=["dekao",10,"da"]),M?(w=M[2],b=s.substring(2)):P&&(w=P[1],b=s.substring(P[2].length));for(var B=0;B<f.length;B++)S=f[B][2]===null?[]:f[B][2],(f[B][1]===b||S.indexOf(b)>=0)&&(d=f[B])}return u===null||d===null||u[3]!==d[3]?error.na:t*u[6]*v/(d[6]*w)},e.DEC2BIN=function(t,r){if(t=utils.parseNumber(t),t instanceof Error)return t;if(!/^-?[0-9]{1,3}$/.test(t)||t<-512||t>511)return error.num;if(t<0)return"1"+REPT("0",9-(512+t).toString(2).length)+(512+t).toString(2);var s=parseInt(t,10).toString(2);return typeof r=="undefined"?s:isNaN(r)?error.value:r<0?error.num:(r=Math.floor(r),r>=s.length?REPT("0",r-s.length)+s:error.num)},e.DEC2HEX=function(t,r){if(t=utils.parseNumber(t),t instanceof Error)return t;if(!/^-?[0-9]{1,12}$/.test(t)||t<-549755813888||t>549755813887)return error.num;if(t<0)return(1099511627776+t).toString(16);var s=parseInt(t,10).toString(16);return typeof r=="undefined"?s:isNaN(r)?error.value:r<0?error.num:(r=Math.floor(r),r>=s.length?REPT("0",r-s.length)+s:error.num)},e.DEC2OCT=function(t,r){if(t=utils.parseNumber(t),t instanceof Error)return t;if(!/^-?[0-9]{1,9}$/.test(t)||t<-536870912||t>536870911)return error.num;if(t<0)return(1073741824+t).toString(8);var s=parseInt(t,10).toString(8);return typeof r=="undefined"?s:isNaN(r)?error.value:r<0?error.num:(r=Math.floor(r),r>=s.length?REPT("0",r-s.length)+s:error.num)},e.DELTA=function(t,r){return r=r===void 0?0:r,t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(t,r)?error.value:t===r?1:0},e.ERF=function(t,r){},e.ERF.PRECISE=function(){},e.ERFC=function(t){},e.ERFC.PRECISE=function(){},e.GESTEP=function(t,r){return r=r||0,t=utils.parseNumber(t),utils.anyIsError(r,t)?t:t>=r?1:0},e.HEX2BIN=function(t,r){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return error.num;var s=t.length===10&&t.substring(0,1).toLowerCase()==="f",f=s?parseInt(t,16)-1099511627776:parseInt(t,16);if(f<-512||f>511)return error.num;if(s)return"1"+REPT("0",9-(512+f).toString(2).length)+(512+f).toString(2);var h=f.toString(2);return r===void 0?h:isNaN(r)?error.value:r<0?error.num:(r=Math.floor(r),r>=h.length?REPT("0",r-h.length)+h:error.num)},e.HEX2DEC=function(t){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return error.num;var r=parseInt(t,16);return r>=549755813888?r-1099511627776:r},e.HEX2OCT=function(t,r){if(!/^[0-9A-Fa-f]{1,10}$/.test(t))return error.num;var s=parseInt(t,16);if(s>536870911&&s<0xffe0000000)return error.num;if(s>=0xffe0000000)return(s-0xffc0000000).toString(8);var f=s.toString(8);return r===void 0?f:isNaN(r)?error.value:r<0?error.num:(r=Math.floor(r),r>=f.length?REPT("0",r-f.length)+f:error.num)},e.IMABS=function(t){var r=e.IMREAL(t),s=e.IMAGINARY(t);return utils.anyIsError(r,s)?error.value:Math.sqrt(Math.pow(r,2)+Math.pow(s,2))},e.IMAGINARY=function(t){if(t===void 0||t===!0||t===!1)return error.value;if(t===0||t==="0")return 0;if(["i","j"].indexOf(t)>=0)return 1;t=t.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j");var r=t.indexOf("+"),s=t.indexOf("-");r===0&&(r=t.indexOf("+",1)),s===0&&(s=t.indexOf("-",1));var f=t.substring(t.length-1,t.length),h=f==="i"||f==="j";return r>=0||s>=0?h?r>=0?isNaN(t.substring(0,r))||isNaN(t.substring(r+1,t.length-1))?error.num:Number(t.substring(r+1,t.length-1)):isNaN(t.substring(0,s))||isNaN(t.substring(s+1,t.length-1))?error.num:-Number(t.substring(s+1,t.length-1)):error.num:h?isNaN(t.substring(0,t.length-1))?error.num:t.substring(0,t.length-1):isNaN(t)?error.num:0},e.IMARGUMENT=function(t){var r=e.IMREAL(t),s=e.IMAGINARY(t);return utils.anyIsError(r,s)?error.value:r===0&&s===0?error.div0:r===0&&s>0?Math.PI/2:r===0&&s<0?-Math.PI/2:s===0&&r>0?0:s===0&&r<0?-Math.PI:r>0?Math.atan(s/r):r<0&&s>=0?Math.atan(s/r)+Math.PI:Math.atan(s/r)-Math.PI},e.IMCONJUGATE=function(t){var r=e.IMREAL(t),s=e.IMAGINARY(t);if(utils.anyIsError(r,s))return error.value;var f=t.substring(t.length-1);return f=f==="i"||f==="j"?f:"i",s!==0?e.COMPLEX(r,-s,f):t},e.IMCOS=function(t){var r=e.IMREAL(t),s=e.IMAGINARY(t);if(utils.anyIsError(r,s))return error.value;var f=t.substring(t.length-1);return f=f==="i"||f==="j"?f:"i",e.COMPLEX(Math.cos(r)*(Math.exp(s)+Math.exp(-s))/2,-Math.sin(r)*(Math.exp(s)-Math.exp(-s))/2,f)},e.IMCOSH=function(t){var r=e.IMREAL(t),s=e.IMAGINARY(t);if(utils.anyIsError(r,s))return error.value;var f=t.substring(t.length-1);return f=f==="i"||f==="j"?f:"i",e.COMPLEX(Math.cos(s)*(Math.exp(r)+Math.exp(-r))/2,Math.sin(s)*(Math.exp(r)-Math.exp(-r))/2,f)},e.IMCOT=function(t){var r=e.IMREAL(t),s=e.IMAGINARY(t);return utils.anyIsError(r,s)?error.value:e.IMDIV(e.IMCOS(t),e.IMSIN(t))},e.IMDIV=function(t,r){var s=e.IMREAL(t),f=e.IMAGINARY(t),h=e.IMREAL(r),g=e.IMAGINARY(r);if(utils.anyIsError(s,f,h,g))return error.value;var u=t.substring(t.length-1),d=r.substring(r.length-1),a="i";if((u==="j"||d==="j")&&(a="j"),h===0&&g===0)return error.num;var b=h*h+g*g;return e.COMPLEX((s*h+f*g)/b,(f*h-s*g)/b,a)},e.IMEXP=function(t){var r=e.IMREAL(t),s=e.IMAGINARY(t);if(utils.anyIsError(r,s))return error.value;var f=t.substring(t.length-1);f=f==="i"||f==="j"?f:"i";var h=Math.exp(r);return e.COMPLEX(h*Math.cos(s),h*Math.sin(s),f)},e.IMLN=function(t){var r=e.IMREAL(t),s=e.IMAGINARY(t);if(utils.anyIsError(r,s))return error.value;var f=t.substring(t.length-1);return f=f==="i"||f==="j"?f:"i",e.COMPLEX(Math.log(Math.sqrt(r*r+s*s)),Math.atan(s/r),f)},e.IMLOG10=function(t){var r=e.IMREAL(t),s=e.IMAGINARY(t);if(utils.anyIsError(r,s))return error.value;var f=t.substring(t.length-1);return f=f==="i"||f==="j"?f:"i",e.COMPLEX(Math.log(Math.sqrt(r*r+s*s))/Math.log(10),Math.atan(s/r)/Math.log(10),f)},e.IMLOG2=function(t){var r=e.IMREAL(t),s=e.IMAGINARY(t);if(utils.anyIsError(r,s))return error.value;var f=t.substring(t.length-1);return f=f==="i"||f==="j"?f:"i",e.COMPLEX(Math.log(Math.sqrt(r*r+s*s))/Math.log(2),Math.atan(s/r)/Math.log(2),f)},e.IMPOWER=function(t,r){r=utils.parseNumber(r);var s=e.IMREAL(t),f=e.IMAGINARY(t);if(utils.anyIsError(r,s,f))return error.value;var h=t.substring(t.length-1);h=h==="i"||h==="j"?h:"i";var g=Math.pow(e.IMABS(t),r),u=e.IMARGUMENT(t);return e.COMPLEX(g*Math.cos(r*u),g*Math.sin(r*u),h)},e.IMPRODUCT=function(){for(var t=arguments[0],r=1;r<arguments.length;r++){var s=e.IMREAL(t),f=e.IMAGINARY(t),h=e.IMREAL(arguments[r]),g=e.IMAGINARY(arguments[r]);if(utils.anyIsError(s,f,h,g))return error.value;t=e.COMPLEX(s*h-f*g,s*g+f*h)}return t},e.IMREAL=function(t){if(t===void 0||t===!0||t===!1)return error.value;if(t===0||t==="0"||["i","+i","1i","+1i","-i","-1i","j","+j","1j","+1j","-j","-1j"].indexOf(t)>=0)return 0;var r=t.indexOf("+"),s=t.indexOf("-");r===0&&(r=t.indexOf("+",1)),s===0&&(s=t.indexOf("-",1));var f=t.substring(t.length-1,t.length),h=f==="i"||f==="j";return r>=0||s>=0?h?r>=0?isNaN(t.substring(0,r))||isNaN(t.substring(r+1,t.length-1))?error.num:Number(t.substring(0,r)):isNaN(t.substring(0,s))||isNaN(t.substring(s+1,t.length-1))?error.num:Number(t.substring(0,s)):error.num:h?isNaN(t.substring(0,t.length-1))?error.num:0:isNaN(t)?error.num:t},e.IMSEC=function(t){if(t===!0||t===!1)return error.value;var r=e.IMREAL(t),s=e.IMAGINARY(t);return utils.anyIsError(r,s)?error.value:e.IMDIV("1",e.IMCOS(t))},e.IMSECH=function(t){var r=e.IMREAL(t),s=e.IMAGINARY(t);return utils.anyIsError(r,s)?error.value:e.IMDIV("1",e.IMCOSH(t))},e.IMSIN=function(t){var r=e.IMREAL(t),s=e.IMAGINARY(t);if(utils.anyIsError(r,s))return error.value;var f=t.substring(t.length-1);return f=f==="i"||f==="j"?f:"i",e.COMPLEX(Math.sin(r)*(Math.exp(s)+Math.exp(-s))/2,Math.cos(r)*(Math.exp(s)-Math.exp(-s))/2,f)},e.IMSINH=function(t){var r=e.IMREAL(t),s=e.IMAGINARY(t);if(utils.anyIsError(r,s))return error.value;var f=t.substring(t.length-1);return f=f==="i"||f==="j"?f:"i",e.COMPLEX(Math.cos(s)*(Math.exp(r)-Math.exp(-r))/2,Math.sin(s)*(Math.exp(r)+Math.exp(-r))/2,f)},e.IMSQRT=function(t){var r=e.IMREAL(t),s=e.IMAGINARY(t);if(utils.anyIsError(r,s))return error.value;var f=t.substring(t.length-1);f=f==="i"||f==="j"?f:"i";var h=Math.sqrt(e.IMABS(t)),g=e.IMARGUMENT(t);return e.COMPLEX(h*Math.cos(g/2),h*Math.sin(g/2),f)},e.IMCSC=function(t){if(t===!0||t===!1)return error.value;var r=e.IMREAL(t),s=e.IMAGINARY(t);return utils.anyIsError(r,s)?error.num:e.IMDIV("1",e.IMSIN(t))},e.IMCSCH=function(t){if(t===!0||t===!1)return error.value;var r=e.IMREAL(t),s=e.IMAGINARY(t);return utils.anyIsError(r,s)?error.num:e.IMDIV("1",e.IMSINH(t))},e.IMSUB=function(t,r){var s=this.IMREAL(t),f=this.IMAGINARY(t),h=this.IMREAL(r),g=this.IMAGINARY(r);if(utils.anyIsError(s,f,h,g))return error.value;var u=t.substring(t.length-1),d=r.substring(r.length-1),a="i";return(u==="j"||d==="j")&&(a="j"),this.COMPLEX(s-h,f-g,a)},e.IMSUM=function(){for(var t=utils.flatten(arguments),r=t[0],s=1;s<t.length;s++){var f=this.IMREAL(r),h=this.IMAGINARY(r),g=this.IMREAL(t[s]),u=this.IMAGINARY(t[s]);if(utils.anyIsError(f,h,g,u))return error.value;r=this.COMPLEX(f+g,h+u)}return r},e.IMTAN=function(t){if(t===!0||t===!1)return error.value;var r=e.IMREAL(t),s=e.IMAGINARY(t);return utils.anyIsError(r,s)?error.value:this.IMDIV(this.IMSIN(t),this.IMCOS(t))},e.OCT2BIN=function(t,r){if(!/^[0-7]{1,10}$/.test(t))return error.num;var s=t.length===10&&t.substring(0,1)==="7",f=s?parseInt(t,8)-1073741824:parseInt(t,8);if(f<-512||f>511)return error.num;if(s)return"1"+REPT("0",9-(512+f).toString(2).length)+(512+f).toString(2);var h=f.toString(2);return typeof r=="undefined"?h:isNaN(r)?error.value:r<0?error.num:(r=Math.floor(r),r>=h.length?REPT("0",r-h.length)+h:error.num)},e.OCT2DEC=function(t){if(!/^[0-7]{1,10}$/.test(t))return error.num;var r=parseInt(t,8);return r>=536870912?r-1073741824:r},e.OCT2HEX=function(t,r){if(!/^[0-7]{1,10}$/.test(t))return error.num;var s=parseInt(t,8);if(s>=536870912)return"ff"+(s+3221225472).toString(16);var f=s.toString(16);return r===void 0?f:isNaN(r)?error.value:r<0?error.num:(r=Math.floor(r),r>=f.length?REPT("0",r-f.length)+f:error.num)},e}(),met.financial=function(){var e={};function o(r){return r&&r.getTime&&!isNaN(r.getTime())}function t(r){return r instanceof Date?r:new Date(r)}return e.ACCRINT=function(r,s,f,h,g,u,d){return r=t(r),s=t(s),f=t(f),!o(r)||!o(s)||!o(f)?"#VALUE!":h<=0||g<=0||[1,2,4].indexOf(u)===-1||[0,1,2,3,4].indexOf(d)===-1||f<=r?"#NUM!":(g=g||0,d=d||0,g*h*YEARFRAC(r,f,d))},e.ACCRINTM=null,e.AMORDEGRC=null,e.AMORLINC=null,e.COUPDAYBS=null,e.COUPDAYS=null,e.COUPDAYSNC=null,e.COUPNCD=null,e.COUPNUM=null,e.COUPPCD=null,e.CUMIPMT=function(r,s,f,h,g,u){if(r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),utils.anyIsError(r,s,f))return error.value;if(r<=0||s<=0||f<=0||h<1||g<1||h>g||u!==0&&u!==1)return error.num;var d=e.PMT(r,s,f,0,u),a=0;h===1&&u===0&&(a=-f,h++);for(var b=h;b<=g;b++)u===1?a+=e.FV(r,b-2,d,f,1)-d:a+=e.FV(r,b-1,d,f,0);return a*=r,a},e.CUMPRINC=function(r,s,f,h,g,u){if(r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),utils.anyIsError(r,s,f))return error.value;if(r<=0||s<=0||f<=0||h<1||g<1||h>g||u!==0&&u!==1)return error.num;var d=e.PMT(r,s,f,0,u),a=0;h===1&&(u===0?a=d+f*r:a=d,h++);for(var b=h;b<=g;b++)u>0?a+=d-(e.FV(r,b-2,d,f,1)-d)*r:a+=d-e.FV(r,b-1,d,f,0)*r;return a},e.DB=function(r,s,f,h,g){if(g=g===void 0?12:g,r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),h=utils.parseNumber(h),g=utils.parseNumber(g),utils.anyIsError(r,s,f,h,g))return error.value;if(r<0||s<0||f<0||h<0||[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(g)===-1||h>f)return error.num;if(s>=r)return 0;for(var u=(1-Math.pow(s/r,1/f)).toFixed(3),d=r*u*g/12,a=d,b=0,v=h===f?f-1:h,w=2;w<=v;w++)b=(r-a)*u,a+=b;return h===1?d:h===f?(r-a)*u:b},e.DDB=function(r,s,f,h,g){if(g=g===void 0?2:g,r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),h=utils.parseNumber(h),g=utils.parseNumber(g),utils.anyIsError(r,s,f,h,g))return error.value;if(r<0||s<0||f<0||h<0||g<=0||h>f)return error.num;if(s>=r)return 0;for(var u=0,d=0,a=1;a<=h;a++)d=Math.min((r-u)*(g/f),r-s-u),u+=d;return d},e.DISC=null,e.DOLLARDE=function(r,s){if(r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(r,s))return error.value;if(s<0)return error.num;if(s>=0&&s<1)return error.div0;s=parseInt(s,10);var f=parseInt(r,10);f+=r%1*Math.pow(10,Math.ceil(Math.log(s)/Math.LN10))/s;var h=Math.pow(10,Math.ceil(Math.log(s)/Math.LN2)+1);return f=Math.round(f*h)/h,f},e.DOLLARFR=function(r,s){if(r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(r,s))return error.value;if(s<0)return error.num;if(s>=0&&s<1)return error.div0;s=parseInt(s,10);var f=parseInt(r,10);return f+=r%1*Math.pow(10,-Math.ceil(Math.log(s)/Math.LN10))*s,f},e.DURATION=null,e.EFFECT=function(r,s){return r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(r,s)?error.value:r<=0||s<1?error.num:(s=parseInt(s,10),Math.pow(1+r/s,s)-1)},e.FV=function(r,s,f,h,g){if(h=h||0,g=g||0,r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),h=utils.parseNumber(h),g=utils.parseNumber(g),utils.anyIsError(r,s,f,h,g))return error.value;var u;if(r===0)u=h+f*s;else{var d=Math.pow(1+r,s);g===1?u=h*d+f*(1+r)*(d-1)/r:u=h*d+f*(d-1)/r}return-u},e.FVSCHEDULE=function(r,s){if(r=utils.parseNumber(r),s=utils.parseNumberArray(utils.flatten(s)),utils.anyIsError(r,s))return error.value;for(var f=s.length,h=r,g=0;g<f;g++)h*=1+s[g];return h},e.INTRATE=null,e.IPMT=function(r,s,f,h,g,u){if(g=g||0,u=u||0,r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),h=utils.parseNumber(h),g=utils.parseNumber(g),u=utils.parseNumber(u),utils.anyIsError(r,s,f,h,g,u))return error.value;var d=e.PMT(r,f,h,g,u),a;return s===1?u===1?a=0:a=-h:u===1?a=e.FV(r,s-2,d,h,1)-d:a=e.FV(r,s-1,d,h,0),a*r},e.IRR=function(r,s){if(s=s||0,r=utils.parseNumberArray(utils.flatten(r)),s=utils.parseNumber(s),utils.anyIsError(r,s))return error.value;for(var f=function(_,T,M){for(var P=M+1,B=_[0],D=1;D<_.length;D++)B+=_[D]/Math.pow(P,(T[D]-T[0])/365);return B},h=function(_,T,M){for(var P=M+1,B=0,D=1;D<_.length;D++){var L=(T[D]-T[0])/365;B-=L*_[D]/Math.pow(P,L+1)}return B},g=[],u=!1,d=!1,a=0;a<r.length;a++)g[a]=a===0?0:g[a-1]+365,r[a]>0&&(u=!0),r[a]<0&&(d=!0);if(!u||!d)return error.num;s=s===void 0?.1:s;var b=s,v=1e-10,w,S,E,m=!0;do E=f(r,g,b),w=b-E/h(r,g,b),S=Math.abs(w-b),b=w,m=S>v&&Math.abs(E)>v;while(m);return b},e.ISPMT=function(r,s,f,h){return r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),h=utils.parseNumber(h),utils.anyIsError(r,s,f,h)?error.value:h*r*(s/f-1)},e.MDURATION=null,e.MIRR=function(r,s,f){if(r=utils.parseNumberArray(utils.flatten(r)),s=utils.parseNumber(s),f=utils.parseNumber(f),utils.anyIsError(r,s,f))return error.value;for(var h=r.length,g=[],u=[],d=0;d<h;d++)r[d]<0?g.push(r[d]):u.push(r[d]);var a=-e.NPV(f,u)*Math.pow(1+f,h-1),b=e.NPV(s,g)*(1+s);return Math.pow(a/b,1/(h-1))-1},e.NOMINAL=function(r,s){return r=utils.parseNumber(r),s=utils.parseNumber(s),utils.anyIsError(r,s)?error.value:r<=0||s<1?error.num:(s=parseInt(s,10),(Math.pow(r+1,1/s)-1)*s)},e.NPER=function(r,s,f,h,g){if(g=g===void 0?0:g,h=h===void 0?0:h,r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),h=utils.parseNumber(h),g=utils.parseNumber(g),utils.anyIsError(r,s,f,h,g))return error.value;var u=s*(1+r*g)-h*r,d=f*r+s*(1+r*g);return Math.log(u/d)/Math.log(1+r)},e.NPV=function(){var r=utils.parseNumberArray(utils.flatten(arguments));if(r instanceof Error)return r;for(var s=r[0],f=0,h=1;h<r.length;h++)f+=r[h]/Math.pow(1+s,h);return f},e.ODDFPRICE=null,e.ODDFYIELD=null,e.ODDLPRICE=null,e.ODDLYIELD=null,e.PDURATION=function(r,s,f){return r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),utils.anyIsError(r,s,f)?error.value:r<=0?error.num:(Math.log(f)-Math.log(s))/Math.log(1+r)},e.PMT=function(r,s,f,h,g){if(h=h||0,g=g||0,r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),h=utils.parseNumber(h),g=utils.parseNumber(g),utils.anyIsError(r,s,f,h,g))return error.value;var u;if(r===0)u=(f+h)/s;else{var d=Math.pow(1+r,s);g===1?u=(h*r/(d-1)+f*r/(1-1/d))/(1+r):u=h*r/(d-1)+f*r/(1-1/d)}return-u},e.PPMT=function(r,s,f,h,g,u){return g=g||0,u=u||0,r=utils.parseNumber(r),f=utils.parseNumber(f),h=utils.parseNumber(h),g=utils.parseNumber(g),u=utils.parseNumber(u),utils.anyIsError(r,f,h,g,u)?error.value:e.PMT(r,f,h,g,u)-e.IPMT(r,s,f,h,g,u)},e.PRICE=null,e.PRICEDISC=null,e.PRICEMAT=null,e.PV=function(r,s,f,h,g){return h=h||0,g=g||0,r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),h=utils.parseNumber(h),g=utils.parseNumber(g),utils.anyIsError(r,s,f,h,g)?error.value:r===0?-f*s-h:((1-Math.pow(1+r,s))/r*f*(1+r*g)-h)/Math.pow(1+r,s)},e.RATE=function(r,s,f,h,g,u){if(u=u===void 0?.01:u,h=h===void 0?0:h,g=g===void 0?0:g,r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),h=utils.parseNumber(h),g=utils.parseNumber(g),u=utils.parseNumber(u),utils.anyIsError(r,s,f,h,g,u))return error.value;for(var d=1e-6,a=100,b=0,v=!1,w=u;b<a&&!v;){var S=Math.pow(w+1,r),E=Math.pow(w+1,r-1),m=h+S*f+s*(S-1)*(w*g+1)/w,_=r*E*f-s*(S-1)*(w*g+1)/Math.pow(w,2),T=r*s*E*(w*g+1)/w+s*(S-1)*g/w,M=w-m/(_+T);Math.abs(M-w)<d&&(v=!0),b++,w=M}return v?w:Number.NaN+w},e.RECEIVED=null,e.RRI=function(r,s,f){return r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),utils.anyIsError(r,s,f)?error.value:r===0||s===0?error.num:Math.pow(f/s,1/r)-1},e.SLN=function(r,s,f){return r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),utils.anyIsError(r,s,f)?error.value:f===0?error.num:(r-s)/f},e.SYD=function(r,s,f,h){return r=utils.parseNumber(r),s=utils.parseNumber(s),f=utils.parseNumber(f),h=utils.parseNumber(h),utils.anyIsError(r,s,f,h)?error.value:f===0||h<1||h>f?error.num:(h=parseInt(h,10),(r-s)*(f-h+1)*2/(f*(f+1)))},e.TBILLEQ=function(r,s,f){return r=utils.parseDate(r),s=utils.parseDate(s),f=utils.parseNumber(f),utils.anyIsError(r,s,f)?error.value:f<=0||r>s||s-r>31536e6?error.num:365*f/(360-f*DAYS360(r,s,!1))},e.TBILLPRICE=function(r,s,f){return r=utils.parseDate(r),s=utils.parseDate(s),f=utils.parseNumber(f),utils.anyIsError(r,s,f)?error.value:f<=0||r>s||s-r>31536e6?error.num:100*(1-f*DAYS360(r,s,!1)/360)},e.TBILLYIELD=function(r,s,f){return r=utils.parseDate(r),s=utils.parseDate(s),f=utils.parseNumber(f),utils.anyIsError(r,s,f)?error.value:f<=0||r>s||s-r>31536e6?error.num:(100-f)*360/(f*DAYS360(r,s,!1))},e.VDB=null,e.XIRR=function(r,s,f){if(r=utils.parseNumberArray(utils.flatten(r)),s=utils.parseDateArray(utils.flatten(s)),f=utils.parseNumber(f),utils.anyIsError(r,s,f))return error.value;for(var h=function(_,T,M){for(var P=M+1,B=_[0],D=1;D<_.length;D++)B+=_[D]/Math.pow(P,DAYS(T[D],T[0])/365);return B},g=function(_,T,M){for(var P=M+1,B=0,D=1;D<_.length;D++){var L=DAYS(T[D],T[0])/365;B-=L*_[D]/Math.pow(P,L+1)}return B},u=!1,d=!1,a=0;a<r.length;a++)r[a]>0&&(u=!0),r[a]<0&&(d=!0);if(!u||!d)return error.num;f=f||.1;var b=f,v=1e-10,w,S,E,m=!0;do E=h(r,s,b),w=b-E/g(r,s,b),S=Math.abs(w-b),b=w,m=S>v&&Math.abs(E)>v;while(m);return b},e.XNPV=function(r,s,f){if(r=utils.parseNumber(r),s=utils.parseNumberArray(utils.flatten(s)),f=utils.parseDateArray(utils.flatten(f)),utils.anyIsError(r,s,f))return error.value;for(var h=0,g=0;g<s.length;g++)h+=s[g]/Math.pow(1+r,DAYS(f[g],f[0])/365);return h},e.YIELD=null,e.YIELDDISC=null,e.YIELDMAT=null,e}(),met.information=function(){var e={};return e.CELL=null,e.ERROR={},e.ERROR.TYPE=function(o){switch(o){case error.nil:return 1;case error.div0:return 2;case error.value:return 3;case error.ref:return 4;case error.name:return 5;case error.num:return 6;case error.na:return 7;case error.data:return 8}return error.na},e.INFO=null,e.ISBLANK=function(o){return o===null},e.ISBINARY=function(o){return/^[01]{1,10}$/.test(o)},e.ISERR=function(o){return[error.value,error.ref,error.div0,error.num,error.name,error.nil].indexOf(o)>=0||typeof o=="number"&&(isNaN(o)||!isFinite(o))},e.ISERROR=function(o){return e.ISERR(o)||o===error.na},e.ISEVEN=function(o){return!(Math.floor(Math.abs(o))&1)},e.ISFORMULA=null,e.ISLOGICAL=function(o){return o===!0||o===!1},e.ISNA=function(o){return o===error.na},e.ISNONTEXT=function(o){return typeof o!="string"},e.ISNUMBER=function(o){return typeof o=="number"&&!isNaN(o)&&isFinite(o)},e.ISODD=function(o){return!!(Math.floor(Math.abs(o))&1)},e.ISREF=null,e.ISTEXT=function(o){return typeof o=="string"},e.N=function(o){return this.ISNUMBER(o)?o:o instanceof Date?o.getTime():o===!0?1:o===!1?0:this.ISERROR(o)?o:0},e.NA=function(){return error.na},e.SHEET=null,e.SHEETS=null,e.TYPE=function(o){if(this.ISNUMBER(o))return 1;if(this.ISTEXT(o))return 2;if(this.ISLOGICAL(o))return 4;if(this.ISERROR(o))return 16;if(Array.isArray(o))return 64},e}(),met.logical=function(){var e={};return e.AND=function(){for(var o=utils.flatten(arguments),t=!0,r=0;r<o.length;r++)o[r]||(t=!1);return t},e.CHOOSE=function(){if(arguments.length<2)return error.na;var o=arguments[0];return o<1||o>254||arguments.length<o+1?error.value:arguments[o]},e.FALSE=function(){return!1},e.IF=function(o,t,r){return o?t:r},e.IFERROR=function(o,t){return ISERROR(o)?t:o},e.IFNA=function(o,t){return o===error.na?t:o},e.NOT=function(o){return!o},e.OR=function(){for(var o=utils.flatten(arguments),t=!1,r=0;r<o.length;r++)o[r]&&(t=!0);return t},e.TRUE=function(){return!0},e.XOR=function(){for(var o=utils.flatten(arguments),t=0,r=0;r<o.length;r++)o[r]&&t++;return!!(Math.floor(Math.abs(t))&1)},e.SWITCH=function(){var o;if(arguments.length>0){var t=arguments[0],r=arguments.length-1,s=Math.floor(r/2),f=!1,h=r%2===0?null:arguments[arguments.length-1];if(s){for(var g=0;g<s;g++)if(t===arguments[g*2+1]){o=arguments[g*2+2],f=!0;break}}!f&&h&&(o=h)}return o},e}(),met.math=function(){var exports={};exports.ABS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.abs(utils.parseNumber(e))},exports.ACOS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.acos(e)},exports.ACOSH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e+Math.sqrt(e*e-1))},exports.ACOT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.atan(1/e)},exports.ACOTH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:.5*Math.log((e+1)/(e-1))},exports.AGGREGATE=null,exports.ARABIC=function(e){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(e))return error.value;var o=0;return e.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(t){o+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[t]}),o},exports.ASIN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.asin(e)},exports.ASINH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e+Math.sqrt(e*e+1))},exports.ATAN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.atan(e)},exports.ATAN2=function(e,o){return e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.value:Math.atan2(e,o)},exports.ATANH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log((1+e)/(1-e))/2},exports.BASE=function(e,o,t){if(t=t||0,e=utils.parseNumber(e),o=utils.parseNumber(o),t=utils.parseNumber(t),utils.anyIsError(e,o,t))return error.value;t=t===void 0?0:t;var r=e.toString(o);return new Array(Math.max(t+1-r.length,0)).join("0")+r},exports.CEILING=function(e,o,t){return o=o===void 0?1:o,t=t===void 0?0:t,e=utils.parseNumber(e),o=utils.parseNumber(o),t=utils.parseNumber(t),utils.anyIsError(e,o,t)?error.value:o===0?0:(o=Math.abs(o),e>=0?Math.ceil(e/o)*o:t===0?-1*Math.floor(Math.abs(e)/o)*o:-1*Math.ceil(Math.abs(e)/o)*o)},exports.CEILING.MATH=exports.CEILING,exports.CEILING.PRECISE=exports.CEILING,exports.COMBIN=function(e,o){return e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.value:exports.FACT(e)/(exports.FACT(o)*exports.FACT(e-o))},exports.COMBINA=function(e,o){return e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.value:e===0&&o===0?1:exports.COMBIN(e+o-1,e-1)},exports.COS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.cos(e)},exports.COSH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:(Math.exp(e)+Math.exp(-e))/2},exports.COT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.tan(e)},exports.COTH=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var o=Math.exp(2*e);return(o+1)/(o-1)},exports.CSC=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.sin(e)},exports.CSCH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:2/(Math.exp(e)-Math.exp(-e))},exports.DECIMAL=function(e,o){return arguments.length<1?error.value:parseInt(e,o)},exports.DEGREES=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e*180/Math.PI},exports.EVEN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:exports.CEILING(e,-2,-1)},exports.EXP=Math.exp;var MEMOIZED_FACT=[];return exports.FACT=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var o=Math.floor(e);return o===0||o===1?1:(MEMOIZED_FACT[o]>0||(MEMOIZED_FACT[o]=exports.FACT(o-1)*o),MEMOIZED_FACT[o])},exports.FACTDOUBLE=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var o=Math.floor(e);return o<=0?1:o*exports.FACTDOUBLE(o-2)},exports.FLOOR=function(e,o,t){return o=o===void 0?1:o,t=t===void 0?0:t,e=utils.parseNumber(e),o=utils.parseNumber(o),t=utils.parseNumber(t),utils.anyIsError(e,o,t)?error.value:o===0?0:(o=Math.abs(o),e>=0?Math.floor(e/o)*o:t===0?-1*Math.ceil(Math.abs(e)/o)*o:-1*Math.floor(Math.abs(e)/o)*o)},exports.FLOOR.MATH=exports.FLOOR,exports.GCD=null,exports.INT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.floor(e)},exports.LCM=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var o,t,r,s,f=1;(r=e.pop())!==void 0;)for(;r>1;){if(r%2){for(o=3,t=Math.floor(Math.sqrt(r));o<=t&&r%o;o+=2);s=o<=t?o:r}else s=2;for(r/=s,f*=s,o=e.length;o;e[--o]%s===0&&(e[o]/=s)===1&&e.splice(o,1));}return f},exports.LN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e)},exports.LOG=function(e,o){return e=utils.parseNumber(e),o=o===void 0?10:utils.parseNumber(o),utils.anyIsError(e,o)?error.value:Math.log(e)/Math.log(o)},exports.LOG10=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log(e)/Math.log(10)},exports.MDETERM=null,exports.MINVERSE=null,exports.MMULT=null,exports.MOD=function(e,o){if(e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o))return error.value;if(o===0)return error.div0;var t=Math.abs(e%o);return o>0?t:-t},exports.MROUND=function(e,o){return e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.value:e*o<0?error.num:Math.round(e/o)*o},exports.MULTINOMIAL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var o=0,t=1,r=0;r<e.length;r++)o+=e[r],t*=exports.FACT(e[r]);return exports.FACT(o)/t},exports.MUNIT=null,exports.ODD=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var o=Math.ceil(Math.abs(e));return o=o&1?o:o+1,e>0?o:-o},exports.PI=function(){return Math.PI},exports.POWER=function(e,o){if(e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o))return error.value;var t=Math.pow(e,o);return isNaN(t)?error.num:t},exports.PRODUCT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var o=1,t=0;t<e.length;t++)o*=e[t];return o},exports.QUOTIENT=function(e,o){return e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.value:parseInt(e/o,10)},exports.RADIANS=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e*Math.PI/180},exports.RAND=function(){return Math.random()},exports.RANDBETWEEN=function(e,o){return e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.value:e+Math.ceil((o-e+1)*Math.random())-1},exports.ROMAN=null,exports.ROUND=function(e,o){return e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.value:Math.round(e*Math.pow(10,o))/Math.pow(10,o)},exports.ROUNDDOWN=function(e,o){if(e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o))return error.value;var t=e>0?1:-1;return t*Math.floor(Math.abs(e)*Math.pow(10,o))/Math.pow(10,o)},exports.ROUNDUP=function(e,o){if(e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o))return error.value;var t=e>0?1:-1;return t*Math.ceil(Math.abs(e)*Math.pow(10,o))/Math.pow(10,o)},exports.SEC=function(e){return e=utils.parseNumber(e),e instanceof Error?e:1/Math.cos(e)},exports.SECH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:2/(Math.exp(e)+Math.exp(-e))},exports.SERIESSUM=function(e,o,t,r){if(e=utils.parseNumber(e),o=utils.parseNumber(o),t=utils.parseNumber(t),r=utils.parseNumberArray(r),utils.anyIsError(e,o,t,r))return error.value;for(var s=r[0]*Math.pow(e,o),f=1;f<r.length;f++)s+=r[f]*Math.pow(e,o+f*t);return s},exports.SIGN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e<0?-1:e===0?0:1},exports.SIN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.sin(e)},exports.SINH=function(e){return e=utils.parseNumber(e),e instanceof Error?e:(Math.exp(e)-Math.exp(-e))/2},exports.SQRT=function(e){return e=utils.parseNumber(e),e instanceof Error?e:e<0?error.num:Math.sqrt(e)},exports.SQRTPI=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.sqrt(e*Math.PI)},exports.SUBTOTAL=null,exports.ADD=function(e,o){return arguments.length!==2?error.na:(e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.value:e+o)},exports.MINUS=function(e,o){return arguments.length!==2?error.na:(e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.value:e-o)},exports.DIVIDE=function(e,o){return arguments.length!==2?error.na:(e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.value:o===0?error.div0:e/o)},exports.MULTIPLY=function(e,o){return arguments.length!==2?error.na:(e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.value:e*o)},exports.GTE=function(e,o){return arguments.length!==2?error.na:(e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.error:e>=o)},exports.LT=function(e,o){return arguments.length!==2?error.na:(e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.error:e<o)},exports.LTE=function(e,o){return arguments.length!==2?error.na:(e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.error:e<=o)},exports.EQ=function(e,o){return arguments.length!==2?error.na:e===o},exports.NE=function(e,o){return arguments.length!==2?error.na:e!==o},exports.POW=function(e,o){return arguments.length!==2?error.na:(e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.error:exports.POWER(e,o))},exports.SUM=function(){for(var e=0,o=Object.keys(arguments),t=0;t<o.length;++t){var r=arguments[o[t]];if(typeof r=="number")e+=r;else if(typeof r=="string"){var s=parseFloat(r);!isNaN(s)&&(e+=s)}else Array.isArray(r)&&(e+=exports.SUM.apply(null,r))}return e},exports.SUMIF=function(){var args=utils.argsToArray(arguments),criteria=args.pop(),range=utils.parseNumberArray(utils.flatten(args));if(range instanceof Error)return range;for(var result=0,i=0;i<range.length;i++)result+=eval(range[i]+criteria)?range[i]:0;return result},exports.SUMIFS=function(){var args=utils.argsToArray(arguments),range=utils.parseNumberArray(utils.flatten(args.shift()));if(range instanceof Error)return range;for(var criteria=args,n_range_elements=range.length,n_criterias=criteria.length,result=0,i=0;i<n_range_elements;i++){for(var el=range[i],condition="",c=0;c<n_criterias;c+=2)isNaN(criteria[c][i])?condition+='"'+criteria[c][i]+'"'+criteria[c+1]:condition+=criteria[c][i]+criteria[c+1],c!==n_criterias-1&&(condition+=" && ");condition=condition.slice(0,-4),eval(condition)&&(result+=el)}return result},exports.SUMPRODUCT=null,exports.SUMSQ=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var o=0,t=e.length,r=0;r<t;r++)o+=ISNUMBER(e[r])?e[r]*e[r]:0;return o},exports.SUMX2MY2=function(e,o){if(e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumberArray(utils.flatten(o)),utils.anyIsError(e,o))return error.value;for(var t=0,r=0;r<e.length;r++)t+=e[r]*e[r]-o[r]*o[r];return t},exports.SUMX2PY2=function(e,o){if(e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumberArray(utils.flatten(o)),utils.anyIsError(e,o))return error.value;var t=0;e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumberArray(utils.flatten(o));for(var r=0;r<e.length;r++)t+=e[r]*e[r]+o[r]*o[r];return t},exports.SUMXMY2=function(e,o){if(e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumberArray(utils.flatten(o)),utils.anyIsError(e,o))return error.value;var t=0;e=utils.flatten(e),o=utils.flatten(o);for(var r=0;r<e.length;r++)t+=Math.pow(e[r]-o[r],2);return t},exports.TAN=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.tan(e)},exports.TANH=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var o=Math.exp(2*e);return(o-1)/(o+1)},exports.TRUNC=function(e,o){if(o=o===void 0?0:o,e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o))return error.value;var t=e>0?1:-1;return t*Math.floor(Math.abs(e)*Math.pow(10,o))/Math.pow(10,o)},exports}(),met.misc=function(){var e={};return e.UNIQUE=function(){for(var o=[],t=0;t<arguments.length;++t){for(var r=!1,s=arguments[t],f=0;f<o.length&&(r=o[f]===s,!r);++f);r||o.push(s)}return o},e.FLATTEN=utils.flatten,e.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},e.REFERENCE=function(o,t){try{for(var r=t.split("."),s=o,f=0;f<r.length;++f){var h=r[f];if(h[h.length-1]==="]"){var g=h.indexOf("["),u=h.substring(g+1,h.length-1);s=s[h.substring(0,g)][u]}else s=s[h]}return s}catch{}},e.JOIN=function(o,t){return o.join(t)},e.NUMBERS=function(){var o=utils.flatten(arguments);return o.filter(function(t){return typeof t=="number"})},e.NUMERAL=null,e}(),met.text=function(){var e={};return e.ASC=null,e.BAHTTEXT=null,e.CHAR=function(o){return o=utils.parseNumber(o),o instanceof Error?o:String.fromCharCode(o)},e.CLEAN=function(o){o=o||"";var t=/[\0-\x1F]/g;return o.replace(t,"")},e.CODE=function(o){return o=o||"",o.charCodeAt(0)},e.CONCATENATE=function(){for(var o=utils.flatten(arguments),t=0;(t=o.indexOf(!0))>-1;)o[t]="TRUE";for(var r=0;(r=o.indexOf(!1))>-1;)o[r]="FALSE";return o.join("")},e.DBCS=null,e.DOLLAR=null,e.EXACT=function(o,t){return o===t},e.FIND=function(o,t,r){return r=r===void 0?0:r,t?t.indexOf(o,r-1)+1:null},e.FIXED=null,e.HTML2TEXT=function(o){var t="";return o&&(o instanceof Array?o.forEach(function(r){t!==""&&(t+=`
`),t+=r.replace(/<(?:.|\n)*?>/gm,"")}):t=o.replace(/<(?:.|\n)*?>/gm,"")),t},e.LEFT=function(o,t){return t=t===void 0?1:t,t=utils.parseNumber(t),t instanceof Error||typeof o!="string"?error.value:o?o.substring(0,t):null},e.LEN=function(o){return arguments.length===0?error.error:typeof o=="string"?o?o.length:0:o.length?o.length:error.value},e.LOWER=function(o){return typeof o!="string"?error.value:o&&o.toLowerCase()},e.MID=function(o,t,r){if(t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(t,r)||typeof o!="string")return r;var s=t-1,f=s+r;return o.substring(s,f)},e.NUMBERVALUE=null,e.PRONETIC=null,e.PROPER=function(o){return o===void 0||o.length===0||(o===!0&&(o="TRUE"),o===!1&&(o="FALSE"),isNaN(o)&&typeof o=="number")?error.value:(typeof o=="number"&&(o=""+o),o.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()}))},e.REGEXEXTRACT=function(o,t){var r=o.match(new RegExp(t));return r?r[r.length>1?r.length-1:0]:null},e.REGEXMATCH=function(o,t,r){var s=o.match(new RegExp(t));return r?s:!!s},e.REGEXREPLACE=function(o,t,r){return o.replace(new RegExp(t),r)},e.REPLACE=function(o,t,r,s){return t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(t,r)||typeof o!="string"||typeof s!="string"?error.value:o.substr(0,t-1)+s+o.substr(t-1+r)},e.REPT=function(o,t){return t=utils.parseNumber(t),t instanceof Error?t:new Array(t+1).join(o)},e.RIGHT=function(o,t){return t=t===void 0?1:t,t=utils.parseNumber(t),t instanceof Error?t:o?o.substring(o.length-t):null},e.SEARCH=function(o,t,r){var s;return typeof o!="string"||typeof t!="string"?error.value:(r=r===void 0?0:r,s=t.toLowerCase().indexOf(o.toLowerCase(),r-1)+1,s===0?error.value:s)},e.SPLIT=function(o,t){return o.split(t)},e.SUBSTITUTE=function(o,t,r,s){if(!o||!t||!r)return o;if(s===void 0)return o.replace(new RegExp(t,"g"),r);for(var f=0,h=0;o.indexOf(t,f)>0;)if(f=o.indexOf(t,f+1),h++,h===s)return o.substring(0,f)+r+o.substring(f+t.length)},e.T=function(o){return typeof o=="string"?o:""},e.TEXT=null,e.TRIM=function(o){return typeof o!="string"?error.value:o.replace(/ +/g," ").trim()},e.UNICHAR=e.CHAR,e.UNICODE=e.CODE,e.UPPER=function(o){return typeof o!="string"?error.value:o.toUpperCase()},e.VALUE=null,e}(),met.stats=function(){var exports={},SQRT2PI=2.5066282746310002;return exports.AVEDEV=null,exports.AVERAGE=function(){for(var e=utils.numbers(utils.flatten(arguments)),o=e.length,t=0,r=0,s=0;s<o;s++)t+=e[s],r+=1;return t/r},exports.AVERAGEA=function(){for(var e=utils.flatten(arguments),o=e.length,t=0,r=0,s=0;s<o;s++){var f=e[s];typeof f=="number"&&(t+=f),f===!0&&t++,f!==null&&r++}return t/r},exports.AVERAGEIF=function(range,criteria,average_range){if(average_range=average_range||range,range=utils.flatten(range),average_range=utils.parseNumberArray(utils.flatten(average_range)),average_range instanceof Error)return average_range;for(var average_count=0,result=0,i=0;i<range.length;i++)eval(range[i]+criteria)&&(result+=average_range[i],average_count++);return result/average_count},exports.AVERAGEIFS=null,exports.COUNT=function(){return utils.numbers(utils.flatten(arguments)).length},exports.COUNTA=function(){var e=utils.flatten(arguments);return e.length-exports.COUNTBLANK(e)},exports.COUNTIN=function(e,o){for(var t=0,r=0;r<e.length;r++)e[r]===o&&t++;return t},exports.COUNTBLANK=function(){for(var e=utils.flatten(arguments),o=0,t,r=0;r<e.length;r++)t=e[r],(t===null||t==="")&&o++;return o},exports.COUNTIF=function(){var args=utils.argsToArray(arguments),criteria=args.pop(),range=utils.flatten(args);/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var matches=0,i=0;i<range.length;i++)typeof range[i]!="string"?eval(range[i]+criteria)&&matches++:eval('"'+range[i]+'"'+criteria)&&matches++;return matches},exports.COUNTIFS=function(){for(var args=utils.argsToArray(arguments),results=new Array(utils.flatten(args[0]).length),i=0;i<results.length;i++)results[i]=!0;for(i=0;i<args.length;i+=2){var range=utils.flatten(args[i]),criteria=args[i+1];/[<>=!]/.test(criteria)||(criteria='=="'+criteria+'"');for(var j=0;j<range.length;j++)typeof range[j]!="string"?results[j]=results[j]&&eval(range[j]+criteria):results[j]=results[j]&&eval('"'+range[j]+'"'+criteria)}var result=0;for(i=0;i<results.length;i++)results[i]&&result++;return result},exports.COUNTUNIQUE=function(){return UNIQUE.apply(null,utils.flatten(arguments)).length},exports.FISHER=function(e){return e=utils.parseNumber(e),e instanceof Error?e:Math.log((1+e)/(1-e))/2},exports.FISHERINV=function(e){if(e=utils.parseNumber(e),e instanceof Error)return e;var o=Math.exp(2*e);return(o-1)/(o+1)},exports.FREQUENCY=function(e,o){if(e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumberArray(utils.flatten(o)),utils.anyIsError(e,o))return error.value;for(var t=e.length,r=o.length,s=[],f=0;f<=r;f++){s[f]=0;for(var h=0;h<t;h++)f===0?e[h]<=o[0]&&(s[0]+=1):f<r?e[h]>o[f-1]&&e[h]<=o[f]&&(s[f]+=1):f===r&&e[h]>o[r-1]&&(s[r]+=1)}return s},exports.LARGE=function(e,o){return e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumber(o),utils.anyIsError(e,o)?e:e.sort(function(t,r){return r-t})[o-1]},exports.MAX=function(){var e=utils.numbers(utils.flatten(arguments));return e.length===0?0:Math.max.apply(Math,e)},exports.MAXA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return e.length===0?0:Math.max.apply(Math,e)},exports.MIN=function(){var e=utils.numbers(utils.flatten(arguments));return e.length===0?0:Math.min.apply(Math,e)},exports.MINA=function(){var e=utils.arrayValuesToNumbers(utils.flatten(arguments));return e.length===0?0:Math.min.apply(Math,e)},exports.MODE={},exports.MODE.MULT=function(){var e=utils.parseNumberArray(utils.flatten(arguments));if(e instanceof Error)return e;for(var o=e.length,t={},r=[],s=0,f,h=0;h<o;h++)f=e[h],t[f]=t[f]?t[f]+1:1,t[f]>s&&(s=t[f],r=[]),t[f]===s&&(r[r.length]=f);return r},exports.MODE.SNGL=function(){var e=utils.parseNumberArray(utils.flatten(arguments));return e instanceof Error?e:exports.MODE.MULT(e).sort(function(o,t){return o-t})[0]},exports.PERCENTILE={},exports.PERCENTILE.EXC=function(e,o){if(e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumber(o),utils.anyIsError(e,o))return error.value;e=e.sort(function(f,h){return f-h});var t=e.length;if(o<1/(t+1)||o>1-1/(t+1))return error.num;var r=o*(t+1)-1,s=Math.floor(r);return utils.cleanFloat(r===s?e[r]:e[s]+(r-s)*(e[s+1]-e[s]))},exports.PERCENTILE.INC=function(e,o){if(e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumber(o),utils.anyIsError(e,o))return error.value;e=e.sort(function(f,h){return f-h});var t=e.length,r=o*(t-1),s=Math.floor(r);return utils.cleanFloat(r===s?e[r]:e[s]+(r-s)*(e[s+1]-e[s]))},exports.PERCENTRANK={},exports.PERCENTRANK.EXC=function(e,o,t){if(t=t===void 0?3:t,e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumber(o),t=utils.parseNumber(t),utils.anyIsError(e,o,t))return error.value;e=e.sort(function(a,b){return a-b});for(var r=UNIQUE.apply(null,e),s=e.length,f=r.length,h=Math.pow(10,t),g=0,u=!1,d=0;!u&&d<f;)o===r[d]?(g=(e.indexOf(r[d])+1)/(s+1),u=!0):o>=r[d]&&(o<r[d+1]||d===f-1)&&(g=(e.indexOf(r[d])+1+(o-r[d])/(r[d+1]-r[d]))/(s+1),u=!0),d++;return Math.floor(g*h)/h},exports.PERCENTRANK.INC=function(e,o,t){if(t=t===void 0?3:t,e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumber(o),t=utils.parseNumber(t),utils.anyIsError(e,o,t))return error.value;e=e.sort(function(a,b){return a-b});for(var r=UNIQUE.apply(null,e),s=e.length,f=r.length,h=Math.pow(10,t),g=0,u=!1,d=0;!u&&d<f;)o===r[d]?(g=e.indexOf(r[d])/(s-1),u=!0):o>=r[d]&&(o<r[d+1]||d===f-1)&&(g=(e.indexOf(r[d])+(o-r[d])/(r[d+1]-r[d]))/(s-1),u=!0),d++;return Math.floor(g*h)/h},exports.PERMUT=function(e,o){return e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.value:FACT(e)/FACT(e-o)},exports.PERMUTATIONA=function(e,o){return e=utils.parseNumber(e),o=utils.parseNumber(o),utils.anyIsError(e,o)?error.value:Math.pow(e,o)},exports.PHI=function(e){return e=utils.parseNumber(e),e instanceof Error?error.value:Math.exp(-.5*e*e)/SQRT2PI},exports.PROB=function(e,o,t,r){if(t===void 0)return 0;if(r=r===void 0?t:r,e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumberArray(utils.flatten(o)),t=utils.parseNumber(t),r=utils.parseNumber(r),utils.anyIsError(e,o,t,r))return error.value;if(t===r)return e.indexOf(t)>=0?o[e.indexOf(t)]:0;for(var s=e.sort(function(u,d){return u-d}),f=s.length,h=0,g=0;g<f;g++)s[g]>=t&&s[g]<=r&&(h+=o[e.indexOf(s[g])]);return h},exports.QUARTILE={},exports.QUARTILE.EXC=function(e,o){if(e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumber(o),utils.anyIsError(e,o))return error.value;switch(o){case 1:return exports.PERCENTILE.EXC(e,.25);case 2:return exports.PERCENTILE.EXC(e,.5);case 3:return exports.PERCENTILE.EXC(e,.75);default:return error.num}},exports.QUARTILE.INC=function(e,o){if(e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumber(o),utils.anyIsError(e,o))return error.value;switch(o){case 1:return exports.PERCENTILE.INC(e,.25);case 2:return exports.PERCENTILE.INC(e,.5);case 3:return exports.PERCENTILE.INC(e,.75);default:return error.num}},exports.RANK={},exports.RANK.AVG=function(e,o,t){if(e=utils.parseNumber(e),o=utils.parseNumberArray(utils.flatten(o)),utils.anyIsError(e,o))return error.value;o=utils.flatten(o),t=t||!1;var r=t?function(g,u){return g-u}:function(g,u){return u-g};o=o.sort(r);for(var s=o.length,f=0,h=0;h<s;h++)o[h]===e&&f++;return f>1?(2*o.indexOf(e)+f+1)/2:o.indexOf(e)+1},exports.RANK.EQ=function(e,o,t){if(e=utils.parseNumber(e),o=utils.parseNumberArray(utils.flatten(o)),utils.anyIsError(e,o))return error.value;t=t||!1;var r=t?function(s,f){return s-f}:function(s,f){return f-s};return o=o.sort(r),o.indexOf(e)+1},exports.RSQ=function(e,o){return e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumberArray(utils.flatten(o)),utils.anyIsError(e,o)?error.value:Math.pow(exports.PEARSON(e,o),2)},exports.SMALL=function(e,o){return e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumber(o),utils.anyIsError(e,o)?e:e.sort(function(t,r){return t-r})[o-1]},exports.STANDARDIZE=function(e,o,t){return e=utils.parseNumber(e),o=utils.parseNumber(o),t=utils.parseNumber(t),utils.anyIsError(e,o,t)?error.value:(e-o)/t},exports.STDEV={},exports.STDEV.P=function(){var e=exports.VAR.P.apply(this,arguments);return Math.sqrt(e)},exports.STDEV.S=function(){var e=exports.VAR.S.apply(this,arguments);return Math.sqrt(e)},exports.STDEVA=function(){var e=exports.VARA.apply(this,arguments);return Math.sqrt(e)},exports.STDEVPA=function(){var e=exports.VARPA.apply(this,arguments);return Math.sqrt(e)},exports.VAR={},exports.VAR.P=function(){for(var e=utils.numbers(utils.flatten(arguments)),o=e.length,t=0,r=exports.AVERAGE(e),s=0;s<o;s++)t+=Math.pow(e[s]-r,2);return t/o},exports.VAR.S=function(){for(var e=utils.numbers(utils.flatten(arguments)),o=e.length,t=0,r=exports.AVERAGE(e),s=0;s<o;s++)t+=Math.pow(e[s]-r,2);return t/(o-1)},exports.VARA=function(){for(var e=utils.flatten(arguments),o=e.length,t=0,r=0,s=exports.AVERAGEA(e),f=0;f<o;f++){var h=e[f];typeof h=="number"?t+=Math.pow(h-s,2):h===!0?t+=Math.pow(1-s,2):t+=Math.pow(0-s,2),h!==null&&r++}return t/(r-1)},exports.VARPA=function(){for(var e=utils.flatten(arguments),o=e.length,t=0,r=0,s=exports.AVERAGEA(e),f=0;f<o;f++){var h=e[f];typeof h=="number"?t+=Math.pow(h-s,2):h===!0?t+=Math.pow(1-s,2):t+=Math.pow(0-s,2),h!==null&&r++}return t/r},exports.WEIBULL={},exports.WEIBULL.DIST=function(e,o,t,r){return e=utils.parseNumber(e),o=utils.parseNumber(o),t=utils.parseNumber(t),utils.anyIsError(e,o,t)?error.value:r?1-Math.exp(-Math.pow(e/t,o)):Math.pow(e,o-1)*Math.exp(-Math.pow(e/t,o))*o/Math.pow(t,o)},exports.Z={},exports.Z.TEST=function(e,o,t){if(e=utils.parseNumberArray(utils.flatten(e)),o=utils.parseNumber(o),utils.anyIsError(e,o))return error.value;t=t||exports.STDEV.S(e);var r=e.length;return 1-exports.NORM.S.DIST((exports.AVERAGE(e)-o)/(t/Math.sqrt(r)),!0)},exports}(),met.utils=function(){var e={};return e.PROGRESS=function(o,t){var r=t||"red",s=o||"0";return'<div style="width:'+s+"%;height:4px;background-color:"+r+';margin-top:1px;"></div>'},e.RATING=function(o){for(var t='<div class="jrating">',r=0;r<5;r++)r<o?t+='<div class="jrating-selected"></div>':t+="<div></div>";return t+="</div>",t},e}();for(var i=0;i<Object.keys(met).length;i++)for(var methods=met[Object.keys(met)[i]],keys=Object.keys(methods),j=0;j<keys.length;j++)if(!methods[keys[j]])window[keys[j]]=function(){return keys[j]+"Not implemented"};else if(typeof methods[keys[j]]=="function"||typeof methods[keys[j]]=="object"){if(window[keys[j]]=methods[keys[j]],window[keys[j]].toString=function(){return"#ERROR"},typeof methods[keys[j]]=="object")for(var tmp=Object.keys(methods[keys[j]]),z=0;z<tmp.length;z++)window[keys[j]][tmp[z]].toString=function(){return"#ERROR"}}else window[keys[j]]=function(){return keys[j]+"Not implemented"};var x=null,y=null,instance=null;window.TABLE=function(){return instance},window.COLUMN=window.COL=function(){return parseInt(x)+1},window.ROW=function(){return parseInt(y)+1},window.CELL=function(){return F.getColumnNameFromCoords(x,y)},window.VALUE=function(e,o,t){return instance.getValueFromCoords(parseInt(e)-1,parseInt(o)-1,t)},window.THISROWCELL=function(e){return instance.getValueFromCoords(parseInt(e)-1,parseInt(y))};var secureFormula=function(e,o){for(var t="",r=0,s=["=","!",">","<"],f=0;f<e.length;f++)e[f]=='"'&&(r==0?r=1:r=0),r==1?t+=e[f]:(t+=e[f].toUpperCase(),o==!0&&f>0&&e[f]=="="&&s.indexOf(e[f-1])==-1&&s.indexOf(e[f+1])==-1&&(t+="="));return t=t.replace(/\^/g,"**"),t=t.replace(/\<\>/g,"!="),t=t.replace(/\&/g,"+"),t=t.replace(/\$/g,""),t},tokensUpdate=function(e,o){for(var t=0;t<e.length;t++){var r=F.getTokensFromRange(e[t]);o=o.replace(e[t],"["+r.join(",")+"]")}return o},F=function(e,o,t,r,s){instance=s,x=t,y=r;var f="",h=Object.keys(o);if(h.length)for(var t=0;t<h.length;t++)h[t].indexOf(".")==-1&&h[t].indexOf("!")==-1?f+="var "+h[t]+" = "+o[h[t]]+`;
`:f+=h[t]+" = "+o[h[t]]+`;
`;e=e.replace(/\$/g,""),e=e.replace(/\!/g,"."),e=secureFormula(e,!0);var g=e.match(/([A-Z]+[0-9]*\.)?(\$?[A-Z]+\$?[0-9]+):(\$?[A-Z]+\$?[0-9]+)?/g);return g&&g.length&&(e=tokensUpdate(g,e)),new Function(f+"; return "+e)()},getColumnName=function(e){var o="";return e>701?(o+=String.fromCharCode(64+parseInt(e/676)),o+=String.fromCharCode(64+parseInt(e%676/26))):e>25&&(o+=String.fromCharCode(64+parseInt(e/26))),o+=String.fromCharCode(65+e%26),o};return F.getColumnNameFromCoords=function(e,o){return getColumnName(parseInt(e))+(parseInt(o)+1)},F.getCoordsFromColumnName=function(e){var o=/^[a-zA-Z]+/.exec(e);if(o){for(var t=0,r=0;r<o[0].length;r++)t+=parseInt(o[0].charCodeAt(r)-64)*Math.pow(26,o[0].length-1-r);t--,t<0&&(t=0);var s=parseInt(/[0-9]+$/.exec(e))||null;return s>0&&s--,[t,s]}},F.getRangeFromTokens=function(e){e=e.filter(function(s){return s!="#REF!"});for(var o="",t="",r=0;r<e.length;r++)e[r].indexOf(".")>=0?o=".":e[r].indexOf("!")>=0&&(o="!"),o&&(t=e[r].split(o),e[r]=t[1],t=t[0]+o);return e.sort(function(s,f){var h=Helpers.getCoordsFromColumnName(s),g=Helpers.getCoordsFromColumnName(f);return h[1]>g[1]?1:h[1]<g[1]?-1:h[0]>g[0]?1:h[0]<g[0]?-1:0}),e.length?t+(e[0]+":"+e[e.length-1]):"#REF!"},F.getTokensFromRange=function(t){if(t.indexOf(".")>0){var o=t.split(".");t=o[1],o=o[0]+"."}else if(t.indexOf("!")>0){var o=t.split("!");t=o[1],o=o[0]+"!"}else var o="";var t=t.split(":"),r=F.getCoordsFromColumnName(t[0]),s=F.getCoordsFromColumnName(t[1]);if(r[0]<=s[0])var f=r[0],h=s[0];else var f=s[0],h=r[0];if(r[1]===null&&s[1]==null)for(var g=null,u=null,d=Object.keys(vars),a=0;a<d.length;a++){var b=F.getCoordsFromColumnName(d[a]);b[0]===r[0]&&(g===null||b[1]<g)&&(g=b[1]),b[0]===s[0]&&(u===null||b[1]>u)&&(u=b[1])}else if(r[1]<=s[1])var g=r[1],u=s[1];else var g=s[1],u=r[1];for(var v=[],w=g;w<=u;w++){for(var S=[],a=f;a<=h;a++)S.push(o+F.getColumnNameFromCoords(a,w));v.push(S)}return v},F.setFormula=function(e){for(var o=Object.keys(e),t=0;t<o.length;t++)typeof e[o[t]]=="function"&&(window[o[t]]=e[o[t]])},F}();if(!jSuites&&typeof commonjsRequire=="function")var jSuites=jsuites.exports;(function(e,o){module.exports=o()})(commonjsGlobal,function(){var Version=function(){var e={title:"Jspreadsheet",version:"4.11.1",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join(`\r
`)}};return function(){return e}}(),isFormula=function(e){var o=(""+e)[0];return o=="="||o=="#"},getMask=function(e){if(e.format||e.mask||e.locale){var o={};return e.mask?o.mask=e.mask:e.format?o.mask=e.format:(o.locale=e.locale,o.options=e.options),e.decimal&&(o.options||(o.options={}),o.options={decimal:e.decimal}),o}return null},jexcel=function(el,options){var obj={};if(obj.options={},el instanceof Element||el instanceof HTMLDocument){if(el.tagName=="TABLE")if(options=jexcel.createFromTable(el,options)){var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}else return console.error("Jspreadsheet: el is not a valid DOM element"),!1}else return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if(property==="text"){obj.options[property]=defaults[property];for(var textKey in options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey])}else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,obj.options.lazyLoading==!0&&obj.options.tableOverflow==!1&&obj.options.fullscreen==!1&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(e){e==null&&(e=!obj.options.fullscreen),obj.options.fullscreen!=e&&(obj.options.fullscreen=e,e==!0?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(e){if(!obj.ignoreEvents){if(typeof obj.options.onevent=="function")var o=obj.options.onevent.apply(this,arguments);if(typeof obj.options[e]=="function")var o=obj.options[e].apply(this,Array.prototype.slice.call(arguments,1))}if(e=="onafterchanges"&&obj.options.persistance){var t=obj.options.persistance==!0?obj.options.url:obj.options.persistance,r=obj.prepareJson(arguments[2]);obj.save(t,r)}return o},obj.prepareTable=function(){var e=obj.options.columns.length;if(obj.options.data&&typeof obj.options.data[0]!="undefined"){var o=Object.keys(obj.options.data[0]);o.length>e&&(e=o.length)}obj.options.minDimensions[0]>e&&(e=obj.options.minDimensions[0]);for(var t=[],r=0;r<e;r++)obj.options.colHeaders[r]||(obj.options.colHeaders[r]=""),obj.options.colWidths[r]||(obj.options.colWidths[r]=obj.options.defaultColWidth),obj.options.colAlignments[r]||(obj.options.colAlignments[r]=obj.options.defaultColAlign),obj.options.columns[r]?obj.options.columns[r].type||(obj.options.columns[r].type="text"):obj.options.columns[r]={type:"text"},obj.options.columns[r].name||(obj.options.columns[r].name=o&&o[r]?o[r]:r),obj.options.columns[r].source||(obj.options.columns[r].source=[]),obj.options.columns[r].options||(obj.options.columns[r].options=[]),obj.options.columns[r].editor||(obj.options.columns[r].editor=null),obj.options.columns[r].allowEmpty||(obj.options.columns[r].allowEmpty=!1),obj.options.columns[r].title||(obj.options.columns[r].title=obj.options.colHeaders[r]?obj.options.colHeaders[r]:""),obj.options.columns[r].width||(obj.options.columns[r].width=obj.options.colWidths[r]?obj.options.colWidths[r]:obj.options.defaultColWidth),obj.options.columns[r].align||(obj.options.columns[r].align=obj.options.colAlignments[r]?obj.options.colAlignments[r]:"center"),obj.options.columns[r].type=="autocomplete"||obj.options.columns[r].type=="dropdown"?obj.options.columns[r].url&&t.push({url:obj.options.columns[r].url,index:r,method:"GET",dataType:"json",success:function(s){for(var f=0;f<s.length;f++)obj.options.columns[this.index].source.push(s[f])}}):obj.options.columns[r].type=="calendar"&&(obj.options.columns[r].options.format||(obj.options.columns[r].options.format="DD/MM/YYYY"));t.length?jSuites.ajax(t,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(_){obj.scrollControls(_)},obj.content.onwheel=function(_){obj.wheelControls(_)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var e=document.createElement("div"),o=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),e.appendChild(o),e.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var t=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var r=0;r<obj.options.paginationOptions.length;r++){var s=document.createElement("option");s.value=obj.options.paginationOptions[r],s.innerHTML=obj.options.paginationOptions[r],obj.paginationDropdown.appendChild(s)}obj.paginationDropdown.value=obj.options.pagination,t.appendChild(document.createTextNode(obj.options.text.show)),t.appendChild(obj.paginationDropdown),t.appendChild(document.createTextNode(obj.options.text.entries))}var f=document.createElement("div");f.classList.add("jexcel_filter"),f.appendChild(t),f.appendChild(e),obj.colgroupContainer=document.createElement("colgroup");var g=document.createElement("col");if(g.setAttribute("width","50"),obj.colgroupContainer.appendChild(g),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var h=0;h<obj.options.nestedHeaders.length;h++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[h]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));obj.headerContainer=document.createElement("tr");var g=document.createElement("td");g.classList.add("jexcel_selectall"),obj.headerContainer.appendChild(g);for(var r=0;r<obj.options.columns.length;r++)obj.createCellHeader(r),obj.headerContainer.appendChild(obj.headers[r]),obj.colgroupContainer.appendChild(obj.colgroup[r]);if(obj.thead.appendChild(obj.headerContainer),obj.options.filters==!0){obj.filter=document.createElement("tr");var u=document.createElement("td");obj.filter.appendChild(u);for(var r=0;r<obj.options.columns.length;r++){var u=document.createElement("td");u.innerHTML="&nbsp;",u.setAttribute("data-x",r),u.className="jexcel_column_filter",obj.options.columns[r].type=="hidden"&&(u.style.display="none"),obj.filter.appendChild(u)}obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),obj.options.selectionCopy==!1&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var d=document.createElement("a");d.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{if(typeof sessionStorage!="undefined"&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var a=document.createElement("img");a.src="//bossanova.uk/jspreadsheet/logo.png",d.appendChild(a)}}catch{}var b=document.createElement("span");b.innerHTML="Jspreadsheet CE",d.appendChild(b),obj.ads.appendChild(d);var v=document.createElement("div");v.classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var w=document.createElement("div"),S=document.createElement("div");if(obj.pagination.appendChild(w),obj.pagination.appendChild(S),obj.options.pagination||(obj.pagination.style.display="none"),obj.options.search==!0&&el.appendChild(f),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),obj.options.fullscreen==!0?el.classList.add("fullscreen"):obj.options.tableOverflow==!0&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),obj.options.tableOverflow!=!0&&obj.options.toolbar&&el.classList.add("with-toolbar"),obj.options.columnDrag==!0&&obj.thead.classList.add("draggable"),obj.options.columnResize==!0&&obj.thead.classList.add("resizable"),obj.options.rowDrag==!0&&obj.tbody.classList.add("draggable"),obj.options.rowResize==!0&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes)for(var E=Object.keys(obj.options.classes),r=0;r<E.length;r++){var m=jexcel.getIdFromColumnName(E[r],!0);obj.records[m[1]][m[0]].classList.add(obj.options.classes[E[r]])}},obj.refresh=function(){obj.options.url?(obj.options.loadingSpin==!0&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.setData(),obj.options.loadingSpin==!0&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(e){if(e&&(typeof e=="string"&&(e=JSON.parse(e)),obj.options.data=e),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){for(var e=[],t=0;t<obj.options.data.length;t++){for(var o=[],r=0;r<obj.options.columns.length;r++)o[r]=obj.options.data[t][obj.options.columns[r].name];e.push(o)}obj.options.data=e}var t=0,r=0,s=obj.options.columns.length,f=obj.options.data.length,h=obj.options.minDimensions[0],g=obj.options.minDimensions[1],u=h>s?h:s,d=g>f?g:f;for(t=0;t<d;t++)for(r=0;r<u;r++)obj.options.data[t]==null&&(obj.options.data[t]=[]),obj.options.data[t][r]==null&&(obj.options.data[t][r]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",obj.options.lazyLoading==!0){var a=0,b=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else if(obj.options.pagination)obj.pageNumber||(obj.pageNumber=0),obj.options.pagination,a=obj.options.pagination*obj.pageNumber,b=obj.options.pagination*obj.pageNumber+obj.options.pagination,obj.options.data.length<b&&(b=obj.options.data.length);else var a=0,b=obj.options.data.length;for(t=0;t<obj.options.data.length;t++){var v=obj.createRow(t,obj.options.data[t]);t>=a&&t<b&&obj.tbody.appendChild(v)}if(obj.options.lazyLoading==!0||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells)for(var w=Object.keys(obj.options.mergeCells),r=0;r<w.length;r++){var S=obj.options.mergeCells[w[r]];obj.setMerge(w[r],S[0],S[1],1)}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(e,o){for(var t=[],r=0,s=0,f=o==!0||obj.options.copyCompatibility==!1,h=obj.options.columns.length,g=obj.options.data.length,u=0;u<g;u++){r=0;for(var d=0;d<h;d++)(!e||obj.records[u][d].classList.contains("highlight"))&&(t[s]||(t[s]=[]),f?t[s][r]=obj.options.data[u][d]:t[s][r]=obj.records[u][d].innerHTML,r++);r>0&&s++}return t},obj.getJsonRow=function(e){for(var o=obj.options.data[e],t=obj.options.columns.length,r={},s=0;s<t;s++)obj.options.columns[s].name||(obj.options.columns[s].name=s),r[obj.options.columns[s].name]=o[s];return r},obj.getJson=function(e){for(var o=[],t=obj.options.columns.length,r=obj.options.data.length,s=0;s<r;s++){for(var f=null,h=0;h<t;h++)(!e||obj.records[s][h].classList.contains("highlight"))&&(f==null&&(f={}),obj.options.columns[h].name||(obj.options.columns[h].name=h),f[obj.options.columns[h].name]=obj.options.data[s][h]);f!=null&&o.push(f)}return o},obj.prepareJson=function(e){for(var o=[],t=0;t<e.length;t++){var r=e[t].x,s=e[t].y,f=obj.options.columns[r].name?obj.options.columns[r].name:r;o[s]||(o[s]={row:s,data:{}}),o[s].data[f]=e[t].newValue}return o.filter(function(h){return h!=null})},obj.save=function(e,o){var t=obj.dispatch("onbeforesave",el,obj,o);if(t)var o=t;else if(t===!1)return!1;jSuites.ajax({url:e,method:"POST",dataType:"json",data:{data:JSON.stringify(o)},success:function(r){obj.dispatch("onsave",el,obj,o)}})},obj.getRowData=function(e){return obj.options.data[e]},obj.setRowData=function(e,o){for(var t=0;t<obj.headers.length;t++){var r=jexcel.getColumnNameFromId([t,e]);o[t]!=null&&obj.setValue(r,o[t])}},obj.getColumnData=function(e){for(var o=[],t=0;t<obj.options.data.length;t++)o.push(obj.options.data[t][e]);return o},obj.setColumnData=function(e,o){for(var t=0;t<obj.rows.length;t++){var r=jexcel.getColumnNameFromId([e,t]);o[t]!=null&&obj.setValue(r,o[t])}},obj.createRow=function(e,o){if(obj.records[e]||(obj.records[e]=[]),!o)var o=obj.options.data[e];obj.rows[e]=document.createElement("tr"),obj.rows[e].setAttribute("data-y",e);var t=null;obj.options.defaultRowHeight&&(obj.rows[e].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[e]&&(obj.options.rows[e].height&&(obj.rows[e].style.height=obj.options.rows[e].height),obj.options.rows[e].title&&(t=obj.options.rows[e].title)),t||(t=parseInt(e+1));var r=document.createElement("td");r.innerHTML=t,r.setAttribute("data-y",e),r.className="jexcel_row",obj.rows[e].appendChild(r);for(var s=0;s<obj.options.columns.length;s++)obj.records[e][s]=obj.createCell(s,e,o[s]),obj.rows[e].appendChild(obj.records[e][s]);return obj.rows[e]},obj.parseValue=function(e,o,t,r){(""+t).substr(0,1)=="="&&obj.options.parseFormulas==!0&&(t=obj.executeFormula(t,e,o));var s=obj.options.columns[e];if(s&&!isFormula(t)){var f=null;if(f=getMask(s)){t&&t==Number(t)&&(t=Number(t));var h=jSuites.mask.render(t,f,!0);if(r&&f.mask){var g=f.mask.split(";");if(g[1]){var u=g[1].match(new RegExp("\\[Red\\]","gi"));u&&(t<0?r.classList.add("red"):r.classList.remove("red"));var d=g[1].match(new RegExp("\\(","gi"));d&&t<0&&(h="("+h+")")}}h&&(t=h)}}return t};var validDate=function(e){return e=""+e,e.substr(4,1)=="-"&&e.substr(7,1)=="-"?!0:(e=e.split("-"),e[0].length==4&&e[0]==Number(e[0])&&e[1].length==2&&e[1]==Number(e[1]))};obj.createCell=function(e,o,t){var r=document.createElement("td");if(r.setAttribute("data-x",e),r.setAttribute("data-y",o),(""+t).substr(0,1)=="="&&obj.options.secureFormulas==!0){var s=secureFormula(t);s!=t&&(t=s)}if(obj.options.columns[e].editor)obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?r.innerHTML=t:r.innerText=t,typeof obj.options.columns[e].editor.createCell=="function"&&(r=obj.options.columns[e].editor.createCell(r));else if(obj.options.columns[e].type=="hidden")r.style.display="none",r.innerText=t;else if(obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio"){var f=document.createElement("input");f.type=obj.options.columns[e].type,f.name="c"+e,f.checked=t==1||t==!0||t=="true",f.onclick=function(){obj.setValue(r,this.checked)},(obj.options.columns[e].readOnly==!0||obj.options.editable==!1)&&f.setAttribute("disabled","disabled"),r.appendChild(f),obj.options.data[o][e]=f.checked}else if(obj.options.columns[e].type=="calendar"){var h=null;if(!validDate(t)){var g=jSuites.calendar.extractDateFromString(t,obj.options.columns[e].options.format);g&&(h=g)}r.innerText=jSuites.calendar.getDateString(h||t,obj.options.columns[e].options.format)}else if(obj.options.columns[e].type=="dropdown"||obj.options.columns[e].type=="autocomplete")r.classList.add("jexcel_dropdown"),r.innerText=obj.getDropDownValue(e,t);else if(obj.options.columns[e].type=="color")if(obj.options.columns[e].render=="square"){var u=document.createElement("div");u.className="color",u.style.backgroundColor=t,r.appendChild(u)}else r.style.color=t,r.innerText=t;else if(obj.options.columns[e].type=="image"){if(t&&t.substr(0,10)=="data:image"){var d=document.createElement("img");d.src=t,r.appendChild(d)}}else obj.options.columns[e].type=="html"||obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?r.innerHTML=stripScript(obj.parseValue(e,o,t,r)):r.innerText=obj.parseValue(e,o,t,r);obj.options.columns[e].readOnly==!0&&(r.className="readonly");var a=obj.options.columns[e].align?obj.options.columns[e].align:"center";return r.style.textAlign=a,obj.options.columns[e].wordWrap!=!1&&(obj.options.wordWrap==!0||obj.options.columns[e].wordWrap==!0||r.innerHTML.length>200)&&(r.style.whiteSpace="pre-wrap"),e>0&&this.options.textOverflow==!0&&(t||r.innerHTML?obj.records[o][e-1].style.overflow="hidden":e==obj.options.columns.length-1&&(r.style.overflow="hidden")),r},obj.createCellHeader=function(e){var o=obj.options.columns[e].width?obj.options.columns[e].width:obj.options.defaultColWidth,t=obj.options.columns[e].align?obj.options.columns[e].align:obj.options.defaultColAlign;obj.headers[e]=document.createElement("td"),obj.options.stripHTML?obj.headers[e].innerText=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e):obj.headers[e].innerHTML=obj.options.columns[e].title?obj.options.columns[e].title:jexcel.getColumnName(e),obj.headers[e].setAttribute("data-x",e),obj.headers[e].style.textAlign=t,obj.options.columns[e].title&&obj.headers[e].setAttribute("title",obj.options.columns[e].title),obj.options.columns[e].id&&obj.headers[e].setAttribute("id",obj.options.columns[e].id),obj.colgroup[e]=document.createElement("col"),obj.colgroup[e].setAttribute("width",o),obj.options.columns[e].type=="hidden"&&(obj.headers[e].style.display="none",obj.colgroup[e].style.display="none")},obj.updateNestedHeader=function(e,o,t){obj.options.nestedHeaders[o][e].title&&(obj.options.nestedHeaders[o][e].title=t,obj.options.nestedHeaders[o].element.children[e+1].innerText=t)},obj.createNestedHeader=function(e){var o=document.createElement("tr");o.classList.add("jexcel_nested");var t=document.createElement("td");o.appendChild(t),e.element=o;for(var r=0,s=0;s<e.length;s++){e[s].colspan||(e[s].colspan=1),e[s].align||(e[s].align="center"),e[s].title||(e[s].title="");for(var f=e[s].colspan,h=[],g=0;g<f;g++)obj.options.columns[r]&&obj.options.columns[r].type=="hidden"&&f++,h.push(r),r++;var t=document.createElement("td");t.setAttribute("data-column",h.join(",")),t.setAttribute("colspan",e[s].colspan),t.setAttribute("align",e[s].align),t.innerText=e[s].title,o.appendChild(t)}return o},obj.createToolbar=function(e){if(e)obj.options.toolbar=e;else var e=obj.options.toolbar;for(var o=0;o<e.length;o++)if(e[o].type=="i"){var t=document.createElement("i");t.classList.add("jexcel_toolbar_item"),t.classList.add("material-icons"),t.setAttribute("data-k",e[o].k),t.setAttribute("data-v",e[o].v),t.setAttribute("id",e[o].id),e[o].tooltip&&t.setAttribute("title",e[o].tooltip),e[o].onclick&&typeof e[o].onclick?t.onclick=function(f){var h=f;return function(){e[h].onclick(el,obj,this)}}(o):t.onclick=function(){var f=this.getAttribute("data-k"),h=this.getAttribute("data-v");obj.setStyle(obj.highlighted,f,h)},t.innerText=e[o].content,obj.toolbar.appendChild(t)}else if(e[o].type=="select"){var t=document.createElement("select");t.classList.add("jexcel_toolbar_item"),t.setAttribute("data-k",e[o].k),e[o].tooltip&&t.setAttribute("title",e[o].tooltip),e[o].onchange&&typeof e[o].onchange?t.onchange=e[o].onchange:t.onchange=function(){var h=this.getAttribute("data-k");obj.setStyle(obj.highlighted,h,this.value)};for(var r=0;r<e[o].v.length;r++){var s=document.createElement("option");s.value=e[o].v[r],s.innerText=e[o].v[r],t.appendChild(s)}obj.toolbar.appendChild(t)}else if(e[o].type=="color"){var t=document.createElement("i");t.classList.add("jexcel_toolbar_item"),t.classList.add("material-icons"),t.setAttribute("data-k",e[o].k),t.setAttribute("data-v",""),e[o].tooltip&&t.setAttribute("title",e[o].tooltip),obj.toolbar.appendChild(t),t.innerText=e[o].content,jSuites.color(t,{onchange:function(h,g){var u=h.getAttribute("data-k");obj.setStyle(obj.highlighted,u,g)}})}},obj.setMerge=function(e,o,t,r){var s=!1;if(!e)if(obj.highlighted.length)var f=parseInt(obj.highlighted[0].getAttribute("data-x")),h=parseInt(obj.highlighted[0].getAttribute("data-y")),g=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),u=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y")),e=jexcel.getColumnNameFromId([f,h]),o=g-f+1,t=u-h+1;else return alert(obj.options.text.noCellsSelected),null;var d=jexcel.getIdFromColumnName(e,!0);if(obj.options.mergeCells[e])obj.records[d[1]][d[0]].getAttribute("data-merged")&&(s=obj.options.text.cellAlreadyMerged);else if((!o||o<2)&&(!t||t<2))s=obj.options.text.invalidMergeProperties;else for(var a=d[1];a<d[1]+t;a++)for(var b=d[0];b<d[0]+o;b++)jexcel.getColumnNameFromId([b,a]),obj.records[a][b].getAttribute("data-merged")&&(s=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(s)alert(s);else{o>1?obj.records[d[1]][d[0]].setAttribute("colspan",o):o=1,t>1?obj.records[d[1]][d[0]].setAttribute("rowspan",t):t=1,obj.options.mergeCells[e]=[o,t,[]],obj.records[d[1]][d[0]].setAttribute("data-merged","true"),obj.records[d[1]][d[0]].style.overflow="hidden";for(var v=[],w=d[1];w<d[1]+t;w++)for(var S=d[0];S<d[0]+o;S++)d[0]==S&&d[1]==w||(v.push(obj.options.data[w][S]),obj.updateCell(S,w,"",!0),obj.options.mergeCells[e][2].push(obj.records[w][S]),obj.records[w][S].style.display="none",obj.records[w][S]=obj.records[d[1]][d[0]]);obj.updateSelection(obj.records[d[1]][d[0]]),r||(obj.setHistory({action:"setMerge",column:e,colspan:o,rowspan:t,data:v}),obj.dispatch("onmerge",el,e,o,t))}},obj.getMerge=function(e){var o={};if(e)obj.options.mergeCells[e]?o=[obj.options.mergeCells[e][0],obj.options.mergeCells[e][1]]:o=null;else if(obj.options.mergeCells){obj.options.mergeCells;for(var t=Object.keys(obj.options.mergeCells),r=0;r<t.length;r++)o[t[r]]=[obj.options.mergeCells[t[r]][0],obj.options.mergeCells[t[r]][1]]}return o},obj.removeMerge=function(e,o,t){if(obj.options.mergeCells[e]){var r=jexcel.getIdFromColumnName(e,!0);obj.records[r[1]][r[0]].removeAttribute("colspan"),obj.records[r[1]][r[0]].removeAttribute("rowspan"),obj.records[r[1]][r[0]].removeAttribute("data-merged");for(var s=obj.options.mergeCells[e],f=0,h=0;h<s[1];h++)for(var g=0;g<s[0];g++)(h>0||g>0)&&(obj.records[r[1]+h][r[0]+g]=s[2][f],obj.records[r[1]+h][r[0]+g].style.display="",o&&o[f]&&obj.updateCell(r[0]+g,r[1]+h,o[f]),f++);obj.updateSelection(obj.records[r[1]][r[0]],obj.records[r[1]+h-1][r[0]+g-1]),t||delete obj.options.mergeCells[e]}},obj.destroyMerged=function(e){if(obj.options.mergeCells){obj.options.mergeCells;for(var o=Object.keys(obj.options.mergeCells),t=0;t<o.length;t++)obj.removeMerge(o[t],null,e)}},obj.isColMerged=function(e,o){var t=[];if(obj.options.mergeCells)for(var r=Object.keys(obj.options.mergeCells),s=0;s<r.length;s++){var f=jexcel.getIdFromColumnName(r[s],!0),h=obj.options.mergeCells[r[s]][0],g=f[0],u=f[0]+(h>1?h-1:0);o==null?g<=e&&u>=e&&t.push(r[s]):o?g<e&&u>=e&&t.push(r[s]):g<=e&&u>e&&t.push(r[s])}return t},obj.isRowMerged=function(e,o){var t=[];if(obj.options.mergeCells)for(var r=Object.keys(obj.options.mergeCells),s=0;s<r.length;s++){var f=jexcel.getIdFromColumnName(r[s],!0),h=obj.options.mergeCells[r[s]][1],g=f[1],u=f[1]+(h>1?h-1:0);o==null?g<=e&&u>=e&&t.push(r[s]):o?g<e&&u>=e&&t.push(r[s]):g<=e&&u>e&&t.push(r[s])}return t},obj.openFilter=function(e){if(!obj.options.filters)console.log("Jspreadsheet: filters not enabled.");else{e=parseInt(e),obj.resetSelection();var o=[];if(obj.options.columns[e].type=="checkbox")o.push({id:"true",name:"True"}),o.push({id:"false",name:"False"});else{for(var t=[],r=!1,s=0;s<obj.options.data.length;s++){var f=obj.options.data[s][e],h=obj.records[s][e].innerHTML;if(f&&h)t[f]=h;else var r=!0}for(var g=Object.keys(t),o=[],s=0;s<g.length;s++)o.push({id:g[s],name:t[g[s]]});r&&o.push({value:"",id:"",name:"(Blanks)"})}var u=document.createElement("div");obj.filter.children[e+1].innerHTML="",obj.filter.children[e+1].appendChild(u),obj.filter.children[e+1].style.paddingLeft="0px",obj.filter.children[e+1].style.paddingRight="0px",obj.filter.children[e+1].style.overflow="initial";var d={data:o,multiple:!0,autocomplete:!0,opened:!0,value:obj.filters[e]!==void 0?obj.filters[e]:null,width:"100%",position:obj.options.tableOverflow==!0||obj.options.fullscreen==!0,onclose:function(a){obj.resetFilters(),obj.filters[e]=a.dropdown.getValue(!0),obj.filter.children[e+1].innerHTML=a.dropdown.getText(),obj.filter.children[e+1].style.paddingLeft="",obj.filter.children[e+1].style.paddingRight="",obj.filter.children[e+1].style.overflow="",obj.closeFilter(e),obj.refreshSelection()}};jSuites.dropdown(u,d)}},obj.resetFilters=function(){if(obj.options.filters)for(var e=0;e<obj.filter.children.length;e++)obj.filter.children[e].innerHTML="&nbsp;",obj.filters[e]=null;obj.results=null,obj.updateResult()},obj.closeFilter=function(e){if(!e)for(var o=0;o<obj.filter.children.length;o++)obj.filters[o]&&(e=o);var t=function(f,h,g){for(var u=0;u<f.length;u++){var d=""+obj.options.data[g][h],a=""+obj.records[g][h].innerHTML;if(f[u]==d||f[u]==a)return!0}return!1},r=obj.filters[e];obj.results=[];for(var s=0;s<obj.options.data.length;s++)t(r,e,s)&&obj.results.push(s);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(e,o,t){var r=e.getAttribute("data-y"),s=e.getAttribute("data-x");obj.dispatch("oneditionstart",el,e,s,r),s>0&&(obj.records[r][s-1].style.overflow="hidden");var f=function(T){var M=e.getBoundingClientRect(),P=document.createElement(T);return P.style.width=M.width+"px",P.style.height=M.height-2+"px",P.style.minHeight=M.height-2+"px",e.classList.add("editor"),e.innerHTML="",e.appendChild(P),obj.dispatch("oncreateeditor",el,e,s,r,P),P};if(e.classList.contains("readonly")!=!0){if(obj.edition=[obj.records[r][s],obj.records[r][s].innerHTML,s,r],obj.options.columns[s].editor)obj.options.columns[s].editor.openEditor(e,el,o,t);else if(obj.options.columns[s].type!="hidden")if(obj.options.columns[s].type=="checkbox"||obj.options.columns[s].type=="radio"){var h=!e.children[0].checked;obj.setValue(e,h),obj.edition=null}else if(obj.options.columns[s].type=="dropdown"||obj.options.columns[s].type=="autocomplete"){var h=obj.options.data[r][s];if(obj.options.columns[s].multiple&&!Array.isArray(h)&&(h=h.split(";")),typeof obj.options.columns[s].filter=="function")var g=obj.options.columns[s].filter(el,e,s,r,obj.options.columns[s].source);else var g=obj.options.columns[s].source;for(var u=[],d=0;d<g.length;d++)u.push(g[d]);var a=f("div"),b={data:u,multiple:!!obj.options.columns[s].multiple,autocomplete:!!(obj.options.columns[s].autocomplete||obj.options.columns[s].type=="autocomplete"),opened:!0,value:h,width:"100%",height:a.style.minHeight,position:obj.options.tableOverflow==!0||obj.options.fullscreen==!0,onclose:function(){obj.closeEditor(e,!0)}};obj.options.columns[s].options&&obj.options.columns[s].options.type&&(b.type=obj.options.columns[s].options.type),jSuites.dropdown(a,b)}else if(obj.options.columns[s].type=="calendar"||obj.options.columns[s].type=="color"){var h=obj.options.data[r][s],a=f("input");a.value=h,(obj.options.tableOverflow==!0||obj.options.fullscreen==!0)&&(obj.options.columns[s].options.position=!0),obj.options.columns[s].options.value=obj.options.data[r][s],obj.options.columns[s].options.opened=!0,obj.options.columns[s].options.onclose=function(P,B){obj.closeEditor(e,!0)},obj.options.columns[s].type=="color"?jSuites.color(a,obj.options.columns[s].options):jSuites.calendar(a,obj.options.columns[s].options),a.focus()}else if(obj.options.columns[s].type=="html"){var h=obj.options.data[r][s],a=f("div");a.style.position="relative";var v=document.createElement("div");v.classList.add("jexcel_richtext"),a.appendChild(v),jSuites.editor(v,{focus:!0,value:h});var w=e.getBoundingClientRect(),S=v.getBoundingClientRect();window.innerHeight<w.bottom+S.height?v.style.top=w.top-(S.height+2)+"px":v.style.top=w.top+"px"}else if(obj.options.columns[s].type=="image"){var E=e.children[0],a=f("div");a.style.position="relative";var v=document.createElement("div");v.classList.add("jclose"),E&&E.src&&v.appendChild(E),a.appendChild(v),jSuites.image(v,obj.options.imageOptions);var w=e.getBoundingClientRect(),S=v.getBoundingClientRect();window.innerHeight<w.bottom+S.height?v.style.top=w.top-(S.height+2)+"px":v.style.top=w.top+"px"}else{var h=o==!0?"":obj.options.data[r][s];if(obj.options.columns[s].wordWrap!=!1&&(obj.options.wordWrap==!0||obj.options.columns[s].wordWrap==!0))var a=f("textarea");else var a=f("input");a.focus(),a.value=h;var b=obj.options.columns[s],m=null;if(!isFormula(h)&&(m=getMask(b))){if(!b.disabledMaskOnEdition)if(b.mask){var _=b.mask.split(";");a.setAttribute("data-mask",_[0])}else b.locale&&a.setAttribute("data-locale",b.locale);m.input=a,a.mask=m,jSuites.mask.render(h,m,!1)}a.onblur=function(){obj.closeEditor(e,!0)},a.scrollLeft=a.scrollWidth}}},obj.closeEditor=function(e,o){var t=parseInt(e.getAttribute("data-x")),r=parseInt(e.getAttribute("data-y"));if(o==!0){if(obj.options.columns[t].editor)var s=obj.options.columns[t].editor.closeEditor(e,o);else if(!(obj.options.columns[t].type=="checkbox"||obj.options.columns[t].type=="radio"||obj.options.columns[t].type=="hidden"))if(obj.options.columns[t].type=="dropdown"||obj.options.columns[t].type=="autocomplete")var s=e.children[0].dropdown.close(!0);else if(obj.options.columns[t].type=="calendar")var s=e.children[0].calendar.close(!0);else if(obj.options.columns[t].type=="color")var s=e.children[0].color.close(!0);else if(obj.options.columns[t].type=="html")var s=e.children[0].children[0].editor.getData();else if(obj.options.columns[t].type=="image")var f=e.children[0].children[0].children[0],s=f&&f.tagName=="IMG"?f.src:"";else if(obj.options.columns[t].type=="numeric"){var s=e.children[0].value;(""+s).substr(0,1)!="="&&s==""&&(s=obj.options.columns[t].allowEmpty?"":0),e.children[0].onblur=null}else{var s=e.children[0].value;e.children[0].onblur=null;var h=obj.options.columns[t],g=null;if((g=getMask(h))&&s!==""&&!isFormula(s)&&typeof s!="number"){var u=jSuites.mask.extract(s,g,!0);u&&u.value!==""&&(s=u.value)}}obj.options.data[r][t]==s?e.innerHTML=obj.edition[1]:obj.setValue(e,s)}else obj.options.columns[t].editor?obj.options.columns[t].editor.closeEditor(e,o):obj.options.columns[t].type=="dropdown"||obj.options.columns[t].type=="autocomplete"?e.children[0].dropdown.close(!0):obj.options.columns[t].type=="calendar"?e.children[0].calendar.close(!0):obj.options.columns[t].type=="color"?e.children[0].color.close(!0):e.children[0].onblur=null,e.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,e,t,r,s,o),e.classList.remove("editor"),obj.edition=null},obj.getCell=function(e){e=jexcel.getIdFromColumnName(e,!0);var o=e[0],t=e[1];return obj.records[t][o]},obj.getColumnOptions=function(e,o){var t=obj.options.columns[e];return t||(t={type:"text"}),t},obj.getCellFromCoords=function(e,o){return obj.records[o][e]},obj.getLabel=function(e){e=jexcel.getIdFromColumnName(e,!0);var o=e[0],t=e[1];return obj.records[t][o].innerHTML},obj.getLabelFromCoords=function(e,o){return obj.records[o][e].innerHTML},obj.getValue=function(e,o){if(typeof e=="object")var t=e.getAttribute("data-x"),r=e.getAttribute("data-y");else{e=jexcel.getIdFromColumnName(e,!0);var t=e[0],r=e[1]}var s=null;return t!=null&&r!=null&&(obj.records[r]&&obj.records[r][t]&&(o||obj.options.copyCompatibility==!0)?s=obj.records[r][t].innerHTML:obj.options.data[r]&&obj.options.data[r][t]!="undefined"&&(s=obj.options.data[r][t])),s},obj.getValueFromCoords=function(e,o,t){var r=null;return e!=null&&o!=null&&(obj.records[o]&&obj.records[o][e]&&t||obj.options.copyCompatibility==!0?r=obj.records[o][e].innerHTML:obj.options.data[o]&&obj.options.data[o][e]!="undefined"&&(r=obj.options.data[o][e])),r},obj.setValue=function(e,o,t){var r=[];if(typeof e=="string"){var s=jexcel.getIdFromColumnName(e,!0),f=s[0],h=s[1];r.push(obj.updateCell(f,h,o,t)),obj.updateFormulaChain(f,h,r)}else{var f=null,h=null;if(e&&e.getAttribute)var f=e.getAttribute("data-x"),h=e.getAttribute("data-y");if(f!=null&&h!=null)r.push(obj.updateCell(f,h,o,t)),obj.updateFormulaChain(f,h,r);else{var g=Object.keys(e);if(g.length>0)for(var u=0;u<g.length;u++){if(typeof e[u]=="string")var s=jexcel.getIdFromColumnName(e[u],!0),f=s[0],h=s[1];else if(e[u].x!=null&&e[u].y!=null){var f=e[u].x,h=e[u].y;e[u].newValue!=null?o=e[u].newValue:e[u].value!=null&&(o=e[u].value)}else var f=e[u].getAttribute("data-x"),h=e[u].getAttribute("data-y");f!=null&&h!=null&&(r.push(obj.updateCell(f,h,o,t)),obj.updateFormulaChain(f,h,r))}}}obj.setHistory({action:"setValue",records:r,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,r)},obj.setValueFromCoords=function(e,o,t,r){var s=[];s.push(obj.updateCell(e,o,t,r)),obj.updateFormulaChain(e,o,s),obj.setHistory({action:"setValue",records:s,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,s)},obj.setCheckRadioValue=function(){for(var e=[],o=Object.keys(obj.highlighted),t=0;t<o.length;t++){var r=obj.highlighted[t].getAttribute("data-x"),s=obj.highlighted[t].getAttribute("data-y");(obj.options.columns[r].type=="checkbox"||obj.options.columns[r].type=="radio")&&e.push(obj.updateCell(r,s,!obj.options.data[s][r]))}e.length&&(obj.setHistory({action:"setValue",records:e,selection:obj.selectedCell}),obj.onafterchanges(el,e))};var stripScript=function(e){var o=new Option;o.innerHTML=e;var t=null;for(e=o.getElementsByTagName("script");t=e[0];)t.parentNode.removeChild(t);return o.innerHTML};obj.updateCell=function(e,o,t,r){if(obj.records[o][e].classList.contains("readonly")==!0&&!r)var s={x:e,y:o,col:e,row:o};else{if((""+t).substr(0,1)=="="&&obj.options.secureFormulas==!0){var f=secureFormula(t);f!=t&&(t=f)}var f=obj.dispatch("onbeforechange",el,obj.records[o][e],e,o,t);f!=null&&(t=f),obj.options.columns[e].editor&&typeof obj.options.columns[e].editor.updateCell=="function"&&(t=obj.options.columns[e].editor.updateCell(obj.records[o][e],t,r));var s={x:e,y:o,col:e,row:o,newValue:t,oldValue:obj.options.data[o][e]};if(obj.options.columns[e].editor)obj.options.data[o][e]=t;else if(obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio"){if(obj.options.columns[e].type=="radio")for(var h=0;h<obj.options.data.length;h++)obj.options.data[h][e]=!1;obj.records[o][e].children[0].checked=t==1||t==!0||t=="true"||t=="TRUE",obj.options.data[o][e]=obj.records[o][e].children[0].checked}else if(obj.options.columns[e].type=="dropdown"||obj.options.columns[e].type=="autocomplete")obj.options.data[o][e]=t,obj.records[o][e].innerText=obj.getDropDownValue(e,t);else if(obj.options.columns[e].type=="calendar"){var g=null;if(!validDate(t)){var u=jSuites.calendar.extractDateFromString(t,obj.options.columns[e].options.format);u&&(g=u)}obj.options.data[o][e]=t,obj.records[o][e].innerText=jSuites.calendar.getDateString(g||t,obj.options.columns[e].options.format)}else if(obj.options.columns[e].type=="color")if(obj.options.data[o][e]=t,obj.options.columns[e].render=="square"){var d=document.createElement("div");d.className="color",d.style.backgroundColor=t,obj.records[o][e].innerText="",obj.records[o][e].appendChild(d)}else obj.records[o][e].style.color=t,obj.records[o][e].innerText=t;else if(obj.options.columns[e].type=="image"){if(t=""+t,obj.options.data[o][e]=t,obj.records[o][e].innerHTML="",t&&t.substr(0,10)=="data:image"){var a=document.createElement("img");a.src=t,obj.records[o][e].appendChild(a)}}else obj.options.data[o][e]=t,obj.options.columns[e].type=="html"?obj.records[o][e].innerHTML=stripScript(obj.parseValue(e,o,t)):obj.options.stripHTML===!1||obj.options.columns[e].stripHTML===!1?obj.records[o][e].innerHTML=stripScript(obj.parseValue(e,o,t,obj.records[o][e])):obj.records[o][e].innerText=obj.parseValue(e,o,t,obj.records[o][e]),obj.options.columns[e].wordWrap!=!1&&(obj.options.wordWrap==!0||obj.options.columns[e].wordWrap==!0||obj.records[o][e].innerHTML.length>200)?obj.records[o][e].style.whiteSpace="pre-wrap":obj.records[o][e].style.whiteSpace="";e>0&&(t?obj.records[o][e-1].style.overflow="hidden":obj.records[o][e-1].style.overflow=""),obj.dispatch("onchange",el,obj.records[o]&&obj.records[o][e]?obj.records[o][e]:null,e,o,t,s.oldValue)}return s},obj.copyData=function(e,o){var t=obj.getData(!0,!0),r=obj.selectedContainer,s=parseInt(e.getAttribute("data-x")),f=parseInt(e.getAttribute("data-y")),h=parseInt(o.getAttribute("data-x")),g=parseInt(o.getAttribute("data-y")),u=[],d=!1;if(r[0]==s){if(f<r[1])var a=f-r[1];else var a=1;var b=0}else{if(s<r[0])var b=s-r[0];else var b=1;var a=0}for(var v=0,w=0,S=f;S<=g;S++)if(!(obj.rows[S]&&obj.rows[S].style.display=="none")){if(t[w]==null&&(w=0),v=0,r[0]!=s)if(s<r[0])var b=s-r[0];else var b=1;for(var E=s;E<=h;E++){if(obj.records[S][E]&&!obj.records[S][E].classList.contains("readonly")&&obj.records[S][E].style.display!="none"&&d==!1){if(!obj.selection.length&&obj.options.data[S][E]!=""){d=!0;continue}(t[w]==null||t[w][v]==null)&&(v=0);var m=t[w][v];if(m&&!t[1]&&obj.options.autoIncrement==!0){if(obj.options.columns[E].type=="text"||obj.options.columns[E].type=="number")if((""+m).substr(0,1)=="="){var _=m.match(/([A-Z]+[0-9]+)/g);if(_){for(var T=[],M=0;M<_.length;M++){var P=jexcel.getIdFromColumnName(_[M],1);P[0]+=b,P[1]+=a,P[1]<0&&(P[1]=0);var B=jexcel.getColumnNameFromId([P[0],P[1]]);B!=_[M]&&(T[_[M]]=B)}T&&(m=obj.updateFormula(m,T))}}else m==Number(m)&&(m=Number(m)+a);else if(obj.options.columns[E].type=="calendar"){var D=new Date(m);D.setDate(D.getDate()+a),m=D.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(D.getMonth()+1))+"-"+jexcel.doubleDigitFormat(D.getDate())+" 00:00:00"}}u.push(obj.updateCell(E,S,m)),obj.updateFormulaChain(E,S,u)}v++,r[0]!=s&&b++}w++,a++}obj.setHistory({action:"setValue",records:u,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,u)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(e,o,t){if(e==1){if(obj.selectedCell&&(o>=obj.selectedCell[1]&&o<=obj.selectedCell[3]||t>=obj.selectedCell[1]&&t<=obj.selectedCell[3])){obj.resetSelection();return}}else if(obj.selectedCell&&(o>=obj.selectedCell[0]&&o<=obj.selectedCell[2]||t>=obj.selectedCell[0]&&t<=obj.selectedCell[2])){obj.resetSelection();return}},obj.resetSelection=function(e){if(obj.highlighted.length)for(var o=1,t=0;t<obj.highlighted.length;t++){obj.highlighted[t].classList.remove("highlight"),obj.highlighted[t].classList.remove("highlight-left"),obj.highlighted[t].classList.remove("highlight-right"),obj.highlighted[t].classList.remove("highlight-top"),obj.highlighted[t].classList.remove("highlight-bottom"),obj.highlighted[t].classList.remove("highlight-selected");var r=parseInt(obj.highlighted[t].getAttribute("data-x")),s=parseInt(obj.highlighted[t].getAttribute("data-y"));if(obj.highlighted[t].getAttribute("data-merged"))var f=parseInt(obj.highlighted[t].getAttribute("colspan")),h=parseInt(obj.highlighted[t].getAttribute("rowspan")),g=f>0?r+(f-1):r,u=h>0?s+(h-1):s;else var g=r,u=s;for(var d=r;d<=g;d++)obj.headers[d]&&obj.headers[d].classList.remove("selected");for(var d=s;d<=u;d++)obj.rows[d]&&obj.rows[d].classList.remove("selected")}else var o=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",e==!0&&o==1&&obj.dispatch("onblur",el),o},obj.updateSelection=function(e,o,t){var r=e.getAttribute("data-x"),s=e.getAttribute("data-y");if(o)var f=o.getAttribute("data-x"),h=o.getAttribute("data-y");else var f=r,h=s;obj.updateSelectionFromCoords(r,s,f,h,t)},obj.updateSelectionFromCoords=function(e,o,t,r,s){var f=obj.resetSelection();if(o==null&&(o=0,r=obj.rows.length-1),t==null&&(t=e),r==null&&(r=o),e>=obj.headers.length&&(e=obj.headers.length-1),o>=obj.rows.length&&(o=obj.rows.length-1),t>=obj.headers.length&&(t=obj.headers.length-1),r>=obj.rows.length&&(r=obj.rows.length-1),obj.selectedCell=[e,o,t,r],e!=null){if(obj.records[o][e]&&obj.records[o][e].classList.add("highlight-selected"),parseInt(e)<parseInt(t))var h=parseInt(e),g=parseInt(t);else var h=parseInt(t),g=parseInt(e);if(parseInt(o)<parseInt(r))var u=parseInt(o),d=parseInt(r);else var u=parseInt(r),d=parseInt(o);for(var a=h;a<=g;a++)for(var b=u;b<=d;b++)if(obj.records[b][a]&&obj.records[b][a].getAttribute("data-merged")){var v=parseInt(obj.records[b][a].getAttribute("data-x")),w=parseInt(obj.records[b][a].getAttribute("data-y")),S=parseInt(obj.records[b][a].getAttribute("colspan")),E=parseInt(obj.records[b][a].getAttribute("rowspan"));S>1&&(v<h&&(h=v),v+S>g&&(g=v+S-1)),E&&(w<u&&(u=w),w+E>d&&(d=w+E-1))}for(var m=null,_=null,T=null,M=null,b=u;b<=d;b++)obj.rows[b].style.display!="none"&&(T==null&&(T=b),M=b);for(var a=h;a<=g;a++){for(var b=u;b<=d;b++)obj.rows[b].style.display!="none"&&obj.records[b][a].style.display!="none"&&(obj.records[b][a].classList.add("highlight"),obj.highlighted.push(obj.records[b][a]));obj.options.columns[a].type!="hidden"&&(m==null&&(m=a),_=a)}m||(m=0),_||(_=0);for(var a=m;a<=_;a++)obj.options.columns[a].type!="hidden"&&(obj.records[T]&&obj.records[T][a]&&obj.records[T][a].classList.add("highlight-top"),obj.records[M]&&obj.records[M][a]&&obj.records[M][a].classList.add("highlight-bottom"),obj.headers[a].classList.add("selected"));for(var b=T;b<=M;b++)obj.rows[b]&&obj.rows[b].style.display!="none"&&(obj.records[b][m].classList.add("highlight-left"),obj.records[b][_].classList.add("highlight-right"),obj.rows[b].classList.add("selected"));obj.selectedContainer=[m,T,_,M]}f==0&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,m,T,_,M,s),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var e=0;e<obj.selection.length;e++)obj.selection[e].classList.remove("selection"),obj.selection[e].classList.remove("selection-left"),obj.selection[e].classList.remove("selection-right"),obj.selection[e].classList.remove("selection-top"),obj.selection[e].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(e,o){obj.removeCopySelection();var t=obj.selectedContainer[0],r=obj.selectedContainer[1],s=obj.selectedContainer[2],f=obj.selectedContainer[3];if(e!=null&&o!=null){if(e-s>0)var h=parseInt(s)+1,g=parseInt(e);else var h=parseInt(e),g=parseInt(t)-1;if(o-f>0)var u=parseInt(f)+1,d=parseInt(o);else var u=parseInt(o),d=parseInt(r)-1;if(g-h<=d-u)var h=parseInt(t),g=parseInt(s);else var u=parseInt(r),d=parseInt(f);for(var a=u;a<=d;a++)for(var b=h;b<=g;b++)obj.records[a][b]&&obj.rows[a].style.display!="none"&&obj.records[a][b].style.display!="none"&&(obj.records[a][b].classList.add("selection"),obj.records[u][b].classList.add("selection-top"),obj.records[d][b].classList.add("selection-bottom"),obj.records[a][h].classList.add("selection-left"),obj.records[a][g].classList.add("selection-right"),obj.selection.push(obj.records[a][b]))}},obj.updateCornerPosition=function(){if(!obj.highlighted.length)obj.corner.style.top="-2000px",obj.corner.style.left="-2000px";else{var e=obj.highlighted[obj.highlighted.length-1],o=e.getAttribute("data-x"),t=obj.content.getBoundingClientRect(),r=t.left,s=t.top,f=e.getBoundingClientRect(),h=f.left,g=f.top,u=f.width,d=f.height,a=h-r+obj.content.scrollLeft+u-4,b=g-s+obj.content.scrollTop+d-4;if(obj.corner.style.top=b+"px",obj.corner.style.left=a+"px",obj.options.freezeColumns){var v=obj.getFreezeWidth();o>obj.options.freezeColumns-1&&h-r+u<v?obj.corner.style.display="none":obj.options.selectionCopy==!0&&(obj.corner.style.display="")}else obj.options.selectionCopy==!0&&(obj.corner.style.display="")}},obj.updateScroll=function(e){var o=obj.content.getBoundingClientRect(),t=o.left,r=o.top,s=o.width,f=o.height,h=obj.records[obj.selectedCell[3]][obj.selectedCell[2]],g=h.getBoundingClientRect(),u=g.left,d=g.top,a=g.width,b=g.height;if(e==0||e==1)var v=u-t+obj.content.scrollLeft,w=d-r+obj.content.scrollTop-2;else var v=u-t+obj.content.scrollLeft+a,w=d-r+obj.content.scrollTop+b;w>obj.content.scrollTop+30&&w<obj.content.scrollTop+f||(w<obj.content.scrollTop+30?obj.content.scrollTop=w-b:obj.content.scrollTop=w-(f-2));var S=obj.getFreezeWidth();v>obj.content.scrollLeft+S&&v<obj.content.scrollLeft+s||(v<obj.content.scrollLeft+30?(obj.content.scrollLeft=v,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):v<obj.content.scrollLeft+S?obj.content.scrollLeft=v-S-1:obj.content.scrollLeft=v-(s-20))},obj.getWidth=function(e){if(e)typeof e=="object"&&(e=$(e).getAttribute("data-x")),o=obj.colgroup[e].getAttribute("width");else for(var o=[],t=0;t<obj.headers.length;t++)o.push(obj.options.columns[t].width);return o},obj.setWidth=function(e,o,t){if(o){if(Array.isArray(e)){if(!t)var t=[];for(var r=0;r<e.length;r++){t[r]||(t[r]=obj.colgroup[e[r]].getAttribute("width"));var s=Array.isArray(o)&&o[r]?o[r]:o;obj.colgroup[e[r]].setAttribute("width",s),obj.options.columns[e[r]].width=s}}else t||(t=obj.colgroup[e].getAttribute("width")),obj.colgroup[e].setAttribute("width",o),obj.options.columns[e].width=o;obj.setHistory({action:"setWidth",column:e,oldValue:t,newValue:o}),obj.dispatch("onresizecolumn",el,e,o,t),obj.updateCornerPosition()}},obj.setHeight=function(e,o,t){if(o>0){if(typeof e=="object"&&(e=e.getAttribute("data-y")),!t&&(t=obj.rows[e].getAttribute("height"),!t)){var r=obj.rows[e].getBoundingClientRect();t=r.height}o=parseInt(o),obj.rows[e].style.height=o+"px",obj.options.rows[e]||(obj.options.rows[e]={}),obj.options.rows[e].height=o,obj.setHistory({action:"setHeight",row:e,oldValue:t,newValue:o}),obj.dispatch("onresizerow",el,e,o,t),obj.updateCornerPosition()}},obj.getHeight=function(e){if(e){typeof e=="object"&&(e=$(e).getAttribute("data-y"));var o=obj.rows[e].style.height}else for(var o=[],t=0;t<obj.rows.length;t++){var r=obj.rows[t].style.height;r&&(o[t]=r)}return o},obj.setFooter=function(e){if(e&&(obj.options.footers=e),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var o=0;o<obj.options.footers.length;o++){if(obj.tfoot.children[o])var t=obj.tfoot.children[o];else{var t=document.createElement("tr"),r=document.createElement("td");t.appendChild(r),obj.tfoot.appendChild(t)}for(var s=0;s<obj.headers.length;s++){if(obj.options.footers[o][s]||(obj.options.footers[o][s]=""),obj.tfoot.children[o].children[s+1])var r=obj.tfoot.children[o].children[s+1];else{var r=document.createElement("td");t.appendChild(r);var f=obj.options.columns[s].align?obj.options.columns[s].align:"center";r.style.textAlign=f}r.innerText=obj.parseValue(+obj.records.length+s,o,obj.options.footers[o][s])}}}},obj.getHeader=function(e){return obj.headers[e].innerText},obj.setHeader=function(e,o){if(obj.headers[e]){var t=obj.headers[e].innerText;o||(o=prompt(obj.options.text.columnName,t)),o&&(obj.headers[e].innerText=o,obj.headers[e].setAttribute("title",o),obj.options.columns[e].title=o),obj.setHistory({action:"setHeader",column:e,oldValue:t,newValue:o}),obj.dispatch("onchangeheader",el,e,t,o)}},obj.getHeaders=function(e){for(var o=[],t=0;t<obj.headers.length;t++)o.push(obj.getHeader(t));return e?o:o.join(obj.options.csvDelimiter)},obj.getMeta=function(e,o){return e?o?obj.options.meta[e]&&obj.options.meta[e][o]?obj.options.meta[e][o]:null:obj.options.meta[e]?obj.options.meta[e]:null:obj.options.meta},obj.setMeta=function(e,o,t){if(obj.options.meta||(obj.options.meta={}),o&&t)obj.options.meta[e]||(obj.options.meta[e]={}),obj.options.meta[e][o]=t;else for(var r=Object.keys(e),s=0;s<r.length;s++){obj.options.meta[r[s]]||(obj.options.meta[r[s]]={});for(var f=Object.keys(e[r[s]]),h=0;h<f.length;h++)obj.options.meta[r[s]][f[h]]=e[r[s]][f[h]]}obj.dispatch("onchangemeta",el,e,o,t)},obj.updateMeta=function(e){if(obj.options.meta){for(var o={},t=Object.keys(obj.options.meta),r=0;r<t.length;r++)e[t[r]]?o[e[t[r]]]=obj.options.meta[t[r]]:o[t[r]]=obj.options.meta[t[r]];obj.options.meta=o}},obj.getStyle=function(e,o){if(e)return e=jexcel.getIdFromColumnName(e,!0),o?obj.records[e[1]][e[0]].style[o]:obj.records[e[1]][e[0]].getAttribute("style");for(var t={},r=obj.options.data[0].length,s=obj.options.data.length,f=0;f<s;f++)for(var h=0;h<r;h++){var g=o?obj.records[f][h].style[o]:obj.records[f][h].getAttribute("style");if(g){var u=jexcel.getColumnNameFromId([h,f]);t[u]=g}}return t},obj.resetStyle=function(e,o){for(var t=Object.keys(e),r=0;r<t.length;r++){var s=jexcel.getIdFromColumnName(t[r],!0);obj.records[s[1]]&&obj.records[s[1]][s[0]]&&obj.records[s[1]][s[0]].setAttribute("style","")}obj.setStyle(e,null,null,null,o)},obj.setStyle=function(e,o,t,r,s){var f={},h={},g=function(m,_,T){var M=jexcel.getIdFromColumnName(m,!0);if(obj.records[M[1]]&&obj.records[M[1]][M[0]]&&(obj.records[M[1]][M[0]].classList.contains("readonly")==!1||r)){var P=obj.records[M[1]][M[0]].style[_];P==T&&!r?(T="",obj.records[M[1]][M[0]].style[_]=""):obj.records[M[1]][M[0]].style[_]=T,h[m]||(h[m]=[]),f[m]||(f[m]=[]),h[m].push([_+":"+P]),f[m].push([_+":"+T])}};if(o&&t)if(typeof e=="string")g(e,o,t);else for(var u=[],d=0;d<e.length;d++){var a=e[d].getAttribute("data-x"),b=e[d].getAttribute("data-y"),v=jexcel.getColumnNameFromId([a,b]);u[v]||(g(v,o,t),u[v]=!0)}else for(var E=Object.keys(e),d=0;d<E.length;d++){var w=e[E[d]];typeof w=="string"&&(w=w.split(";"));for(var S=0;S<w.length;S++)typeof w[S]=="string"&&(w[S]=w[S].split(":")),w[S][0].trim()&&g(E[d],w[S][0].trim(),w[S][1])}for(var E=Object.keys(h),d=0;d<E.length;d++)h[E[d]]=h[E[d]].join(";");for(var E=Object.keys(f),d=0;d<E.length;d++)f[E[d]]=f[E[d]].join(";");s||obj.setHistory({action:"setStyle",oldValue:h,newValue:f}),obj.dispatch("onchangestyle",el,e,o,t)},obj.getComments=function(e,o){if(e){if(typeof e=="string")var e=jexcel.getIdFromColumnName(e,!0);return o?[obj.records[e[1]][e[0]].getAttribute("title"),obj.records[e[1]][e[0]].getAttribute("author")]:obj.records[e[1]][e[0]].getAttribute("title")||""}else{for(var t={},r=0;r<obj.options.data.length;r++)for(var s=0;s<obj.options.columns.length;s++){var f=obj.records[r][s].getAttribute("title");if(f){var e=jexcel.getColumnNameFromId([s,r]);t[e]=f}}return t}},obj.setComments=function(e,o,f){if(typeof e=="string")var r=jexcel.getIdFromColumnName(e,!0);else var r=e;var s=obj.records[r[1]][r[0]].getAttribute("title"),f=obj.records[r[1]][r[0]].getAttribute("data-author"),h=[s,f];obj.records[r[1]][r[0]].setAttribute("title",o||""),obj.records[r[1]][r[0]].setAttribute("data-author",f||""),o?obj.records[r[1]][r[0]].classList.add("jexcel_comments"):obj.records[r[1]][r[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:e,newValue:[o,f],oldValue:h}),obj.dispatch("oncomments",el,o,s,r,r[0],r[1])},obj.getConfig=function(){var e=obj.options;return e.style=obj.getStyle(),e.mergeCells=obj.getMerge(),e.comments=obj.getComments(),e},obj.orderBy=function(e,o){if(e>=0){if(Object.keys(obj.options.mergeCells).length>0)if(confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))obj.destroyMerged();else return!1;o==null?o=obj.headers[e].classList.contains("arrow-down")?1:0:o=o?1:0;var t=[];if(obj.options.columns[e].type=="number"||obj.options.columns[e].type=="percentage"||obj.options.columns[e].type=="autonumber"||obj.options.columns[e].type=="color")for(var r=0;r<obj.options.data.length;r++)t[r]=[r,Number(obj.options.data[r][e])];else if(obj.options.columns[e].type=="calendar"||obj.options.columns[e].type=="checkbox"||obj.options.columns[e].type=="radio")for(var r=0;r<obj.options.data.length;r++)t[r]=[r,obj.options.data[r][e]];else for(var r=0;r<obj.options.data.length;r++)t[r]=[r,obj.records[r][e].innerText.toLowerCase()];typeof obj.options.sorting!="function"&&(obj.options.sorting=function(f){return function(h,g){var u=h[1],d=g[1];return f?u===""&&d!==""?1:u!==""&&d===""||u>d?-1:u<d?1:0:u===""&&d!==""?1:u!==""&&d===""?-1:u>d?1:u<d?-1:0}}),t=t.sort(obj.options.sorting(o));for(var s=[],r=0;r<t.length;r++)s[r]=t[r][0];return obj.setHistory({action:"orderBy",rows:s,column:e,order:o}),obj.updateOrderArrow(e,o),obj.updateOrder(s),obj.dispatch("onsort",el,e,o),!0}},obj.updateOrderArrow=function(e,o){for(var t=0;t<obj.headers.length;t++)obj.headers[t].classList.remove("arrow-up"),obj.headers[t].classList.remove("arrow-down");o?obj.headers[e].classList.add("arrow-up"):obj.headers[e].classList.add("arrow-down")},obj.updateOrder=function(e){for(var t=[],o=0;o<e.length;o++)t[o]=obj.options.data[e[o]];obj.options.data=t;for(var t=[],o=0;o<e.length;o++)t[o]=obj.records[e[o]];obj.records=t;for(var t=[],o=0;o<e.length;o++)t[o]=obj.rows[e[o]];if(obj.rows=t,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(obj.options.lazyLoading==!0)obj.loadPage(0);else for(var o=0;o<obj.rows.length;o++)obj.tbody.appendChild(obj.rows[o])},obj.moveRow=function(e,o,t){if(Object.keys(obj.options.mergeCells).length>0){if(e>o)var r=1;else var r=0;if(obj.isRowMerged(e).length||obj.isRowMerged(o,r).length)if(confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))obj.destroyMerged();else return!1}if(obj.options.search==!0){if(obj.results&&obj.results.length!=obj.rows.length)if(confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))obj.resetSearch();else return!1;obj.results=null}t||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[o])>=0?e>o?obj.tbody.insertBefore(obj.rows[e],obj.rows[o]):obj.tbody.insertBefore(obj.rows[e],obj.rows[o].nextSibling):obj.tbody.removeChild(obj.rows[e])),obj.rows.splice(o,0,obj.rows.splice(e,1)[0]),obj.records.splice(o,0,obj.records.splice(e,1)[0]),obj.options.data.splice(o,0,obj.options.data.splice(e,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:e,newValue:o}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,e,o)},obj.insertRow=function(e,o,t){if(obj.options.allowInsertRow==!0){var r=[];if(e>0)var s=e;else{var s=1;e&&(r=e)}var t=!!t,f=obj.options.data.length-1;if((o==null||o>=parseInt(f)||o<0)&&(o=f),obj.dispatch("onbeforeinsertrow",el,o,s,t)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(o,t).length)if(confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))obj.destroyMerged();else return!1;if(obj.options.search==!0){if(obj.results&&obj.results.length!=obj.rows.length)if(confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))obj.resetSearch();else return!1;obj.results=null}for(var h=t?o:o+1,g=obj.records.splice(h),u=obj.options.data.splice(h),d=obj.rows.splice(h),a=[],b=[],v=[],w=h;w<s+h;w++){obj.options.data[w]=[];for(var S=0;S<obj.options.columns.length;S++)obj.options.data[w][S]=r[S]?r[S]:"";var E=obj.createRow(w,obj.options.data[w]);d[0]?Array.prototype.indexOf.call(obj.tbody.children,d[0])>=0&&obj.tbody.insertBefore(E,d[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[o])>=0&&obj.tbody.appendChild(E),a.push(obj.records[w]),b.push(obj.options.data[w]),v.push(E)}Array.prototype.push.apply(obj.records,g),Array.prototype.push.apply(obj.options.data,u),Array.prototype.push.apply(obj.rows,d),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:o,numOfRows:s,insertBefore:t,rowRecords:a,rowData:b,rowNode:v}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,o,s,a,t)}},obj.deleteRow=function(e,o){if(obj.options.allowDeleteRow==!0)if(obj.options.allowDeletingAllRows==!0||obj.options.data.length>1){if(e==null){var t=obj.getSelectedRows();t[0]?(e=parseInt(t[0].getAttribute("data-y")),o=t.length):(e=obj.options.data.length-1,o=1)}var r=obj.options.data.length-1;if((e==null||e>r||e<0)&&(e=r),o||(o=1),e+o>=obj.options.data.length&&(o=obj.options.data.length-e),obj.dispatch("onbeforedeleterow",el,e,o)===!1)return!1;if(parseInt(e)>-1){var s=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var f=e;f<e+o;f++)obj.isRowMerged(f,!1).length&&(s=!0);if(s)if(confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))obj.destroyMerged();else return!1;if(obj.options.search==!0){if(obj.results&&obj.results.length!=obj.rows.length)if(confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))obj.resetSearch();else return!1;obj.results=null}obj.options.allowDeletingAllRows==!1&&r+1===o&&(o--,console.error("Jspreadsheet: It is not possible to delete the last row"));for(var f=e;f<e+o;f++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[f])>=0&&(obj.rows[f].className="",obj.rows[f].parentNode.removeChild(obj.rows[f]));var h=obj.records.splice(e,o),g=obj.options.data.splice(e,o),u=obj.rows.splice(e,o);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,e,e+o-1),obj.setHistory({action:"deleteRow",rowNumber:e,numOfRows:o,insertBefore:1,rowRecords:h,rowData:g,rowNode:u}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,e,o,h)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(r,s){if(Object.keys(obj.options.mergeCells).length>0){if(r>s)var t=1;else var t=0;if(obj.isColMerged(r).length||obj.isColMerged(s,t).length)if(confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))obj.destroyMerged();else return!1}var r=parseInt(r),s=parseInt(s);if(r>s){obj.headerContainer.insertBefore(obj.headers[r],obj.headers[s]),obj.colgroupContainer.insertBefore(obj.colgroup[r],obj.colgroup[s]);for(var f=0;f<obj.rows.length;f++)obj.rows[f].insertBefore(obj.records[f][r],obj.records[f][s])}else{obj.headerContainer.insertBefore(obj.headers[r],obj.headers[s].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[r],obj.colgroup[s].nextSibling);for(var f=0;f<obj.rows.length;f++)obj.rows[f].insertBefore(obj.records[f][r],obj.records[f][s].nextSibling)}obj.options.columns.splice(s,0,obj.options.columns.splice(r,1)[0]),obj.headers.splice(s,0,obj.headers.splice(r,1)[0]),obj.colgroup.splice(s,0,obj.colgroup.splice(r,1)[0]);for(var f=0;f<obj.rows.length;f++)obj.options.data[f].splice(s,0,obj.options.data[f].splice(r,1)[0]),obj.records[f].splice(s,0,obj.records[f].splice(r,1)[0]);if(obj.options.footers)for(var f=0;f<obj.options.footers.length;f++)obj.options.footers[f].splice(s,0,obj.options.footers[f].splice(r,1)[0]);obj.setHistory({action:"moveColumn",oldValue:r,newValue:s}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,r,s)},obj.insertColumn=function(e,o,t,r){if(obj.options.allowInsertColumn==!0){var s=[];if(e>0)var f=e;else{var f=1;e&&(s=e)}var t=!!t,h=obj.options.columns.length-1;if((o==null||o>=parseInt(h)||o<0)&&(o=h),obj.dispatch("onbeforeinsertcolumn",el,o,f,t)===!1)return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(o,t).length)if(confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))obj.destroyMerged();else return!1;r||(r=[]);for(var g=0;g<f;g++)r[g]||(r[g]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var u=t?o:o+1;obj.options.columns=jexcel.injectArray(obj.options.columns,u,r);for(var d=obj.headers.splice(u),a=obj.colgroup.splice(u),b=[],v=[],w=[],S=[],E=[],m=u;m<f+u;m++)obj.createCellHeader(m),obj.headerContainer.insertBefore(obj.headers[m],obj.headerContainer.children[m+1]),obj.colgroupContainer.insertBefore(obj.colgroup[m],obj.colgroupContainer.children[m+1]),b.push(obj.headers[m]),v.push(obj.colgroup[m]);if(obj.options.footers)for(var _=0;_<obj.options.footers.length;_++){E[_]=[];for(var g=0;g<f;g++)E[_].push("");obj.options.footers[_].splice(u,0,E[_])}for(var T=0;T<obj.options.data.length;T++){var M=obj.options.data[T].splice(u),P=obj.records[T].splice(u);S[T]=[],w[T]=[];for(var m=u;m<f+u;m++){var B=s[T]?s[T]:"";obj.options.data[T][m]=B;var D=obj.createCell(m,T,obj.options.data[T][m]);obj.records[T][m]=D,obj.rows[T]&&obj.rows[T].insertBefore(D,obj.rows[T].children[m+1]),S[T].push(B),w[T].push(D)}Array.prototype.push.apply(obj.options.data[T],M),Array.prototype.push.apply(obj.records[T],P)}if(Array.prototype.push.apply(obj.headers,d),Array.prototype.push.apply(obj.colgroup,a),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var _=0;_<obj.options.nestedHeaders.length;_++){var L=parseInt(obj.options.nestedHeaders[_][obj.options.nestedHeaders[_].length-1].colspan)+f;obj.options.nestedHeaders[_][obj.options.nestedHeaders[_].length-1].colspan=L,obj.thead.children[_].children[obj.thead.children[_].children.length-1].setAttribute("colspan",L);var X=obj.thead.children[_].children[obj.thead.children[_].children.length-1].getAttribute("data-column");X=X.split(",");for(var m=u;m<f+u;m++)X.push(m);obj.thead.children[_].children[obj.thead.children[_].children.length-1].setAttribute("data-column",X)}else{var L=parseInt(obj.options.nestedHeaders[0].colspan)+f;obj.options.nestedHeaders[0].colspan=L,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",L)}obj.setHistory({action:"insertColumn",columnNumber:o,numOfColumns:f,insertBefore:t,columns:r,headers:b,colgroup:v,records:w,footers:E,data:S}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,o,f,w,t)}},obj.deleteColumn=function(e,o){if(obj.options.allowDeleteColumn==!0)if(obj.headers.length>1){if(e==null){var t=obj.getSelectedColumns(!0);t.length?(e=parseInt(t[0]),o=parseInt(t.length)):(e=obj.headers.length-1,o=1)}var r=obj.options.data[0].length-1;if((e==null||e>r||e<0)&&(e=r),o||(o=1),o>obj.options.data[0].length-e&&(o=obj.options.data[0].length-e),obj.dispatch("onbeforedeletecolumn",el,e,o)===!1)return!1;if(parseInt(e)>-1){var s=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var f=e;f<e+o;f++)obj.isColMerged(f,!1).length&&(s=!0);if(s)if(confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))obj.destroyMerged();else return!1;for(var h=obj.options.columns.splice(e,o),f=e;f<e+o;f++)obj.colgroup[f].className="",obj.headers[f].className="",obj.colgroup[f].parentNode.removeChild(obj.colgroup[f]),obj.headers[f].parentNode.removeChild(obj.headers[f]);for(var g=obj.headers.splice(e,o),u=obj.colgroup.splice(e,o),d=[],a=[],b=[],v=0;v<obj.options.data.length;v++)for(var f=e;f<e+o;f++)obj.records[v][f].className="",obj.records[v][f].parentNode.removeChild(obj.records[v][f]);for(var v=0;v<obj.options.data.length;v++)a[v]=obj.options.data[v].splice(e,o),d[v]=obj.records[v].splice(e,o);if(obj.options.footers)for(var v=0;v<obj.options.footers.length;v++)b[v]=obj.options.footers[v].splice(e,o);if(obj.conditionalSelectionUpdate(0,e,e+o-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var w=0;w<obj.options.nestedHeaders.length;w++){var S=parseInt(obj.options.nestedHeaders[w][obj.options.nestedHeaders[w].length-1].colspan)-o;obj.options.nestedHeaders[w][obj.options.nestedHeaders[w].length-1].colspan=S,obj.thead.children[w].children[obj.thead.children[w].children.length-1].setAttribute("colspan",S)}else{var S=parseInt(obj.options.nestedHeaders[0].colspan)-o;obj.options.nestedHeaders[0].colspan=S,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",S)}obj.setHistory({action:"deleteColumn",columnNumber:e,numOfColumns:o,insertBefore:1,columns:h,headers:g,colgroup:u,records:d,footers:b,data:a}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,e,o,d)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(e){for(var o=[],t=0;t<obj.rows.length;t++)obj.rows[t].classList.contains("selected")&&(e?o.push(t):o.push(obj.rows[t]));return o},obj.getSelectedColumns=function(){for(var e=[],o=0;o<obj.headers.length;o++)obj.headers[o].classList.contains("selected")&&e.push(o);return e},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var e=0;e<obj.headers.length;e++){var o=obj.headers[e].getAttribute("data-x");o!=e&&(obj.headers[e].setAttribute("data-x",e),obj.headers[e].getAttribute("title")||(obj.headers[e].innerHTML=jexcel.getColumnName(e)))}for(var t=0;t<obj.rows.length;t++)if(obj.rows[t]){var r=obj.rows[t].getAttribute("data-y");r!=t&&(obj.rows[t].setAttribute("data-y",t),obj.rows[t].children[0].setAttribute("data-y",t),obj.rows[t].children[0].innerHTML=t+1)}for(var s=[],f=[],h=function(w,S,E,m){if(w!=E&&obj.records[m][E].setAttribute("data-x",E),S!=m&&obj.records[m][E].setAttribute("data-y",m),w!=E||S!=m){var _=jexcel.getColumnNameFromId([w,S]),T=jexcel.getColumnNameFromId([E,m]);s[_]=T}},t=0;t<obj.records.length;t++)for(var e=0;e<obj.records[0].length;e++)if(obj.records[t][e]){var o=obj.records[t][e].getAttribute("data-x"),r=obj.records[t][e].getAttribute("data-y");if(obj.records[t][e].getAttribute("data-merged")){var g=jexcel.getColumnNameFromId([o,r]),u=jexcel.getColumnNameFromId([e,t]);if(f[g]==null)if(g==u)f[g]=!1;else{var d=parseInt(e-o),a=parseInt(t-r);f[g]=[u,d,a]}}else h(o,r,e,t)}var b=Object.keys(f);if(b.length){for(var e=0;e<b.length;e++)if(f[b[e]]){var v=jexcel.getIdFromColumnName(b[e],!0),o=v[0],r=v[1];h(o,r,o+f[b[e]][1],r+f[b[e]][2]);for(var g=b[e],u=f[b[e]][0],t=0;t<obj.options.mergeCells[g][2].length;t++){var o=parseInt(obj.options.mergeCells[g][2][t].getAttribute("data-x")),r=parseInt(obj.options.mergeCells[g][2][t].getAttribute("data-y"));obj.options.mergeCells[g][2][t].setAttribute("data-x",o+f[b[e]][1]),obj.options.mergeCells[g][2][t].setAttribute("data-y",r+f[b[e]][2])}obj.options.mergeCells[u]=obj.options.mergeCells[g],delete obj.options.mergeCells[g]}}obj.updateFormulas(s),obj.updateMeta(s),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var e=0,o=obj.rows.length-1;o>=0;o--){for(var t=!1,r=0;r<obj.headers.length;r++)obj.options.data[o][r]&&(t=!0);if(t)break;e++}obj.options.minSpareRows-e>0&&obj.insertRow(obj.options.minSpareRows-e)}if(obj.options.minSpareCols>0){for(var s=0,r=obj.headers.length-1;r>=0;r--){for(var t=!1,o=0;o<obj.rows.length;o++)obj.options.data[o][r]&&(t=!0);if(t)break;s++}obj.options.minSpareCols-s>0&&obj.insertColumn(obj.options.minSpareCols-s)}if(typeof obj.options.updateTable=="function"){obj.options.detachForUpdates&&el.removeChild(obj.content);for(var o=0;o<obj.rows.length;o++)for(var r=0;r<obj.headers.length;r++)obj.options.updateTable(el,obj.records[o][r],r,o,obj.options.data[o][r],obj.records[o][r].innerText,jexcel.getColumnNameFromId([r,o]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(e){if(e=obj.getCell(e))return!!e.classList.contains("readonly")},obj.setReadOnly=function(e,o){(e=obj.getCell(e))&&(o?e.classList.add("readonly"):e.classList.remove("readonly"))},obj.showRow=function(e){obj.rows[e].style.display=""},obj.hideRow=function(e){obj.rows[e].style.display="none"},obj.showColumn=function(e){obj.headers[e].style.display="",obj.colgroup[e].style.display="",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="");for(var o=0;o<obj.options.data.length;o++)obj.records[o][e].style.display="";obj.resetSelection()},obj.hideColumn=function(e){obj.headers[e].style.display="none",obj.colgroup[e].style.display="none",obj.filter&&obj.filter.children.length>e+1&&(obj.filter.children[e+1].style.display="none");for(var o=0;o<obj.options.data.length;o++)obj.records[o][e].style.display="none";obj.resetSelection()},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(e,o,t){var r=jexcel.getColumnNameFromId([e,o]);if(obj.formula[r]&&obj.formula[r].length>0)if(chainLoopProtection[r])obj.records[o][e].innerHTML="#ERROR",obj.formula[r]="";else{chainLoopProtection[r]=!0;for(var s=0;s<obj.formula[r].length;s++){var f=jexcel.getIdFromColumnName(obj.formula[r][s],!0),h=""+obj.options.data[f[1]][f[0]];h.substr(0,1)=="="?t.push(obj.updateCell(f[0],f[1],h,!0)):Object.keys(obj.formula)[s]=null,obj.updateFormulaChain(f[0],f[1],t)}}chainLoopProtection=[]},obj.updateFormulas=function(e){for(var o=0;o<obj.options.data.length;o++)for(var t=0;t<obj.options.data[0].length;t++){var r=""+obj.options.data[o][t];if(r.substr(0,1)=="="){var s=obj.updateFormula(r,e);s!=r&&(obj.options.data[o][t]=s)}}for(var f=[],h=Object.keys(obj.formula),o=0;o<h.length;o++){var g=h[o],r=obj.formula[g];e[g]&&(g=e[g]),f[g]=[];for(var t=0;t<r.length;t++){var u=r[t];e[u]&&(u=e[u]),f[g].push(u)}}obj.formula=f},obj.updateFormula=function(e,o){for(var t=/[A-Z]/,r=/[0-9]/,s="",f=null,h=null,g="",u=0;u<e.length;u++)t.exec(e[u])?(f=1,h=0,g+=e[u]):r.exec(e[u])?(h=f?1:0,g+=e[u]):(f&&h&&(g=o[g]?o[g]:g),s+=g,s+=e[u],f=0,h=0,g="");return g&&(f&&h&&(g=o[g]?o[g]:g),s+=g),s};var secureFormula=function(e){for(var o="",t=0,r=0;r<e.length;r++)e[r]=='"'&&(t==0?t=1:t=0),t==1?o+=e[r]:o+=e[r].toUpperCase();return o};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(e){for(var o=0;o<e.length;o++){var t=[],r=e[o].split(":"),s=jexcel.getIdFromColumnName(r[0],!0),f=jexcel.getIdFromColumnName(r[1],!0);if(s[0]<=f[0])var h=s[0],g=f[0];else var h=f[0],g=s[0];if(s[1]<=f[1])var u=s[1],d=f[1];else var u=f[1],d=s[1];for(var a=u;a<=d;a++)for(var b=h;b<=g;b++)t.push(jexcel.getColumnNameFromId([b,a]));expression=expression.replace(e[o],t.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens){for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(typeof obj.options.data[position[1]]!="undefined"&&typeof obj.options.data[position[1]][position[0]]!="undefined")var value=obj.options.data[position[1]][position[0]];else var value="";if((""+value).substr(0,1)=="="&&(formulaResults[tokens[i]]?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),(""+value).trim()=="")formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&obj.options.autoCasting==!0)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);obj.options.autoCasting==!0&&number?formulaExpressions[tokens[i]]=number:formulaExpressions[tokens[i]]='"'+value+'"'}}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(e){var res="#ERROR";console.log(e)}return res};return execute(expression,x,y)},obj.parseNumber=function(e,o){var t=o&&obj.options.columns[o].decimal?obj.options.columns[o].decimal:".",r=""+e;if(r=r.split(t),r[0]=r[0].match(/[+-]?[0-9]/g),r[0]&&(r[0]=r[0].join("")),r[1]&&(r[1]=r[1].match(/[0-9]*/g).join("")),r[0]&&Number(r[0])>=0)if(r[1])var e=Number(r[0]+"."+r[1]);else var e=Number(r[0]+".00");else var e=null;return e},obj.row=function(e){},obj.col=function(e){},obj.up=function(e,o){if(e?obj.selectedCell[3]>0&&obj.up.visible(1,o?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,o?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==!0)if(obj.selectedCell[1]==0||obj.selectedCell[3]==0)obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var t=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-t<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var r=obj.whichPage(obj.selectedCell[3]);r!=obj.pageNumber&&obj.page(r)}obj.updateScroll(1)},obj.up.visible=function(e,o){if(e==0)var t=parseInt(obj.selectedCell[0]),r=parseInt(obj.selectedCell[1]);else var t=parseInt(obj.selectedCell[2]),r=parseInt(obj.selectedCell[3]);if(o==0){for(var s=0;s<r;s++)if(obj.records[s][t].style.display!="none"&&obj.rows[s].style.display!="none"){r=s;break}}else r=obj.up.get(t,r);e==0?(obj.selectedCell[0]=t,obj.selectedCell[1]=r):(obj.selectedCell[2]=t,obj.selectedCell[3]=r)},obj.up.get=function(t,r){for(var t=parseInt(t),r=parseInt(r),s=r-1;s>=0;s--)if(obj.records[s][t].style.display!="none"&&obj.rows[s].style.display!="none"){if(obj.records[s][t].getAttribute("data-merged")&&obj.records[s][t]==obj.records[r][t])continue;r=s;break}return r},obj.down=function(e,o){if(e?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,o?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,o?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.options.lazyLoading==!0)if(obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1)obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var t=parseInt(obj.tbody.lastChild.getAttribute("data-y"));t-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var r=obj.whichPage(obj.selectedCell[3]);r!=obj.pageNumber&&obj.page(r)}obj.updateScroll(3)},obj.down.visible=function(e,o){if(e==0)var t=parseInt(obj.selectedCell[0]),r=parseInt(obj.selectedCell[1]);else var t=parseInt(obj.selectedCell[2]),r=parseInt(obj.selectedCell[3]);if(o==0){for(var s=obj.rows.length-1;s>r;s--)if(obj.records[s][t].style.display!="none"&&obj.rows[s].style.display!="none"){r=s;break}}else r=obj.down.get(t,r);e==0?(obj.selectedCell[0]=t,obj.selectedCell[1]=r):(obj.selectedCell[2]=t,obj.selectedCell[3]=r)},obj.down.get=function(t,r){for(var t=parseInt(t),r=parseInt(r),s=r+1;s<obj.rows.length;s++)if(obj.records[s][t].style.display!="none"&&obj.rows[s].style.display!="none"){if(obj.records[s][t].getAttribute("data-merged")&&obj.records[s][t]==obj.records[r][t])continue;r=s;break}return r},obj.right=function(e,o){e?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,o?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,o?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(e,o){if(e==0)var t=parseInt(obj.selectedCell[0]),r=parseInt(obj.selectedCell[1]);else var t=parseInt(obj.selectedCell[2]),r=parseInt(obj.selectedCell[3]);if(o==0){for(var s=obj.headers.length-1;s>t;s--)if(obj.records[r][s].style.display!="none"){t=s;break}}else t=obj.right.get(t,r);e==0?(obj.selectedCell[0]=t,obj.selectedCell[1]=r):(obj.selectedCell[2]=t,obj.selectedCell[3]=r)},obj.right.get=function(t,r){for(var t=parseInt(t),r=parseInt(r),s=t+1;s<obj.headers.length;s++)if(obj.records[r][s].style.display!="none"){if(obj.records[r][s].getAttribute("data-merged")&&obj.records[r][s]==obj.records[r][t])continue;t=s;break}return t},obj.left=function(e,o){e?obj.selectedCell[2]>0&&obj.left.visible(1,o?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,o?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(e,o){if(e==0)var t=parseInt(obj.selectedCell[0]),r=parseInt(obj.selectedCell[1]);else var t=parseInt(obj.selectedCell[2]),r=parseInt(obj.selectedCell[3]);if(o==0){for(var s=0;s<t;s++)if(obj.records[r][s].style.display!="none"){t=s;break}}else t=obj.left.get(t,r);e==0?(obj.selectedCell[0]=t,obj.selectedCell[1]=r):(obj.selectedCell[2]=t,obj.selectedCell[3]=r)},obj.left.get=function(t,r){for(var t=parseInt(t),r=parseInt(r),s=t-1;s>=0;s--)if(obj.records[r][s].style.display!="none"){if(obj.records[r][s].getAttribute("data-merged")&&obj.records[r][s]==obj.records[r][t])continue;t=s;break}return t},obj.first=function(e,o){if(e?o?obj.selectedCell[3]=0:obj.left.visible(1,0):(o?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading==!0&&(obj.selectedCell[1]==0||obj.selectedCell[3]==0))obj.loadPage(0);else if(obj.options.pagination>0){var t=obj.whichPage(obj.selectedCell[3]);t!=obj.pageNumber&&obj.page(t)}obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(e,o){if(e?o?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(o?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.options.lazyLoading==!0&&(obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1))obj.loadPage(-1);else if(obj.options.pagination>0){var t=obj.whichPage(obj.selectedCell[3]);t!=obj.pageNumber&&obj.page(t)}obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(e){if(obj.options.search==!0&&obj.results)var o=obj.results;else var o=obj.rows;var t=100;(e==null||e==-1)&&(e=Math.ceil(o.length/t)-1);var r=e*t,s=e*t+t;s>o.length&&(s=o.length),r=s-100,r<0&&(r=0);for(var f=r;f<s;f++)obj.options.search==!0&&obj.results?obj.tbody.appendChild(obj.rows[o[f]]):obj.tbody.appendChild(obj.rows[f]),obj.tbody.children.length>t&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(obj.options.search==!0&&obj.results)var e=obj.results;else var e=obj.rows;var o=0;if(e.length>100){var t=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(obj.options.search==!0&&obj.results&&(t=e.indexOf(t)),t>0)for(var r=0;r<30;r++)t=t-1,t>-1&&(obj.options.search==!0&&obj.results?obj.tbody.insertBefore(obj.rows[e[t]],obj.tbody.firstChild):obj.tbody.insertBefore(obj.rows[t],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),o=1))}return o},obj.loadDown=function(){if(obj.options.search==!0&&obj.results)var e=obj.results;else var e=obj.rows;var o=0;if(e.length>100){var t=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(obj.options.search==!0&&obj.results&&(t=e.indexOf(t)),t<obj.rows.length-1)for(var r=0;r<=30;r++)t<e.length&&(obj.options.search==!0&&obj.results?obj.tbody.appendChild(obj.rows[e[t]]):obj.tbody.appendChild(obj.rows[t]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),o=1)),t=t+1}return o},obj.loadValidation=function(){if(obj.selectedCell){var e=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,o=parseInt(obj.selectedCell[3]/100),t=parseInt(obj.rows.length/100);if(e!=o&&o<=t&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(o),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(e){if(e)var e=e.toLowerCase();if(obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],e){var o=function(r,s,f){for(var h=0;h<r.length;h++)if((""+r[h]).toLowerCase().search(s)>=0||(""+obj.records[f][h].innerHTML).toLowerCase().search(s)>=0)return!0;return!1},t=function(r){obj.results.indexOf(r)==-1&&obj.results.push(r)};obj.options.data.filter(function(r,s){if(o(r,e,s)){var f=obj.isRowMerged(s);if(f.length)for(var h=0;h<f.length;h++)for(var g=jexcel.getIdFromColumnName(f[h],!0),u=0;u<obj.options.mergeCells[f[h]][1];u++)t(g[1]+u);else t(s);return!0}else return!1})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var e=0,o=0;for(obj.options.lazyLoading==!0?e=100:obj.options.pagination>0?e=obj.options.pagination:obj.results?e=obj.results.length:e=obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var t=0;t<obj.rows.length;t++)!obj.results||obj.results.indexOf(t)>-1?(o<e&&(obj.tbody.appendChild(obj.rows[t]),o++),obj.rows[t].style.display=""):obj.rows[t].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),e},obj.whichPage=function(e){return obj.options.search==!0&&obj.results&&(e=obj.results.indexOf(e)),Math.ceil((parseInt(e)+1)/parseInt(obj.options.pagination))-1},obj.page=function(e){var o=obj.pageNumber;if(obj.options.search==!0&&obj.results)var t=obj.results;else var t=obj.rows;var r=parseInt(obj.options.pagination);(e==null||e==-1)&&(e=Math.ceil(t.length/r)-1),obj.pageNumber=e;var s=e*r,f=e*r+r;for(f>t.length&&(f=t.length),s<0&&(s=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var h=s;h<f;h++)obj.options.search==!0&&obj.results?obj.tbody.appendChild(obj.rows[t[h]]):obj.tbody.appendChild(obj.rows[h]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,e,o)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(obj.options.search==!0&&obj.results)var e=obj.results.length;else var e=obj.rows.length;if(!e)obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound;else{var o=Math.ceil(e/obj.options.pagination);if(obj.pageNumber<6)var t=1,r=o<10?o:10;else if(o-obj.pageNumber<5){var t=o-9,r=o;t<1&&(t=1)}else var t=obj.pageNumber-4,r=obj.pageNumber+5;if(t>1){var s=document.createElement("div");s.className="jexcel_page",s.innerHTML="<",s.title=1,obj.pagination.children[1].appendChild(s)}for(var f=t;f<=r;f++){var s=document.createElement("div");s.className="jexcel_page",s.innerHTML=f,obj.pagination.children[1].appendChild(s),obj.pageNumber==f-1&&s.classList.add("jexcel_page_selected")}if(r<o){var s=document.createElement("div");s.className="jexcel_page",s.innerHTML=">",s.title=o,obj.pagination.children[1].appendChild(s)}var h=function(g){var u=Array.prototype.slice.call(arguments,1);return g.replace(/{(\d+)}/g,function(d,a){return typeof u[a]!="undefined"?u[a]:d})};obj.pagination.children[0].innerHTML=h(obj.options.text.showingPage,obj.pageNumber+1,o)}}},obj.download=function(e){if(obj.options.allowExport==!1)console.error("Export not allowed");else{var o="";o+=obj.copy(!1,obj.options.csvDelimiter,!0,e,!0);var t=new Blob(["\uFEFF"+o],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(t,obj.options.csvFileName+".csv");else{var r=document.createElement("a"),s=URL.createObjectURL(t);r.href=s,r.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(r),r.click(),r.parentNode.removeChild(r)}}},obj.setHistory=function(e){if(obj.ignoreHistory!=!0){var o=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,o+1),obj.history[o]=e}},obj.copy=function(e,o,t,r,s){o||(o="	");for(var f=new RegExp(o,"ig"),h=[],g=[],u=[],d=[],a=[],b=obj.options.data[0].length,v=obj.options.data.length,w="",S=!1,E="",m="",_=0,T=0,M=0,P=0,B=!0,D=0;D<v;D++)for(var L=0;L<b;L++)(!e||obj.records[D][L].classList.contains("highlight"))&&(M<=L&&(M=L),P<=D&&(P=D));if(b===M+1&&v===P+1&&(B=!1),s&&obj.options.includeHeadersOnDownload==!0||!s&&obj.options.includeHeadersOnCopy==!0&&!B||r){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0){obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?w=obj.options.nestedHeaders:w=[obj.options.nestedHeaders];for(var D=0;D<w.length;D++){for(var X=[],L=0;L<w[D].length;L++){var ie=parseInt(w[D][L].colspan);X.push(w[D][L].title);for(var ue=0;ue<ie-1;ue++)X.push("")}m+=X.join(o)+`\r
`}}S=!0}obj.style=[];for(var D=0;D<v;D++){g=[],u=[];for(var L=0;L<b;L++)if(!e||obj.records[D][L].classList.contains("highlight")){S==!0&&h.push(obj.headers[L].innerText);var fe=obj.options.data[D][L];if(fe.match&&(fe.match(f)||fe.match(/,/g)||fe.match(/\n/)||fe.match(/\"/))&&(fe=fe.replace(new RegExp('"',"g"),'""'),fe='"'+fe+'"'),g.push(fe),obj.options.columns[L].type=="checkbox"||obj.options.columns[L].type=="radio")var q=fe;else{if(obj.options.stripHTMLOnCopy==!0)var q=obj.records[D][L].innerText;else var q=obj.records[D][L].innerHTML;q.match&&(q.match(f)||q.match(/,/g)||q.match(/\n/)||q.match(/\"/))&&(q=q.replace(new RegExp('"',"g"),'""'),q='"'+q+'"')}u.push(q),w=obj.records[D][L].getAttribute("style"),w=w.replace("display: none;",""),obj.style.push(w||"")}g.length&&(S&&(_=g.length,d.push(h.join(o))),d.push(g.join(o))),u.length&&(T++,S&&(a.push(h.join(o)),S=!1),a.push(u.join(o)))}b==_&&v==T&&(E=m);var G=E+d.join(`\r
`),Y=E+a.join(`\r
`);if(t||(obj.options.copyCompatibility==!0?obj.textarea.value=Y:obj.textarea.value=G,obj.textarea.select(),document.execCommand("copy")),obj.options.copyCompatibility==!0?obj.data=Y:obj.data=G,obj.hashString=obj.hash(obj.data),!t){if(obj.removeCopyingSelection(),obj.highlighted)for(var L=0;L<obj.highlighted.length;L++)obj.highlighted[L].classList.add("copying"),obj.highlighted[L].classList.contains("highlight-left")&&obj.highlighted[L].classList.add("copying-left"),obj.highlighted[L].classList.contains("highlight-right")&&obj.highlighted[L].classList.add("copying-right"),obj.highlighted[L].classList.contains("highlight-top")&&obj.highlighted[L].classList.add("copying-top"),obj.highlighted[L].classList.contains("highlight-bottom")&&obj.highlighted[L].classList.add("copying-bottom");obj.dispatch("oncopy",el,obj.options.copyCompatibility==!0?a:d,obj.hashString)}return obj.data},obj.paste=function(e,o,h){var r=obj.dispatch("onbeforepaste",el,h,e,o);if(r===!1)return!1;if(r)var h=r;var s=obj.hash(h),f=s==obj.hashString?obj.style:null;if(obj.options.copyCompatibility==!0&&s==obj.hashString)var h=obj.data;var h=obj.parseCSV(h,"	");if(e!=null&&o!=null&&h){for(var g=0,u=0,d=[],a={},b={},v=0,w=parseInt(e),S=parseInt(o),E=null;E=h[u];){for(g=0,w=parseInt(e);E[g]!=null;){var m=obj.updateCell(w,S,E[g]);if(d.push(m),obj.updateFormulaChain(w,S,d),f&&f[v]){var _=jexcel.getColumnNameFromId([w,S]);a[_]=f[v],b[_]=obj.getStyle(_),obj.records[S][w].setAttribute("style",f[v]),v++}if(g++,E[g]!=null){if(w>=obj.headers.length-1)if(obj.options.allowInsertColumn==!0)obj.insertColumn();else break;w=obj.right.get(w,S)}}if(u++,h[u]){if(S>=obj.rows.length-1)if(obj.options.allowInsertRow==!0)obj.insertRow();else break;S=obj.down.get(e,S)}}obj.updateSelectionFromCoords(e,o,w,S),obj.setHistory({action:"setValue",records:d,selection:obj.selectedCell,newStyle:a,oldStyle:b}),obj.updateTable(),obj.dispatch("onpaste",el,h),obj.onafterchanges(el,d)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var e=document.querySelectorAll(".jexcel .copying"),o=0;o<e.length;o++)e[o].classList.remove("copying"),e[o].classList.remove("copying-left"),e[o].classList.remove("copying-right"),e[o].classList.remove("copying-top"),e[o].classList.remove("copying-bottom")},obj.historyProcessRow=function(e,o){var t=o.insertBefore?+o.rowNumber:o.rowNumber+1;if(obj.options.search==!0&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),e==1){for(var r=o.numOfRows,s=t;s<r+t;s++)obj.rows[s].parentNode.removeChild(obj.rows[s]);obj.records.splice(t,r),obj.options.data.splice(t,r),obj.rows.splice(t,r),obj.conditionalSelectionUpdate(1,t,r+t-1)}else{obj.records=jexcel.injectArray(obj.records,t,o.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,t,o.rowData),obj.rows=jexcel.injectArray(obj.rows,t,o.rowNode);for(var f=0,s=t;s<o.numOfRows+t;s++)obj.tbody.insertBefore(o.rowNode[f],obj.tbody.children[s]),f++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(e,o){var t=o.insertBefore?o.columnNumber:o.columnNumber+1;if(e==1){var r=o.numOfColumns;obj.options.columns.splice(t,r);for(var s=t;s<r+t;s++)obj.headers[s].parentNode.removeChild(obj.headers[s]),obj.colgroup[s].parentNode.removeChild(obj.colgroup[s]);obj.headers.splice(t,r),obj.colgroup.splice(t,r);for(var f=0;f<o.data.length;f++){for(var s=t;s<r+t;s++)obj.records[f][s].parentNode.removeChild(obj.records[f][s]);obj.records[f].splice(t,r),obj.options.data[f].splice(t,r)}if(obj.options.footers)for(var f=0;f<obj.options.footers.length;f++)obj.options.footers[f].splice(t,r)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,t,o.columns),obj.headers=jexcel.injectArray(obj.headers,t,o.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,t,o.colgroup);for(var h=0,s=t;s<o.numOfColumns+t;s++)obj.headerContainer.insertBefore(o.headers[h],obj.headerContainer.children[s+1]),obj.colgroupContainer.insertBefore(o.colgroup[h],obj.colgroupContainer.children[s+1]),h++;for(var f=0;f<o.data.length;f++){obj.options.data[f]=jexcel.injectArray(obj.options.data[f],t,o.data[f]),obj.records[f]=jexcel.injectArray(obj.records[f],t,o.records[f]);for(var h=0,s=t;s<o.numOfColumns+t;s++)obj.rows[f].insertBefore(o.records[f][h],obj.rows[f].children[s+1]),h++}if(obj.options.footers)for(var f=0;f<obj.options.footers.length;f++)obj.options.footers[f]=jexcel.injectArray(obj.options.footers[f],t,o.footers[f])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var f=0;f<obj.options.nestedHeaders.length;f++){if(e==1)var g=parseInt(obj.options.nestedHeaders[f][obj.options.nestedHeaders[f].length-1].colspan)-o.numOfColumns;else var g=parseInt(obj.options.nestedHeaders[f][obj.options.nestedHeaders[f].length-1].colspan)+o.numOfColumns;obj.options.nestedHeaders[f][obj.options.nestedHeaders[f].length-1].colspan=g,obj.thead.children[f].children[obj.thead.children[f].children.length-1].setAttribute("colspan",g)}else{if(e==1)var g=parseInt(obj.options.nestedHeaders[0].colspan)-o.numOfColumns;else var g=parseInt(obj.options.nestedHeaders[0].colspan)+o.numOfColumns;obj.options.nestedHeaders[0].colspan=g,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",g)}obj.updateTableReferences()},obj.undo=function(){var e=!!obj.ignoreEvents,o=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var t=[];if(obj.historyIndex>=0){var r=obj.history[obj.historyIndex--];if(r.action=="insertRow")obj.historyProcessRow(1,r);else if(r.action=="deleteRow")obj.historyProcessRow(0,r);else if(r.action=="insertColumn")obj.historyProcessColumn(1,r);else if(r.action=="deleteColumn")obj.historyProcessColumn(0,r);else if(r.action=="moveRow")obj.moveRow(r.newValue,r.oldValue);else if(r.action=="moveColumn")obj.moveColumn(r.newValue,r.oldValue);else if(r.action=="setMerge")obj.removeMerge(r.column,r.data);else if(r.action=="setStyle")obj.setStyle(r.oldValue,null,null,1);else if(r.action=="setWidth")obj.setWidth(r.column,r.oldValue);else if(r.action=="setHeight")obj.setHeight(r.row,r.oldValue);else if(r.action=="setHeader")obj.setHeader(r.column,r.oldValue);else if(r.action=="setComments")obj.setComments(r.column,r.oldValue[0],r.oldValue[1]);else if(r.action=="orderBy"){for(var s=[],f=0;f<r.rows.length;f++)s[r.rows[f]]=f;obj.updateOrderArrow(r.column,r.order?0:1),obj.updateOrder(s)}else if(r.action=="setValue"){for(var h=0;h<r.records.length;h++)t.push({x:r.records[h].x,y:r.records[h].y,newValue:r.records[h].oldValue}),r.oldStyle&&obj.resetStyle(r.oldStyle);obj.setValue(t),r.selection&&obj.updateSelectionFromCoords(r.selection[0],r.selection[1],r.selection[2],r.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=o,obj.dispatch("onundo",el,r)},obj.redo=function(){var e=!!obj.ignoreEvents,o=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var t=obj.history[++obj.historyIndex];if(t.action=="insertRow")obj.historyProcessRow(0,t);else if(t.action=="deleteRow")obj.historyProcessRow(1,t);else if(t.action=="insertColumn")obj.historyProcessColumn(0,t);else if(t.action=="deleteColumn")obj.historyProcessColumn(1,t);else if(t.action=="moveRow")obj.moveRow(t.oldValue,t.newValue);else if(t.action=="moveColumn")obj.moveColumn(t.oldValue,t.newValue);else if(t.action=="setMerge")obj.setMerge(t.column,t.colspan,t.rowspan,1);else if(t.action=="setStyle")obj.setStyle(t.newValue,null,null,1);else if(t.action=="setWidth")obj.setWidth(t.column,t.newValue);else if(t.action=="setHeight")obj.setHeight(t.row,t.newValue);else if(t.action=="setHeader")obj.setHeader(t.column,t.newValue);else if(t.action=="setComments")obj.setComments(t.column,t.newValue[0],t.newValue[1]);else if(t.action=="orderBy")obj.updateOrderArrow(t.column,t.order),obj.updateOrder(t.rows);else if(t.action=="setValue"){obj.setValue(t.records);for(var r=0;r<t.records.length;r++)t.oldStyle&&obj.resetStyle(t.newStyle);t.selection&&obj.updateSelectionFromCoords(t.selection[0],t.selection[1],t.selection[2],t.selection[3])}}obj.ignoreEvents=e,obj.ignoreHistory=o,obj.dispatch("onredo",el,t)},obj.getDropDownValue=function(e,o){var t=[];if(obj.options.columns[e]&&obj.options.columns[e].source){for(var r=[],s=obj.options.columns[e].source,f=0;f<s.length;f++)typeof s[f]=="object"?r[s[f].id]=s[f].name:r[s[f]]=s[f];for(var h=Array.isArray(o)?o:(""+o).split(";"),f=0;f<h.length;f++)typeof h[f]=="object"?t.push(r[h[f].id]):r[h[f]]&&t.push(r[h[f]])}else console.error("Invalid column");return t.length>0?t.join("; "):""},obj.parseCSV=function(e,o){e=e.replace(/\r?\n$|\r$|\n$/g,""),e.charCodeAt(e.length-1)==9&&(e+="\0"),o=o||",";for(var t=[],r=!1,s=0,f=0,h=0;h<e.length;h++){var g=e[h],u=e[h+1];if(t[s]=t[s]||[],t[s][f]=t[s][f]||"",g=='"'&&r&&u=='"'){t[s][f]+=g,++h;continue}if(g=='"'){r=!r;continue}if(g==o&&!r){++f;continue}if(g=="\r"&&u==`
`&&!r){++s,f=0,++h;continue}if(g==`
`&&!r){++s,f=0;continue}if(g=="\r"&&!r){++s,f=0;continue}t[s][f]+=g}return t},obj.hash=function(e){var o=0,t,r;if(e.length===0)return o;for(t=0;t<e.length;t++)r=e.charCodeAt(t),o=(o<<5)-o+r,o|=0;return o},obj.onafterchanges=function(e,o){obj.dispatch("onafterchanges",e,o)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,typeof jexcel.build=="function"&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(e){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(obj.options.loadingSpin==!0&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(e){var o=obj.parseCSV(e,obj.options.csvDelimiter);if(obj.options.csvHeaders==!0&&o.length>0)for(var t=o.shift(),r=0;r<t.length;r++)obj.options.columns[r]||(obj.options.columns[r]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),typeof obj.options.columns[r].title=="undefined"&&(obj.options.columns[r].title=t[r]);obj.options.data=o,obj.prepareTable(),obj.options.loadingSpin==!0&&jSuites.loading.hide()}})):obj.options.url?(obj.options.loadingSpin==!0&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(e){obj.options.data=e.data?e.data:e,obj.prepareTable(),obj.options.loadingSpin==!0&&jSuites.loading.hide()}})):obj.prepareTable()},options&&options.contextMenu!=null?obj.options.contextMenu=options.contextMenu:obj.options.contextMenu=function(e,o,t,r){var s=[];if(t==null)obj.options.allowInsertColumn==!0&&s.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(o),1)}}),obj.options.allowInsertColumn==!0&&s.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(o),0)}}),obj.options.allowDeleteColumn==!0&&s.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(o))}}),obj.options.allowRenameColumn==!0&&s.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(o)}}),obj.options.columnSorting==!0&&(s.push({type:"line"}),s.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(o,0)}}),s.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(o,1)}}));else if(obj.options.allowInsertRow==!0&&(s.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(t),1)}}),s.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(t))}})),obj.options.allowDeleteRow==!0&&s.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(t))}}),o&&obj.options.allowComments==!0){s.push({type:"line"});var f=obj.records[t][o].getAttribute("title")||"";s.push({title:f?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var h=prompt(obj.options.text.comments,f);h&&obj.setComments([o,t],h)}}),f&&s.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([o,t],"")}})}return s.push({type:"line"}),s.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&s.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(h){h&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],h)})}}),obj.options.allowExport&&s.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&s.push({title:obj.options.text.about,onclick:function(){obj.options.about===!0?alert(Version().print()):alert(obj.options.about)}}),s},obj.scrollControls=function(e){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),(obj.options.lazyLoading==!0||obj.options.tableOverflow==!0)&&obj.edition&&e.target.className.substr(0,9)!="jdropdown"&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(e){obj.options.lazyLoading==!0&&jexcel.timeControlLoading==null&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var e=0;if(obj.options.freezeColumns>0)for(var o=0;o<obj.options.freezeColumns;o++)e+=parseInt(obj.options.columns[o].width);return e};var scrollLeft=0;return obj.updateFreezePosition=function(){scrollLeft=obj.content.scrollLeft;var e=0;if(scrollLeft>50)for(var o=0;o<obj.options.freezeColumns;o++){o>0&&obj.options.columns[o-1].type!=="hidden"&&(e+=parseInt(obj.options.columns[o-1].width)),obj.headers[o].classList.add("jexcel_freezed"),obj.headers[o].style.left=e+"px";for(var t=0;t<obj.rows.length;t++)if(obj.rows[t]&&obj.records[t][o]){var r=scrollLeft+(o>0?obj.records[t][o-1].style.width:0)-51+"px";obj.records[t][o].classList.add("jexcel_freezed"),obj.records[t][o].style.left=r}}else for(var o=0;o<obj.options.freezeColumns;o++){obj.headers[o].classList.remove("jexcel_freezed"),obj.headers[o].style.left="";for(var t=0;t<obj.rows.length;t++)obj.records[t][o]&&(obj.records[t][o].classList.remove("jexcel_freezed"),obj.records[t][o].style.left="")}obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj};return jexcel.setDictionary=function(e){jSuites.setDictionary(e)},jexcel.setExtensions=function(e){for(var o=Object.keys(e),t=0;t<o.length;t++)typeof e[o[t]]=="function"&&(jexcel[o[t]]=e[o[t]],jexcel.license&&typeof e[o[t]].license=="function"&&e[o[t]].license(jexcel.license))},typeof formula!="undefined"&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null,jexcel.destroy=function(e,o){if(e.jexcel){var t=e.jexcel.options.root?e.jexcel.options.root:document;e.removeEventListener("DOMMouseScroll",e.jexcel.scrollControls),e.removeEventListener("mousewheel",e.jexcel.scrollControls),e.jexcel=null,e.innerHTML="",o&&(t.removeEventListener("mouseup",jexcel.mouseUpControls),t.removeEventListener("mousedown",jexcel.mouseDownControls),t.removeEventListener("mousemove",jexcel.mouseMoveControls),t.removeEventListener("mouseover",jexcel.mouseOverControls),t.removeEventListener("dblclick",jexcel.doubleClickControls),t.removeEventListener("paste",jexcel.pasteControls),t.removeEventListener("contextmenu",jexcel.contextMenuControls),t.removeEventListener("touchstart",jexcel.touchStartControls),t.removeEventListener("touchend",jexcel.touchEndControls),t.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls),jexcel=null)}},jexcel.build=function(e){e.addEventListener("mouseup",jexcel.mouseUpControls),e.addEventListener("mousedown",jexcel.mouseDownControls),e.addEventListener("mousemove",jexcel.mouseMoveControls),e.addEventListener("mouseover",jexcel.mouseOverControls),e.addEventListener("dblclick",jexcel.doubleClickControls),e.addEventListener("paste",jexcel.pasteControls),e.addEventListener("contextmenu",jexcel.contextMenuControls),e.addEventListener("touchstart",jexcel.touchStartControls),e.addEventListener("touchend",jexcel.touchEndControls),e.addEventListener("touchcancel",jexcel.touchEndControls),e.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(e){if(jexcel.current){if(jexcel.current.edition)if(e.which==27)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),e.preventDefault();else if(e.which==13){if(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar")jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if(!(jexcel.current.options.columns[jexcel.current.edition[2]].type=="dropdown"||jexcel.current.options.columns[jexcel.current.edition[2]].type=="autocomplete"))if((jexcel.current.options.wordWrap==!0||jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap==!0||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&e.altKey){var o=jexcel.current.edition[0].children[0],t=jexcel.current.edition[0].children[0].value,r=o.selectionStart;t=t.slice(0,r)+`
`+t.slice(r),o.value=t,o.focus(),o.selectionStart=r+1,o.selectionEnd=r+1}else jexcel.current.edition[0].children[0].blur()}else e.which==9&&(jexcel.current.options.columns[jexcel.current.edition[2]].type=="calendar"?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell){if(e.which==37)jexcel.current.left(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==39)jexcel.current.right(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==38)jexcel.current.up(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==40)jexcel.current.down(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==36)jexcel.current.first(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==35)jexcel.current.last(e.shiftKey,e.ctrlKey),e.preventDefault();else if(e.which==32)jexcel.current.options.editable==!0&&jexcel.current.setCheckRadioValue(),e.preventDefault();else if(e.which==46)jexcel.current.options.editable==!0&&(jexcel.current.selectedRow?jexcel.current.options.allowDeleteRow==!0&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?jexcel.current.options.allowDeleteColumn==!0&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(e.which==13)e.shiftKey?jexcel.current.up():(jexcel.current.options.allowInsertRow==!0&&jexcel.current.options.allowManualInsertRow==!0&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),e.preventDefault();else if(e.which==9)e.shiftKey?jexcel.current.left():(jexcel.current.options.allowInsertColumn==!0&&jexcel.current.options.allowManualInsertColumn==!0&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),e.preventDefault();else if((e.ctrlKey||e.metaKey)&&!e.shiftKey)e.which==65?(jexcel.current.selectAll(),e.preventDefault()):e.which==83?(jexcel.current.download(),e.preventDefault()):e.which==89?(jexcel.current.redo(),e.preventDefault()):e.which==90?(jexcel.current.undo(),e.preventDefault()):e.which==67?(jexcel.current.copy(!0),e.preventDefault()):e.which==88?(jexcel.current.options.editable==!0?jexcel.cutControls():jexcel.copyControls(),e.preventDefault()):e.which==86&&jexcel.pasteControls();else if(jexcel.current.selectedCell&&jexcel.current.options.editable==!0){var s=jexcel.current.selectedCell[1],f=jexcel.current.selectedCell[0];jexcel.current.options.columns[f].type!="readonly"&&(e.keyCode==32?jexcel.current.options.columns[f].type=="checkbox"||jexcel.current.options.columns[f].type=="radio"?e.preventDefault():jexcel.current.openEditor(jexcel.current.records[s][f],!0):e.keyCode==113?jexcel.current.openEditor(jexcel.current.records[s][f],!1):(e.keyCode==8||e.keyCode>=48&&e.keyCode<=57||e.keyCode>=96&&e.keyCode<=111||e.keyCode>=187&&e.keyCode<=190||(String.fromCharCode(e.keyCode)==e.key||String.fromCharCode(e.keyCode).toLowerCase()==e.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(e.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[s][f],!0),jexcel.current.options.columns[f].type=="calendar"&&e.preventDefault()))}}else e.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(e.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(e){if(e=e||window.event,e.buttons)var o=e.buttons;else if(e.button)var o=e.button;else var o=e.which;var t=jexcel.getElement(e.target);if(t[0]?jexcel.current!=t[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=t[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&o==1){if(e.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(e.target.classList.contains("jexcel_corner"))jexcel.current.options.editable==!0&&(jexcel.current.selectedCorner=!0);else{if(t[1]==1){var r=e.target.getAttribute("data-x");if(r){var s=e.target.getBoundingClientRect();if(jexcel.current.options.columnResize==!0&&s.width-e.offsetX<6){jexcel.current.resizing={mousePosition:e.pageX,column:r,width:s.width},jexcel.current.headers[r].classList.add("resizing");for(var f=0;f<jexcel.current.records.length;f++)jexcel.current.records[f][r]&&jexcel.current.records[f][r].classList.add("resizing")}else if(jexcel.current.options.columnDrag==!0&&s.height-e.offsetY<6)if(jexcel.current.isColMerged(r).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target,column:r,destination:r},jexcel.current.headers[r].classList.add("dragging");for(var f=0;f<jexcel.current.records.length;f++)jexcel.current.records[f][r]&&jexcel.current.records[f][r].classList.add("dragging")}else{if(jexcel.current.selectedHeader&&(e.shiftKey||e.ctrlKey))var h=jexcel.current.selectedHeader,g=r;else{jexcel.current.selectedHeader==r&&jexcel.current.options.allowRenameColumn==!0&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(r)},800)),jexcel.current.selectedHeader=r;var h=r,g=r}jexcel.current.updateSelectionFromCoords(h,0,g,jexcel.current.options.data.length-1)}}else if(e.target.parentNode.classList.contains("jexcel_nested")){if(e.target.getAttribute("data-column"))var u=e.target.getAttribute("data-column").split(","),d=parseInt(u[0]),a=parseInt(u[u.length-1]);else var d=0,a=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(d,0,a,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(t[1]==2){var b=e.target.getAttribute("data-y");if(e.target.classList.contains("jexcel_row")){var s=e.target.getBoundingClientRect();if(jexcel.current.options.rowResize==!0&&s.height-e.offsetY<6)jexcel.current.resizing={element:e.target.parentNode,mousePosition:e.pageY,row:b,height:s.height},e.target.parentNode.classList.add("resizing");else if(jexcel.current.options.rowDrag==!0&&s.width-e.offsetX<6)jexcel.current.isRowMerged(b).length?console.error("Jspreadsheet: This row is part of a merged cell"):jexcel.current.options.search==!0&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:e.target.parentNode,row:b,destination:b},e.target.parentNode.classList.add("dragging"));else{if(jexcel.current.selectedRow&&(e.shiftKey||e.ctrlKey))var h=jexcel.current.selectedRow,g=b;else{jexcel.current.selectedRow=b;var h=b,g=b}jexcel.current.updateSelectionFromCoords(0,h,jexcel.current.options.data[0].length-1,g)}}else if(e.target.classList.contains("jclose")&&e.target.clientWidth-e.offsetX<50&&e.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var v=function(S){var E=S.getAttribute("data-x"),m=S.getAttribute("data-y");if(E&&m)return[E,m];if(S.parentNode)return v(S.parentNode)},w=v(e.target);if(w){var r=w[0],b=w[1];jexcel.current.edition&&(jexcel.current.edition[2]!=r||jexcel.current.edition[3]!=b)&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.edition||(e.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],r,b):jexcel.current.updateSelectionFromCoords(r,b)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;e.target.classList.contains("jexcel_page")&&(e.target.innerText=="<"?jexcel.current.page(0):e.target.innerText==">"?jexcel.current.page(e.target.getAttribute("title")-1):jexcel.current.page(e.target.innerText-1))}jexcel.current.edition?jexcel.isMouseAction=!1:jexcel.isMouseAction=!0}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(e){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var o=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),t=jexcel.current.getSelectedColumns();if(t.length>1){for(var r=[],s=0;s<t.length;s++)r.push(parseInt(jexcel.current.colgroup[t[s]].getAttribute("width")));var f=t.indexOf(parseInt(jexcel.current.resizing.column));r[f]=jexcel.current.resizing.width,jexcel.current.setWidth(t,o,r)}else jexcel.current.setWidth(jexcel.current.resizing.column,o,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var h=0;h<jexcel.current.records.length;h++)jexcel.current.records[h][jexcel.current.resizing.column]&&jexcel.current.records[h][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var g=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,g,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var u=e.target.getAttribute("data-x");jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging");for(var h=0;h<jexcel.current.rows.length;h++)jexcel.current.records[h][jexcel.current.dragging.column]&&jexcel.current.records[h][jexcel.current.dragging.column].classList.remove("dragging");for(var s=0;s<jexcel.current.headers.length;s++)jexcel.current.headers[s].classList.remove("dragging-left"),jexcel.current.headers[s].classList.remove("dragging-right");u&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var d=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<d&&(d-=1)}else var d=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,d,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(e){if(e=e||window.event,e.buttons)var o=e.buttons;else if(e.button)var o=e.button;else var o=e.which;if(o||(jexcel.isMouseAction=!1),jexcel.current)if(jexcel.isMouseAction==!0){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var t=e.pageX-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.width+t>0){var r=jexcel.current.resizing.width+t;jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",r),jexcel.current.updateCornerPosition()}}else{var s=e.pageY-jexcel.current.resizing.mousePosition;if(jexcel.current.resizing.height+s>0){var f=jexcel.current.resizing.height+s;jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",f),jexcel.current.updateCornerPosition()}}else if(jexcel.current.dragging)if(jexcel.current.dragging.column){var h=e.target.getAttribute("data-x");if(h)if(jexcel.current.isColMerged(h).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var g=0;g<jexcel.current.headers.length;g++)jexcel.current.headers[g].classList.remove("dragging-left"),jexcel.current.headers[g].classList.remove("dragging-right");jexcel.current.dragging.column==h?jexcel.current.dragging.destination=parseInt(h):e.target.clientWidth/2>e.offsetX?(jexcel.current.dragging.column<h?jexcel.current.dragging.destination=parseInt(h)-1:jexcel.current.dragging.destination=parseInt(h),jexcel.current.headers[h].classList.add("dragging-left")):(jexcel.current.dragging.column<h?jexcel.current.dragging.destination=parseInt(h):jexcel.current.dragging.destination=parseInt(h)+1,jexcel.current.headers[h].classList.add("dragging-right"))}}else{var u=e.target.getAttribute("data-y");if(u)if(jexcel.current.isRowMerged(u).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var d=e.target.clientHeight/2>e.offsetY?e.target.parentNode.nextSibling:e.target.parentNode;jexcel.current.dragging.element!=d&&(e.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,d),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}}else{var a=e.target.getAttribute("data-x"),b=e.target.getAttribute("data-y"),v=e.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),e.target.parentNode.parentNode&&e.target.parentNode.parentNode.className&&(e.target.parentNode.parentNode.classList.contains("resizable")&&(e.target&&a&&!b&&v.width-(e.clientX-v.left)<6?(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="col-resize"):e.target&&!a&&b&&v.height-(e.clientY-v.top)<6&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="row-resize")),e.target.parentNode.parentNode.classList.contains("draggable")&&(e.target&&!a&&b&&v.width-(e.clientX-v.left)<6||e.target&&a&&!b&&v.height-(e.clientY-v.top)<6)&&(jexcel.current.cursor=e.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(e){if(e=e||window.event,e.buttons)var o=e.buttons;else if(e.button)var o=e.button;else var o=e.which;if(o||(jexcel.isMouseAction=!1),jexcel.current&&jexcel.isMouseAction==!0){var t=jexcel.getElement(e.target);if(t[0]){if(jexcel.current!=t[0].jexcel&&jexcel.current)return!1;var r=e.target.getAttribute("data-x"),s=e.target.getAttribute("data-y");if(!(jexcel.current.resizing||jexcel.current.dragging)){if(t[1]==1&&jexcel.current.selectedHeader){var r=e.target.getAttribute("data-x"),f=jexcel.current.selectedHeader,h=r;jexcel.current.updateSelectionFromCoords(f,0,h,jexcel.current.options.data.length-1)}if(t[1]==2)if(e.target.classList.contains("jexcel_row")){if(jexcel.current.selectedRow){var f=jexcel.current.selectedRow,h=s;jexcel.current.updateSelectionFromCoords(0,f,jexcel.current.options.data[0].length-1,h)}}else jexcel.current.edition||r&&s&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(r,s):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],r,s))}}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(e){if(jexcel.current)if(e.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var o=jexcel.current.highlighted[0].getAttribute("data-x"),t=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,r=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x"),s=jexcel.current.records.length-1;jexcel.current.copyData(jexcel.current.records[t][o],jexcel.current.records[s][r])}}else if(e.target.classList.contains("jexcel_column_filter")){var f=e.target.getAttribute("data-x");jexcel.current.openFilter(f)}else{var h=jexcel.getElement(e.target);if(h[1]==1&&jexcel.current.options.columnSorting==!0){var f=e.target.getAttribute("data-x");f&&jexcel.current.orderBy(f)}if(h[1]==2&&jexcel.current.options.editable==!0&&!jexcel.current.edition){var g=function(d){if(d.parentNode){var a=d.getAttribute("data-x"),b=d.getAttribute("data-y");return a&&b?d:g(d.parentNode)}},u=g(e.target);u&&u.classList.contains("highlight")&&jexcel.current.openEditor(u)}}},jexcel.copyControls=function(e){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(e){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),jexcel.current.options.editable==!0&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(e){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||jexcel.current.options.editable==!0&&(e&&e.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],e.clipboardData.getData("text")),e.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(e){if(e=e||window.event,"buttons"in e?e.buttons:e.which||e.button,jexcel.current){if(jexcel.current.edition)e.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var o=e.target.getAttribute("data-x"),t=e.target.getAttribute("data-y");if(o||t){(o<parseInt(jexcel.current.selectedCell[0])||o>parseInt(jexcel.current.selectedCell[2])||t<parseInt(jexcel.current.selectedCell[1])||t>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(o,t,o,t);var r=jexcel.current.options.contextMenu(jexcel.current,o,t,e);jexcel.current.contextMenu.contextmenu.open(e,r),e.preventDefault()}}}},jexcel.touchStartControls=function(e){var o=jexcel.getElement(e.target);if(o[0]?jexcel.current!=o[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=o[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var t=e.target.getAttribute("data-x"),r=e.target.getAttribute("data-y");t&&r&&(jexcel.current.updateSelectionFromCoords(t,r),jexcel.timeControl=setTimeout(function(){jexcel.current.options.columns[t].type=="color"?jexcel.tmpElement=null:jexcel.tmpElement=e.target,jexcel.current.openEditor(e.target,!1,e)},500))}},jexcel.touchEndControls=function(e){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&jexcel.tmpElement.children[0].tagName=="INPUT"&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(e,o){var t=[];if(e.classList.contains("jexcel_tabs"))var r=e.children[0],f=e.children[1];else{e.innerHTML="",e.classList.add("jexcel_tabs"),e.jexcel=[];var s=document.createElement("div"),r=e.appendChild(s),s=document.createElement("div"),f=e.appendChild(s)}for(var h=[],g=[],u=0;u<o.length;u++){h[u]=document.createElement("div"),h[u].classList.add("jexcel_tab");var d=jexcel(h[u],o[u]);f.appendChild(h[u]),t[u]=e.jexcel.push(d),g[u]=document.createElement("div"),g[u].classList.add("jexcel_tab_link"),g[u].setAttribute("data-spreadsheet",e.jexcel.length-1),g[u].innerHTML=o[u].sheetName,g[u].onclick=function(){for(var b=0;b<r.children.length;b++)r.children[b].classList.remove("selected"),f.children[b].style.display="none";var v=this.getAttribute("data-spreadsheet");f.children[v].style.display="block",r.children[v].classList.add("selected")},r.appendChild(g[u])}for(var a=0;a<r.children.length;a++)r.children[a].classList.remove("selected"),f.children[a].style.display="none";return r.children[r.children.length-1].classList.add("selected"),f.children[r.children.length-1].style.display="block",t},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(e,o){var t=function(s){var f=[];return s.SheetNames.forEach(function(h){var g={};g.rows=[],g.columns=[],g.data=[],g.style={},g.sheetName=h;var m=s.Sheets[h]["!cols"];if(m&&m.length)for(var u=0;u<m.length;u++)g.columns[u]={},m[u]&&m[u].wpx&&(g.columns[u].width=m[u].wpx+"px");var m=s.Sheets[h]["!rows"];if(m&&m.length)for(var u=0;u<m.length;u++)m[u]&&m[u].hpx&&(g.rows[u]={},g.rows[u].height=m[u].hpx+"px");var m=s.Sheets[h]["!merges"];if(m&&m.length>0){g.mergeCells=[];for(var u=0;u<m.length;u++){var d=m[u].s.c,a=m[u].s.r,b=m[u].e.c,v=m[u].e.r,w=jexcel.getColumnNameFromId([d,a]);g.mergeCells[w]=[b-d+1,v-a+1]}}for(var S=0,E=0,m=Object.keys(s.Sheets[h]),u=0;u<m.length;u++)if(m[u].substr(0,1)!="!"){var _=s.Sheets[h][m[u]],T=jexcel.getIdFromColumnName(m[u],!0);g.data[T[1]]||(g.data[T[1]]=[]),g.data[T[1]][T[0]]=_.f?"="+_.f:_.w,S<T[0]&&(S=T[0]),E<T[1]&&(E=T[1]),_.style&&Object.keys(_.style).length>0&&(g.style[m[u]]=_.style),_.s&&_.s.fgColor&&(g.style[m[u]]&&(g.style[m[u]]+=";"),g.style[m[u]]+="background-color:#"+_.s.fgColor.rgb)}for(var M=g.columns,P=0;P<=E;P++)for(var u=0;u<=S;u++)g.data[P]||(g.data[P]=[]),g.data[P][u]||M<u&&(g.data[P][u]="");f.push(g)}),f},r;r=new XMLHttpRequest,r.open("GET",e,!0),typeof Uint8Array!="undefined"?(r.responseType="arraybuffer",r.onload=function(s){var f=r.response,h=new Uint8Array(f),g=XLSX.read(h,{type:"array",cellFormula:!0,cellStyles:!0});o(t(g))}):(r.setRequestHeader("Accept-Charset","x-user-defined"),r.onreadystatechange=function(){if(r.readyState==4&&r.status==200){var s=convertResponseBodyToText(r.responseBody),f=XLSX.read(s,{type:"binary",cellFormula:!0,cellStyles:!0});o(t(f))}}),r.send()},jexcel.validLetter=function(e){var o=/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g;return e.match(o)?1:0},jexcel.injectArray=function(e,o,t){return e.slice(0,o).concat(t).concat(e.slice(o))},jexcel.getColumnName=function(e){var o="";return e>701?(o+=String.fromCharCode(64+parseInt(e/676)),o+=String.fromCharCode(64+parseInt(e%676/26))):e>25&&(o+=String.fromCharCode(64+parseInt(e/26))),o+=String.fromCharCode(65+e%26),o},jexcel.getIdFromColumnName=function(e,o){var t=/^[a-zA-Z]+/.exec(e);if(t){for(var r=0,s=0;s<t[0].length;s++)r+=parseInt(t[0].charCodeAt(s)-64)*Math.pow(26,t[0].length-1-s);r--,r<0&&(r=0);var f=parseInt(/[0-9]+$/.exec(e));f>0&&f--,o==!0?e=[r,f]:e=r+"-"+f}return e},jexcel.getColumnNameFromId=function(e){return Array.isArray(e)||(e=e.split("-")),jexcel.getColumnName(parseInt(e[0]))+(parseInt(e[1])+1)},jexcel.getElement=function(e){var o=0,t=0;function r(s){s.className&&s.classList.contains("jexcel_container")&&(t=s),s.tagName=="THEAD"?o=1:s.tagName=="TBODY"&&(o=2),s.parentNode&&(t||r(s.parentNode))}return r(e),[t,o]},jexcel.doubleDigitFormat=function(e){return e=""+e,e.length==1&&(e="0"+e),e},jexcel.createFromTable=function(e,o){if(e.tagName!="TABLE")console.log("Element is not a table");else{o||(o={}),o.columns=[],o.data=[];var t=e.querySelectorAll("colgroup > col");if(t.length)for(var r=0;r<t.length;r++){var s=t[r].style.width;if(!s)var s=t[r].getAttribute("width");s&&(o.columns[r]||(o.columns[r]={}),o.columns[r].width=s)}var f=function(G){var Y=G.getBoundingClientRect(),J=Y.width>50?Y.width:50;o.columns[r]||(o.columns[r]={}),G.getAttribute("data-celltype")?o.columns[r].type=G.getAttribute("data-celltype"):o.columns[r].type="text",o.columns[r].width=J+"px",o.columns[r].title=G.innerHTML,o.columns[r].align=G.style.textAlign||"center",(Y=G.getAttribute("name"))&&(o.columns[r].name=Y),(Y=G.getAttribute("id"))&&(o.columns[r].id=Y)},h=[],g=e.querySelectorAll(":scope > thead > tr");if(g.length){for(var u=0;u<g.length-1;u++){for(var d=[],r=0;r<g[u].children.length;r++){var a={title:g[u].children[r].innerText,colspan:g[u].children[r].getAttribute("colspan")||1};d.push(a)}h.push(d)}g=g[g.length-1].children;for(var r=0;r<g.length;r++)f(g[r])}for(var b=0,v={},w={},S={},E={},D=e.querySelectorAll(":scope > tr, :scope > tbody > tr"),u=0;u<D.length;u++)if(o.data[b]=[],o.parseTableFirstRowAsHeader==!0&&!g.length&&u==0)for(var r=0;r<D[u].children.length;r++)f(D[u].children[r]);else{for(var r=0;r<D[u].children.length;r++){var m=D[u].children[r].getAttribute("data-formula");if(m)m.substr(0,1)!="="&&(m="="+m);else var m=D[u].children[r].innerHTML;o.data[b].push(m);var _=jexcel.getColumnNameFromId([r,u]),T=D[u].children[r].getAttribute("class");T&&(E[_]=T);var M=parseInt(D[u].children[r].getAttribute("colspan"))||0,P=parseInt(D[u].children[r].getAttribute("rowspan"))||0;(M||P)&&(v[_]=[M||1,P||1]),(B=D[u].children[r].style&&D[u].children[r].style.display=="none")&&(D[u].children[r].style.display="");var B=D[u].children[r].getAttribute("style");B&&(S[_]=B),D[u].children[r].classList.contains("styleBold")&&(S[_]?S[_]+="; font-weight:bold;":S[_]="font-weight:bold;")}D[u].style&&D[u].style.height&&(w[u]={height:D[u].style.height}),b++}Object.keys(h).length>0&&(o.nestedHeaders=h),Object.keys(S).length>0&&(o.style=S),Object.keys(v).length>0&&(o.mergeCells=v),Object.keys(w).length>0&&(o.rows=w),Object.keys(E).length>0&&(o.classes=E);var D=e.querySelectorAll("tfoot tr");if(D.length){for(var L=[],u=0;u<D.length;u++){for(var X=[],r=0;r<D[u].children.length;r++)X.push(D[u].children[r].innerText);L.push(X)}Object.keys(L).length>0&&(o.footers=L)}if(o.parseTableAutoCellType==!0)for(var ie=[],r=0;r<o.columns.length;r++){var ue=!0,fe=!0;ie[r]=[];for(var u=0;u<o.data.length;u++){var m=o.data[u][r];ie[r][m]||(ie[r][m]=0),ie[r][m]++,m.length>25&&(ue=!1),m.length==10&&m.substr(4,1)=="-"&&m.substr(7,1)=="-"||(fe=!1)}var q=Object.keys(ie[r]).length;fe?o.columns[r].type="calendar":ue==!0&&q>1&&q<=parseInt(o.data.length*.1)&&(o.columns[r].type="dropdown",o.columns[r].source=Object.keys(ie[r]))}return o}},jexcel.helpers=function(){var e={};return e.getCaretIndex=function(o){if(this.config.root)var t=this.config.root;else var t=window;var r=0,s=t.getSelection();if(s&&s.rangeCount!==0){var f=s.getRangeAt(0),h=f.cloneRange();h.selectNodeContents(o),h.setEnd(f.endContainer,f.endOffset),r=h.toString().length}return r},e.invert=function(o){for(var t=[],r=Object.keys(o),s=0;s<r.length;s++)t[o[r[s]]]=r[s];return t},e.getColumnName=function(o){var t="";return o>701?(t+=String.fromCharCode(64+parseInt(o/676)),t+=String.fromCharCode(64+parseInt(o%676/26))):o>25&&(t+=String.fromCharCode(64+parseInt(o/26))),t+=String.fromCharCode(65+o%26),t},e.getColumnNameFromCoords=function(o,t){return e.getColumnName(parseInt(o))+(parseInt(t)+1)},e.getCoordsFromColumnName=function(o){var t=/^[a-zA-Z]+/.exec(o);if(t){for(var r=0,s=0;s<t[0].length;s++)r+=parseInt(t[0].charCodeAt(s)-64)*Math.pow(26,t[0].length-1-s);r--,r<0&&(r=0);var f=parseInt(/[0-9]+$/.exec(o))||null;return f>0&&f--,[r,f]}},e.createFromTable=function(){},e.injectArray=function(o,t,r){return o.slice(0,t).concat(r).concat(o.slice(t))},e.parseCSV=function(o,t){t=t||",";for(var r=0,s=0,f=[[]],h=0,g=null,u=!1,d=!1,a=0;a<o.length;a++)if(f[s]||(f[s]=[]),f[s][r]||(f[s][r]=""),o[a]!="\r")if((o[a]==`
`||o[a]==t)&&(u==!1||d==!0||!g)){if(g=null,u=!1,d=!1,f[s][r][0]=='"'){var b=f[s][r].trim();b[b.length-1]=='"'&&(f[s][r]=b.substr(1,b.length-2))}o[a]==`
`?(r=0,s++):(r++,r>h&&(h=r))}else{if(o[a]=='"'&&(u=!u),g===null){if(g=u,g==!0)continue}else if(g===!0&&!d&&o[a]=='"'){o[a+1]=='"'?(u=!0,f[s][r]+=o[a],a++):d=!0;continue}f[s][r]+=o[a]}for(var v=0;v<f.length;v++)for(var a=0;a<=h;a++)f[v][a]===void 0&&(f[v][a]="");return f},e}(),typeof jQuery!="undefined"&&function(e){e.fn.jspreadsheet=e.fn.jexcel=function(o){var t=e(this).get(0);return t.jexcel?Array.isArray(t.jexcel)?t.jexcel[o][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):t.jexcel[o].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(e(this).get(0),arguments[0])}}(jQuery),jexcel})})(dist);var jspreadsheet=dist.exports;function create_fragment$1(e){let o;return{c(){o=element("div"),attr(o,"id","spreadsheet")},m(t,r){insert(t,o,r),e[1](o)},p:noop$1,i:noop$1,o:noop$1,d(t){t&&detach(o),e[1](null)}}}function instance(e,o,t){let r,s=[["Mazda",2001,2e3],["Pegeout",2010,5e3],["Honda Fit",2009,3e3],["Honda CRV",2010,6e3]];onMount(()=>{jspreadsheet(r,{data:s,columns:[{title:"Model",width:300},{title:"Price",width:80},{title:"Model",width:100}]})});function f(h){binding_callbacks[h?"unshift":"push"](()=>{r=h,t(0,r)})}return[r,f]}class SpreadSheet extends SvelteComponent{constructor(o){super(),init(this,o,instance,create_fragment$1,safe_not_equal,{})}}var App_svelte_svelte_type_style_lang=(()=>`:root{font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen,Ubuntu,Cantarell,Open Sans,Helvetica Neue,sans-serif}main.svelte-oqubrc{text-align:center;padding:1em;margin:0 auto}p.svelte-oqubrc{max-width:14rem;margin:1rem auto;line-height:1.35}@media (min-width: 480px){p.svelte-oqubrc{max-width:none}}
`)();function create_default_slot_11(e){let o;return{c(){o=text("Firmata.io, Fast prototyping on web browser. No need to download tools.")},m(t,r){insert(t,o,r)},d(t){t&&detach(o)}}}function create_default_slot_10(e){let o,t,r,s;return o=new Col({props:{$$slots:{default:[create_default_slot_11]},$$scope:{ctx:e}}}),r=new Col({}),{c(){create_component(o.$$.fragment),t=space(),create_component(r.$$.fragment)},m(f,h){mount_component(o,f,h),insert(f,t,h),mount_component(r,f,h),s=!0},p(f,h){const g={};h&1&&(g.$$scope={dirty:h,ctx:f}),o.$set(g)},i(f){s||(transition_in(o.$$.fragment,f),transition_in(r.$$.fragment,f),s=!0)},o(f){transition_out(o.$$.fragment,f),transition_out(r.$$.fragment,f),s=!1},d(f){destroy_component(o,f),f&&detach(t),destroy_component(r,f)}}}function create_default_slot_9(e){let o,t;return o=new Serial({}),{c(){create_component(o.$$.fragment)},m(r,s){mount_component(o,r,s),t=!0},i(r){t||(transition_in(o.$$.fragment,r),t=!0)},o(r){transition_out(o.$$.fragment,r),t=!1},d(r){destroy_component(o,r)}}}function create_default_slot_8(e){let o,t;return o=new Col({props:{$$slots:{default:[create_default_slot_9]},$$scope:{ctx:e}}}),{c(){create_component(o.$$.fragment)},m(r,s){mount_component(o,r,s),t=!0},p(r,s){const f={};s&1&&(f.$$scope={dirty:s,ctx:r}),o.$set(f)},i(r){t||(transition_in(o.$$.fragment,r),t=!0)},o(r){transition_out(o.$$.fragment,r),t=!1},d(r){destroy_component(o,r)}}}function create_default_slot_7(e){let o;return{c(){o=text("asdasdl")},m(t,r){insert(t,o,r)},d(t){t&&detach(o)}}}function create_default_slot_6(e){let o,t;return o=new Button({props:{color:"primary",$$slots:{default:[create_default_slot_7]},$$scope:{ctx:e}}}),{c(){create_component(o.$$.fragment)},m(r,s){mount_component(o,r,s),t=!0},p(r,s){const f={};s&1&&(f.$$scope={dirty:s,ctx:r}),o.$set(f)},i(r){t||(transition_in(o.$$.fragment,r),t=!0)},o(r){transition_out(o.$$.fragment,r),t=!1},d(r){destroy_component(o,r)}}}function create_default_slot_5(e){let o,t;return o=new Col({props:{$$slots:{default:[create_default_slot_6]},$$scope:{ctx:e}}}),{c(){create_component(o.$$.fragment)},m(r,s){mount_component(o,r,s),t=!0},p(r,s){const f={};s&1&&(f.$$scope={dirty:s,ctx:r}),o.$set(f)},i(r){t||(transition_in(o.$$.fragment,r),t=!0)},o(r){transition_out(o.$$.fragment,r),t=!1},d(r){destroy_component(o,r)}}}function create_default_slot_4(e){let o,t,r;return{c(){o=element("p"),o.innerHTML=`Visit <a href="https://svelte.dev">svelte.dev</a> to learn how to build Svelte
        apps.`,t=space(),r=element("p"),r.innerHTML=`Check out <a href="https://github.com/sveltejs/kit#readme">SvelteKit</a> for
        the officially supported framework, also powered by Vite!`,attr(o,"class","svelte-oqubrc"),attr(r,"class","svelte-oqubrc")},m(s,f){insert(s,o,f),insert(s,t,f),insert(s,r,f)},p:noop$1,d(s){s&&detach(o),s&&detach(t),s&&detach(r)}}}function create_default_slot_3(e){let o,t,r,s,f,h;return o=new Row({props:{class:"bottom-buffer border",$$slots:{default:[create_default_slot_8]},$$scope:{ctx:e}}}),r=new Row({props:{class:"bottom-buffer border",$$slots:{default:[create_default_slot_5]},$$scope:{ctx:e}}}),f=new Row({props:{class:"bottom-buffer border",$$slots:{default:[create_default_slot_4]},$$scope:{ctx:e}}}),{c(){create_component(o.$$.fragment),t=space(),create_component(r.$$.fragment),s=space(),create_component(f.$$.fragment)},m(g,u){mount_component(o,g,u),insert(g,t,u),mount_component(r,g,u),insert(g,s,u),mount_component(f,g,u),h=!0},p(g,u){const d={};u&1&&(d.$$scope={dirty:u,ctx:g}),o.$set(d);const a={};u&1&&(a.$$scope={dirty:u,ctx:g}),r.$set(a);const b={};u&1&&(b.$$scope={dirty:u,ctx:g}),f.$set(b)},i(g){h||(transition_in(o.$$.fragment,g),transition_in(r.$$.fragment,g),transition_in(f.$$.fragment,g),h=!0)},o(g){transition_out(o.$$.fragment,g),transition_out(r.$$.fragment,g),transition_out(f.$$.fragment,g),h=!1},d(g){destroy_component(o,g),g&&detach(t),destroy_component(r,g),g&&detach(s),destroy_component(f,g)}}}function create_default_slot_2(e){let o,t;return o=new Col({props:{class:"border",$$slots:{default:[create_default_slot_3]},$$scope:{ctx:e}}}),{c(){create_component(o.$$.fragment)},m(r,s){mount_component(o,r,s),t=!0},p(r,s){const f={};s&1&&(f.$$scope={dirty:s,ctx:r}),o.$set(f)},i(r){t||(transition_in(o.$$.fragment,r),t=!0)},o(r){transition_out(o.$$.fragment,r),t=!1},d(r){destroy_component(o,r)}}}function create_default_slot_1(e){let o,t;return o=new SpreadSheet({}),{c(){create_component(o.$$.fragment)},m(r,s){mount_component(o,r,s),t=!0},i(r){t||(transition_in(o.$$.fragment,r),t=!0)},o(r){transition_out(o.$$.fragment,r),t=!1},d(r){destroy_component(o,r)}}}function create_default_slot(e){let o,t,r;return o=new Col({props:{$$slots:{default:[create_default_slot_1]},$$scope:{ctx:e}}}),{c(){create_component(o.$$.fragment),t=text(`\r
    Footer`)},m(s,f){mount_component(o,s,f),insert(s,t,f),r=!0},p(s,f){const h={};f&1&&(h.$$scope={dirty:f,ctx:s}),o.$set(h)},i(s){r||(transition_in(o.$$.fragment,s),r=!0)},o(s){transition_out(o.$$.fragment,s),r=!1},d(s){destroy_component(o,s),s&&detach(t)}}}function create_fragment(e){let o,t,r,s,f,h,g,u,d;return t=new Styles({}),s=new Row({props:{class:"bottom-buffer border",$$slots:{default:[create_default_slot_10]},$$scope:{ctx:e}}}),h=new Row({props:{class:"bottom-buffer border",$$slots:{default:[create_default_slot_2]},$$scope:{ctx:e}}}),u=new Row({props:{$$slots:{default:[create_default_slot]},$$scope:{ctx:e}}}),{c(){o=element("main"),create_component(t.$$.fragment),r=space(),create_component(s.$$.fragment),f=space(),create_component(h.$$.fragment),g=space(),create_component(u.$$.fragment),attr(o,"class","svelte-oqubrc")},m(a,b){insert(a,o,b),mount_component(t,o,null),append(o,r),mount_component(s,o,null),append(o,f),mount_component(h,o,null),append(o,g),mount_component(u,o,null),d=!0},p(a,[b]){const v={};b&1&&(v.$$scope={dirty:b,ctx:a}),s.$set(v);const w={};b&1&&(w.$$scope={dirty:b,ctx:a}),h.$set(w);const S={};b&1&&(S.$$scope={dirty:b,ctx:a}),u.$set(S)},i(a){d||(transition_in(t.$$.fragment,a),transition_in(s.$$.fragment,a),transition_in(h.$$.fragment,a),transition_in(u.$$.fragment,a),d=!0)},o(a){transition_out(t.$$.fragment,a),transition_out(s.$$.fragment,a),transition_out(h.$$.fragment,a),transition_out(u.$$.fragment,a),d=!1},d(a){a&&detach(o),destroy_component(t),destroy_component(s),destroy_component(h),destroy_component(u)}}}class App extends SvelteComponent{constructor(o){super(),init(this,o,null,create_fragment,safe_not_equal,{})}}new App({target:document.getElementById("app")});
